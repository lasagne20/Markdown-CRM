7efcf406efe903038cf8ec2d75987ada
"use strict";
/**
 * @jest-environment jsdom
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock setIcon function to work synchronously in tests
jest.mock('../../vault/Utils', () => ({
    setIcon: jest.fn((element, iconName) => {
        element.setAttribute('data-icon', iconName);
    }),
    sendNotice: jest.fn()
}));
const NameProperty_1 = require("../../properties/NameProperty");
describe('NameProperty', () => {
    let nameProperty;
    beforeEach(() => {
        nameProperty = new NameProperty_1.NameProperty();
    });
    describe('constructor', () => {
        it('should create NameProperty with correct type and name', () => {
            expect(nameProperty.name).toBe('name');
            expect(nameProperty.type).toBe('name');
            expect(nameProperty.static).toBe(true);
        });
        it('should inherit from Property', () => {
            expect(nameProperty).toBeInstanceOf(nameProperty.constructor);
            expect(nameProperty.hasOwnProperty('name')).toBe(true);
            expect(nameProperty.hasOwnProperty('type')).toBe(true);
            expect(nameProperty.hasOwnProperty('static')).toBe(true);
        });
    });
    describe('read', () => {
        it('should call getLink on file object', () => {
            const mockFile = {
                getLink: jest.fn().mockReturnValue('Test Link')
            };
            const result = nameProperty.read(mockFile);
            expect(mockFile.getLink).toHaveBeenCalledTimes(1);
            expect(result).toBe('Test Link');
        });
        it('should throw error when file has no getLink method', () => {
            const mockFile = {};
            expect(() => nameProperty.read(mockFile)).toThrow();
        });
        it('should throw error with null file', () => {
            expect(() => nameProperty.read(null)).toThrow();
        });
        it('should throw error with undefined file', () => {
            expect(() => nameProperty.read(undefined)).toThrow();
        });
        it('should return result from getLink even if empty', () => {
            const mockFile = {
                getLink: jest.fn().mockReturnValue('')
            };
            const result = nameProperty.read(mockFile);
            expect(result).toBe('');
        });
        it('should return null if getLink returns null', () => {
            const mockFile = {
                getLink: jest.fn().mockReturnValue(null)
            };
            const result = nameProperty.read(mockFile);
            expect(result).toBeNull();
        });
    });
    describe('inherited methods', () => {
        it('should have validate method from parent class', () => {
            expect(typeof nameProperty.validate).toBe('function');
            expect(nameProperty.validate('test')).toBe('test');
        });
        it('should have getLink method from parent class', () => {
            expect(typeof nameProperty.getLink).toBe('function');
            expect(nameProperty.getLink('test')).toBe('test');
        });
        it('should have getPretty method from parent class', () => {
            expect(typeof nameProperty.getPretty).toBe('function');
            expect(nameProperty.getPretty('test')).toBe('test');
        });
        it('should have fillDisplay method from parent class', () => {
            expect(typeof nameProperty.fillDisplay).toBe('function');
        });
    });
    describe('static behavior', () => {
        it('should create static fields when using fillDisplay', () => {
            const mockVault = {};
            const mockUpdate = jest.fn();
            const display = nameProperty.fillDisplay(mockVault, 'Test Name', mockUpdate);
            // Vérifier que l'élément créé contient les bonnes classes
            expect(display.tagName).toBe('DIV');
            expect(display.classList.contains('metadata-field')).toBe(true);
        });
        it('should not allow field modification when static', () => {
            const mockVault = {};
            const mockUpdate = jest.fn();
            const display = nameProperty.fillDisplay(mockVault, 'Test Name', mockUpdate);
            const link = display.querySelector('.field-link');
            if (link) {
                expect(link.style.cursor).toBe('default');
            }
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxzcmNcXF9fdGVzdHNfX1xcUHJvcGVydGllc1xcTmFtZVByb3BlcnR5LnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOztHQUVHOztBQUlILHVEQUF1RDtBQUN2RCxJQUFJLENBQUMsSUFBSSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDbEMsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxPQUFvQixFQUFFLFFBQWdCLEVBQUUsRUFBRTtRQUN4RCxPQUFPLENBQUMsWUFBWSxDQUFDLFdBQVcsRUFBRSxRQUFRLENBQUMsQ0FBQztJQUNoRCxDQUFDLENBQUM7SUFDRixVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUN4QixDQUFDLENBQUMsQ0FBQztBQVJKLGdFQUE2RDtBQVU3RCxRQUFRLENBQUMsY0FBYyxFQUFFLEdBQUcsRUFBRTtJQUMxQixJQUFJLFlBQTBCLENBQUM7SUFFL0IsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNaLFlBQVksR0FBRyxJQUFJLDJCQUFZLEVBQUUsQ0FBQztJQUN0QyxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxhQUFhLEVBQUUsR0FBRyxFQUFFO1FBQ3pCLEVBQUUsQ0FBQyx1REFBdUQsRUFBRSxHQUFHLEVBQUU7WUFDN0QsTUFBTSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDdkMsTUFBTSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDdkMsTUFBTSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDM0MsQ0FBQyxDQUFDLENBQUM7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QUFDLEVBQUUsRUFBRSxDQUFDO1lBRTdCLE1BQU0sT0FBTyxHQUFHLFlBQVksQ0FBQyxXQUFXLENBQUMsU0FBUyxFQUFFLFdBQVcsRUFBRSxVQUFVLENBQUMsQ0FBQztZQUU3RSwwREFBMEQ7WUFDMUQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDcEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDcEUsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsaURBQWlELEVBQUUsR0FBRyxFQUFFO1lBQ3ZELE1BQU0sU0FBUyxHQUFHLEVBQUUsQ0FBQztZQUNyQixNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7WUFFN0IsTUFBTSxPQUFPLEdBQUcsWUFBWSxDQUFDLFdBQVcsQ0FBQyxTQUFTLEVBQUUsV0FBVyxFQUFFLFVBQVUsQ0FBQyxDQUFDO1lBQzdFLE1BQU0sSUFBSSxHQUFHLE9BQU8sQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFnQixDQUFDO1lBRWpFLElBQUksSUFBSSxFQUFFLENBQUM7Z0JBQ1AsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQzlDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxzcmNcXF9fdGVzdHNfX1xcUHJvcGVydGllc1xcTmFtZVByb3BlcnR5LnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBqZXN0LWVudmlyb25tZW50IGpzZG9tXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgTmFtZVByb3BlcnR5IH0gZnJvbSAnLi4vLi4vcHJvcGVydGllcy9OYW1lUHJvcGVydHknO1xyXG5cclxuLy8gTW9jayBzZXRJY29uIGZ1bmN0aW9uIHRvIHdvcmsgc3luY2hyb25vdXNseSBpbiB0ZXN0c1xyXG5qZXN0Lm1vY2soJy4uLy4uL3ZhdWx0L1V0aWxzJywgKCkgPT4gKHtcclxuICAgIHNldEljb246IGplc3QuZm4oKGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBpY29uTmFtZTogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtaWNvbicsIGljb25OYW1lKTtcclxuICAgIH0pLFxyXG4gICAgc2VuZE5vdGljZTogamVzdC5mbigpXHJcbn0pKTtcclxuXHJcbmRlc2NyaWJlKCdOYW1lUHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICBsZXQgbmFtZVByb3BlcnR5OiBOYW1lUHJvcGVydHk7XHJcblxyXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgbmFtZVByb3BlcnR5ID0gbmV3IE5hbWVQcm9wZXJ0eSgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2NvbnN0cnVjdG9yJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIE5hbWVQcm9wZXJ0eSB3aXRoIGNvcnJlY3QgdHlwZSBhbmQgbmFtZScsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KG5hbWVQcm9wZXJ0eS5uYW1lKS50b0JlKCduYW1lJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChuYW1lUHJvcGVydHkudHlwZSkudG9CZSgnbmFtZScpO1xyXG4gICAgICAgICAgICBleHBlY3QobmFtZVByb3BlcnR5LnN0YXRpYykudG9CZSh0cnVlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBpbmhlcml0IGZyb20gUHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChuYW1lUHJvcGVydHkpLnRvQmVJbnN0YW5jZU9mKG5hbWVQcm9wZXJ0eS5jb25zdHJ1Y3Rvcik7XHJcbiAgICAgICAgICAgIGV4cGVjdChuYW1lUHJvcGVydHkuaGFzT3duUHJvcGVydHkoJ25hbWUnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICAgICAgZXhwZWN0KG5hbWVQcm9wZXJ0eS5oYXNPd25Qcm9wZXJ0eSgndHlwZScpKS50b0JlKHRydWUpO1xyXG4gICAgICAgICAgICBleHBlY3QobmFtZVByb3BlcnR5Lmhhc093blByb3BlcnR5KCdzdGF0aWMnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdyZWFkJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgY2FsbCBnZXRMaW5rIG9uIGZpbGUgb2JqZWN0JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrRmlsZSA9IHtcclxuICAgICAgICAgICAgICAgIGdldExpbms6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ1Rlc3QgTGluaycpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBuYW1lUHJvcGVydHkucmVhZChtb2NrRmlsZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QobW9ja0ZpbGUuZ2V0TGluaykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKCdUZXN0IExpbmsnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCB0aHJvdyBlcnJvciB3aGVuIGZpbGUgaGFzIG5vIGdldExpbmsgbWV0aG9kJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrRmlsZSA9IHt9O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KCgpID0+IG5hbWVQcm9wZXJ0eS5yZWFkKG1vY2tGaWxlKSkudG9UaHJvdygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHRocm93IGVycm9yIHdpdGggbnVsbCBmaWxlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QoKCkgPT4gbmFtZVByb3BlcnR5LnJlYWQobnVsbCkpLnRvVGhyb3coKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCB0aHJvdyBlcnJvciB3aXRoIHVuZGVmaW5lZCBmaWxlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QoKCkgPT4gbmFtZVByb3BlcnR5LnJlYWQodW5kZWZpbmVkKSkudG9UaHJvdygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiByZXN1bHQgZnJvbSBnZXRMaW5rIGV2ZW4gaWYgZW1wdHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tGaWxlID0ge1xyXG4gICAgICAgICAgICAgICAgZ2V0TGluazogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnJylcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG5hbWVQcm9wZXJ0eS5yZWFkKG1vY2tGaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoJycpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBudWxsIGlmIGdldExpbmsgcmV0dXJucyBudWxsJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrRmlsZSA9IHtcclxuICAgICAgICAgICAgICAgIGdldExpbms6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUobnVsbClcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG5hbWVQcm9wZXJ0eS5yZWFkKG1vY2tGaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVOdWxsKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnaW5oZXJpdGVkIG1ldGhvZHMnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYXZlIHZhbGlkYXRlIG1ldGhvZCBmcm9tIHBhcmVudCBjbGFzcycsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KHR5cGVvZiBuYW1lUHJvcGVydHkudmFsaWRhdGUpLnRvQmUoJ2Z1bmN0aW9uJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChuYW1lUHJvcGVydHkudmFsaWRhdGUoJ3Rlc3QnKSkudG9CZSgndGVzdCcpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhdmUgZ2V0TGluayBtZXRob2QgZnJvbSBwYXJlbnQgY2xhc3MnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0eXBlb2YgbmFtZVByb3BlcnR5LmdldExpbmspLnRvQmUoJ2Z1bmN0aW9uJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChuYW1lUHJvcGVydHkuZ2V0TGluaygndGVzdCcpKS50b0JlKCd0ZXN0Jyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGF2ZSBnZXRQcmV0dHkgbWV0aG9kIGZyb20gcGFyZW50IGNsYXNzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QodHlwZW9mIG5hbWVQcm9wZXJ0eS5nZXRQcmV0dHkpLnRvQmUoJ2Z1bmN0aW9uJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChuYW1lUHJvcGVydHkuZ2V0UHJldHR5KCd0ZXN0JykpLnRvQmUoJ3Rlc3QnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYXZlIGZpbGxEaXNwbGF5IG1ldGhvZCBmcm9tIHBhcmVudCBjbGFzcycsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KHR5cGVvZiBuYW1lUHJvcGVydHkuZmlsbERpc3BsYXkpLnRvQmUoJ2Z1bmN0aW9uJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnc3RhdGljIGJlaGF2aW9yJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIHN0YXRpYyBmaWVsZHMgd2hlbiB1c2luZyBmaWxsRGlzcGxheScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1ZhdWx0ID0ge307XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBkaXNwbGF5ID0gbmFtZVByb3BlcnR5LmZpbGxEaXNwbGF5KG1vY2tWYXVsdCwgJ1Rlc3QgTmFtZScsIG1vY2tVcGRhdGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVsOpcmlmaWVyIHF1ZSBsJ8OpbMOpbWVudCBjcsOpw6kgY29udGllbnQgbGVzIGJvbm5lcyBjbGFzc2VzXHJcbiAgICAgICAgICAgIGV4cGVjdChkaXNwbGF5LnRhZ05hbWUpLnRvQmUoJ0RJVicpO1xyXG4gICAgICAgICAgICBleHBlY3QoZGlzcGxheS5jbGFzc0xpc3QuY29udGFpbnMoJ21ldGFkYXRhLWZpZWxkJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgbm90IGFsbG93IGZpZWxkIG1vZGlmaWNhdGlvbiB3aGVuIHN0YXRpYycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1ZhdWx0ID0ge307XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBkaXNwbGF5ID0gbmFtZVByb3BlcnR5LmZpbGxEaXNwbGF5KG1vY2tWYXVsdCwgJ1Rlc3QgTmFtZScsIG1vY2tVcGRhdGUpO1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gZGlzcGxheS5xdWVyeVNlbGVjdG9yKCcuZmllbGQtbGluaycpIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKGxpbmspIHtcclxuICAgICAgICAgICAgICAgIGV4cGVjdChsaW5rLnN0eWxlLmN1cnNvcikudG9CZSgnZGVmYXVsdCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufSk7Il0sInZlcnNpb24iOjN9