{"file":"C:\\Users\\leodu\\Documents\\1 - Pro\\Test plugin obsidian\\.obsidian\\plugins\\obsidian-CRM\\dynamic-fields\\src\\properties\\RatingProperty.ts","mappings":"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","names":[],"sources":["C:\\Users\\leodu\\Documents\\1 - Pro\\Test plugin obsidian\\.obsidian\\plugins\\obsidian-CRM\\dynamic-fields\\src\\properties\\RatingProperty.ts"],"sourcesContent":["import { setIcon } from \"../vault/Utils\";\r\nimport { Property } from \"./Property\";\r\n\r\n\r\nexport class RatingProperty extends Property {\r\n\r\n    public override type : string = \"rating\";\r\n\r\n    constructor(name: string, args : {} = {icon: \"star\"}) {\r\n        super(name, args); \r\n    }\r\n\r\n    override fillDisplay(vault : any, value : any, update: (value: string) => Promise<void>) {\r\n        this.vault = vault\r\n        const field = this.createFieldContainer();\r\n        const fieldContainer = document.createElement(\"div\");\r\n        fieldContainer.classList.add(\"field-container-column\");\r\n\r\n        const header = document.createElement(\"div\");\r\n        header.classList.add(\"metadata-header\");\r\n        header.textContent = this.name\r\n        fieldContainer.appendChild(header);\r\n\r\n        const stars = this.createStarRating(value, update); \r\n        fieldContainer.appendChild(stars);\r\n        field.appendChild(fieldContainer);\r\n        return field;\r\n    }\r\n\r\n    // Fonction pour créer la notation par étoiles (5 étoiles cliquables)\r\n    createStarRating(value: string, update: (value: string) => Promise<void>): HTMLDivElement {\r\n        const starContainer = document.createElement(\"div\");\r\n        starContainer.classList.add(\"star-rating\");\r\n\r\n        let selectedRating = 0;\r\n        if (value) {\r\n            selectedRating = value.length;\r\n        }\r\n\r\n        // Crée les 5 étoiles\r\n        for (let i = 1; i <= 5; i++) {\r\n            const star = document.createElement(\"div\");\r\n            star.classList.add(\"star\");\r\n            setIcon(star, this.icon);\r\n\r\n            star.setAttribute(\"data-value\", i.toString());\r\n\r\n            const svg = star.querySelector(\"svg\");\r\n            if (svg) {\r\n                if (i <= selectedRating) {\r\n                    svg.classList.add(\"filled-star\");\r\n                }\r\n            }\r\n\r\n            // Ajout des événements pour l'interaction utilisateur\r\n            star.onmouseover = () => this.previewStars(starContainer, i);\r\n            star.onmouseleave = () => this.previewStars(starContainer, selectedRating);\r\n            star.onclick = async () => {\r\n                selectedRating = i;\r\n                await update('+'.repeat(i)); // Sauvegarde en métadonnées sous forme de \"+\"\r\n                this.updateStarRating(starContainer, selectedRating);\r\n            };\r\n\r\n            starContainer.appendChild(star);\r\n        }\r\n\r\n        this.updateStarRating(starContainer, selectedRating); // Initial update to ensure correct state\r\n        return starContainer;\r\n    }\r\n\r\n    // Met à jour l'affichage des étoiles en fonction du niveau actuel\r\n    updateStarRating(starContainer: HTMLDivElement, rating: number) {\r\n        const stars = starContainer.querySelectorAll('.star') as NodeListOf<HTMLElement>;\r\n        stars.forEach((star, index) => {\r\n            const svg = star.querySelector(\"svg\");\r\n            if (svg) {\r\n                if (index < rating) {\r\n                    svg.classList.add(\"filled-star\");\r\n                } else {\r\n                    svg.classList.remove(\"filled-star\");\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    // Prévisualise les étoiles en fonction du survol\r\n    previewStars(starContainer: HTMLDivElement, rating: number) {\r\n        const stars = starContainer.querySelectorAll('.star') as NodeListOf<HTMLElement>;\r\n        stars.forEach((star, index) => {\r\n            const svg = star.querySelector(\"svg\");\r\n            if (svg) {\r\n                if (index < rating) {\r\n                    svg.classList.add(\"hovered-star\");\r\n                } else {\r\n                    svg.classList.remove(\"hovered-star\");\r\n                }\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n"],"version":3}