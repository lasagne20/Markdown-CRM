26ba0277bd8a03c14c2ccbbe71eeaadb
"use strict";
/**
 * @jest-environment jsdom
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock dependencies
jest.mock('../../vault/Utils', () => ({
    setIcon: jest.fn()
}));
const SelectProperty_1 = require("../../properties/SelectProperty");
const SubClassProperty_1 = require("../../properties/SubClassProperty");
describe('SubClassProperty', () => {
    let subClassProperty;
    let mockSubClasses;
    let mockFile;
    beforeEach(() => {
        // Reset DOM mocks
        document.body.innerHTML = '';
        jest.clearAllMocks();
        // Mock SubClass objects
        mockSubClasses = [
            {
                getsubClassName: jest.fn().mockReturnValue('SubClass1'),
                getConstructor: jest.fn().mockReturnValue('Constructor1'),
                getProperties: jest.fn().mockReturnValue({
                    prop1: { name: 'prop1', type: 'text' },
                    prop2: { name: 'prop2', type: 'number' }
                }),
                getTopDisplayContent: jest.fn().mockReturnValue(document.createElement('div'))
            },
            {
                getsubClassName: jest.fn().mockReturnValue('SubClass2'),
                getConstructor: jest.fn().mockReturnValue('Constructor2'),
                getProperties: jest.fn().mockReturnValue({
                    prop3: { name: 'prop3', type: 'text' }
                }),
                getTopDisplayContent: jest.fn().mockReturnValue(document.createElement('span'))
            }
        ];
        // Mock File object
        mockFile = {
            metadata: {},
            updateMetadata: jest.fn()
        };
    });
    beforeEach(() => {
        subClassProperty = new SubClassProperty_1.SubClassProperty('testSubClass', mockSubClasses);
    });
    describe('constructor', () => {
        it('should create SubClassProperty with correct type', () => {
            expect(subClassProperty.type).toBe('subClass');
        });
        it('should inherit from SelectProperty', () => {
            expect(subClassProperty).toBeInstanceOf(SelectProperty_1.SelectProperty);
        });
        it('should store subClasses correctly', () => {
            expect(subClassProperty.subClasses).toBe(mockSubClasses);
            expect(subClassProperty.subClasses.length).toBe(2);
        });
        it('should pass subclass names to parent SelectProperty', () => {
            // Check that options were created from subclass names
            expect(subClassProperty.options).toEqual([
                { name: 'SubClass1', color: '' },
                { name: 'SubClass2', color: '' }
            ]);
        });
        it('should pass args to parent constructor', () => {
            const customArgs = { icon: 'custom-icon' };
            const customProperty = new SubClassProperty_1.SubClassProperty('customName', mockSubClasses, customArgs);
            expect(customProperty.name).toBe('customName');
        });
        it('should handle empty subClasses array', () => {
            const emptyProperty = new SubClassProperty_1.SubClassProperty('empty', []);
            expect(emptyProperty.subClasses).toEqual([]);
            expect(emptyProperty.options).toEqual([]);
        });
    });
    describe('getSubClassFromName', () => {
        it('should return constructor for existing subclass name', () => {
            const result = subClassProperty.getSubClassFromName('SubClass1');
            expect(result).toBe('Constructor1');
            expect(mockSubClasses[0].getsubClassName).toHaveBeenCalled();
            expect(mockSubClasses[0].getConstructor).toHaveBeenCalled();
        });
        it('should return undefined for non-existing subclass name', () => {
            const result = subClassProperty.getSubClassFromName('NonExistentClass');
            expect(result).toBeUndefined();
        });
        it('should handle empty string', () => {
            const result = subClassProperty.getSubClassFromName('');
            expect(result).toBeUndefined();
        });
        it('should handle null input', () => {
            const result = subClassProperty.getSubClassFromName(null);
            expect(result).toBeUndefined();
        });
        it('should handle case sensitivity', () => {
            const result = subClassProperty.getSubClassFromName('subclass1');
            expect(result).toBeUndefined(); // Should be case sensitive
        });
    });
    describe('getSubClass', () => {
        beforeEach(() => {
            // Mock the read method to return a specific value
            subClassProperty.read = jest.fn();
        });
        it('should return subclass when value matches', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass1');
            const result = subClassProperty.getSubClass(mockFile);
            expect(subClassProperty.read).toHaveBeenCalledWith(mockFile);
            expect(result).toBe(mockSubClasses[0]);
        });
        it('should return undefined when no match found', () => {
            subClassProperty.read = jest.fn().mockReturnValue('NonExistentClass');
            const result = subClassProperty.getSubClass(mockFile);
            expect(result).toBeUndefined();
        });
        it('should return undefined when read returns null', () => {
            subClassProperty.read = jest.fn().mockReturnValue(null);
            const result = subClassProperty.getSubClass(mockFile);
            expect(result).toBeUndefined();
        });
        it('should return undefined when read returns undefined', () => {
            subClassProperty.read = jest.fn().mockReturnValue(undefined);
            const result = subClassProperty.getSubClass(mockFile);
            expect(result).toBeUndefined();
        });
        it('should handle second subclass correctly', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass2');
            const result = subClassProperty.getSubClass(mockFile);
            expect(result).toBe(mockSubClasses[1]);
        });
    });
    describe('getSubclassesNames', () => {
        it('should return all subclasses', () => {
            const result = subClassProperty.getSubclassesNames();
            expect(result).toBe(mockSubClasses);
            expect(result.length).toBe(2);
        });
        it('should return empty array when no subclasses', () => {
            const emptyProperty = new SubClassProperty_1.SubClassProperty('empty', []);
            const result = emptyProperty.getSubclassesNames();
            expect(result).toEqual([]);
        });
        it('should return same reference to subclasses array', () => {
            const result = subClassProperty.getSubclassesNames();
            expect(result).toBe(subClassProperty.subClasses);
        });
    });
    describe('getSubClassProperty', () => {
        beforeEach(() => {
            subClassProperty.read = jest.fn();
        });
        it('should return properties when subclass found', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass1');
            const result = subClassProperty.getSubClassProperty(mockFile);
            expect(result).toEqual([
                { name: 'prop1', type: 'text' },
                { name: 'prop2', type: 'number' }
            ]);
            expect(mockSubClasses[0].getProperties).toHaveBeenCalled();
        });
        it('should return empty array when no subclass found', () => {
            subClassProperty.read = jest.fn().mockReturnValue('NonExistentClass');
            const result = subClassProperty.getSubClassProperty(mockFile);
            expect(result).toEqual([]);
        });
        it('should return empty array when subclass has no properties', () => {
            const subClassWithoutProps = {
                getsubClassName: jest.fn().mockReturnValue('EmptyClass'),
                getConstructor: jest.fn().mockReturnValue('EmptyConstructor'),
                getProperties: jest.fn().mockReturnValue(null),
                getTopDisplayContent: jest.fn().mockReturnValue(document.createElement('div'))
            };
            const propertyWithEmptyClass = new SubClassProperty_1.SubClassProperty('test', [subClassWithoutProps]);
            propertyWithEmptyClass.read = jest.fn().mockReturnValue('EmptyClass');
            const result = propertyWithEmptyClass.getSubClassProperty(mockFile);
            expect(result).toEqual([]);
        });
        it('should handle different property structures', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass2');
            const result = subClassProperty.getSubClassProperty(mockFile);
            expect(result).toEqual([{ name: 'prop3', type: 'text' }]);
        });
    });
    describe('getTopDisplayContent', () => {
        beforeEach(() => {
            subClassProperty.read = jest.fn();
        });
        it('should return container with subclass content when subclass found', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass1');
            const result = subClassProperty.getTopDisplayContent(mockFile);
            expect(result.tagName).toBe('DIV');
            expect(result.children.length).toBe(1);
            expect(mockSubClasses[0].getTopDisplayContent).toHaveBeenCalledWith(mockFile);
        });
        it('should return empty container when no subclass found', () => {
            subClassProperty.read = jest.fn().mockReturnValue('NonExistentClass');
            const result = subClassProperty.getTopDisplayContent(mockFile);
            expect(result.tagName).toBe('DIV');
            expect(result.children.length).toBe(0);
        });
        it('should handle null read result', () => {
            subClassProperty.read = jest.fn().mockReturnValue(null);
            const result = subClassProperty.getTopDisplayContent(mockFile);
            expect(result.tagName).toBe('DIV');
            expect(result.children.length).toBe(0);
        });
        it('should call getTopDisplayContent on correct subclass', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass2');
            const result = subClassProperty.getTopDisplayContent(mockFile);
            expect(mockSubClasses[1].getTopDisplayContent).toHaveBeenCalledWith(mockFile);
            expect(mockSubClasses[0].getTopDisplayContent).not.toHaveBeenCalled();
        });
    });
    describe('inheritance from SelectProperty', () => {
        it('should have options property from parent', () => {
            expect(subClassProperty.options).toBeDefined();
            expect(Array.isArray(subClassProperty.options)).toBe(true);
        });
        it('should have name property from parent', () => {
            expect(subClassProperty.name).toBe('testSubClass');
        });
        it('should have fillDisplay method from parent', () => {
            expect(typeof subClassProperty.fillDisplay).toBe('function');
        });
        it('should have read method from parent', () => {
            expect(typeof subClassProperty.read).toBe('function');
        });
    });
    describe('integration with subclasses', () => {
        it('should maintain consistency between subClasses and options', () => {
            expect(subClassProperty.subClasses.length).toBe(subClassProperty.options.length);
            subClassProperty.subClasses.forEach((subClass, index) => {
                expect(subClass.getsubClassName()).toBe(subClassProperty.options[index].name);
            });
        });
        it('should handle subclass method calls correctly', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass1');
            // Test multiple method calls
            subClassProperty.getSubClass(mockFile);
            subClassProperty.getSubClassProperty(mockFile);
            subClassProperty.getTopDisplayContent(mockFile);
            // Verify all methods were called on the correct subclass
            expect(mockSubClasses[0].getsubClassName).toHaveBeenCalled();
            expect(mockSubClasses[0].getProperties).toHaveBeenCalled();
            expect(mockSubClasses[0].getTopDisplayContent).toHaveBeenCalled();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxzcmNcXF9fdGVzdHNfX1xcUHJvcGVydGllc1xcU3ViQ2xhc3NQcm9wZXJ0eS50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7QUFLSCxvQkFBb0I7QUFDcEIsSUFBSSxDQUFDLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ2xDLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0NBQ3JCLENBQUMsQ0FBQyxDQUFDO0FBTkosb0VBQWlFO0FBQ2pFLHdFQUFxRTtBQU9yRSxRQUFRLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxFQUFFO0lBQzlCLElBQUksZ0JBQWtDLENBQUM7SUFDdkMsSUFBSSxjQUFxQixDQUFDO0lBQzFCLElBQUksUUFBYSxDQUFDO0lBRWxCLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDWixrQkFBa0I7UUFDbEIsUUFBUSxDQUFDLElBQUksQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDO1FBQzdCLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUVyQix3QkFBd0I7UUFDeEIsY0FBYyxHQUFHO1lBQ2I7Z0JBQ0ksZUFBZSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsV0FBVyxDQUFDO2dCQUN2RCxjQUFjLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQyxjQUFjLENBQUM7Z0JBQ3pELGFBQWEsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDO29CQUNyQyxLQUFLLEVBQUUsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUU7b0JBQ3RDLEtBQUssRUFBRSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRTtpQkFDM0MsQ0FBQztnQkFDRixvQkFBb0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7YUFDakY7WUFDRDtnQkFDSSxlQUFlLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQyxXQUFXLENBQUM7Z0JBQ3ZELGNBQWMsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLGNBQWMsQ0FBQztnQkFDekQsYUFBYSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUM7b0JBQ3JDLEtBQUssRUFBRSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRTtpQkFDekMsQ0FBQztnQkFDRixvQkFBb0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLENBQUM7YUFDbEY7U0FDSixDQUFDO1FBRUYsbUJBQW1CO1FBQ25CLFFBQVEsR0FBRztZQUNQLFFBQVEsRUFBRSxFQUFFO1lBQ1osY0FBYyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7U0FDNUIsQ0FBQztJQUNOLENBQUMsQ0FBQyxDQUFDO0lBRUgsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNaLGdCQUFnQixHQUFHLElBQUksbUNBQWdCLENBQUMsY0FBYyxFQUFFLGNBQWMsQ0FBQyxDQUFDO0lBQzVFLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGFBQWEsRUFBRSxHQUFHLEVBQUU7UUFDekIsRUFBRSxDQUFDLGtEQUFrRCxFQUFFLEdBQUcsRUFBRTtZQUN4RCxNQUFNLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ25ELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG9DQUFvQyxFQUFFLEdBQUcsRUFBRTtZQUMxQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxjQUFjLENBQUMsK0JBQWMsQ0FBQyxDQUFDO1FBQzVELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG1DQUFtQyxFQUFFLEdBQUcsRUFBRTtZQUN6QyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDO1lBQ3pELE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3ZELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHFEQUFxRCxFQUFFLEdBQUcsRUFBRTtZQUMzRCxzREFBc0Q7WUFDdEQsTUFBTSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQztnQkFDckMsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUU7Z0JBQ2hDLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFO2FBQ25DLENBQUMsQ0FBQztRQUNQLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHdDQUF3QyxFQUFFLEdBQUcsRUFBRTtZQUM5QyxNQUFNLFVBQVUsR0FBRyxFQUFFLElBQUksRUFBRSxhQUFhLEVBQUUsQ0FBQztZQUMzQyxNQUFNLGNBQWMsR0FBRyxJQUFJLG1DQUFnQixDQUFDLFlBQVksRUFBRSxjQUFjLEVBQUUsVUFBVSxDQUFDLENBQUM7WUFDdEYsTUFBTSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDbkQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsc0NBQXNDLEVBQUUsR0FBRyxFQUFFO1lBQzVDLE1BQU0sYUFBYSxHQUFHLElBQUksbUNBQWdCLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBQ3hELE1BQU0sQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQzdDLE1BQU0sQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQzlDLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMscUJBQXFCLEVBQUUsR0FBRyxFQUFFO1FBQ2pDLEVBQUUsQ0FBQyxzREFBc0QsRUFBRSxHQUFHLEVBQUU7WUFDNUQsTUFBTSxNQUFNLEdBQUcsZ0JBQWdCLENBQUMsbUJBQW1CLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDakUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQztZQUNwQyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLGdCQUFnQixFQUFFLENBQUM7WUFDN0QsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxjQUFjLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQ2hFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHdEQUF3RCxFQUFFLEdBQUcsRUFBRTtZQUM5RCxNQUFNLE1BQU0sR0FBRyxnQkFBZ0IsQ0FBQyxtQkFBbUIsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1lBQ3hFLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUNuQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw0QkFBNEIsRUFBRSxHQUFHLEVBQUU7WUFDbEMsTUFBTSxNQUFNLEdBQUcsZ0JBQWdCLENBQUMsbUJBQW1CLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDeEQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQ25DLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDBCQUEwQixFQUFFLEdBQUcsRUFBRTtZQUNoQyxNQUFNLE1BQU0sR0FBRyxnQkFBZ0IsQ0FBQyxtQkFBbUIsQ0FBQyxJQUFXLENBQUMsQ0FBQztZQUNqRSxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDbkMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsZ0NBQWdDLEVBQUUsR0FBRyxFQUFFO1lBQ3RDLE1BQU0sTUFBTSxHQUFHLGdCQUFnQixDQUFDLG1CQUFtQixDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQ2pFLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxhQUFhLEVBQUUsQ0FBQyxDQUFDLDJCQUEyQjtRQUMvRCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGFBQWEsRUFBRSxHQUFHLEVBQUU7UUFDekIsVUFBVSxDQUFDLEdBQUcsRUFBRTtZQUNaLGtEQUFrRDtZQUNsRCxnQkFBZ0IsQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQ3RDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDJDQUEyQyxFQUFFLEdBQUcsRUFBRTtZQUNqRCxnQkFBZ0IsQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUUvRCxNQUFNLE1BQU0sR0FBRyxnQkFBZ0IsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7WUFFdEQsTUFBTSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxDQUFDLG9CQUFvQixDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQzdELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDM0MsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNkNBQTZDLEVBQUUsR0FBRyxFQUFFO1lBQ25ELGdCQUFnQixDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLGtCQUFrQixDQUFDLENBQUM7WUFFdEUsTUFBTSxNQUFNLEdBQUcsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBRXRELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUNuQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxnREFBZ0QsRUFBRSxHQUFHLEVBQUU7WUFDdEQsZ0JBQWdCLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUM7WUFFeEQsTUFBTSxNQUFNLEdBQUcsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBRXRELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUNuQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxxREFBcUQsRUFBRSxHQUFHLEVBQUU7WUFDM0QsZ0JBQWdCLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsU0FBUyxDQUFDLENBQUM7WUFFN0QsTUFBTSxNQUFNLEdBQUcsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBRXRELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUNuQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx5Q0FBeUMsRUFBRSxHQUFHLEVBQUU7WUFDL0MsZ0JBQWdCLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsV0FBVyxDQUFDLENBQUM7WUFFL0QsTUFBTSxNQUFNLEdBQUcsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBRXRELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDM0MsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUU7UUFDaEMsRUFBRSxDQUFDLDhCQUE4QixFQUFFLEdBQUcsRUFBRTtZQUNwQyxNQUFNLE1BQU0sR0FBRyxnQkFBZ0IsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1lBRXJELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7WUFDcEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsOENBQThDLEVBQUUsR0FBRyxFQUFFO1lBQ3BELE1BQU0sYUFBYSxHQUFHLElBQUksbUNBQWdCLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBRXhELE1BQU0sTUFBTSxHQUFHLGFBQWEsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1lBRWxELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDL0IsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsa0RBQWtELEVBQUUsR0FBRyxFQUFFO1lBQ3hELE1BQU0sTUFBTSxHQUFHLGdCQUFnQixDQUFDLGtCQUFrQixFQUFFLENBQUM7WUFFckQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNyRCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLHFCQUFxQixFQUFFLEdBQUcsRUFBRTtRQUNqQyxVQUFVLENBQUMsR0FBRyxFQUFFO1lBQ1osZ0JBQWdCLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQztRQUN0QyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw4Q0FBOEMsRUFBRSxHQUFHLEVBQUU7WUFDcEQsZ0JBQWdCLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsV0FBVyxDQUFDLENBQUM7WUFFL0QsTUFBTSxNQUFNLEdBQUcsZ0JBQWdCLENBQUMsbUJBQW1CLENBQUMsUUFBUSxDQUFDLENBQUM7WUFFOUQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQztnQkFDbkIsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUU7Z0JBQy9CLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFO2FBQ3BDLENBQUMsQ0FBQztZQUNILE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztRQUMvRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxrREFBa0QsRUFBRSxHQUFHLEVBQUU7WUFDeEQsZ0JBQWdCLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsa0JBQWtCLENBQUMsQ0FBQztZQUV0RSxNQUFNLE1BQU0sR0FBRyxnQkFBZ0IsQ0FBQyxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUU5RCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQy9CLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDJEQUEyRCxFQUFFLEdBQUcsRUFBRTtZQUNqRSxNQUFNLG9CQUFvQixHQUFHO2dCQUN6QixlQUFlLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQyxZQUFZLENBQUM7Z0JBQ3hELGNBQWMsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLGtCQUFrQixDQUFDO2dCQUM3RCxhQUFhLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUM7Z0JBQzlDLG9CQUFvQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQzthQUNqRixDQUFDO1lBRUYsTUFBTSxzQkFBc0IsR0FBRyxJQUFJLG1DQUFnQixDQUFDLE1BQU0sRUFBRSxDQUFDLG9CQUFvQixDQUFDLENBQUMsQ0FBQztZQUNwRixzQkFBc0IsQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUV0RSxNQUFNLE1BQU0sR0FBRyxzQkFBc0IsQ0FBQyxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUVwRSxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQy9CLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDZDQUE2QyxFQUFFLEdBQUcsRUFBRTtZQUNuRCxnQkFBZ0IsQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUUvRCxNQUFNLE1BQU0sR0FBRyxnQkFBZ0IsQ0FBQyxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUU5RCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDOUQsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLEVBQUU7UUFDbEMsVUFBVSxDQUFDLEdBQUcsRUFBRTtZQUNaLGdCQUFnQixDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDdEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsbUVBQW1FLEVBQUUsR0FBRyxFQUFFO1lBQ3pFLGdCQUFnQixDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBRS9ELE1BQU0sTUFBTSxHQUFHLGdCQUFnQixDQUFDLG9CQUFvQixDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBRS9ELE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ25DLE1BQU0sQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN2QyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLENBQUMsb0JBQW9CLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDbEYsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsc0RBQXNELEVBQUUsR0FBRyxFQUFFO1lBQzVELGdCQUFnQixDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLGtCQUFrQixDQUFDLENBQUM7WUFFdEUsTUFBTSxNQUFNLEdBQUcsZ0JBQWdCLENBQUMsb0JBQW9CLENBQUMsUUFBUSxDQUFDLENBQUM7WUFFL0QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDbkMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzNDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGdDQUFnQyxFQUFFLEdBQUcsRUFBRTtZQUN0QyxnQkFBZ0IsQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUV4RCxNQUFNLE1BQU0sR0FBRyxnQkFBZ0IsQ0FBQyxvQkFBb0IsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUUvRCxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNuQyxNQUFNLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDM0MsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsc0RBQXNELEVBQUUsR0FBRyxFQUFFO1lBQzVELGdCQUFnQixDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBRS9ELE1BQU0sTUFBTSxHQUFHLGdCQUFnQixDQUFDLG9CQUFvQixDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBRS9ELE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUM5RSxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLENBQUMsR0FBRyxDQUFDLGdCQUFnQixFQUFFLENBQUM7UUFDMUUsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxpQ0FBaUMsRUFBRSxHQUFHLEVBQUU7UUFDN0MsRUFBRSxDQUFDLDBDQUEwQyxFQUFFLEdBQUcsRUFBRTtZQUNoRCxNQUFNLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDL0MsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDL0QsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsdUNBQXVDLEVBQUUsR0FBRyxFQUFFO1lBQzdDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDdkQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNENBQTRDLEVBQUUsR0FBRyxFQUFFO1lBQ2xELE1BQU0sQ0FBQyxPQUFPLGdCQUFnQixDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNqRSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxxQ0FBcUMsRUFBRSxHQUFHLEVBQUU7WUFDM0MsTUFBTSxDQUFDLE9BQU8sZ0JBQWdCLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQzFELENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsNkJBQTZCLEVBQUUsR0FBRyxFQUFFO1FBQ3pDLEVBQUUsQ0FBQyw0REFBNEQsRUFBRSxHQUFHLEVBQUU7WUFDbEUsTUFBTSxDQUFDLGdCQUFnQixDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBRWpGLGdCQUFnQixDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxRQUFRLEVBQUUsS0FBSyxFQUFFLEVBQUU7Z0JBQ3BELE1BQU0sQ0FBQyxRQUFRLENBQUMsZUFBZSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2xGLENBQUMsQ0FBQyxDQUFDO1FBQ1AsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsK0NBQStDLEVBQUUsR0FBRyxFQUFFO1lBQ3JELGdCQUFnQixDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBRS9ELDZCQUE2QjtZQUM3QixnQkFBZ0IsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDdkMsZ0JBQWdCLENBQUMsbUJBQW1CLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDL0MsZ0JBQWdCLENBQUMsb0JBQW9CLENBQUMsUUFBUSxDQUFDLENBQUM7WUFFaEQseURBQXlEO1lBQ3pELE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUMsZUFBZSxDQUFDLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztZQUM3RCxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLGdCQUFnQixFQUFFLENBQUM7WUFDM0QsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLGdCQUFnQixFQUFFLENBQUM7UUFDdEUsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbGVvZHVcXERvY3VtZW50c1xcMSAtIFByb1xcVGVzdCBwbHVnaW4gb2JzaWRpYW5cXC5vYnNpZGlhblxccGx1Z2luc1xcb2JzaWRpYW4tQ1JNXFxkeW5hbWljLWZpZWxkc1xcc3JjXFxfX3Rlc3RzX19cXFByb3BlcnRpZXNcXFN1YkNsYXNzUHJvcGVydHkudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQGplc3QtZW52aXJvbm1lbnQganNkb21cclxuICovXHJcblxyXG5pbXBvcnQgeyBTZWxlY3RQcm9wZXJ0eSB9IGZyb20gJy4uLy4uL3Byb3BlcnRpZXMvU2VsZWN0UHJvcGVydHknO1xyXG5pbXBvcnQgeyBTdWJDbGFzc1Byb3BlcnR5IH0gZnJvbSAnLi4vLi4vcHJvcGVydGllcy9TdWJDbGFzc1Byb3BlcnR5JztcclxuXHJcbi8vIE1vY2sgZGVwZW5kZW5jaWVzXHJcbmplc3QubW9jaygnLi4vLi4vdmF1bHQvVXRpbHMnLCAoKSA9PiAoe1xyXG4gICAgc2V0SWNvbjogamVzdC5mbigpXHJcbn0pKTtcclxuXHJcbmRlc2NyaWJlKCdTdWJDbGFzc1Byb3BlcnR5JywgKCkgPT4ge1xyXG4gICAgbGV0IHN1YkNsYXNzUHJvcGVydHk6IFN1YkNsYXNzUHJvcGVydHk7XHJcbiAgICBsZXQgbW9ja1N1YkNsYXNzZXM6IGFueVtdO1xyXG4gICAgbGV0IG1vY2tGaWxlOiBhbnk7XHJcblxyXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgLy8gUmVzZXQgRE9NIG1vY2tzXHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBNb2NrIFN1YkNsYXNzIG9iamVjdHNcclxuICAgICAgICBtb2NrU3ViQ2xhc3NlcyA9IFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZ2V0c3ViQ2xhc3NOYW1lOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdTdWJDbGFzczEnKSxcclxuICAgICAgICAgICAgICAgIGdldENvbnN0cnVjdG9yOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdDb25zdHJ1Y3RvcjEnKSxcclxuICAgICAgICAgICAgICAgIGdldFByb3BlcnRpZXM6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHByb3AxOiB7IG5hbWU6ICdwcm9wMScsIHR5cGU6ICd0ZXh0JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHByb3AyOiB7IG5hbWU6ICdwcm9wMicsIHR5cGU6ICdudW1iZXInIH1cclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgZ2V0VG9wRGlzcGxheUNvbnRlbnQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JykpXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGdldHN1YkNsYXNzTmFtZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnU3ViQ2xhc3MyJyksXHJcbiAgICAgICAgICAgICAgICBnZXRDb25zdHJ1Y3RvcjogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnQ29uc3RydWN0b3IyJyksXHJcbiAgICAgICAgICAgICAgICBnZXRQcm9wZXJ0aWVzOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9wMzogeyBuYW1lOiAncHJvcDMnLCB0eXBlOiAndGV4dCcgfVxyXG4gICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICBnZXRUb3BEaXNwbGF5Q29udGVudDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJykpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIE1vY2sgRmlsZSBvYmplY3RcclxuICAgICAgICBtb2NrRmlsZSA9IHtcclxuICAgICAgICAgICAgbWV0YWRhdGE6IHt9LFxyXG4gICAgICAgICAgICB1cGRhdGVNZXRhZGF0YTogamVzdC5mbigpXHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgIHN1YkNsYXNzUHJvcGVydHkgPSBuZXcgU3ViQ2xhc3NQcm9wZXJ0eSgndGVzdFN1YkNsYXNzJywgbW9ja1N1YkNsYXNzZXMpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2NvbnN0cnVjdG9yJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIFN1YkNsYXNzUHJvcGVydHkgd2l0aCBjb3JyZWN0IHR5cGUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChzdWJDbGFzc1Byb3BlcnR5LnR5cGUpLnRvQmUoJ3N1YkNsYXNzJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaW5oZXJpdCBmcm9tIFNlbGVjdFByb3BlcnR5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3Qoc3ViQ2xhc3NQcm9wZXJ0eSkudG9CZUluc3RhbmNlT2YoU2VsZWN0UHJvcGVydHkpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHN0b3JlIHN1YkNsYXNzZXMgY29ycmVjdGx5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3Qoc3ViQ2xhc3NQcm9wZXJ0eS5zdWJDbGFzc2VzKS50b0JlKG1vY2tTdWJDbGFzc2VzKTtcclxuICAgICAgICAgICAgZXhwZWN0KHN1YkNsYXNzUHJvcGVydHkuc3ViQ2xhc3Nlcy5sZW5ndGgpLnRvQmUoMik7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcGFzcyBzdWJjbGFzcyBuYW1lcyB0byBwYXJlbnQgU2VsZWN0UHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIENoZWNrIHRoYXQgb3B0aW9ucyB3ZXJlIGNyZWF0ZWQgZnJvbSBzdWJjbGFzcyBuYW1lc1xyXG4gICAgICAgICAgICBleHBlY3Qoc3ViQ2xhc3NQcm9wZXJ0eS5vcHRpb25zKS50b0VxdWFsKFtcclxuICAgICAgICAgICAgICAgIHsgbmFtZTogJ1N1YkNsYXNzMScsIGNvbG9yOiAnJyB9LFxyXG4gICAgICAgICAgICAgICAgeyBuYW1lOiAnU3ViQ2xhc3MyJywgY29sb3I6ICcnIH1cclxuICAgICAgICAgICAgXSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcGFzcyBhcmdzIHRvIHBhcmVudCBjb25zdHJ1Y3RvcicsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VzdG9tQXJncyA9IHsgaWNvbjogJ2N1c3RvbS1pY29uJyB9O1xyXG4gICAgICAgICAgICBjb25zdCBjdXN0b21Qcm9wZXJ0eSA9IG5ldyBTdWJDbGFzc1Byb3BlcnR5KCdjdXN0b21OYW1lJywgbW9ja1N1YkNsYXNzZXMsIGN1c3RvbUFyZ3MpO1xyXG4gICAgICAgICAgICBleHBlY3QoY3VzdG9tUHJvcGVydHkubmFtZSkudG9CZSgnY3VzdG9tTmFtZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBzdWJDbGFzc2VzIGFycmF5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBlbXB0eVByb3BlcnR5ID0gbmV3IFN1YkNsYXNzUHJvcGVydHkoJ2VtcHR5JywgW10pO1xyXG4gICAgICAgICAgICBleHBlY3QoZW1wdHlQcm9wZXJ0eS5zdWJDbGFzc2VzKS50b0VxdWFsKFtdKTtcclxuICAgICAgICAgICAgZXhwZWN0KGVtcHR5UHJvcGVydHkub3B0aW9ucykudG9FcXVhbChbXSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnZ2V0U3ViQ2xhc3NGcm9tTmFtZScsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBjb25zdHJ1Y3RvciBmb3IgZXhpc3Rpbmcgc3ViY2xhc3MgbmFtZScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gc3ViQ2xhc3NQcm9wZXJ0eS5nZXRTdWJDbGFzc0Zyb21OYW1lKCdTdWJDbGFzczEnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSgnQ29uc3RydWN0b3IxJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrU3ViQ2xhc3Nlc1swXS5nZXRzdWJDbGFzc05hbWUpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tTdWJDbGFzc2VzWzBdLmdldENvbnN0cnVjdG9yKS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIHVuZGVmaW5lZCBmb3Igbm9uLWV4aXN0aW5nIHN1YmNsYXNzIG5hbWUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0U3ViQ2xhc3NGcm9tTmFtZSgnTm9uRXhpc3RlbnRDbGFzcycpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlVW5kZWZpbmVkKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IHN0cmluZycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gc3ViQ2xhc3NQcm9wZXJ0eS5nZXRTdWJDbGFzc0Zyb21OYW1lKCcnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZVVuZGVmaW5lZCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBudWxsIGlucHV0JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBzdWJDbGFzc1Byb3BlcnR5LmdldFN1YkNsYXNzRnJvbU5hbWUobnVsbCBhcyBhbnkpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlVW5kZWZpbmVkKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGNhc2Ugc2Vuc2l0aXZpdHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0U3ViQ2xhc3NGcm9tTmFtZSgnc3ViY2xhc3MxJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVVbmRlZmluZWQoKTsgLy8gU2hvdWxkIGJlIGNhc2Ugc2Vuc2l0aXZlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnZ2V0U3ViQ2xhc3MnLCAoKSA9PiB7XHJcbiAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIE1vY2sgdGhlIHJlYWQgbWV0aG9kIHRvIHJldHVybiBhIHNwZWNpZmljIHZhbHVlXHJcbiAgICAgICAgICAgIHN1YkNsYXNzUHJvcGVydHkucmVhZCA9IGplc3QuZm4oKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gc3ViY2xhc3Mgd2hlbiB2YWx1ZSBtYXRjaGVzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LnJlYWQgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdTdWJDbGFzczEnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0U3ViQ2xhc3MobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHN1YkNsYXNzUHJvcGVydHkucmVhZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKG1vY2tTdWJDbGFzc2VzWzBdKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gdW5kZWZpbmVkIHdoZW4gbm8gbWF0Y2ggZm91bmQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHN1YkNsYXNzUHJvcGVydHkucmVhZCA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ05vbkV4aXN0ZW50Q2xhc3MnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0U3ViQ2xhc3MobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZVVuZGVmaW5lZCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiB1bmRlZmluZWQgd2hlbiByZWFkIHJldHVybnMgbnVsbCcsICgpID0+IHtcclxuICAgICAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eS5yZWFkID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShudWxsKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0U3ViQ2xhc3MobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZVVuZGVmaW5lZCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiB1bmRlZmluZWQgd2hlbiByZWFkIHJldHVybnMgdW5kZWZpbmVkJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LnJlYWQgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHVuZGVmaW5lZCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBzdWJDbGFzc1Byb3BlcnR5LmdldFN1YkNsYXNzKG1vY2tGaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVVbmRlZmluZWQoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2Vjb25kIHN1YmNsYXNzIGNvcnJlY3RseScsICgpID0+IHtcclxuICAgICAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eS5yZWFkID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnU3ViQ2xhc3MyJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBzdWJDbGFzc1Byb3BlcnR5LmdldFN1YkNsYXNzKG1vY2tGaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUobW9ja1N1YkNsYXNzZXNbMV0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2dldFN1YmNsYXNzZXNOYW1lcycsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBhbGwgc3ViY2xhc3NlcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gc3ViQ2xhc3NQcm9wZXJ0eS5nZXRTdWJjbGFzc2VzTmFtZXMoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUobW9ja1N1YkNsYXNzZXMpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0Lmxlbmd0aCkudG9CZSgyKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gZW1wdHkgYXJyYXkgd2hlbiBubyBzdWJjbGFzc2VzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBlbXB0eVByb3BlcnR5ID0gbmV3IFN1YkNsYXNzUHJvcGVydHkoJ2VtcHR5JywgW10pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gZW1wdHlQcm9wZXJ0eS5nZXRTdWJjbGFzc2VzTmFtZXMoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoW10pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBzYW1lIHJlZmVyZW5jZSB0byBzdWJjbGFzc2VzIGFycmF5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBzdWJDbGFzc1Byb3BlcnR5LmdldFN1YmNsYXNzZXNOYW1lcygpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZShzdWJDbGFzc1Byb3BlcnR5LnN1YkNsYXNzZXMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2dldFN1YkNsYXNzUHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHN1YkNsYXNzUHJvcGVydHkucmVhZCA9IGplc3QuZm4oKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gcHJvcGVydGllcyB3aGVuIHN1YmNsYXNzIGZvdW5kJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LnJlYWQgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdTdWJDbGFzczEnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0U3ViQ2xhc3NQcm9wZXJ0eShtb2NrRmlsZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKFtcclxuICAgICAgICAgICAgICAgIHsgbmFtZTogJ3Byb3AxJywgdHlwZTogJ3RleHQnIH0sXHJcbiAgICAgICAgICAgICAgICB7IG5hbWU6ICdwcm9wMicsIHR5cGU6ICdudW1iZXInIH1cclxuICAgICAgICAgICAgXSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrU3ViQ2xhc3Nlc1swXS5nZXRQcm9wZXJ0aWVzKS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGVtcHR5IGFycmF5IHdoZW4gbm8gc3ViY2xhc3MgZm91bmQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHN1YkNsYXNzUHJvcGVydHkucmVhZCA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ05vbkV4aXN0ZW50Q2xhc3MnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0U3ViQ2xhc3NQcm9wZXJ0eShtb2NrRmlsZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKFtdKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gZW1wdHkgYXJyYXkgd2hlbiBzdWJjbGFzcyBoYXMgbm8gcHJvcGVydGllcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgc3ViQ2xhc3NXaXRob3V0UHJvcHMgPSB7XHJcbiAgICAgICAgICAgICAgICBnZXRzdWJDbGFzc05hbWU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ0VtcHR5Q2xhc3MnKSxcclxuICAgICAgICAgICAgICAgIGdldENvbnN0cnVjdG9yOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdFbXB0eUNvbnN0cnVjdG9yJyksXHJcbiAgICAgICAgICAgICAgICBnZXRQcm9wZXJ0aWVzOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKG51bGwpLFxyXG4gICAgICAgICAgICAgICAgZ2V0VG9wRGlzcGxheUNvbnRlbnQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JykpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0eVdpdGhFbXB0eUNsYXNzID0gbmV3IFN1YkNsYXNzUHJvcGVydHkoJ3Rlc3QnLCBbc3ViQ2xhc3NXaXRob3V0UHJvcHNdKTtcclxuICAgICAgICAgICAgcHJvcGVydHlXaXRoRW1wdHlDbGFzcy5yZWFkID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnRW1wdHlDbGFzcycpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gcHJvcGVydHlXaXRoRW1wdHlDbGFzcy5nZXRTdWJDbGFzc1Byb3BlcnR5KG1vY2tGaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoW10pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBkaWZmZXJlbnQgcHJvcGVydHkgc3RydWN0dXJlcycsICgpID0+IHtcclxuICAgICAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eS5yZWFkID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnU3ViQ2xhc3MyJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBzdWJDbGFzc1Byb3BlcnR5LmdldFN1YkNsYXNzUHJvcGVydHkobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbeyBuYW1lOiAncHJvcDMnLCB0eXBlOiAndGV4dCcgfV0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2dldFRvcERpc3BsYXlDb250ZW50JywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LnJlYWQgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvbnRhaW5lciB3aXRoIHN1YmNsYXNzIGNvbnRlbnQgd2hlbiBzdWJjbGFzcyBmb3VuZCcsICgpID0+IHtcclxuICAgICAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eS5yZWFkID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnU3ViQ2xhc3MxJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBzdWJDbGFzc1Byb3BlcnR5LmdldFRvcERpc3BsYXlDb250ZW50KG1vY2tGaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQudGFnTmFtZSkudG9CZSgnRElWJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQuY2hpbGRyZW4ubGVuZ3RoKS50b0JlKDEpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1N1YkNsYXNzZXNbMF0uZ2V0VG9wRGlzcGxheUNvbnRlbnQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1vY2tGaWxlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gZW1wdHkgY29udGFpbmVyIHdoZW4gbm8gc3ViY2xhc3MgZm91bmQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHN1YkNsYXNzUHJvcGVydHkucmVhZCA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ05vbkV4aXN0ZW50Q2xhc3MnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0VG9wRGlzcGxheUNvbnRlbnQobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC50YWdOYW1lKS50b0JlKCdESVYnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC5jaGlsZHJlbi5sZW5ndGgpLnRvQmUoMCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIG51bGwgcmVhZCByZXN1bHQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHN1YkNsYXNzUHJvcGVydHkucmVhZCA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUobnVsbCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBzdWJDbGFzc1Byb3BlcnR5LmdldFRvcERpc3BsYXlDb250ZW50KG1vY2tGaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQudGFnTmFtZSkudG9CZSgnRElWJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQuY2hpbGRyZW4ubGVuZ3RoKS50b0JlKDApO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGNhbGwgZ2V0VG9wRGlzcGxheUNvbnRlbnQgb24gY29ycmVjdCBzdWJjbGFzcycsICgpID0+IHtcclxuICAgICAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eS5yZWFkID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnU3ViQ2xhc3MyJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBzdWJDbGFzc1Byb3BlcnR5LmdldFRvcERpc3BsYXlDb250ZW50KG1vY2tGaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrU3ViQ2xhc3Nlc1sxXS5nZXRUb3BEaXNwbGF5Q29udGVudCkudG9IYXZlQmVlbkNhbGxlZFdpdGgobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1N1YkNsYXNzZXNbMF0uZ2V0VG9wRGlzcGxheUNvbnRlbnQpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnaW5oZXJpdGFuY2UgZnJvbSBTZWxlY3RQcm9wZXJ0eScsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGhhdmUgb3B0aW9ucyBwcm9wZXJ0eSBmcm9tIHBhcmVudCcsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KHN1YkNsYXNzUHJvcGVydHkub3B0aW9ucykudG9CZURlZmluZWQoKTtcclxuICAgICAgICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkoc3ViQ2xhc3NQcm9wZXJ0eS5vcHRpb25zKSkudG9CZSh0cnVlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYXZlIG5hbWUgcHJvcGVydHkgZnJvbSBwYXJlbnQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChzdWJDbGFzc1Byb3BlcnR5Lm5hbWUpLnRvQmUoJ3Rlc3RTdWJDbGFzcycpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhdmUgZmlsbERpc3BsYXkgbWV0aG9kIGZyb20gcGFyZW50JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QodHlwZW9mIHN1YkNsYXNzUHJvcGVydHkuZmlsbERpc3BsYXkpLnRvQmUoJ2Z1bmN0aW9uJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGF2ZSByZWFkIG1ldGhvZCBmcm9tIHBhcmVudCcsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KHR5cGVvZiBzdWJDbGFzc1Byb3BlcnR5LnJlYWQpLnRvQmUoJ2Z1bmN0aW9uJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnaW50ZWdyYXRpb24gd2l0aCBzdWJjbGFzc2VzJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgbWFpbnRhaW4gY29uc2lzdGVuY3kgYmV0d2VlbiBzdWJDbGFzc2VzIGFuZCBvcHRpb25zJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3Qoc3ViQ2xhc3NQcm9wZXJ0eS5zdWJDbGFzc2VzLmxlbmd0aCkudG9CZShzdWJDbGFzc1Byb3BlcnR5Lm9wdGlvbnMubGVuZ3RoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHN1YkNsYXNzUHJvcGVydHkuc3ViQ2xhc3Nlcy5mb3JFYWNoKChzdWJDbGFzcywgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgICAgIGV4cGVjdChzdWJDbGFzcy5nZXRzdWJDbGFzc05hbWUoKSkudG9CZShzdWJDbGFzc1Byb3BlcnR5Lm9wdGlvbnNbaW5kZXhdLm5hbWUpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgc3ViY2xhc3MgbWV0aG9kIGNhbGxzIGNvcnJlY3RseScsICgpID0+IHtcclxuICAgICAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eS5yZWFkID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnU3ViQ2xhc3MxJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBUZXN0IG11bHRpcGxlIG1ldGhvZCBjYWxsc1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LmdldFN1YkNsYXNzKG1vY2tGaWxlKTtcclxuICAgICAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eS5nZXRTdWJDbGFzc1Byb3BlcnR5KG1vY2tGaWxlKTtcclxuICAgICAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eS5nZXRUb3BEaXNwbGF5Q29udGVudChtb2NrRmlsZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBWZXJpZnkgYWxsIG1ldGhvZHMgd2VyZSBjYWxsZWQgb24gdGhlIGNvcnJlY3Qgc3ViY2xhc3NcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tTdWJDbGFzc2VzWzBdLmdldHN1YkNsYXNzTmFtZSkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1N1YkNsYXNzZXNbMF0uZ2V0UHJvcGVydGllcykudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1N1YkNsYXNzZXNbMF0uZ2V0VG9wRGlzcGxheUNvbnRlbnQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59KTsiXSwidmVyc2lvbiI6M30=