{"file":"C:\\Users\\leodu\\Documents\\1 - Pro\\Test plugin obsidian\\.obsidian\\plugins\\obsidian-CRM\\dynamic-fields\\__tests__\\Config\\ClassConfigManager.test.ts","mappings":"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","names":[],"sources":["C:\\Users\\leodu\\Documents\\1 - Pro\\Test plugin obsidian\\.obsidian\\plugins\\obsidian-CRM\\dynamic-fields\\__tests__\\Config\\ClassConfigManager.test.ts"],"sourcesContent":["import { ClassConfigManager } from '../../src/Config/ClassConfigManager';\r\nimport { ConfigLoader } from '../../src/Config/ConfigLoader';\r\n\r\n// Mock ConfigLoader\r\njest.mock('../../src/Config/ConfigLoader');\r\n\r\ndescribe('ClassConfigManager', () => {\r\n    let configManager: ClassConfigManager;\r\n    let mockConfigLoader: jest.Mocked<ConfigLoader>;\r\n    let mockApp: any;\r\n\r\n    beforeEach(() => {\r\n        jest.clearAllMocks();\r\n        \r\n        mockApp = {\r\n            getVaultPath: jest.fn(() => '/test/vault'),\r\n            getName: jest.fn(() => 'TestVault')\r\n        };\r\n\r\n        // Create mock config loader with correct methods\r\n        mockConfigLoader = {\r\n            loadClassConfig: jest.fn()\r\n        } as any;\r\n\r\n        // Mock the constructor\r\n        (ConfigLoader as jest.MockedClass<typeof ConfigLoader>).mockImplementation(() => mockConfigLoader);\r\n        \r\n        configManager = new ClassConfigManager('./test-config', mockApp);\r\n    });\r\n\r\n    describe('constructor', () => {\r\n        it('should create instance with config loader', () => {\r\n            expect(ConfigLoader).toHaveBeenCalledWith('./test-config', mockApp);\r\n        });\r\n    });\r\n\r\n    describe('createDynamicClasse', () => {\r\n        it('should create dynamic class from config', async () => {\r\n            const mockConfig = {\r\n                className: 'TestClass',\r\n                classIcon: 'test-icon',\r\n                properties: {},\r\n                displayContainer: {\r\n                    template: 'default',\r\n                    components: []\r\n                }\r\n            };\r\n\r\n            mockConfigLoader.loadClassConfig.mockResolvedValue(mockConfig);\r\n            \r\n            const DynamicClass = await configManager.createDynamicClasse('TestClass');\r\n            \r\n            expect(mockConfigLoader.loadClassConfig).toHaveBeenCalledWith('TestClass');\r\n            expect(DynamicClass).toBeDefined();\r\n            \r\n            // Test instance creation\r\n            const mockVault = { app: mockApp } as any;\r\n            const mockFile = { path: 'test.md' } as any;\r\n            const instance = new DynamicClass(mockVault, mockFile);\r\n            \r\n            expect(instance.name).toBe('TestClass');\r\n            expect(instance.icon).toBe('test-icon');\r\n        });\r\n\r\n        it('should return cached class if already loaded', async () => {\r\n            const mockConfig = {\r\n                className: 'TestClass',\r\n                classIcon: 'test-icon',\r\n                properties: {},\r\n                displayContainer: {\r\n                    template: 'default',\r\n                    components: []\r\n                }\r\n            };\r\n\r\n            mockConfigLoader.loadClassConfig.mockResolvedValue(mockConfig);\r\n            \r\n            // First call\r\n            const firstClass = await configManager.createDynamicClasse('TestClass');\r\n            \r\n            // Second call - should return cached version\r\n            jest.clearAllMocks();\r\n            const secondClass = await configManager.createDynamicClasse('TestClass');\r\n            \r\n            expect(firstClass).toBe(secondClass);\r\n            expect(mockConfigLoader.loadClassConfig).not.toHaveBeenCalled();\r\n        });\r\n\r\n        it('should handle config loading errors', async () => {\r\n            const error = new Error('Config not found');\r\n            mockConfigLoader.loadClassConfig.mockRejectedValue(error);\r\n            \r\n            await expect(configManager.createDynamicClasse('NonExistentClass'))\r\n                .rejects.toThrow('Config not found');\r\n        });\r\n    });\r\n\r\n    describe('getClassConfig', () => {\r\n        it('should delegate to config loader', async () => {\r\n            const mockConfig = {\r\n                className: 'TestClass',\r\n                classIcon: 'test-icon',\r\n                properties: {},\r\n                displayContainer: { template: 'default' }\r\n            };\r\n            \r\n            mockConfigLoader.loadClassConfig.mockResolvedValue(mockConfig);\r\n            \r\n            const result = await configManager.getClassConfig('TestClass');\r\n            \r\n            expect(mockConfigLoader.loadClassConfig).toHaveBeenCalledWith('TestClass');\r\n            expect(result).toBe(mockConfig);\r\n        });\r\n    });\r\n\r\n    describe('getAvailableClasses', () => {\r\n        it('should return empty array as default implementation', async () => {\r\n            const result = await configManager.getAvailableClasses();\r\n            \r\n            expect(Array.isArray(result)).toBe(true);\r\n        });\r\n    });\r\n\r\n    describe('clearCache', () => {\r\n        it('should clear loaded classes cache', () => {\r\n            // Add something to cache first\r\n            (configManager as any).loadedClasses.set('TestClass', class {});\r\n            \r\n            expect((configManager as any).loadedClasses.size).toBe(1);\r\n            \r\n            configManager.clearCache();\r\n            \r\n            expect((configManager as any).loadedClasses.size).toBe(0);\r\n        });\r\n    });\r\n});"],"version":3}