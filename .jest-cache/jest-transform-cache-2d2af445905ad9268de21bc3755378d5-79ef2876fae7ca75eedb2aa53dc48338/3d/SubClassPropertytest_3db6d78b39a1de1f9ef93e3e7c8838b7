8bb6adb2083f6a44a930559671b9a38b
"use strict";
/**
 * @jest-environment jsdom
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock dependencies
jest.mock('../src/vault/Utils', () => ({
    setIcon: jest.fn()
}));
const SelectProperty_1 = require("../src/properties/SelectProperty");
const SubClassProperty_1 = require("../src/properties/SubClassProperty");
describe('SubClassProperty', () => {
    let subClassProperty;
    let mockSubClasses;
    let mockFile;
    beforeEach(() => {
        // Reset DOM mocks
        document.body.innerHTML = '';
        jest.clearAllMocks();
        // Mock SubClass objects
        mockSubClasses = [
            {
                getsubClassName: jest.fn().mockReturnValue('SubClass1'),
                getConstructor: jest.fn().mockReturnValue('Constructor1'),
                getProperties: jest.fn().mockReturnValue({
                    prop1: { name: 'prop1', type: 'text' },
                    prop2: { name: 'prop2', type: 'number' }
                }),
                getTopDisplayContent: jest.fn().mockReturnValue(document.createElement('div'))
            },
            {
                getsubClassName: jest.fn().mockReturnValue('SubClass2'),
                getConstructor: jest.fn().mockReturnValue('Constructor2'),
                getProperties: jest.fn().mockReturnValue({
                    prop3: { name: 'prop3', type: 'text' }
                }),
                getTopDisplayContent: jest.fn().mockReturnValue(document.createElement('span'))
            }
        ];
        // Mock File object
        mockFile = {
            metadata: {},
            updateMetadata: jest.fn()
        };
    });
    beforeEach(() => {
        subClassProperty = new SubClassProperty_1.SubClassProperty('testSubClass', mockSubClasses);
    });
    describe('constructor', () => {
        it('should create SubClassProperty with correct type', () => {
            expect(subClassProperty.type).toBe('subClass');
        });
        it('should inherit from SelectProperty', () => {
            expect(subClassProperty).toBeInstanceOf(SelectProperty_1.SelectProperty);
        });
        it('should store subClasses correctly', () => {
            expect(subClassProperty.subClasses).toBe(mockSubClasses);
            expect(subClassProperty.subClasses.length).toBe(2);
        });
        it('should pass subclass names to parent SelectProperty', () => {
            // Check that options were created from subclass names
            expect(subClassProperty.options).toEqual([
                { name: 'SubClass1', color: '' },
                { name: 'SubClass2', color: '' }
            ]);
        });
        it('should pass args to parent constructor', () => {
            const customArgs = { icon: 'custom-icon' };
            const customProperty = new SubClassProperty_1.SubClassProperty('customName', mockSubClasses, customArgs);
            expect(customProperty.name).toBe('customName');
        });
        it('should handle empty subClasses array', () => {
            const emptyProperty = new SubClassProperty_1.SubClassProperty('empty', []);
            expect(emptyProperty.subClasses).toEqual([]);
            expect(emptyProperty.options).toEqual([]);
        });
    });
    describe('getSubClassFromName', () => {
        it('should return constructor for existing subclass name', () => {
            const result = subClassProperty.getSubClassFromName('SubClass1');
            expect(result).toBe('Constructor1');
            expect(mockSubClasses[0].getsubClassName).toHaveBeenCalled();
            expect(mockSubClasses[0].getConstructor).toHaveBeenCalled();
        });
        it('should return undefined for non-existing subclass name', () => {
            const result = subClassProperty.getSubClassFromName('NonExistentClass');
            expect(result).toBeUndefined();
        });
        it('should handle empty string', () => {
            const result = subClassProperty.getSubClassFromName('');
            expect(result).toBeUndefined();
        });
        it('should handle null input', () => {
            const result = subClassProperty.getSubClassFromName(null);
            expect(result).toBeUndefined();
        });
        it('should handle case sensitivity', () => {
            const result = subClassProperty.getSubClassFromName('subclass1');
            expect(result).toBeUndefined(); // Should be case sensitive
        });
    });
    describe('getSubClass', () => {
        beforeEach(() => {
            // Mock the read method to return a specific value
            subClassProperty.read = jest.fn();
        });
        it('should return subclass when value matches', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass1');
            const result = subClassProperty.getSubClass(mockFile);
            expect(subClassProperty.read).toHaveBeenCalledWith(mockFile);
            expect(result).toBe(mockSubClasses[0]);
        });
        it('should return undefined when no match found', () => {
            subClassProperty.read = jest.fn().mockReturnValue('NonExistentClass');
            const result = subClassProperty.getSubClass(mockFile);
            expect(result).toBeUndefined();
        });
        it('should return undefined when read returns null', () => {
            subClassProperty.read = jest.fn().mockReturnValue(null);
            const result = subClassProperty.getSubClass(mockFile);
            expect(result).toBeUndefined();
        });
        it('should return undefined when read returns undefined', () => {
            subClassProperty.read = jest.fn().mockReturnValue(undefined);
            const result = subClassProperty.getSubClass(mockFile);
            expect(result).toBeUndefined();
        });
        it('should handle second subclass correctly', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass2');
            const result = subClassProperty.getSubClass(mockFile);
            expect(result).toBe(mockSubClasses[1]);
        });
    });
    describe('getSubclassesNames', () => {
        it('should return all subclasses', () => {
            const result = subClassProperty.getSubclassesNames();
            expect(result).toBe(mockSubClasses);
            expect(result.length).toBe(2);
        });
        it('should return empty array when no subclasses', () => {
            const emptyProperty = new SubClassProperty_1.SubClassProperty('empty', []);
            const result = emptyProperty.getSubclassesNames();
            expect(result).toEqual([]);
        });
        it('should return same reference to subclasses array', () => {
            const result = subClassProperty.getSubclassesNames();
            expect(result).toBe(subClassProperty.subClasses);
        });
    });
    describe('getSubClassProperty', () => {
        beforeEach(() => {
            subClassProperty.read = jest.fn();
        });
        it('should return properties when subclass found', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass1');
            const result = subClassProperty.getSubClassProperty(mockFile);
            expect(result).toEqual([
                { name: 'prop1', type: 'text' },
                { name: 'prop2', type: 'number' }
            ]);
            expect(mockSubClasses[0].getProperties).toHaveBeenCalled();
        });
        it('should return empty array when no subclass found', () => {
            subClassProperty.read = jest.fn().mockReturnValue('NonExistentClass');
            const result = subClassProperty.getSubClassProperty(mockFile);
            expect(result).toEqual([]);
        });
        it('should return empty array when subclass has no properties', () => {
            const subClassWithoutProps = {
                getsubClassName: jest.fn().mockReturnValue('EmptyClass'),
                getConstructor: jest.fn().mockReturnValue('EmptyConstructor'),
                getProperties: jest.fn().mockReturnValue(null),
                getTopDisplayContent: jest.fn().mockReturnValue(document.createElement('div'))
            };
            const propertyWithEmptyClass = new SubClassProperty_1.SubClassProperty('test', [subClassWithoutProps]);
            propertyWithEmptyClass.read = jest.fn().mockReturnValue('EmptyClass');
            const result = propertyWithEmptyClass.getSubClassProperty(mockFile);
            expect(result).toEqual([]);
        });
        it('should handle different property structures', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass2');
            const result = subClassProperty.getSubClassProperty(mockFile);
            expect(result).toEqual([{ name: 'prop3', type: 'text' }]);
        });
    });
    describe('getTopDisplayContent', () => {
        beforeEach(() => {
            subClassProperty.read = jest.fn();
        });
        it('should return container with subclass content when subclass found', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass1');
            const result = subClassProperty.getTopDisplayContent(mockFile);
            expect(result.tagName).toBe('DIV');
            expect(result.children.length).toBe(1);
            expect(mockSubClasses[0].getTopDisplayContent).toHaveBeenCalledWith(mockFile);
        });
        it('should return empty container when no subclass found', () => {
            subClassProperty.read = jest.fn().mockReturnValue('NonExistentClass');
            const result = subClassProperty.getTopDisplayContent(mockFile);
            expect(result.tagName).toBe('DIV');
            expect(result.children.length).toBe(0);
        });
        it('should handle null read result', () => {
            subClassProperty.read = jest.fn().mockReturnValue(null);
            const result = subClassProperty.getTopDisplayContent(mockFile);
            expect(result.tagName).toBe('DIV');
            expect(result.children.length).toBe(0);
        });
        it('should call getTopDisplayContent on correct subclass', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass2');
            const result = subClassProperty.getTopDisplayContent(mockFile);
            expect(mockSubClasses[1].getTopDisplayContent).toHaveBeenCalledWith(mockFile);
            expect(mockSubClasses[0].getTopDisplayContent).not.toHaveBeenCalled();
        });
    });
    describe('inheritance from SelectProperty', () => {
        it('should have options property from parent', () => {
            expect(subClassProperty.options).toBeDefined();
            expect(Array.isArray(subClassProperty.options)).toBe(true);
        });
        it('should have name property from parent', () => {
            expect(subClassProperty.name).toBe('testSubClass');
        });
        it('should have fillDisplay method from parent', () => {
            expect(typeof subClassProperty.fillDisplay).toBe('function');
        });
        it('should have read method from parent', () => {
            expect(typeof subClassProperty.read).toBe('function');
        });
    });
    describe('integration with subclasses', () => {
        it('should maintain consistency between subClasses and options', () => {
            expect(subClassProperty.subClasses.length).toBe(subClassProperty.options.length);
            subClassProperty.subClasses.forEach((subClass, index) => {
                expect(subClass.getsubClassName()).toBe(subClassProperty.options[index].name);
            });
        });
        it('should handle subclass method calls correctly', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass1');
            // Test multiple method calls
            subClassProperty.getSubClass(mockFile);
            subClassProperty.getSubClassProperty(mockFile);
            subClassProperty.getTopDisplayContent(mockFile);
            // Verify all methods were called on the correct subclass
            expect(mockSubClasses[0].getsubClassName).toHaveBeenCalled();
            expect(mockSubClasses[0].getProperties).toHaveBeenCalled();
            expect(mockSubClasses[0].getTopDisplayContent).toHaveBeenCalled();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxfX3Rlc3RzX19cXFByb3BlcnRpZXNcXFN1YkNsYXNzUHJvcGVydHkudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7O0dBRUc7O0FBS0gsb0JBQW9CO0FBQ3BCLElBQUksQ0FBQyxJQUFJLENBQUMsb0JBQW9CLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNuQyxPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUNyQixDQUFDLENBQUMsQ0FBQztBQU5KLHFFQUFrRTtBQUNsRSx5RUFBc0U7QUFPdEUsUUFBUSxDQUFDLGtCQUFrQixFQUFFLEdBQUcsRUFBRTtJQUM5QixJQUFJLGdCQUFrQyxDQUFDO0lBQ3ZDLElBQUksY0FBcUIsQ0FBQztJQUMxQixJQUFJLFFBQWEsQ0FBQztJQUVsQixVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ1osa0JBQWtCO1FBQ2xCLFFBQVEsQ0FBQyxJQUFJLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQztRQUM3QixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFFckIsd0JBQXdCO1FBQ3hCLGNBQWMsR0FBRztZQUNiO2dCQUNJLGVBQWUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLFdBQVcsQ0FBQztnQkFDdkQsY0FBYyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsY0FBYyxDQUFDO2dCQUN6RCxhQUFhLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQztvQkFDckMsS0FBSyxFQUFFLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFO29CQUN0QyxLQUFLLEVBQUUsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUU7aUJB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QUFDLENBQUMsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLGdCQUFnQixFQUFFLENBQUM7WUFDN0QsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1lBQzNELE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQ3RFLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGxlb2R1XFxEb2N1bWVudHNcXDEgLSBQcm9cXFRlc3QgcGx1Z2luIG9ic2lkaWFuXFwub2JzaWRpYW5cXHBsdWdpbnNcXG9ic2lkaWFuLUNSTVxcZHluYW1pYy1maWVsZHNcXF9fdGVzdHNfX1xcUHJvcGVydGllc1xcU3ViQ2xhc3NQcm9wZXJ0eS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAamVzdC1lbnZpcm9ubWVudCBqc2RvbVxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFNlbGVjdFByb3BlcnR5IH0gZnJvbSAnLi4vc3JjL3Byb3BlcnRpZXMvU2VsZWN0UHJvcGVydHknO1xyXG5pbXBvcnQgeyBTdWJDbGFzc1Byb3BlcnR5IH0gZnJvbSAnLi4vc3JjL3Byb3BlcnRpZXMvU3ViQ2xhc3NQcm9wZXJ0eSc7XHJcblxyXG4vLyBNb2NrIGRlcGVuZGVuY2llc1xyXG5qZXN0Lm1vY2soJy4uL3NyYy92YXVsdC9VdGlscycsICgpID0+ICh7XHJcbiAgICBzZXRJY29uOiBqZXN0LmZuKClcclxufSkpO1xyXG5cclxuZGVzY3JpYmUoJ1N1YkNsYXNzUHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICBsZXQgc3ViQ2xhc3NQcm9wZXJ0eTogU3ViQ2xhc3NQcm9wZXJ0eTtcclxuICAgIGxldCBtb2NrU3ViQ2xhc3NlczogYW55W107XHJcbiAgICBsZXQgbW9ja0ZpbGU6IGFueTtcclxuXHJcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICAvLyBSZXNldCBET00gbW9ja3NcclxuICAgICAgICBkb2N1bWVudC5ib2R5LmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIE1vY2sgU3ViQ2xhc3Mgb2JqZWN0c1xyXG4gICAgICAgIG1vY2tTdWJDbGFzc2VzID0gW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBnZXRzdWJDbGFzc05hbWU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ1N1YkNsYXNzMScpLFxyXG4gICAgICAgICAgICAgICAgZ2V0Q29uc3RydWN0b3I6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ0NvbnN0cnVjdG9yMScpLFxyXG4gICAgICAgICAgICAgICAgZ2V0UHJvcGVydGllczogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcDE6IHsgbmFtZTogJ3Byb3AxJywgdHlwZTogJ3RleHQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcDI6IHsgbmFtZTogJ3Byb3AyJywgdHlwZTogJ251bWJlcicgfVxyXG4gICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICBnZXRUb3BEaXNwbGF5Q29udGVudDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSlcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZ2V0c3ViQ2xhc3NOYW1lOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdTdWJDbGFzczInKSxcclxuICAgICAgICAgICAgICAgIGdldENvbnN0cnVjdG9yOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdDb25zdHJ1Y3RvcjInKSxcclxuICAgICAgICAgICAgICAgIGdldFByb3BlcnRpZXM6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHByb3AzOiB7IG5hbWU6ICdwcm9wMycsIHR5cGU6ICd0ZXh0JyB9XHJcbiAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgIGdldFRvcERpc3BsYXlDb250ZW50OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIF07XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gTW9jayBGaWxlIG9iamVjdFxyXG4gICAgICAgIG1vY2tGaWxlID0ge1xyXG4gICAgICAgICAgICBtZXRhZGF0YToge30sXHJcbiAgICAgICAgICAgIHVwZGF0ZU1ldGFkYXRhOiBqZXN0LmZuKClcclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcblxyXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eSA9IG5ldyBTdWJDbGFzc1Byb3BlcnR5KCd0ZXN0U3ViQ2xhc3MnLCBtb2NrU3ViQ2xhc3Nlcyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnY29uc3RydWN0b3InLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgU3ViQ2xhc3NQcm9wZXJ0eSB3aXRoIGNvcnJlY3QgdHlwZScsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KHN1YkNsYXNzUHJvcGVydHkudHlwZSkudG9CZSgnc3ViQ2xhc3MnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBpbmhlcml0IGZyb20gU2VsZWN0UHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChzdWJDbGFzc1Byb3BlcnR5KS50b0JlSW5zdGFuY2VPZihTZWxlY3RQcm9wZXJ0eSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgc3RvcmUgc3ViQ2xhc3NlcyBjb3JyZWN0bHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChzdWJDbGFzc1Byb3BlcnR5LnN1YkNsYXNzZXMpLnRvQmUobW9ja1N1YkNsYXNzZXMpO1xyXG4gICAgICAgICAgICBleHBlY3Qoc3ViQ2xhc3NQcm9wZXJ0eS5zdWJDbGFzc2VzLmxlbmd0aCkudG9CZSgyKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBwYXNzIHN1YmNsYXNzIG5hbWVzIHRvIHBhcmVudCBTZWxlY3RQcm9wZXJ0eScsICgpID0+IHtcclxuICAgICAgICAgICAgLy8gQ2hlY2sgdGhhdCBvcHRpb25zIHdlcmUgY3JlYXRlZCBmcm9tIHN1YmNsYXNzIG5hbWVzXHJcbiAgICAgICAgICAgIGV4cGVjdChzdWJDbGFzc1Byb3BlcnR5Lm9wdGlvbnMpLnRvRXF1YWwoW1xyXG4gICAgICAgICAgICAgICAgeyBuYW1lOiAnU3ViQ2xhc3MxJywgY29sb3I6ICcnIH0sXHJcbiAgICAgICAgICAgICAgICB7IG5hbWU6ICdTdWJDbGFzczInLCBjb2xvcjogJycgfVxyXG4gICAgICAgICAgICBdKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBwYXNzIGFyZ3MgdG8gcGFyZW50IGNvbnN0cnVjdG9yJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjdXN0b21BcmdzID0geyBpY29uOiAnY3VzdG9tLWljb24nIH07XHJcbiAgICAgICAgICAgIGNvbnN0IGN1c3RvbVByb3BlcnR5ID0gbmV3IFN1YkNsYXNzUHJvcGVydHkoJ2N1c3RvbU5hbWUnLCBtb2NrU3ViQ2xhc3NlcywgY3VzdG9tQXJncyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChjdXN0b21Qcm9wZXJ0eS5uYW1lKS50b0JlKCdjdXN0b21OYW1lJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IHN1YkNsYXNzZXMgYXJyYXknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVtcHR5UHJvcGVydHkgPSBuZXcgU3ViQ2xhc3NQcm9wZXJ0eSgnZW1wdHknLCBbXSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChlbXB0eVByb3BlcnR5LnN1YkNsYXNzZXMpLnRvRXF1YWwoW10pO1xyXG4gICAgICAgICAgICBleHBlY3QoZW1wdHlQcm9wZXJ0eS5vcHRpb25zKS50b0VxdWFsKFtdKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdnZXRTdWJDbGFzc0Zyb21OYW1lJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvbnN0cnVjdG9yIGZvciBleGlzdGluZyBzdWJjbGFzcyBuYW1lJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBzdWJDbGFzc1Byb3BlcnR5LmdldFN1YkNsYXNzRnJvbU5hbWUoJ1N1YkNsYXNzMScpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKCdDb25zdHJ1Y3RvcjEnKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tTdWJDbGFzc2VzWzBdLmdldHN1YkNsYXNzTmFtZSkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1N1YkNsYXNzZXNbMF0uZ2V0Q29uc3RydWN0b3IpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gdW5kZWZpbmVkIGZvciBub24tZXhpc3Rpbmcgc3ViY2xhc3MgbmFtZScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gc3ViQ2xhc3NQcm9wZXJ0eS5nZXRTdWJDbGFzc0Zyb21OYW1lKCdOb25FeGlzdGVudENsYXNzJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVVbmRlZmluZWQoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgc3RyaW5nJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBzdWJDbGFzc1Byb3BlcnR5LmdldFN1YkNsYXNzRnJvbU5hbWUoJycpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlVW5kZWZpbmVkKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIG51bGwgaW5wdXQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0U3ViQ2xhc3NGcm9tTmFtZShudWxsIGFzIGFueSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVVbmRlZmluZWQoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgY2FzZSBzZW5zaXRpdml0eScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gc3ViQ2xhc3NQcm9wZXJ0eS5nZXRTdWJDbGFzc0Zyb21OYW1lKCdzdWJjbGFzczEnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZVVuZGVmaW5lZCgpOyAvLyBTaG91bGQgYmUgY2FzZSBzZW5zaXRpdmVcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdnZXRTdWJDbGFzcycsICgpID0+IHtcclxuICAgICAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICAgICAgLy8gTW9jayB0aGUgcmVhZCBtZXRob2QgdG8gcmV0dXJuIGEgc3BlY2lmaWMgdmFsdWVcclxuICAgICAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eS5yZWFkID0gamVzdC5mbigpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBzdWJjbGFzcyB3aGVuIHZhbHVlIG1hdGNoZXMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHN1YkNsYXNzUHJvcGVydHkucmVhZCA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ1N1YkNsYXNzMScpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gc3ViQ2xhc3NQcm9wZXJ0eS5nZXRTdWJDbGFzcyhtb2NrRmlsZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3Qoc3ViQ2xhc3NQcm9wZXJ0eS5yZWFkKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChtb2NrRmlsZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUobW9ja1N1YkNsYXNzZXNbMF0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiB1bmRlZmluZWQgd2hlbiBubyBtYXRjaCBmb3VuZCcsICgpID0+IHtcclxuICAgICAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eS5yZWFkID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnTm9uRXhpc3RlbnRDbGFzcycpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gc3ViQ2xhc3NQcm9wZXJ0eS5nZXRTdWJDbGFzcyhtb2NrRmlsZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlVW5kZWZpbmVkKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIHVuZGVmaW5lZCB3aGVuIHJlYWQgcmV0dXJucyBudWxsJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LnJlYWQgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKG51bGwpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gc3ViQ2xhc3NQcm9wZXJ0eS5nZXRTdWJDbGFzcyhtb2NrRmlsZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlVW5kZWZpbmVkKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIHVuZGVmaW5lZCB3aGVuIHJlYWQgcmV0dXJucyB1bmRlZmluZWQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHN1YkNsYXNzUHJvcGVydHkucmVhZCA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUodW5kZWZpbmVkKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0U3ViQ2xhc3MobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZVVuZGVmaW5lZCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZWNvbmQgc3ViY2xhc3MgY29ycmVjdGx5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LnJlYWQgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdTdWJDbGFzczInKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0U3ViQ2xhc3MobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZShtb2NrU3ViQ2xhc3Nlc1sxXSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnZ2V0U3ViY2xhc3Nlc05hbWVzJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGFsbCBzdWJjbGFzc2VzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBzdWJDbGFzc1Byb3BlcnR5LmdldFN1YmNsYXNzZXNOYW1lcygpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZShtb2NrU3ViQ2xhc3Nlcyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQubGVuZ3RoKS50b0JlKDIpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBlbXB0eSBhcnJheSB3aGVuIG5vIHN1YmNsYXNzZXMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVtcHR5UHJvcGVydHkgPSBuZXcgU3ViQ2xhc3NQcm9wZXJ0eSgnZW1wdHknLCBbXSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBlbXB0eVByb3BlcnR5LmdldFN1YmNsYXNzZXNOYW1lcygpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbXSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIHNhbWUgcmVmZXJlbmNlIHRvIHN1YmNsYXNzZXMgYXJyYXknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0U3ViY2xhc3Nlc05hbWVzKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKHN1YkNsYXNzUHJvcGVydHkuc3ViQ2xhc3Nlcyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnZ2V0U3ViQ2xhc3NQcm9wZXJ0eScsICgpID0+IHtcclxuICAgICAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eS5yZWFkID0gamVzdC5mbigpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBwcm9wZXJ0aWVzIHdoZW4gc3ViY2xhc3MgZm91bmQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHN1YkNsYXNzUHJvcGVydHkucmVhZCA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ1N1YkNsYXNzMScpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gc3ViQ2xhc3NQcm9wZXJ0eS5nZXRTdWJDbGFzc1Byb3BlcnR5KG1vY2tGaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoW1xyXG4gICAgICAgICAgICAgICAgeyBuYW1lOiAncHJvcDEnLCB0eXBlOiAndGV4dCcgfSxcclxuICAgICAgICAgICAgICAgIHsgbmFtZTogJ3Byb3AyJywgdHlwZTogJ251bWJlcicgfVxyXG4gICAgICAgICAgICBdKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tTdWJDbGFzc2VzWzBdLmdldFByb3BlcnRpZXMpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gZW1wdHkgYXJyYXkgd2hlbiBubyBzdWJjbGFzcyBmb3VuZCcsICgpID0+IHtcclxuICAgICAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eS5yZWFkID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnTm9uRXhpc3RlbnRDbGFzcycpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gc3ViQ2xhc3NQcm9wZXJ0eS5nZXRTdWJDbGFzc1Byb3BlcnR5KG1vY2tGaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoW10pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBlbXB0eSBhcnJheSB3aGVuIHN1YmNsYXNzIGhhcyBubyBwcm9wZXJ0aWVzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzdWJDbGFzc1dpdGhvdXRQcm9wcyA9IHtcclxuICAgICAgICAgICAgICAgIGdldHN1YkNsYXNzTmFtZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnRW1wdHlDbGFzcycpLFxyXG4gICAgICAgICAgICAgICAgZ2V0Q29uc3RydWN0b3I6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ0VtcHR5Q29uc3RydWN0b3InKSxcclxuICAgICAgICAgICAgICAgIGdldFByb3BlcnRpZXM6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUobnVsbCksXHJcbiAgICAgICAgICAgICAgICBnZXRUb3BEaXNwbGF5Q29udGVudDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSlcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHByb3BlcnR5V2l0aEVtcHR5Q2xhc3MgPSBuZXcgU3ViQ2xhc3NQcm9wZXJ0eSgndGVzdCcsIFtzdWJDbGFzc1dpdGhvdXRQcm9wc10pO1xyXG4gICAgICAgICAgICBwcm9wZXJ0eVdpdGhFbXB0eUNsYXNzLnJlYWQgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdFbXB0eUNsYXNzJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBwcm9wZXJ0eVdpdGhFbXB0eUNsYXNzLmdldFN1YkNsYXNzUHJvcGVydHkobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbXSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGRpZmZlcmVudCBwcm9wZXJ0eSBzdHJ1Y3R1cmVzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LnJlYWQgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdTdWJDbGFzczInKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0U3ViQ2xhc3NQcm9wZXJ0eShtb2NrRmlsZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKFt7IG5hbWU6ICdwcm9wMycsIHR5cGU6ICd0ZXh0JyB9XSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnZ2V0VG9wRGlzcGxheUNvbnRlbnQnLCAoKSA9PiB7XHJcbiAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHN1YkNsYXNzUHJvcGVydHkucmVhZCA9IGplc3QuZm4oKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gY29udGFpbmVyIHdpdGggc3ViY2xhc3MgY29udGVudCB3aGVuIHN1YmNsYXNzIGZvdW5kJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LnJlYWQgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdTdWJDbGFzczEnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0VG9wRGlzcGxheUNvbnRlbnQobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC50YWdOYW1lKS50b0JlKCdESVYnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC5jaGlsZHJlbi5sZW5ndGgpLnRvQmUoMSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrU3ViQ2xhc3Nlc1swXS5nZXRUb3BEaXNwbGF5Q29udGVudCkudG9IYXZlQmVlbkNhbGxlZFdpdGgobW9ja0ZpbGUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBlbXB0eSBjb250YWluZXIgd2hlbiBubyBzdWJjbGFzcyBmb3VuZCcsICgpID0+IHtcclxuICAgICAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eS5yZWFkID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnTm9uRXhpc3RlbnRDbGFzcycpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gc3ViQ2xhc3NQcm9wZXJ0eS5nZXRUb3BEaXNwbGF5Q29udGVudChtb2NrRmlsZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LnRhZ05hbWUpLnRvQmUoJ0RJVicpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LmNoaWxkcmVuLmxlbmd0aCkudG9CZSgwKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgbnVsbCByZWFkIHJlc3VsdCcsICgpID0+IHtcclxuICAgICAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eS5yZWFkID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShudWxsKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0VG9wRGlzcGxheUNvbnRlbnQobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC50YWdOYW1lKS50b0JlKCdESVYnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC5jaGlsZHJlbi5sZW5ndGgpLnRvQmUoMCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgY2FsbCBnZXRUb3BEaXNwbGF5Q29udGVudCBvbiBjb3JyZWN0IHN1YmNsYXNzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LnJlYWQgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdTdWJDbGFzczInKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0VG9wRGlzcGxheUNvbnRlbnQobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tTdWJDbGFzc2VzWzFdLmdldFRvcERpc3BsYXlDb250ZW50KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChtb2NrRmlsZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrU3ViQ2xhc3Nlc1swXS5nZXRUb3BEaXNwbGF5Q29udGVudCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdpbmhlcml0YW5jZSBmcm9tIFNlbGVjdFByb3BlcnR5JywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgaGF2ZSBvcHRpb25zIHByb3BlcnR5IGZyb20gcGFyZW50JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3Qoc3ViQ2xhc3NQcm9wZXJ0eS5vcHRpb25zKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICAgICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShzdWJDbGFzc1Byb3BlcnR5Lm9wdGlvbnMpKS50b0JlKHRydWUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhdmUgbmFtZSBwcm9wZXJ0eSBmcm9tIHBhcmVudCcsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KHN1YkNsYXNzUHJvcGVydHkubmFtZSkudG9CZSgndGVzdFN1YkNsYXNzJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGF2ZSBmaWxsRGlzcGxheSBtZXRob2QgZnJvbSBwYXJlbnQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0eXBlb2Ygc3ViQ2xhc3NQcm9wZXJ0eS5maWxsRGlzcGxheSkudG9CZSgnZnVuY3Rpb24nKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYXZlIHJlYWQgbWV0aG9kIGZyb20gcGFyZW50JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QodHlwZW9mIHN1YkNsYXNzUHJvcGVydHkucmVhZCkudG9CZSgnZnVuY3Rpb24nKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdpbnRlZ3JhdGlvbiB3aXRoIHN1YmNsYXNzZXMnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBtYWludGFpbiBjb25zaXN0ZW5jeSBiZXR3ZWVuIHN1YkNsYXNzZXMgYW5kIG9wdGlvbnMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChzdWJDbGFzc1Byb3BlcnR5LnN1YkNsYXNzZXMubGVuZ3RoKS50b0JlKHN1YkNsYXNzUHJvcGVydHkub3B0aW9ucy5sZW5ndGgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eS5zdWJDbGFzc2VzLmZvckVhY2goKHN1YkNsYXNzLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZXhwZWN0KHN1YkNsYXNzLmdldHN1YkNsYXNzTmFtZSgpKS50b0JlKHN1YkNsYXNzUHJvcGVydHkub3B0aW9uc1tpbmRleF0ubmFtZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBzdWJjbGFzcyBtZXRob2QgY2FsbHMgY29ycmVjdGx5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LnJlYWQgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdTdWJDbGFzczEnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFRlc3QgbXVsdGlwbGUgbWV0aG9kIGNhbGxzXHJcbiAgICAgICAgICAgIHN1YkNsYXNzUHJvcGVydHkuZ2V0U3ViQ2xhc3MobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LmdldFN1YkNsYXNzUHJvcGVydHkobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LmdldFRvcERpc3BsYXlDb250ZW50KG1vY2tGaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFZlcmlmeSBhbGwgbWV0aG9kcyB3ZXJlIGNhbGxlZCBvbiB0aGUgY29ycmVjdCBzdWJjbGFzc1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1N1YkNsYXNzZXNbMF0uZ2V0c3ViQ2xhc3NOYW1lKS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrU3ViQ2xhc3Nlc1swXS5nZXRQcm9wZXJ0aWVzKS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrU3ViQ2xhc3Nlc1swXS5nZXRUb3BEaXNwbGF5Q29udGVudCkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn0pO1xyXG4iXSwidmVyc2lvbiI6M30=