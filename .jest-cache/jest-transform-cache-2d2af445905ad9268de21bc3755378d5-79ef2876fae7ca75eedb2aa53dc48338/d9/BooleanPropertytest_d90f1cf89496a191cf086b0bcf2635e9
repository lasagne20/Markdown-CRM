36cc57a5ad144549c859931bdbf957a2
"use strict";
/**
 * @jest-environment jsdom
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock vault utilities
jest.mock('../../src/vault/Utils', () => ({
    setIcon: jest.fn()
}));
const BooleanProperty_1 = require("../../src/properties/BooleanProperty");
// Import the mocked function for use in tests
const { setIcon } = jest.requireMock('../../src/vault/Utils');
describe('BooleanProperty', () => {
    let booleanProperty;
    let mockVault;
    let mockFile;
    // Helper function to trigger clicks in jsdom
    const triggerClick = (button) => {
        const clickEvent = new MouseEvent('click', { bubbles: true });
        button.dispatchEvent(clickEvent);
    };
    beforeEach(() => {
        // Reset DOM
        document.body.innerHTML = '';
        // Clear all mocks
        jest.clearAllMocks();
        // Ensure setIcon mock is working properly
        setIcon.mockImplementation((element, iconName) => {
            element.setAttribute('data-icon', iconName);
            element.textContent = `[${iconName}]`;
        });
        // Mock vault
        mockVault = {
            app: {
                setIcon: jest.fn((element, iconName) => {
                    element.setAttribute('data-icon', iconName);
                    element.textContent = `[${iconName}]`;
                }),
                vault: { getFiles: jest.fn(() => []) }
            }
        };
        // Mock file
        mockFile = {
            getMetadata: jest.fn(() => ({ isActive: true })),
            getMetadataValue: jest.fn((key) => key === 'isActive' ? true : undefined),
            updateMetadata: jest.fn(),
            vault: mockVault
        };
        booleanProperty = new BooleanProperty_1.BooleanProperty('isActive', mockVault);
        // Ensure clean state for each test
        booleanProperty.static = false;
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    describe('constructor', () => {
        it('should create BooleanProperty with correct type', () => {
            const prop = new BooleanProperty_1.BooleanProperty('test', mockVault);
            expect(prop.name).toBe('test');
            expect(prop.type).toBe('boolean');
        });
        it('should accept additional arguments', () => {
            const args = { icon: 'check', staticProperty: true };
            const prop = new BooleanProperty_1.BooleanProperty('testBool', mockVault, args);
            expect(prop.name).toBe('testBool');
            expect(prop.static).toBe(true);
            expect(prop.icon).toBe('check');
        });
        it('should use default icon if not provided', () => {
            const prop = new BooleanProperty_1.BooleanProperty('testDefault', mockVault);
            expect(prop.icon).toBe('align-left'); // Default from base Property class
        });
    });
    describe('fillDisplay', () => {
        it('should create container with button element', () => {
            const updateFn = jest.fn();
            const container = booleanProperty.fillDisplay(true, updateFn);
            expect(container.tagName).toBe('DIV');
            const button = container.querySelector('span');
            expect(button).toBeTruthy();
            expect(button?.getAttribute('data-icon')).toBe('align-left');
        });
        it('should set vault reference', () => {
            const updateFn = jest.fn();
            booleanProperty.fillDisplay(true, updateFn);
            expect(booleanProperty.vault).toBe(mockVault);
        });
        it('should add active class when value is true', () => {
            const updateFn = jest.fn();
            const container = booleanProperty.fillDisplay(true, updateFn);
            const button = container.querySelector('span');
            expect(button?.classList.contains('boolean-property-button-active')).toBe(true);
        });
        it('should not add active class when value is false', () => {
            const updateFn = jest.fn();
            const container = booleanProperty.fillDisplay(false, updateFn);
            const button = container.querySelector('span');
            expect(button?.classList.contains('boolean-property-button-active')).toBe(false);
        });
        it('should not add active class when value is falsy', () => {
            const updateFn = jest.fn();
            // Test various falsy values
            const falsyValues = [false, null, undefined, 0, '', NaN];
            falsyValues.forEach(value => {
                const container = booleanProperty.fillDisplay(value, updateFn);
                const button = container.querySelector('span');
                expect(button?.classList.contains('boolean-property-button-active')).toBe(false);
            });
        });
        it('should add active class for truthy values', () => {
            const updateFn = jest.fn();
            // Test various truthy values
            const truthyValues = [true, 1, 'yes', {}, [], 42];
            truthyValues.forEach(value => {
                const container = booleanProperty.fillDisplay(value, updateFn);
                const button = container.querySelector('span');
                expect(button?.classList.contains('boolean-property-button-active')).toBe(true);
            });
        });
    });
    describe('click functionality for non-static property', () => {
        it('should toggle value on click when not static', async () => {
            booleanProperty.static = false;
            const updateFn = jest.fn();
            let currentValue = false;
            const container = booleanProperty.fillDisplay(currentValue, updateFn);
            const button = container.querySelector('span');
            // Initially false, should not have active class
            expect(button.classList.contains('boolean-property-button-active')).toBe(false);
            // Click to toggle
            button.click();
            // Wait for async update
            await new Promise(resolve => setTimeout(resolve, 0));
            expect(updateFn).toHaveBeenCalledWith(true);
            expect(button.classList.contains('boolean-property-button-active')).toBe(true);
        });
        it('should toggle from true to false', async () => {
            booleanProperty.static = false;
            const updateFn = jest.fn();
            let currentValue = true;
            const container = booleanProperty.fillDisplay(currentValue, updateFn);
            const button = container.querySelector('span');
            // Initially true, should have active class
            expect(button.classList.contains('boolean-property-button-active')).toBe(true);
            // Click to toggle
            button.click();
            // Wait for async update
            await new Promise(resolve => setTimeout(resolve, 0));
            expect(updateFn).toHaveBeenCalledWith(false);
            expect(button.classList.contains('boolean-property-button-active')).toBe(false);
        });
        it('should handle multiple clicks correctly', async () => {
            booleanProperty.static = false;
            const updateFn = jest.fn();
            let currentValue = false;
            const container = booleanProperty.fillDisplay(currentValue, updateFn);
            const button = container.querySelector('span');
            // Add to document for proper event handling
            document.body.appendChild(container);
            // First click: false -> true
            button.click();
            await new Promise(resolve => setTimeout(resolve, 10));
            expect(updateFn).toHaveBeenNthCalledWith(1, true);
            // Second click: true -> false
            button.click();
            await new Promise(resolve => setTimeout(resolve, 0));
            expect(updateFn).toHaveBeenNthCalledWith(2, false);
            // Third click: false -> true
            button.click();
            await new Promise(resolve => setTimeout(resolve, 0));
            expect(updateFn).toHaveBeenNthCalledWith(3, true);
            expect(updateFn).toHaveBeenCalledTimes(3);
        });
        it('should update visual state immediately on click', async () => {
            booleanProperty.static = false;
            const updateFn = jest.fn();
            const container = booleanProperty.fillDisplay(false, updateFn);
            const button = container.querySelector('span');
            // Before click
            expect(button.classList.contains('boolean-property-button-active')).toBe(false);
            // Click should immediately update visual state
            button.click();
            // Visual state should update immediately, before async operation completes
            expect(button.classList.contains('boolean-property-button-active')).toBe(true);
            // Wait for async operation
            await new Promise(resolve => setTimeout(resolve, 0));
            expect(updateFn).toHaveBeenCalledWith(true);
        });
    });
    describe('static property behavior', () => {
        it('should not add click listener when static', () => {
            booleanProperty.static = true;
            const updateFn = jest.fn();
            const container = booleanProperty.fillDisplay(false, updateFn);
            const button = container.querySelector('span');
            // Click should not trigger update
            button.click();
            expect(updateFn).not.toHaveBeenCalled();
        });
        it('should still show correct visual state when static', () => {
            booleanProperty.static = true;
            const updateFn = jest.fn();
            // Test true value
            const containerTrue = booleanProperty.fillDisplay(true, updateFn);
            const buttonTrue = containerTrue.querySelector('span');
            expect(buttonTrue?.classList.contains('boolean-property-button-active')).toBe(true);
            // Test false value
            const containerFalse = booleanProperty.fillDisplay(false, updateFn);
            const buttonFalse = containerFalse.querySelector('span');
            expect(buttonFalse?.classList.contains('boolean-property-button-active')).toBe(false);
        });
    });
    describe('icon functionality', () => {
        it('should set custom icon', () => {
            const customProperty = new BooleanProperty_1.BooleanProperty('custom', mockVault, { icon: 'check-circle' });
            const updateFn = jest.fn();
            const container = customProperty.fillDisplay(true, updateFn);
            const button = container.querySelector('span');
            expect(button?.getAttribute('data-icon')).toBe('check-circle');
        });
        it('should call setIcon with correct parameters', () => {
            const updateFn = jest.fn();
            // Clear previous calls
            mockVault.app.setIcon.mockClear();
            booleanProperty.fillDisplay(true, updateFn);
            expect(mockVault.app.setIcon).toHaveBeenCalled();
            const callArgs = mockVault.app.setIcon.mock.calls[0];
            expect(callArgs[0]).toHaveProperty('tagName'); // Should be an element-like object
            expect(callArgs[0]).toHaveProperty('classList'); // Should have DOM-like interface
            expect(callArgs[1]).toBe('align-left');
        });
    });
    describe('integration with base Property class', () => {
        it('should inherit from Property class', () => {
            expect(booleanProperty).toBeInstanceOf(BooleanProperty_1.BooleanProperty);
            expect(booleanProperty.name).toBe('isActive');
            expect(booleanProperty.type).toBe('boolean');
        });
        it('should have access to base class properties', () => {
            expect(typeof booleanProperty.read).toBe('function');
            expect(typeof booleanProperty.validate).toBe('function');
            expect(typeof booleanProperty.getPretty).toBe('function');
        });
    });
    describe('edge cases and error handling', () => {
        it('should handle null update function gracefully', () => {
            booleanProperty.static = false;
            // Should not throw error with null update function
            expect(() => {
                booleanProperty.fillDisplay(true, null);
            }).not.toThrow();
        });
        it('should handle undefined value', () => {
            const updateFn = jest.fn();
            const container = booleanProperty.fillDisplay(undefined, updateFn);
            const button = container.querySelector('span');
            expect(button?.classList.contains('boolean-property-button-active')).toBe(false);
        });
        it('should handle string boolean values', () => {
            const updateFn = jest.fn();
            // Test truthy strings
            const containerTruthy = booleanProperty.fillDisplay('true', updateFn);
            const buttonTruthy = containerTruthy.querySelector('span');
            expect(buttonTruthy?.classList.contains('boolean-property-button-active')).toBe(true);
            // Test empty string (falsy)
            const containerFalsy = booleanProperty.fillDisplay('', updateFn);
            const buttonFalsy = containerFalsy.querySelector('span');
            expect(buttonFalsy?.classList.contains('boolean-property-button-active')).toBe(false);
        });
        it('should handle rapid successive clicks', async () => {
            booleanProperty.static = false;
            const updateFn = jest.fn();
            const container = booleanProperty.fillDisplay(false, updateFn);
            const button = container.querySelector('span');
            // Rapid clicks
            button.click();
            button.click();
            button.click();
            // Wait for all async operations
            await new Promise(resolve => setTimeout(resolve, 10));
            expect(updateFn).toHaveBeenCalledTimes(3);
            // Final state should be true (false -> true -> false -> true)
            expect(updateFn).toHaveBeenLastCalledWith(true);
        });
    });
    describe('CSS class management', () => {
        it('should properly add and remove active class', () => {
            booleanProperty.static = false;
            const updateFn = jest.fn();
            // Start with false
            const container = booleanProperty.fillDisplay(false, updateFn);
            const button = container.querySelector('span');
            // Should not have active class initially
            expect(button.classList.contains('boolean-property-button-active')).toBe(false);
            // Click to activate
            button.click();
            expect(button.classList.contains('boolean-property-button-active')).toBe(true);
            // Click to deactivate
            button.click();
            expect(button.classList.contains('boolean-property-button-active')).toBe(false);
        });
        it('should not interfere with other CSS classes', () => {
            booleanProperty.static = false;
            const updateFn = jest.fn();
            const container = booleanProperty.fillDisplay(true, updateFn);
            const button = container.querySelector('span');
            // Add some other classes
            button.classList.add('custom-class', 'another-class');
            // Verify active class is added correctly
            expect(button.classList.contains('boolean-property-button-active')).toBe(true);
            expect(button.classList.contains('custom-class')).toBe(true);
            expect(button.classList.contains('another-class')).toBe(true);
            // Toggle and verify other classes remain
            if (!booleanProperty.static) {
                button.click();
                expect(button.classList.contains('custom-class')).toBe(true);
                expect(button.classList.contains('another-class')).toBe(true);
            }
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxfX3Rlc3RzX19cXFByb3BlcnRpZXNcXEJvb2xlYW5Qcm9wZXJ0eS50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7QUFJSCx1QkFBdUI7QUFDdkIsSUFBSSxDQUFDLElBQUksQ0FBQyx1QkFBdUIsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ3RDLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0NBQ3JCLENBQUMsQ0FBQyxDQUFDO0FBTEosMEVBQXVFO0FBT3ZFLDhDQUE4QztBQUM5QyxNQUFNLEVBQUUsT0FBTyxFQUFFLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO0FBRTlELFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxHQUFHLEVBQUU7SUFDN0IsSUFBSSxlQUFnQyxDQUFDO0lBQ3JDLElBQUksU0FBYyxDQUFDO0lBQ25CLElBQUksUUFBYSxDQUFDO0lBRWxCLDZDQUE2QztJQUM3QyxNQUFNLFlBQVksR0FBRyxDQUFDLE1BQW1CLEVBQUUsRUFBRTtRQUN6QyxNQUFNLFVBQVUsR0FBRyxJQUFJLFVBQVUsQ0FBQyxPQUFPLEVBQUUsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztRQUM5RCxNQUFNLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQ3JDLENBQUMsQ0FBQztJQUVGLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDWixZQUFZO1FBQ1osUUFBUSxDQUFDLElBQUksQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDO1FBRTdCLGtCQUFrQjtRQUNsQixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFFckIsMENBQTBDO1FBQzFDLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLE9BQW9CLEVBQUUsUUFBZ0IsRUFBRSxF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QUMsQ0FBQztZQUM5RCxNQUFNLE1BQU0sR0FBRyxTQUFTLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBZ0IsQ0FBQztZQUU5RCx5QkFBeUI7WUFDekIsTUFBTSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsY0FBYyxFQUFFLGVBQWUsQ0FBQyxDQUFDO1lBRXRELHlDQUF5QztZQUN6QyxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsZ0NBQWdDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUMvRSxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDN0QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBRTlELHlDQUF5QztZQUN6QyxJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU0sRUFBRSxDQUFDO2dCQUMxQixNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7Z0JBQ2YsTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUM3RCxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbEUsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGxlb2R1XFxEb2N1bWVudHNcXDEgLSBQcm9cXFRlc3QgcGx1Z2luIG9ic2lkaWFuXFwub2JzaWRpYW5cXHBsdWdpbnNcXG9ic2lkaWFuLUNSTVxcZHluYW1pYy1maWVsZHNcXF9fdGVzdHNfX1xcUHJvcGVydGllc1xcQm9vbGVhblByb3BlcnR5LnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBqZXN0LWVudmlyb25tZW50IGpzZG9tXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgQm9vbGVhblByb3BlcnR5IH0gZnJvbSAnLi4vLi4vc3JjL3Byb3BlcnRpZXMvQm9vbGVhblByb3BlcnR5JztcclxuXHJcbi8vIE1vY2sgdmF1bHQgdXRpbGl0aWVzXHJcbmplc3QubW9jaygnLi4vLi4vc3JjL3ZhdWx0L1V0aWxzJywgKCkgPT4gKHtcclxuICAgIHNldEljb246IGplc3QuZm4oKVxyXG59KSk7XHJcblxyXG4vLyBJbXBvcnQgdGhlIG1vY2tlZCBmdW5jdGlvbiBmb3IgdXNlIGluIHRlc3RzXHJcbmNvbnN0IHsgc2V0SWNvbiB9ID0gamVzdC5yZXF1aXJlTW9jaygnLi4vLi4vc3JjL3ZhdWx0L1V0aWxzJyk7XHJcblxyXG5kZXNjcmliZSgnQm9vbGVhblByb3BlcnR5JywgKCkgPT4ge1xyXG4gICAgbGV0IGJvb2xlYW5Qcm9wZXJ0eTogQm9vbGVhblByb3BlcnR5O1xyXG4gICAgbGV0IG1vY2tWYXVsdDogYW55O1xyXG4gICAgbGV0IG1vY2tGaWxlOiBhbnk7XHJcblxyXG4gICAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIHRyaWdnZXIgY2xpY2tzIGluIGpzZG9tXHJcbiAgICBjb25zdCB0cmlnZ2VyQ2xpY2sgPSAoYnV0dG9uOiBIVE1MRWxlbWVudCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNsaWNrRXZlbnQgPSBuZXcgTW91c2VFdmVudCgnY2xpY2snLCB7IGJ1YmJsZXM6IHRydWUgfSk7XHJcbiAgICAgICAgYnV0dG9uLmRpc3BhdGNoRXZlbnQoY2xpY2tFdmVudCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgIC8vIFJlc2V0IERPTVxyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ2xlYXIgYWxsIG1vY2tzXHJcbiAgICAgICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gRW5zdXJlIHNldEljb24gbW9jayBpcyB3b3JraW5nIHByb3Blcmx5XHJcbiAgICAgICAgc2V0SWNvbi5tb2NrSW1wbGVtZW50YXRpb24oKGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBpY29uTmFtZTogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLWljb24nLCBpY29uTmFtZSk7XHJcbiAgICAgICAgICAgIGVsZW1lbnQudGV4dENvbnRlbnQgPSBgWyR7aWNvbk5hbWV9XWA7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gTW9jayB2YXVsdFxyXG4gICAgICAgIG1vY2tWYXVsdCA9IHtcclxuICAgICAgICAgICAgYXBwOiB7XHJcbiAgICAgICAgICAgICAgICBzZXRJY29uOiBqZXN0LmZuKChlbGVtZW50OiBIVE1MRWxlbWVudCwgaWNvbk5hbWU6IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLWljb24nLCBpY29uTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC50ZXh0Q29udGVudCA9IGBbJHtpY29uTmFtZX1dYDtcclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgdmF1bHQ6IHsgZ2V0RmlsZXM6IGplc3QuZm4oKCkgPT4gW10pIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIE1vY2sgZmlsZVxyXG4gICAgICAgIG1vY2tGaWxlID0ge1xyXG4gICAgICAgICAgICBnZXRNZXRhZGF0YTogamVzdC5mbigoKSA9PiAoeyBpc0FjdGl2ZTogdHJ1ZSB9KSksXHJcbiAgICAgICAgICAgIGdldE1ldGFkYXRhVmFsdWU6IGplc3QuZm4oKGtleTogc3RyaW5nKSA9PiBrZXkgPT09ICdpc0FjdGl2ZScgPyB0cnVlIDogdW5kZWZpbmVkKSxcclxuICAgICAgICAgICAgdXBkYXRlTWV0YWRhdGE6IGplc3QuZm4oKSxcclxuICAgICAgICAgICAgdmF1bHQ6IG1vY2tWYXVsdFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGJvb2xlYW5Qcm9wZXJ0eSA9IG5ldyBCb29sZWFuUHJvcGVydHkoJ2lzQWN0aXZlJywgbW9ja1ZhdWx0KTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBFbnN1cmUgY2xlYW4gc3RhdGUgZm9yIGVhY2ggdGVzdFxyXG4gICAgICAgIGJvb2xlYW5Qcm9wZXJ0eS5zdGF0aWMgPSBmYWxzZTtcclxuICAgIH0pO1xyXG5cclxuICAgIGFmdGVyRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnY29uc3RydWN0b3InLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgQm9vbGVhblByb3BlcnR5IHdpdGggY29ycmVjdCB0eXBlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwcm9wID0gbmV3IEJvb2xlYW5Qcm9wZXJ0eSgndGVzdCcsIG1vY2tWYXVsdCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocHJvcC5uYW1lKS50b0JlKCd0ZXN0Jyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChwcm9wLnR5cGUpLnRvQmUoJ2Jvb2xlYW4nKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBhY2NlcHQgYWRkaXRpb25hbCBhcmd1bWVudHMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFyZ3MgPSB7IGljb246ICdjaGVjaycsIHN0YXRpY1Byb3BlcnR5OiB0cnVlIH07XHJcbiAgICAgICAgICAgIGNvbnN0IHByb3AgPSBuZXcgQm9vbGVhblByb3BlcnR5KCd0ZXN0Qm9vbCcsIG1vY2tWYXVsdCwgYXJncyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocHJvcC5uYW1lKS50b0JlKCd0ZXN0Qm9vbCcpO1xyXG4gICAgICAgICAgICBleHBlY3QocHJvcC5zdGF0aWMpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChwcm9wLmljb24pLnRvQmUoJ2NoZWNrJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgdXNlIGRlZmF1bHQgaWNvbiBpZiBub3QgcHJvdmlkZWQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHByb3AgPSBuZXcgQm9vbGVhblByb3BlcnR5KCd0ZXN0RGVmYXVsdCcsIG1vY2tWYXVsdCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocHJvcC5pY29uKS50b0JlKCdhbGlnbi1sZWZ0Jyk7IC8vIERlZmF1bHQgZnJvbSBiYXNlIFByb3BlcnR5IGNsYXNzXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnZmlsbERpc3BsYXknLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgY29udGFpbmVyIHdpdGggYnV0dG9uIGVsZW1lbnQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZUZuID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBib29sZWFuUHJvcGVydHkuZmlsbERpc3BsYXkodHJ1ZSwgdXBkYXRlRm4pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci50YWdOYW1lKS50b0JlKCdESVYnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdzcGFuJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b24pLnRvQmVUcnV0aHkoKTtcclxuICAgICAgICAgICAgZXhwZWN0KGJ1dHRvbj8uZ2V0QXR0cmlidXRlKCdkYXRhLWljb24nKSkudG9CZSgnYWxpZ24tbGVmdCcpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHNldCB2YXVsdCByZWZlcmVuY2UnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZUZuID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBib29sZWFuUHJvcGVydHkuZmlsbERpc3BsYXkodHJ1ZSwgdXBkYXRlRm4pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGJvb2xlYW5Qcm9wZXJ0eS52YXVsdCkudG9CZShtb2NrVmF1bHQpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGFkZCBhY3RpdmUgY2xhc3Mgd2hlbiB2YWx1ZSBpcyB0cnVlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVGbiA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gYm9vbGVhblByb3BlcnR5LmZpbGxEaXNwbGF5KHRydWUsIHVwZGF0ZUZuKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdzcGFuJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b24/LmNsYXNzTGlzdC5jb250YWlucygnYm9vbGVhbi1wcm9wZXJ0eS1idXR0b24tYWN0aXZlJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgbm90IGFkZCBhY3RpdmUgY2xhc3Mgd2hlbiB2YWx1ZSBpcyBmYWxzZScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlRm4gPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheShmYWxzZSwgdXBkYXRlRm4pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKTtcclxuICAgICAgICAgICAgZXhwZWN0KGJ1dHRvbj8uY2xhc3NMaXN0LmNvbnRhaW5zKCdib29sZWFuLXByb3BlcnR5LWJ1dHRvbi1hY3RpdmUnKSkudG9CZShmYWxzZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgbm90IGFkZCBhY3RpdmUgY2xhc3Mgd2hlbiB2YWx1ZSBpcyBmYWxzeScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlRm4gPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBUZXN0IHZhcmlvdXMgZmFsc3kgdmFsdWVzXHJcbiAgICAgICAgICAgIGNvbnN0IGZhbHN5VmFsdWVzID0gW2ZhbHNlLCBudWxsLCB1bmRlZmluZWQsIDAsICcnLCBOYU5dO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZmFsc3lWYWx1ZXMuZm9yRWFjaCh2YWx1ZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBib29sZWFuUHJvcGVydHkuZmlsbERpc3BsYXkodmFsdWUsIHVwZGF0ZUZuKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdzcGFuJyk7XHJcbiAgICAgICAgICAgICAgICBleHBlY3QoYnV0dG9uPy5jbGFzc0xpc3QuY29udGFpbnMoJ2Jvb2xlYW4tcHJvcGVydHktYnV0dG9uLWFjdGl2ZScpKS50b0JlKGZhbHNlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgYWRkIGFjdGl2ZSBjbGFzcyBmb3IgdHJ1dGh5IHZhbHVlcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlRm4gPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBUZXN0IHZhcmlvdXMgdHJ1dGh5IHZhbHVlc1xyXG4gICAgICAgICAgICBjb25zdCB0cnV0aHlWYWx1ZXMgPSBbdHJ1ZSwgMSwgJ3llcycsIHt9LCBbXSwgNDJdO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdHJ1dGh5VmFsdWVzLmZvckVhY2godmFsdWUgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gYm9vbGVhblByb3BlcnR5LmZpbGxEaXNwbGF5KHZhbHVlLCB1cGRhdGVGbik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBjb250YWluZXIucXVlcnlTZWxlY3Rvcignc3BhbicpO1xyXG4gICAgICAgICAgICAgICAgZXhwZWN0KGJ1dHRvbj8uY2xhc3NMaXN0LmNvbnRhaW5zKCdib29sZWFuLXByb3BlcnR5LWJ1dHRvbi1hY3RpdmUnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnY2xpY2sgZnVuY3Rpb25hbGl0eSBmb3Igbm9uLXN0YXRpYyBwcm9wZXJ0eScsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIHRvZ2dsZSB2YWx1ZSBvbiBjbGljayB3aGVuIG5vdCBzdGF0aWMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGJvb2xlYW5Qcm9wZXJ0eS5zdGF0aWMgPSBmYWxzZTtcclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlRm4gPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGxldCBjdXJyZW50VmFsdWUgPSBmYWxzZTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheShjdXJyZW50VmFsdWUsIHVwZGF0ZUZuKTtcclxuICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEluaXRpYWxseSBmYWxzZSwgc2hvdWxkIG5vdCBoYXZlIGFjdGl2ZSBjbGFzc1xyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYm9vbGVhbi1wcm9wZXJ0eS1idXR0b24tYWN0aXZlJykpLnRvQmUoZmFsc2UpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gQ2xpY2sgdG8gdG9nZ2xlXHJcbiAgICAgICAgICAgIGJ1dHRvbi5jbGljaygpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gV2FpdCBmb3IgYXN5bmMgdXBkYXRlXHJcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAwKSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QodXBkYXRlRm4pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHRydWUpO1xyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYm9vbGVhbi1wcm9wZXJ0eS1idXR0b24tYWN0aXZlJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgdG9nZ2xlIGZyb20gdHJ1ZSB0byBmYWxzZScsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgYm9vbGVhblByb3BlcnR5LnN0YXRpYyA9IGZhbHNlO1xyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVGbiA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgbGV0IGN1cnJlbnRWYWx1ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBib29sZWFuUHJvcGVydHkuZmlsbERpc3BsYXkoY3VycmVudFZhbHVlLCB1cGRhdGVGbik7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdzcGFuJykgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBJbml0aWFsbHkgdHJ1ZSwgc2hvdWxkIGhhdmUgYWN0aXZlIGNsYXNzXHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdib29sZWFuLXByb3BlcnR5LWJ1dHRvbi1hY3RpdmUnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIENsaWNrIHRvIHRvZ2dsZVxyXG4gICAgICAgICAgICBidXR0b24uY2xpY2soKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFdhaXQgZm9yIGFzeW5jIHVwZGF0ZVxyXG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMCkpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHVwZGF0ZUZuKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChmYWxzZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdib29sZWFuLXByb3BlcnR5LWJ1dHRvbi1hY3RpdmUnKSkudG9CZShmYWxzZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIG11bHRpcGxlIGNsaWNrcyBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGJvb2xlYW5Qcm9wZXJ0eS5zdGF0aWMgPSBmYWxzZTtcclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlRm4gPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGxldCBjdXJyZW50VmFsdWUgPSBmYWxzZTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheShjdXJyZW50VmFsdWUsIHVwZGF0ZUZuKTtcclxuICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEFkZCB0byBkb2N1bWVudCBmb3IgcHJvcGVyIGV2ZW50IGhhbmRsaW5nXHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEZpcnN0IGNsaWNrOiBmYWxzZSAtPiB0cnVlXHJcbiAgICAgICAgICAgIGJ1dHRvbi5jbGljaygpO1xyXG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTApKTtcclxuICAgICAgICAgICAgZXhwZWN0KHVwZGF0ZUZuKS50b0hhdmVCZWVuTnRoQ2FsbGVkV2l0aCgxLCB0cnVlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFNlY29uZCBjbGljazogdHJ1ZSAtPiBmYWxzZVxyXG4gICAgICAgICAgICBidXR0b24uY2xpY2soKTtcclxuICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDApKTtcclxuICAgICAgICAgICAgZXhwZWN0KHVwZGF0ZUZuKS50b0hhdmVCZWVuTnRoQ2FsbGVkV2l0aCgyLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBUaGlyZCBjbGljazogZmFsc2UgLT4gdHJ1ZVxyXG4gICAgICAgICAgICBidXR0b24uY2xpY2soKTtcclxuICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDApKTtcclxuICAgICAgICAgICAgZXhwZWN0KHVwZGF0ZUZuKS50b0hhdmVCZWVuTnRoQ2FsbGVkV2l0aCgzLCB0cnVlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdCh1cGRhdGVGbikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDMpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHVwZGF0ZSB2aXN1YWwgc3RhdGUgaW1tZWRpYXRlbHkgb24gY2xpY2snLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGJvb2xlYW5Qcm9wZXJ0eS5zdGF0aWMgPSBmYWxzZTtcclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlRm4gPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBib29sZWFuUHJvcGVydHkuZmlsbERpc3BsYXkoZmFsc2UsIHVwZGF0ZUZuKTtcclxuICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEJlZm9yZSBjbGlja1xyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYm9vbGVhbi1wcm9wZXJ0eS1idXR0b24tYWN0aXZlJykpLnRvQmUoZmFsc2UpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gQ2xpY2sgc2hvdWxkIGltbWVkaWF0ZWx5IHVwZGF0ZSB2aXN1YWwgc3RhdGVcclxuICAgICAgICAgICAgYnV0dG9uLmNsaWNrKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBWaXN1YWwgc3RhdGUgc2hvdWxkIHVwZGF0ZSBpbW1lZGlhdGVseSwgYmVmb3JlIGFzeW5jIG9wZXJhdGlvbiBjb21wbGV0ZXNcclxuICAgICAgICAgICAgZXhwZWN0KGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2Jvb2xlYW4tcHJvcGVydHktYnV0dG9uLWFjdGl2ZScpKS50b0JlKHRydWUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gV2FpdCBmb3IgYXN5bmMgb3BlcmF0aW9uXHJcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAwKSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QodXBkYXRlRm4pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHRydWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ3N0YXRpYyBwcm9wZXJ0eSBiZWhhdmlvcicsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIG5vdCBhZGQgY2xpY2sgbGlzdGVuZXIgd2hlbiBzdGF0aWMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGJvb2xlYW5Qcm9wZXJ0eS5zdGF0aWMgPSB0cnVlO1xyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVGbiA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheShmYWxzZSwgdXBkYXRlRm4pO1xyXG4gICAgICAgICAgICBjb25zdCBidXR0b24gPSBjb250YWluZXIucXVlcnlTZWxlY3Rvcignc3BhbicpIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gQ2xpY2sgc2hvdWxkIG5vdCB0cmlnZ2VyIHVwZGF0ZVxyXG4gICAgICAgICAgICBidXR0b24uY2xpY2soKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdCh1cGRhdGVGbikubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBzdGlsbCBzaG93IGNvcnJlY3QgdmlzdWFsIHN0YXRlIHdoZW4gc3RhdGljJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBib29sZWFuUHJvcGVydHkuc3RhdGljID0gdHJ1ZTtcclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlRm4gPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBUZXN0IHRydWUgdmFsdWVcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyVHJ1ZSA9IGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheSh0cnVlLCB1cGRhdGVGbik7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvblRydWUgPSBjb250YWluZXJUcnVlLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKTtcclxuICAgICAgICAgICAgZXhwZWN0KGJ1dHRvblRydWU/LmNsYXNzTGlzdC5jb250YWlucygnYm9vbGVhbi1wcm9wZXJ0eS1idXR0b24tYWN0aXZlJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBUZXN0IGZhbHNlIHZhbHVlXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lckZhbHNlID0gYm9vbGVhblByb3BlcnR5LmZpbGxEaXNwbGF5KGZhbHNlLCB1cGRhdGVGbik7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbkZhbHNlID0gY29udGFpbmVyRmFsc2UucXVlcnlTZWxlY3Rvcignc3BhbicpO1xyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uRmFsc2U/LmNsYXNzTGlzdC5jb250YWlucygnYm9vbGVhbi1wcm9wZXJ0eS1idXR0b24tYWN0aXZlJykpLnRvQmUoZmFsc2UpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2ljb24gZnVuY3Rpb25hbGl0eScsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIHNldCBjdXN0b20gaWNvbicsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VzdG9tUHJvcGVydHkgPSBuZXcgQm9vbGVhblByb3BlcnR5KCdjdXN0b20nLCBtb2NrVmF1bHQsIHsgaWNvbjogJ2NoZWNrLWNpcmNsZScgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZUZuID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gY3VzdG9tUHJvcGVydHkuZmlsbERpc3BsYXkodHJ1ZSwgdXBkYXRlRm4pO1xyXG4gICAgICAgICAgICBjb25zdCBidXR0b24gPSBjb250YWluZXIucXVlcnlTZWxlY3Rvcignc3BhbicpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGJ1dHRvbj8uZ2V0QXR0cmlidXRlKCdkYXRhLWljb24nKSkudG9CZSgnY2hlY2stY2lyY2xlJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgY2FsbCBzZXRJY29uIHdpdGggY29ycmVjdCBwYXJhbWV0ZXJzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVGbiA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIENsZWFyIHByZXZpb3VzIGNhbGxzXHJcbiAgICAgICAgICAgIG1vY2tWYXVsdC5hcHAuc2V0SWNvbi5tb2NrQ2xlYXIoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheSh0cnVlLCB1cGRhdGVGbik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1ZhdWx0LmFwcC5zZXRJY29uKS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNhbGxBcmdzID0gbW9ja1ZhdWx0LmFwcC5zZXRJY29uLm1vY2suY2FsbHNbMF07XHJcbiAgICAgICAgICAgIGV4cGVjdChjYWxsQXJnc1swXSkudG9IYXZlUHJvcGVydHkoJ3RhZ05hbWUnKTsgLy8gU2hvdWxkIGJlIGFuIGVsZW1lbnQtbGlrZSBvYmplY3RcclxuICAgICAgICAgICAgZXhwZWN0KGNhbGxBcmdzWzBdKS50b0hhdmVQcm9wZXJ0eSgnY2xhc3NMaXN0Jyk7IC8vIFNob3VsZCBoYXZlIERPTS1saWtlIGludGVyZmFjZVxyXG4gICAgICAgICAgICBleHBlY3QoY2FsbEFyZ3NbMV0pLnRvQmUoJ2FsaWduLWxlZnQnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdpbnRlZ3JhdGlvbiB3aXRoIGJhc2UgUHJvcGVydHkgY2xhc3MnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBpbmhlcml0IGZyb20gUHJvcGVydHkgY2xhc3MnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChib29sZWFuUHJvcGVydHkpLnRvQmVJbnN0YW5jZU9mKEJvb2xlYW5Qcm9wZXJ0eSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChib29sZWFuUHJvcGVydHkubmFtZSkudG9CZSgnaXNBY3RpdmUnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGJvb2xlYW5Qcm9wZXJ0eS50eXBlKS50b0JlKCdib29sZWFuJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGF2ZSBhY2Nlc3MgdG8gYmFzZSBjbGFzcyBwcm9wZXJ0aWVzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QodHlwZW9mIGJvb2xlYW5Qcm9wZXJ0eS5yZWFkKS50b0JlKCdmdW5jdGlvbicpO1xyXG4gICAgICAgICAgICBleHBlY3QodHlwZW9mIGJvb2xlYW5Qcm9wZXJ0eS52YWxpZGF0ZSkudG9CZSgnZnVuY3Rpb24nKTtcclxuICAgICAgICAgICAgZXhwZWN0KHR5cGVvZiBib29sZWFuUHJvcGVydHkuZ2V0UHJldHR5KS50b0JlKCdmdW5jdGlvbicpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdlZGdlIGNhc2VzIGFuZCBlcnJvciBoYW5kbGluZycsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBudWxsIHVwZGF0ZSBmdW5jdGlvbiBncmFjZWZ1bGx5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBib29sZWFuUHJvcGVydHkuc3RhdGljID0gZmFsc2U7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBTaG91bGQgbm90IHRocm93IGVycm9yIHdpdGggbnVsbCB1cGRhdGUgZnVuY3Rpb25cclxuICAgICAgICAgICAgZXhwZWN0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheSh0cnVlLCBudWxsIGFzIGFueSk7XHJcbiAgICAgICAgICAgIH0pLm5vdC50b1Rocm93KCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIHVuZGVmaW5lZCB2YWx1ZScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlRm4gPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheSh1bmRlZmluZWQsIHVwZGF0ZUZuKTtcclxuICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b24/LmNsYXNzTGlzdC5jb250YWlucygnYm9vbGVhbi1wcm9wZXJ0eS1idXR0b24tYWN0aXZlJykpLnRvQmUoZmFsc2UpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBzdHJpbmcgYm9vbGVhbiB2YWx1ZXMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZUZuID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVGVzdCB0cnV0aHkgc3RyaW5nc1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXJUcnV0aHkgPSBib29sZWFuUHJvcGVydHkuZmlsbERpc3BsYXkoJ3RydWUnLCB1cGRhdGVGbik7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvblRydXRoeSA9IGNvbnRhaW5lclRydXRoeS5xdWVyeVNlbGVjdG9yKCdzcGFuJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b25UcnV0aHk/LmNsYXNzTGlzdC5jb250YWlucygnYm9vbGVhbi1wcm9wZXJ0eS1idXR0b24tYWN0aXZlJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBUZXN0IGVtcHR5IHN0cmluZyAoZmFsc3kpXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lckZhbHN5ID0gYm9vbGVhblByb3BlcnR5LmZpbGxEaXNwbGF5KCcnLCB1cGRhdGVGbik7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbkZhbHN5ID0gY29udGFpbmVyRmFsc3kucXVlcnlTZWxlY3Rvcignc3BhbicpO1xyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uRmFsc3k/LmNsYXNzTGlzdC5jb250YWlucygnYm9vbGVhbi1wcm9wZXJ0eS1idXR0b24tYWN0aXZlJykpLnRvQmUoZmFsc2UpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSByYXBpZCBzdWNjZXNzaXZlIGNsaWNrcycsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgYm9vbGVhblByb3BlcnR5LnN0YXRpYyA9IGZhbHNlO1xyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVGbiA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheShmYWxzZSwgdXBkYXRlRm4pO1xyXG4gICAgICAgICAgICBjb25zdCBidXR0b24gPSBjb250YWluZXIucXVlcnlTZWxlY3Rvcignc3BhbicpIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gUmFwaWQgY2xpY2tzXHJcbiAgICAgICAgICAgIGJ1dHRvbi5jbGljaygpO1xyXG4gICAgICAgICAgICBidXR0b24uY2xpY2soKTtcclxuICAgICAgICAgICAgYnV0dG9uLmNsaWNrKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBXYWl0IGZvciBhbGwgYXN5bmMgb3BlcmF0aW9uc1xyXG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTApKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdCh1cGRhdGVGbikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDMpO1xyXG4gICAgICAgICAgICAvLyBGaW5hbCBzdGF0ZSBzaG91bGQgYmUgdHJ1ZSAoZmFsc2UgLT4gdHJ1ZSAtPiBmYWxzZSAtPiB0cnVlKVxyXG4gICAgICAgICAgICBleHBlY3QodXBkYXRlRm4pLnRvSGF2ZUJlZW5MYXN0Q2FsbGVkV2l0aCh0cnVlKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdDU1MgY2xhc3MgbWFuYWdlbWVudCcsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIHByb3Blcmx5IGFkZCBhbmQgcmVtb3ZlIGFjdGl2ZSBjbGFzcycsICgpID0+IHtcclxuICAgICAgICAgICAgYm9vbGVhblByb3BlcnR5LnN0YXRpYyA9IGZhbHNlO1xyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVGbiA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFN0YXJ0IHdpdGggZmFsc2VcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gYm9vbGVhblByb3BlcnR5LmZpbGxEaXNwbGF5KGZhbHNlLCB1cGRhdGVGbik7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdzcGFuJykgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBTaG91bGQgbm90IGhhdmUgYWN0aXZlIGNsYXNzIGluaXRpYWxseVxyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYm9vbGVhbi1wcm9wZXJ0eS1idXR0b24tYWN0aXZlJykpLnRvQmUoZmFsc2UpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gQ2xpY2sgdG8gYWN0aXZhdGVcclxuICAgICAgICAgICAgYnV0dG9uLmNsaWNrKCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdib29sZWFuLXByb3BlcnR5LWJ1dHRvbi1hY3RpdmUnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIENsaWNrIHRvIGRlYWN0aXZhdGVcclxuICAgICAgICAgICAgYnV0dG9uLmNsaWNrKCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdib29sZWFuLXByb3BlcnR5LWJ1dHRvbi1hY3RpdmUnKSkudG9CZShmYWxzZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgbm90IGludGVyZmVyZSB3aXRoIG90aGVyIENTUyBjbGFzc2VzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBib29sZWFuUHJvcGVydHkuc3RhdGljID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZUZuID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gYm9vbGVhblByb3BlcnR5LmZpbGxEaXNwbGF5KHRydWUsIHVwZGF0ZUZuKTtcclxuICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEFkZCBzb21lIG90aGVyIGNsYXNzZXNcclxuICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2N1c3RvbS1jbGFzcycsICdhbm90aGVyLWNsYXNzJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBWZXJpZnkgYWN0aXZlIGNsYXNzIGlzIGFkZGVkIGNvcnJlY3RseVxyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYm9vbGVhbi1wcm9wZXJ0eS1idXR0b24tYWN0aXZlJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdjdXN0b20tY2xhc3MnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICAgICAgZXhwZWN0KGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2Fub3RoZXItY2xhc3MnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFRvZ2dsZSBhbmQgdmVyaWZ5IG90aGVyIGNsYXNzZXMgcmVtYWluXHJcbiAgICAgICAgICAgIGlmICghYm9vbGVhblByb3BlcnR5LnN0YXRpYykge1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uLmNsaWNrKCk7XHJcbiAgICAgICAgICAgICAgICBleHBlY3QoYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnY3VzdG9tLWNsYXNzJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBleHBlY3QoYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYW5vdGhlci1jbGFzcycpKS50b0JlKHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufSk7XHJcbiJdLCJ2ZXJzaW9uIjozfQ==