{"version":3,"names":["cov_lepfa8lcy","actualCoverage","s","Property_1","require","RatingProperty","Property","constructor","name","vault","args","b","icon","f","type","fillDisplay","value","update","field","createFieldContainer","fieldContainer","document","createElement","classList","add","header","textContent","appendChild","stars","createStarRating","starContainer","selectedRating","length","i","star","app","setIcon","setAttribute","toString","svg","querySelector","onmouseover","previewStars","onmouseleave","onclick","repeat","updateStarRating","rating","querySelectorAll","forEach","index","remove","exports"],"sources":["C:\\Users\\leodu\\Documents\\1 - Pro\\Test plugin obsidian\\.obsidian\\plugins\\obsidian-CRM\\dynamic-fields\\src\\properties\\RatingProperty.ts"],"sourcesContent":["\r\nimport { Property } from \"./Property\";\r\nimport { Vault } from \"../vault/Vault\";\r\n\r\nexport class RatingProperty extends Property {\r\n\r\n    public override type : string = \"rating\";\r\n\r\n    constructor(name: string, vault: Vault, args : {} = {icon: \"star\"}) {\r\n        super(name, vault, args); \r\n    }\r\n\r\n    override fillDisplay(vault : any, value : any, update: (value: string) => Promise<void>) {\r\n        this.vault = vault\r\n        const field = this.createFieldContainer();\r\n        const fieldContainer = document.createElement(\"div\");\r\n        fieldContainer.classList.add(\"field-container-column\");\r\n\r\n        const header = document.createElement(\"div\");\r\n        header.classList.add(\"metadata-header\");\r\n        header.textContent = this.name\r\n        fieldContainer.appendChild(header);\r\n\r\n        const stars = this.createStarRating(value, update); \r\n        fieldContainer.appendChild(stars);\r\n        field.appendChild(fieldContainer);\r\n        return field;\r\n    }\r\n\r\n    // Fonction pour créer la notation par étoiles (5 étoiles cliquables)\r\n    createStarRating(value: string, update: (value: string) => Promise<void>): HTMLDivElement {\r\n        const starContainer = document.createElement(\"div\");\r\n        starContainer.classList.add(\"star-rating\");\r\n\r\n        let selectedRating = 0;\r\n        if (value) {\r\n            selectedRating = value.length;\r\n        }\r\n\r\n        // Crée les 5 étoiles\r\n        for (let i = 1; i <= 5; i++) {\r\n            const star = document.createElement(\"div\");\r\n            star.classList.add(\"star\");\r\n            this.vault.app.setIcon(star, this.icon);\r\n\r\n            star.setAttribute(\"data-value\", i.toString());\r\n\r\n            const svg = star.querySelector(\"svg\");\r\n            if (svg) {\r\n                if (i <= selectedRating) {\r\n                    svg.classList.add(\"filled-star\");\r\n                }\r\n            }\r\n\r\n            // Ajout des événements pour l'interaction utilisateur\r\n            star.onmouseover = () => this.previewStars(starContainer, i);\r\n            star.onmouseleave = () => this.previewStars(starContainer, selectedRating);\r\n            star.onclick = async () => {\r\n                selectedRating = i;\r\n                await update('+'.repeat(i)); // Sauvegarde en métadonnées sous forme de \"+\"\r\n                this.updateStarRating(starContainer, selectedRating);\r\n            };\r\n\r\n            starContainer.appendChild(star);\r\n        }\r\n\r\n        this.updateStarRating(starContainer, selectedRating); // Initial update to ensure correct state\r\n        return starContainer;\r\n    }\r\n\r\n    // Met à jour l'affichage des étoiles en fonction du niveau actuel\r\n    updateStarRating(starContainer: HTMLDivElement, rating: number) {\r\n        const stars = starContainer.querySelectorAll('.star') as NodeListOf<HTMLElement>;\r\n        stars.forEach((star, index) => {\r\n            const svg = star.querySelector(\"svg\");\r\n            if (svg) {\r\n                if (index < rating) {\r\n                    svg.classList.add(\"filled-star\");\r\n                } else {\r\n                    svg.classList.remove(\"filled-star\");\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    // Prévisualise les étoiles en fonction du survol\r\n    previewStars(starContainer: HTMLDivElement, rating: number) {\r\n        const stars = starContainer.querySelectorAll('.star') as NodeListOf<HTMLElement>;\r\n        stars.forEach((star, index) => {\r\n            const svg = star.querySelector(\"svg\");\r\n            if (svg) {\r\n                if (index < rating) {\r\n                    svg.classList.add(\"hovered-star\");\r\n                } else {\r\n                    svg.classList.remove(\"hovered-star\");\r\n                }\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAmBQ;IAAA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","ignoreList":[]}