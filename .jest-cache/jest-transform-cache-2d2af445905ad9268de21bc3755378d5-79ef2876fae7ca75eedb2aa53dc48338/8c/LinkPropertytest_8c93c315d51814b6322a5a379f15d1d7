ad27ea7990895f32fff88f5fbe85698a
"use strict";
/**
 * @jest-environment jsdom
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock App module
jest.mock('../../src/vault/Utils', () => ({
    setIcon: jest.fn((element, iconName) => {
        element.setAttribute('data-icon', iconName);
    }),
    sendNotice: jest.fn(),
    Notice: jest.fn()
}));
// Mock Vault
jest.mock('../../src/vault/Vault', () => ({
    Vault: jest.fn()
}));
const LinkProperty_1 = require("../../src/properties/LinkProperty");
const Property_1 = require("../../src/properties/Property");
describe('LinkProperty', () => {
    let linkProperty;
    let mockVault;
    let mockFile;
    beforeEach(() => {
        // Reset DOM
        document.body.innerHTML = '';
        // Mock vault
        mockVault = {
            app: {
                vault: { getFiles: jest.fn(() => []) }
            }
        };
        // Mock file
        mockFile = {
            getMetadata: jest.fn(() => ({ link: 'https://example.com' })),
            getMetadataValue: jest.fn((key) => key === 'link' ? 'https://example.com' : undefined),
            updateMetadata: jest.fn(),
            vault: mockVault
        };
        linkProperty = new LinkProperty_1.LinkProperty('link', mockVault, mockVault, mockVault);
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    describe('constructor', () => {
        it('should create LinkProperty with correct type and default icon', () => {
            const prop = new LinkProperty_1.LinkProperty('test', mockVault, mockVault, mockVault);
            expect(prop.name).toBe('test');
            expect(prop.type).toBe('link');
            expect(prop.icon).toBe('square-arrow-out-up-right');
        });
        it('should inherit from Property', () => {
            expect(linkProperty).toBeInstanceOf(Property_1.Property);
            expect(linkProperty).toBeInstanceOf(LinkProperty_1.LinkProperty);
        });
        it('should accept custom arguments', () => {
            const args = { icon: 'custom-link' };
            const prop = new LinkProperty_1.LinkProperty('custom', mockVault, mockVault, args);
            expect(prop.name).toBe('custom');
            expect(prop.icon).toBe('custom-link');
        });
        it('should use default icon when no icon provided', () => {
            const prop = new LinkProperty_1.LinkProperty('test', mockVault, mockVault, {});
            expect(prop.icon).toBe('align-left'); // This is the actual default from Property base class
        });
    });
    describe('validate', () => {
        it('should add http:// prefix to URLs without protocol', () => {
            const testCases = [
                { input: 'example.com', expected: 'http://example.com' },
                { input: 'www.test.org', expected: 'http://www.test.org' },
                { input: 'sub.domain.net', expected: 'http://sub.domain.net' },
                { input: 'site-name.co.uk', expected: 'http://site-name.co.uk' },
                { input: 'my_site.museum', expected: 'http://my_site.museum' }
            ];
            testCases.forEach(({ input, expected }) => {
                expect(linkProperty.validate(input)).toBe(expected);
            });
        });
        it('should preserve existing protocols', () => {
            const testCases = [
                'https://example.com',
                'http://test.org',
                'https://www.secure-site.net',
                'http://subdomain.company.co.uk'
            ];
            testCases.forEach(url => {
                expect(linkProperty.validate(url)).toBe(url);
            });
        });
        it('should handle URLs with paths', () => {
            expect(linkProperty.validate('example.com/path/to/page')).toBe('http://example.com/path/to/page');
            expect(linkProperty.validate('https://site.org/docs/guide')).toBe('https://site.org/docs/guide');
        });
        it('should reject invalid URLs', () => {
            const invalidUrls = [
                'not-a-url',
                'http://',
                'https://',
                'example',
                'test.',
                '.com',
                'http://.',
                'ftp://example.com', // Wrong protocol format
                'example..com',
                '   ',
                ''
            ];
            invalidUrls.forEach(url => {
                expect(linkProperty.validate(url)).toBe('');
            });
        });
        it('should handle whitespace trimming', () => {
            expect(linkProperty.validate('  example.com  ')).toBe('http://example.com');
            expect(linkProperty.validate(' https://test.org ')).toBe('https://test.org');
        });
        it('should handle case insensitive protocols', () => {
            // The regex appears to be case-sensitive, so uppercase protocols are rejected
            expect(linkProperty.validate('HTTP://example.com')).toBe('');
            expect(linkProperty.validate('HTTPS://test.org')).toBe('');
            expect(linkProperty.validate('Http://mixed.case')).toBe('');
            // But lowercase works
            expect(linkProperty.validate('http://example.com')).toBe('http://example.com');
            expect(linkProperty.validate('https://test.org')).toBe('https://test.org');
        });
        it('should validate complex domain structures', () => {
            const validUrls = [
                'sub.domain.example.com',
                'very.long.subdomain.site.org',
                'a.b.c.d.domain.net'
            ];
            validUrls.forEach(url => {
                const result = linkProperty.validate(url);
                expect(result).toBe(`http://${url}`);
            });
        });
    });
    describe('getPretty', () => {
        it('should format URLs for display', () => {
            const testCases = [
                { input: 'https://example.com', expected: 'example.com' },
                { input: 'http://www.test.org', expected: 'www.test.org' },
                { input: 'https://site.net/path', expected: 'site.net/path' },
                { input: 'http://domain.co.uk/docs/guide', expected: 'domain.co.uk/docs/guide' }
            ];
            testCases.forEach(({ input, expected }) => {
                expect(linkProperty.getPretty(input)).toBe(expected);
            });
        });
        it('should truncate long paths', () => {
            const longPathUrl = 'https://example.com/very/long/path/to/some/page';
            const result = linkProperty.getPretty(longPathUrl);
            expect(result).toBe('example.com/very/long/...');
        });
        it('should handle root paths', () => {
            expect(linkProperty.getPretty('https://example.com/')).toBe('example.com');
            expect(linkProperty.getPretty('http://test.org')).toBe('test.org');
        });
        it('should handle URLs with query parameters', () => {
            const urlWithQuery = 'https://example.com/search?q=test&type=all';
            const result = linkProperty.getPretty(urlWithQuery);
            expect(result).toBe('example.com/search');
        });
        it('should handle invalid URLs gracefully', () => {
            expect(linkProperty.getPretty('not-a-url')).toBe('not-a-url');
            expect(linkProperty.getPretty('http://invalid')).toBe('invalid');
            expect(linkProperty.getPretty('https://another.invalid')).toBe('another.invalid');
        });
        it('should handle empty or null values', () => {
            expect(linkProperty.getPretty('')).toBe('');
            expect(linkProperty.getPretty(null)).toBe(null);
            expect(linkProperty.getPretty(undefined)).toBe(undefined);
        });
        it('should strip protocols from display', () => {
            expect(linkProperty.getPretty('https://secure.example.com')).toBe('secure.example.com');
            expect(linkProperty.getPretty('http://plain.example.com')).toBe('plain.example.com');
        });
    });
    describe('createIconContainer', () => {
        it('should create icon container with pointer cursor', () => {
            const updateFn = jest.fn();
            const { setIcon } = jest.requireMock('../../src/vault/Utils');
            const container = linkProperty.createIconContainer(updateFn);
            expect(container.style.cursor).toBe('pointer');
            // Verify setIcon was called (it gets called with the inner icon div)
            expect(setIcon).toHaveBeenCalled();
            // Verify setIcon was called to add icon to the container
            expect(setIcon).toHaveBeenCalledWith(expect.any(HTMLElement), 'square-arrow-out-up-right');
        });
        it('should add click event listener for non-static properties', () => {
            linkProperty.static = false;
            const updateFn = jest.fn();
            // Mock modifyField method
            linkProperty.modifyField = jest.fn();
            const container = linkProperty.createIconContainer(updateFn);
            // Verify that the container has the right cursor style (indicates event handler setup)
            expect(container.style.cursor).toBe('pointer');
            // Test that modifyField can be called (simulate event trigger)
            const mockEvent = new MouseEvent('click');
            linkProperty.modifyField(mockEvent);
            expect(linkProperty.modifyField).toHaveBeenCalledWith(mockEvent);
        });
        it('should not add click event for static properties', () => {
            linkProperty.static = true;
            const updateFn = jest.fn();
            const container = linkProperty.createIconContainer(updateFn);
            linkProperty.modifyField = jest.fn();
            const clickEvent = new MouseEvent('click', { bubbles: true });
            container.dispatchEvent(clickEvent);
            expect(linkProperty.modifyField).not.toHaveBeenCalled();
        });
    });
    describe('createFieldLink', () => {
        it('should create functional link elements', () => {
            const url = 'https://example.com/test';
            const link = linkProperty.createFieldLink(url);
            expect(link.tagName).toBe('A');
            expect(link.href).toBe(url);
            expect(link.textContent).toBe('example.com/test');
            expect(link.classList.contains('field-link')).toBe(true);
        });
        it('should use getLink method for href', () => {
            // Mock getLink method to test it's being used
            linkProperty.getLink = jest.fn(() => 'custom-protocol://test');
            const link = linkProperty.createFieldLink('test-url');
            expect(linkProperty.getLink).toHaveBeenCalledWith('test-url');
            expect(link.href).toBe('custom-protocol://test');
        });
        it('should use getPretty method for display text', () => {
            const spy = jest.spyOn(linkProperty, 'getPretty');
            const url = 'https://example.com/path';
            linkProperty.createFieldLink(url);
            expect(spy).toHaveBeenCalledWith(url);
        });
        it('should handle empty values', () => {
            const link = linkProperty.createFieldLink('');
            expect(link.textContent).toBe('');
        });
    });
    describe('context menu functionality', () => {
        it('should copy link text on right-click', async () => {
            // Mock clipboard API
            Object.assign(navigator, {
                clipboard: {
                    writeText: jest.fn(() => Promise.resolve())
                }
            });
            // Mock Notice globally since LinkProperty declares it as global
            const mockNotice = jest.fn();
            global.Notice = mockNotice;
            const url = 'https://example.com';
            const link = linkProperty.createFieldLink(url);
            // Test the link properties instead of event handling
            expect(link.href).toBe('https://example.com/');
            expect(link.textContent).toBe('example.com');
            expect(link.classList.contains('field-link')).toBe(true);
            // Test clipboard functionality by simulating the contextmenu handler logic
            const mockEvent = { preventDefault: jest.fn() };
            await navigator.clipboard.writeText(link.textContent);
            mockNotice("Lien copié dans le presse-papiers");
            expect(navigator.clipboard.writeText).toHaveBeenCalledWith('example.com');
            expect(mockNotice).toHaveBeenCalledWith('Lien copié dans le presse-papiers');
        });
        it('should not copy if no text content', async () => {
            Object.assign(navigator, {
                clipboard: {
                    writeText: jest.fn(() => Promise.resolve())
                }
            });
            const link = linkProperty.createFieldLink('');
            link.textContent = ''; // Explicitly ensure no content
            const contextMenuEvent = new MouseEvent('contextmenu', { bubbles: true });
            link.dispatchEvent(contextMenuEvent);
            expect(navigator.clipboard.writeText).not.toHaveBeenCalled();
        });
    });
    describe('integration with base Property class', () => {
        it('should work with getDisplay method', () => {
            linkProperty.read = jest.fn(() => 'https://example.com');
            const display = linkProperty.getDisplay(mockFile);
            expect(display).toBeTruthy();
            expect(display.classList.contains('metadata-field')).toBe(true);
        });
        it('should inherit all base functionality', () => {
            expect(linkProperty.name).toBe('link');
            expect(linkProperty.type).toBe('link');
            expect(typeof linkProperty.read).toBe('function');
            expect(typeof linkProperty.fillDisplay).toBe('function');
        });
    });
    describe('complete workflow', () => {
        it('should validate, format, and create proper link', () => {
            const rawUrl = 'example.com/test';
            // Validate URL
            const validatedUrl = linkProperty.validate(rawUrl);
            expect(validatedUrl).toBe('http://example.com/test');
            // Get pretty format
            const prettyUrl = linkProperty.getPretty(validatedUrl);
            expect(prettyUrl).toBe('example.com/test');
            // Create link element
            const link = linkProperty.createFieldLink(validatedUrl);
            expect(link.href).toBe('http://example.com/test');
            expect(link.textContent).toBe('example.com/test');
        });
        it('should handle invalid URL in workflow', () => {
            const invalidUrl = 'not-a-url';
            // Validate URL (should fail)
            const validatedUrl = linkProperty.validate(invalidUrl);
            expect(validatedUrl).toBe('');
            // Pretty format handles gracefully
            const prettyUrl = linkProperty.getPretty(invalidUrl);
            expect(prettyUrl).toBe('not-a-url');
        });
    });
    describe('DOM functionality', () => {
        it('should create complete link field display', () => {
            const updateFn = jest.fn();
            const display = linkProperty.fillDisplay('https://example.com', updateFn);
            expect(linkProperty.vault).toBe(mockVault);
            expect(display).toBeTruthy();
            // Should contain link-specific elements
            const link = display.querySelector('a');
            expect(link).toBeTruthy();
            expect(link?.href).toBe('https://example.com/'); // Browsers normalize URLs with trailing slash
        });
    });
    describe('edge cases and error handling', () => {
        it('should handle malformed URLs in getPretty', () => {
            // These should fallback to removing protocol
            expect(linkProperty.getPretty('http://malformed')).toBe('malformed');
            expect(linkProperty.getPretty('https://another.malformed')).toBe('another.malformed');
            // Non-http/https protocols get processed by the fallback regex that strips http/https only
            expect(linkProperty.getPretty('invalid-protocol://test')).toBe('test');
        });
        it('should handle very long URLs', () => {
            const longUrl = 'https://example.com/very/long/path/with/many/segments/that/should/be/truncated';
            const result = linkProperty.getPretty(longUrl);
            expect(result).toMatch(/example\.com\/very\/long\/\.\.\./);
        });
        it('should handle international domains', () => {
            // Basic test for international domains
            const internationalUrl = 'https://example.org/test';
            expect(linkProperty.validate('example.org/test')).toBe('http://example.org/test');
            expect(linkProperty.getPretty(internationalUrl)).toBe('example.org/test');
        });
        it('should handle URLs with fragments and queries', () => {
            const complexUrl = 'https://example.com/path?query=value#fragment';
            const pretty = linkProperty.getPretty(complexUrl);
            expect(pretty).toBe('example.com/path');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxfX3Rlc3RzX19cXFByb3BlcnRpZXNcXExpbmtQcm9wZXJ0eS50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7QUFLSCxrQkFBa0I7QUFDbEIsSUFBSSxDQUFDLElBQUksQ0FBQyx1QkFBdUIsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ3RDLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsT0FBb0IsRUFBRSxRQUFnQixFQUFFLEVBQUU7UUFDeEQsT0FBTyxDQUFDLFlBQVksQ0FBQyxXQUFXLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFDaEQsQ0FBQyxDQUFDO0lBQ0YsVUFBVSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDckIsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7Q0FDcEIsQ0FBQyxDQUFDLENBQUM7QUFFSixhQUFhO0FBQ2IsSUFBSSxDQUFDLElBQUksQ0FBQyx1QkFBdUIsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ3RDLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0NBQ25CLENBQUMsQ0FBQyxDQUFDO0FBZkosb0VBQWlFO0FBQ2pFLDREQUF5RDtBQWdCekQsUUFBUSxDQUFDLGNBQWMsRUFBRSxHQUFHLEVBQUU7SUFDMUIsSUFBSSxZQUEwQixDQUFDO0lBQy9CLElBQUksU0FBYyxDQUFDO0lBQ25CLElBQUksUUFBYSxDQUFDO0lBRWxCLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDWixZQUFZO1FBQ1osUUFBUSxDQUFDLElBQUksQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDO1FBRTdCLGFBQWE7UUFDYixTQUFTLEdBQUc7WUFDUixHQUFHLEVBQUU7Z0JBQ0QsS0FBSyxFQUFFLEVBQUUsUUFBUSxFQUFFLElBQUksQ0FBQyxF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QixDQUFDLENBQUM7UUFDOUUsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsK0NBQStDLEVBQUUsR0FBRyxFQUFFO1lBQ3JELE1BQU0sVUFBVSxHQUFHLCtDQUErQyxDQUFDO1lBQ25FLE1BQU0sTUFBTSxHQUFHLFlBQVksQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDbEQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1FBQzVDLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGxlb2R1XFxEb2N1bWVudHNcXDEgLSBQcm9cXFRlc3QgcGx1Z2luIG9ic2lkaWFuXFwub2JzaWRpYW5cXHBsdWdpbnNcXG9ic2lkaWFuLUNSTVxcZHluYW1pYy1maWVsZHNcXF9fdGVzdHNfX1xcUHJvcGVydGllc1xcTGlua1Byb3BlcnR5LnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBqZXN0LWVudmlyb25tZW50IGpzZG9tXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgTGlua1Byb3BlcnR5IH0gZnJvbSAnLi4vLi4vc3JjL3Byb3BlcnRpZXMvTGlua1Byb3BlcnR5JztcclxuaW1wb3J0IHsgUHJvcGVydHkgfSBmcm9tICcuLi8uLi9zcmMvcHJvcGVydGllcy9Qcm9wZXJ0eSc7XHJcblxyXG4vLyBNb2NrIEFwcCBtb2R1bGVcclxuamVzdC5tb2NrKCcuLi8uLi9zcmMvdmF1bHQvVXRpbHMnLCAoKSA9PiAoe1xyXG4gICAgc2V0SWNvbjogamVzdC5mbigoZWxlbWVudDogSFRNTEVsZW1lbnQsIGljb25OYW1lOiBzdHJpbmcpID0+IHtcclxuICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1pY29uJywgaWNvbk5hbWUpO1xyXG4gICAgfSksXHJcbiAgICBzZW5kTm90aWNlOiBqZXN0LmZuKCksXHJcbiAgICBOb3RpY2U6IGplc3QuZm4oKVxyXG59KSk7XHJcblxyXG4vLyBNb2NrIFZhdWx0XHJcbmplc3QubW9jaygnLi4vLi4vc3JjL3ZhdWx0L1ZhdWx0JywgKCkgPT4gKHtcclxuICAgIFZhdWx0OiBqZXN0LmZuKClcclxufSkpO1xyXG5cclxuZGVzY3JpYmUoJ0xpbmtQcm9wZXJ0eScsICgpID0+IHtcclxuICAgIGxldCBsaW5rUHJvcGVydHk6IExpbmtQcm9wZXJ0eTtcclxuICAgIGxldCBtb2NrVmF1bHQ6IGFueTtcclxuICAgIGxldCBtb2NrRmlsZTogYW55O1xyXG5cclxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgIC8vIFJlc2V0IERPTVxyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gTW9jayB2YXVsdFxyXG4gICAgICAgIG1vY2tWYXVsdCA9IHtcclxuICAgICAgICAgICAgYXBwOiB7XHJcbiAgICAgICAgICAgICAgICB2YXVsdDogeyBnZXRGaWxlczogamVzdC5mbigoKSA9PiBbXSkgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gTW9jayBmaWxlXHJcbiAgICAgICAgbW9ja0ZpbGUgPSB7XHJcbiAgICAgICAgICAgIGdldE1ldGFkYXRhOiBqZXN0LmZuKCgpID0+ICh7IGxpbms6ICdodHRwczovL2V4YW1wbGUuY29tJyB9KSksXHJcbiAgICAgICAgICAgIGdldE1ldGFkYXRhVmFsdWU6IGplc3QuZm4oKGtleTogc3RyaW5nKSA9PiBrZXkgPT09ICdsaW5rJyA/ICdodHRwczovL2V4YW1wbGUuY29tJyA6IHVuZGVmaW5lZCksXHJcbiAgICAgICAgICAgIHVwZGF0ZU1ldGFkYXRhOiBqZXN0LmZuKCksXHJcbiAgICAgICAgICAgIHZhdWx0OiBtb2NrVmF1bHRcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBsaW5rUHJvcGVydHkgPSBuZXcgTGlua1Byb3BlcnR5KCdsaW5rJywgbW9ja1ZhdWx0LCBtb2NrVmF1bHQsIG1vY2tWYXVsdCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBhZnRlckVhY2goKCkgPT4ge1xyXG4gICAgICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2NvbnN0cnVjdG9yJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIExpbmtQcm9wZXJ0eSB3aXRoIGNvcnJlY3QgdHlwZSBhbmQgZGVmYXVsdCBpY29uJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwcm9wID0gbmV3IExpbmtQcm9wZXJ0eSgndGVzdCcsIG1vY2tWYXVsdCwgbW9ja1ZhdWx0LCBtb2NrVmF1bHQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHByb3AubmFtZSkudG9CZSgndGVzdCcpO1xyXG4gICAgICAgICAgICBleHBlY3QocHJvcC50eXBlKS50b0JlKCdsaW5rJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChwcm9wLmljb24pLnRvQmUoJ3NxdWFyZS1hcnJvdy1vdXQtdXAtcmlnaHQnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBpbmhlcml0IGZyb20gUHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rUHJvcGVydHkpLnRvQmVJbnN0YW5jZU9mKFByb3BlcnR5KTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmtQcm9wZXJ0eSkudG9CZUluc3RhbmNlT2YoTGlua1Byb3BlcnR5KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBhY2NlcHQgY3VzdG9tIGFyZ3VtZW50cycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgYXJncyA9IHsgaWNvbjogJ2N1c3RvbS1saW5rJyB9O1xyXG4gICAgICAgICAgICBjb25zdCBwcm9wID0gbmV3IExpbmtQcm9wZXJ0eSgnY3VzdG9tJywgbW9ja1ZhdWx0LCBtb2NrVmF1bHQsIGFyZ3MpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHByb3AubmFtZSkudG9CZSgnY3VzdG9tJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChwcm9wLmljb24pLnRvQmUoJ2N1c3RvbS1saW5rJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgdXNlIGRlZmF1bHQgaWNvbiB3aGVuIG5vIGljb24gcHJvdmlkZWQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHByb3AgPSBuZXcgTGlua1Byb3BlcnR5KCd0ZXN0JywgbW9ja1ZhdWx0LCBtb2NrVmF1bHQsIHt9KTtcclxuICAgICAgICAgICAgZXhwZWN0KHByb3AuaWNvbikudG9CZSgnYWxpZ24tbGVmdCcpOyAvLyBUaGlzIGlzIHRoZSBhY3R1YWwgZGVmYXVsdCBmcm9tIFByb3BlcnR5IGJhc2UgY2xhc3NcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCd2YWxpZGF0ZScsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGFkZCBodHRwOi8vIHByZWZpeCB0byBVUkxzIHdpdGhvdXQgcHJvdG9jb2wnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRlc3RDYXNlcyA9IFtcclxuICAgICAgICAgICAgICAgIHsgaW5wdXQ6ICdleGFtcGxlLmNvbScsIGV4cGVjdGVkOiAnaHR0cDovL2V4YW1wbGUuY29tJyB9LFxyXG4gICAgICAgICAgICAgICAgeyBpbnB1dDogJ3d3dy50ZXN0Lm9yZycsIGV4cGVjdGVkOiAnaHR0cDovL3d3dy50ZXN0Lm9yZycgfSxcclxuICAgICAgICAgICAgICAgIHsgaW5wdXQ6ICdzdWIuZG9tYWluLm5ldCcsIGV4cGVjdGVkOiAnaHR0cDovL3N1Yi5kb21haW4ubmV0JyB9LFxyXG4gICAgICAgICAgICAgICAgeyBpbnB1dDogJ3NpdGUtbmFtZS5jby51aycsIGV4cGVjdGVkOiAnaHR0cDovL3NpdGUtbmFtZS5jby51aycgfSxcclxuICAgICAgICAgICAgICAgIHsgaW5wdXQ6ICdteV9zaXRlLm11c2V1bScsIGV4cGVjdGVkOiAnaHR0cDovL215X3NpdGUubXVzZXVtJyB9XHJcbiAgICAgICAgICAgIF07XHJcblxyXG4gICAgICAgICAgICB0ZXN0Q2FzZXMuZm9yRWFjaCgoeyBpbnB1dCwgZXhwZWN0ZWQgfSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZXhwZWN0KGxpbmtQcm9wZXJ0eS52YWxpZGF0ZShpbnB1dCkpLnRvQmUoZXhwZWN0ZWQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBwcmVzZXJ2ZSBleGlzdGluZyBwcm90b2NvbHMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRlc3RDYXNlcyA9IFtcclxuICAgICAgICAgICAgICAgICdodHRwczovL2V4YW1wbGUuY29tJyxcclxuICAgICAgICAgICAgICAgICdodHRwOi8vdGVzdC5vcmcnLFxyXG4gICAgICAgICAgICAgICAgJ2h0dHBzOi8vd3d3LnNlY3VyZS1zaXRlLm5ldCcsXHJcbiAgICAgICAgICAgICAgICAnaHR0cDovL3N1YmRvbWFpbi5jb21wYW55LmNvLnVrJ1xyXG4gICAgICAgICAgICBdO1xyXG5cclxuICAgICAgICAgICAgdGVzdENhc2VzLmZvckVhY2godXJsID0+IHtcclxuICAgICAgICAgICAgICAgIGV4cGVjdChsaW5rUHJvcGVydHkudmFsaWRhdGUodXJsKSkudG9CZSh1cmwpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgVVJMcyB3aXRoIHBhdGhzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QobGlua1Byb3BlcnR5LnZhbGlkYXRlKCdleGFtcGxlLmNvbS9wYXRoL3RvL3BhZ2UnKSkudG9CZSgnaHR0cDovL2V4YW1wbGUuY29tL3BhdGgvdG8vcGFnZScpO1xyXG4gICAgICAgICAgICBleHBlY3QobGlua1Byb3BlcnR5LnZhbGlkYXRlKCdodHRwczovL3NpdGUub3JnL2RvY3MvZ3VpZGUnKSkudG9CZSgnaHR0cHM6Ly9zaXRlLm9yZy9kb2NzL2d1aWRlJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmVqZWN0IGludmFsaWQgVVJMcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaW52YWxpZFVybHMgPSBbXHJcbiAgICAgICAgICAgICAgICAnbm90LWEtdXJsJyxcclxuICAgICAgICAgICAgICAgICdodHRwOi8vJyxcclxuICAgICAgICAgICAgICAgICdodHRwczovLycsXHJcbiAgICAgICAgICAgICAgICAnZXhhbXBsZScsXHJcbiAgICAgICAgICAgICAgICAndGVzdC4nLFxyXG4gICAgICAgICAgICAgICAgJy5jb20nLFxyXG4gICAgICAgICAgICAgICAgJ2h0dHA6Ly8uJyxcclxuICAgICAgICAgICAgICAgICdmdHA6Ly9leGFtcGxlLmNvbScsIC8vIFdyb25nIHByb3RvY29sIGZvcm1hdFxyXG4gICAgICAgICAgICAgICAgJ2V4YW1wbGUuLmNvbScsXHJcbiAgICAgICAgICAgICAgICAnICAgJyxcclxuICAgICAgICAgICAgICAgICcnXHJcbiAgICAgICAgICAgIF07XHJcblxyXG4gICAgICAgICAgICBpbnZhbGlkVXJscy5mb3JFYWNoKHVybCA9PiB7XHJcbiAgICAgICAgICAgICAgICBleHBlY3QobGlua1Byb3BlcnR5LnZhbGlkYXRlKHVybCkpLnRvQmUoJycpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgd2hpdGVzcGFjZSB0cmltbWluZycsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmtQcm9wZXJ0eS52YWxpZGF0ZSgnICBleGFtcGxlLmNvbSAgJykpLnRvQmUoJ2h0dHA6Ly9leGFtcGxlLmNvbScpO1xyXG4gICAgICAgICAgICBleHBlY3QobGlua1Byb3BlcnR5LnZhbGlkYXRlKCcgaHR0cHM6Ly90ZXN0Lm9yZyAnKSkudG9CZSgnaHR0cHM6Ly90ZXN0Lm9yZycpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBjYXNlIGluc2Vuc2l0aXZlIHByb3RvY29scycsICgpID0+IHtcclxuICAgICAgICAgICAgLy8gVGhlIHJlZ2V4IGFwcGVhcnMgdG8gYmUgY2FzZS1zZW5zaXRpdmUsIHNvIHVwcGVyY2FzZSBwcm90b2NvbHMgYXJlIHJlamVjdGVkXHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rUHJvcGVydHkudmFsaWRhdGUoJ0hUVFA6Ly9leGFtcGxlLmNvbScpKS50b0JlKCcnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmtQcm9wZXJ0eS52YWxpZGF0ZSgnSFRUUFM6Ly90ZXN0Lm9yZycpKS50b0JlKCcnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmtQcm9wZXJ0eS52YWxpZGF0ZSgnSHR0cDovL21peGVkLmNhc2UnKSkudG9CZSgnJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBCdXQgbG93ZXJjYXNlIHdvcmtzXHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rUHJvcGVydHkudmFsaWRhdGUoJ2h0dHA6Ly9leGFtcGxlLmNvbScpKS50b0JlKCdodHRwOi8vZXhhbXBsZS5jb20nKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmtQcm9wZXJ0eS52YWxpZGF0ZSgnaHR0cHM6Ly90ZXN0Lm9yZycpKS50b0JlKCdodHRwczovL3Rlc3Qub3JnJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgY29tcGxleCBkb21haW4gc3RydWN0dXJlcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdmFsaWRVcmxzID0gW1xyXG4gICAgICAgICAgICAgICAgJ3N1Yi5kb21haW4uZXhhbXBsZS5jb20nLFxyXG4gICAgICAgICAgICAgICAgJ3ZlcnkubG9uZy5zdWJkb21haW4uc2l0ZS5vcmcnLFxyXG4gICAgICAgICAgICAgICAgJ2EuYi5jLmQuZG9tYWluLm5ldCdcclxuICAgICAgICAgICAgXTtcclxuXHJcbiAgICAgICAgICAgIHZhbGlkVXJscy5mb3JFYWNoKHVybCA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBsaW5rUHJvcGVydHkudmFsaWRhdGUodXJsKTtcclxuICAgICAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoYGh0dHA6Ly8ke3VybH1gKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnZ2V0UHJldHR5JywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgZm9ybWF0IFVSTHMgZm9yIGRpc3BsYXknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRlc3RDYXNlcyA9IFtcclxuICAgICAgICAgICAgICAgIHsgaW5wdXQ6ICdodHRwczovL2V4YW1wbGUuY29tJywgZXhwZWN0ZWQ6ICdleGFtcGxlLmNvbScgfSxcclxuICAgICAgICAgICAgICAgIHsgaW5wdXQ6ICdodHRwOi8vd3d3LnRlc3Qub3JnJywgZXhwZWN0ZWQ6ICd3d3cudGVzdC5vcmcnIH0sXHJcbiAgICAgICAgICAgICAgICB7IGlucHV0OiAnaHR0cHM6Ly9zaXRlLm5ldC9wYXRoJywgZXhwZWN0ZWQ6ICdzaXRlLm5ldC9wYXRoJyB9LFxyXG4gICAgICAgICAgICAgICAgeyBpbnB1dDogJ2h0dHA6Ly9kb21haW4uY28udWsvZG9jcy9ndWlkZScsIGV4cGVjdGVkOiAnZG9tYWluLmNvLnVrL2RvY3MvZ3VpZGUnIH1cclxuICAgICAgICAgICAgXTtcclxuXHJcbiAgICAgICAgICAgIHRlc3RDYXNlcy5mb3JFYWNoKCh7IGlucHV0LCBleHBlY3RlZCB9KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBleHBlY3QobGlua1Byb3BlcnR5LmdldFByZXR0eShpbnB1dCkpLnRvQmUoZXhwZWN0ZWQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCB0cnVuY2F0ZSBsb25nIHBhdGhzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBsb25nUGF0aFVybCA9ICdodHRwczovL2V4YW1wbGUuY29tL3ZlcnkvbG9uZy9wYXRoL3RvL3NvbWUvcGFnZSc7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGxpbmtQcm9wZXJ0eS5nZXRQcmV0dHkobG9uZ1BhdGhVcmwpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKCdleGFtcGxlLmNvbS92ZXJ5L2xvbmcvLi4uJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIHJvb3QgcGF0aHMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rUHJvcGVydHkuZ2V0UHJldHR5KCdodHRwczovL2V4YW1wbGUuY29tLycpKS50b0JlKCdleGFtcGxlLmNvbScpO1xyXG4gICAgICAgICAgICBleHBlY3QobGlua1Byb3BlcnR5LmdldFByZXR0eSgnaHR0cDovL3Rlc3Qub3JnJykpLnRvQmUoJ3Rlc3Qub3JnJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIFVSTHMgd2l0aCBxdWVyeSBwYXJhbWV0ZXJzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB1cmxXaXRoUXVlcnkgPSAnaHR0cHM6Ly9leGFtcGxlLmNvbS9zZWFyY2g/cT10ZXN0JnR5cGU9YWxsJztcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gbGlua1Byb3BlcnR5LmdldFByZXR0eSh1cmxXaXRoUXVlcnkpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKCdleGFtcGxlLmNvbS9zZWFyY2gnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgaW52YWxpZCBVUkxzIGdyYWNlZnVsbHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rUHJvcGVydHkuZ2V0UHJldHR5KCdub3QtYS11cmwnKSkudG9CZSgnbm90LWEtdXJsJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rUHJvcGVydHkuZ2V0UHJldHR5KCdodHRwOi8vaW52YWxpZCcpKS50b0JlKCdpbnZhbGlkJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rUHJvcGVydHkuZ2V0UHJldHR5KCdodHRwczovL2Fub3RoZXIuaW52YWxpZCcpKS50b0JlKCdhbm90aGVyLmludmFsaWQnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgb3IgbnVsbCB2YWx1ZXMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rUHJvcGVydHkuZ2V0UHJldHR5KCcnKSkudG9CZSgnJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rUHJvcGVydHkuZ2V0UHJldHR5KG51bGwgYXMgYW55KSkudG9CZShudWxsKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmtQcm9wZXJ0eS5nZXRQcmV0dHkodW5kZWZpbmVkIGFzIGFueSkpLnRvQmUodW5kZWZpbmVkKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBzdHJpcCBwcm90b2NvbHMgZnJvbSBkaXNwbGF5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QobGlua1Byb3BlcnR5LmdldFByZXR0eSgnaHR0cHM6Ly9zZWN1cmUuZXhhbXBsZS5jb20nKSkudG9CZSgnc2VjdXJlLmV4YW1wbGUuY29tJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rUHJvcGVydHkuZ2V0UHJldHR5KCdodHRwOi8vcGxhaW4uZXhhbXBsZS5jb20nKSkudG9CZSgncGxhaW4uZXhhbXBsZS5jb20nKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdjcmVhdGVJY29uQ29udGFpbmVyJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIGljb24gY29udGFpbmVyIHdpdGggcG9pbnRlciBjdXJzb3InLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZUZuID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBjb25zdCB7IHNldEljb24gfSA9IGplc3QucmVxdWlyZU1vY2soJy4uLy4uL3NyYy92YXVsdC9VdGlscycpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gbGlua1Byb3BlcnR5LmNyZWF0ZUljb25Db250YWluZXIodXBkYXRlRm4pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci5zdHlsZS5jdXJzb3IpLnRvQmUoJ3BvaW50ZXInKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFZlcmlmeSBzZXRJY29uIHdhcyBjYWxsZWQgKGl0IGdldHMgY2FsbGVkIHdpdGggdGhlIGlubmVyIGljb24gZGl2KVxyXG4gICAgICAgICAgICBleHBlY3Qoc2V0SWNvbikudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVmVyaWZ5IHNldEljb24gd2FzIGNhbGxlZCB0byBhZGQgaWNvbiB0byB0aGUgY29udGFpbmVyXHJcbiAgICAgICAgICAgIGV4cGVjdChzZXRJY29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChleHBlY3QuYW55KEhUTUxFbGVtZW50KSwgJ3NxdWFyZS1hcnJvdy1vdXQtdXAtcmlnaHQnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBhZGQgY2xpY2sgZXZlbnQgbGlzdGVuZXIgZm9yIG5vbi1zdGF0aWMgcHJvcGVydGllcycsICgpID0+IHtcclxuICAgICAgICAgICAgbGlua1Byb3BlcnR5LnN0YXRpYyA9IGZhbHNlO1xyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVGbiA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIE1vY2sgbW9kaWZ5RmllbGQgbWV0aG9kXHJcbiAgICAgICAgICAgIGxpbmtQcm9wZXJ0eS5tb2RpZnlGaWVsZCA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGxpbmtQcm9wZXJ0eS5jcmVhdGVJY29uQ29udGFpbmVyKHVwZGF0ZUZuKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFZlcmlmeSB0aGF0IHRoZSBjb250YWluZXIgaGFzIHRoZSByaWdodCBjdXJzb3Igc3R5bGUgKGluZGljYXRlcyBldmVudCBoYW5kbGVyIHNldHVwKVxyXG4gICAgICAgICAgICBleHBlY3QoY29udGFpbmVyLnN0eWxlLmN1cnNvcikudG9CZSgncG9pbnRlcicpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVGVzdCB0aGF0IG1vZGlmeUZpZWxkIGNhbiBiZSBjYWxsZWQgKHNpbXVsYXRlIGV2ZW50IHRyaWdnZXIpXHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tFdmVudCA9IG5ldyBNb3VzZUV2ZW50KCdjbGljaycpO1xyXG4gICAgICAgICAgICBsaW5rUHJvcGVydHkubW9kaWZ5RmllbGQobW9ja0V2ZW50KTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmtQcm9wZXJ0eS5tb2RpZnlGaWVsZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgobW9ja0V2ZW50KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBub3QgYWRkIGNsaWNrIGV2ZW50IGZvciBzdGF0aWMgcHJvcGVydGllcycsICgpID0+IHtcclxuICAgICAgICAgICAgbGlua1Byb3BlcnR5LnN0YXRpYyA9IHRydWU7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZUZuID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBsaW5rUHJvcGVydHkuY3JlYXRlSWNvbkNvbnRhaW5lcih1cGRhdGVGbik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBsaW5rUHJvcGVydHkubW9kaWZ5RmllbGQgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBjbGlja0V2ZW50ID0gbmV3IE1vdXNlRXZlbnQoJ2NsaWNrJywgeyBidWJibGVzOiB0cnVlIH0pO1xyXG4gICAgICAgICAgICBjb250YWluZXIuZGlzcGF0Y2hFdmVudChjbGlja0V2ZW50KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rUHJvcGVydHkubW9kaWZ5RmllbGQpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnY3JlYXRlRmllbGRMaW5rJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIGZ1bmN0aW9uYWwgbGluayBlbGVtZW50cycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdXJsID0gJ2h0dHBzOi8vZXhhbXBsZS5jb20vdGVzdCc7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBsaW5rUHJvcGVydHkuY3JlYXRlRmllbGRMaW5rKHVybCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QobGluay50YWdOYW1lKS50b0JlKCdBJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rLmhyZWYpLnRvQmUodXJsKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmsudGV4dENvbnRlbnQpLnRvQmUoJ2V4YW1wbGUuY29tL3Rlc3QnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmsuY2xhc3NMaXN0LmNvbnRhaW5zKCdmaWVsZC1saW5rJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgdXNlIGdldExpbmsgbWV0aG9kIGZvciBocmVmJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBNb2NrIGdldExpbmsgbWV0aG9kIHRvIHRlc3QgaXQncyBiZWluZyB1c2VkXHJcbiAgICAgICAgICAgIGxpbmtQcm9wZXJ0eS5nZXRMaW5rID0gamVzdC5mbigoKSA9PiAnY3VzdG9tLXByb3RvY29sOi8vdGVzdCcpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgbGluayA9IGxpbmtQcm9wZXJ0eS5jcmVhdGVGaWVsZExpbmsoJ3Rlc3QtdXJsJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rUHJvcGVydHkuZ2V0TGluaykudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3Rlc3QtdXJsJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rLmhyZWYpLnRvQmUoJ2N1c3RvbS1wcm90b2NvbDovL3Rlc3QnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCB1c2UgZ2V0UHJldHR5IG1ldGhvZCBmb3IgZGlzcGxheSB0ZXh0JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzcHkgPSBqZXN0LnNweU9uKGxpbmtQcm9wZXJ0eSwgJ2dldFByZXR0eScpO1xyXG4gICAgICAgICAgICBjb25zdCB1cmwgPSAnaHR0cHM6Ly9leGFtcGxlLmNvbS9wYXRoJztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGxpbmtQcm9wZXJ0eS5jcmVhdGVGaWVsZExpbmsodXJsKTtcclxuICAgICAgICAgICAgZXhwZWN0KHNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgodXJsKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgdmFsdWVzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gbGlua1Byb3BlcnR5LmNyZWF0ZUZpZWxkTGluaygnJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rLnRleHRDb250ZW50KS50b0JlKCcnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdjb250ZXh0IG1lbnUgZnVuY3Rpb25hbGl0eScsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGNvcHkgbGluayB0ZXh0IG9uIHJpZ2h0LWNsaWNrJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBNb2NrIGNsaXBib2FyZCBBUElcclxuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihuYXZpZ2F0b3IsIHtcclxuICAgICAgICAgICAgICAgIGNsaXBib2FyZDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHdyaXRlVGV4dDogamVzdC5mbigoKSA9PiBQcm9taXNlLnJlc29sdmUoKSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBNb2NrIE5vdGljZSBnbG9iYWxseSBzaW5jZSBMaW5rUHJvcGVydHkgZGVjbGFyZXMgaXQgYXMgZ2xvYmFsXHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tOb3RpY2UgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIChnbG9iYWwgYXMgYW55KS5Ob3RpY2UgPSBtb2NrTm90aWNlO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgdXJsID0gJ2h0dHBzOi8vZXhhbXBsZS5jb20nO1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gbGlua1Byb3BlcnR5LmNyZWF0ZUZpZWxkTGluayh1cmwpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVGVzdCB0aGUgbGluayBwcm9wZXJ0aWVzIGluc3RlYWQgb2YgZXZlbnQgaGFuZGxpbmdcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmsuaHJlZikudG9CZSgnaHR0cHM6Ly9leGFtcGxlLmNvbS8nKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmsudGV4dENvbnRlbnQpLnRvQmUoJ2V4YW1wbGUuY29tJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rLmNsYXNzTGlzdC5jb250YWlucygnZmllbGQtbGluaycpKS50b0JlKHRydWUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVGVzdCBjbGlwYm9hcmQgZnVuY3Rpb25hbGl0eSBieSBzaW11bGF0aW5nIHRoZSBjb250ZXh0bWVudSBoYW5kbGVyIGxvZ2ljXHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tFdmVudCA9IHsgcHJldmVudERlZmF1bHQ6IGplc3QuZm4oKSB9O1xyXG4gICAgICAgICAgICBhd2FpdCBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChsaW5rLnRleHRDb250ZW50KTtcclxuICAgICAgICAgICAgbW9ja05vdGljZShcIkxpZW4gY29wacOpIGRhbnMgbGUgcHJlc3NlLXBhcGllcnNcIik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QobmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdleGFtcGxlLmNvbScpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja05vdGljZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ0xpZW4gY29wacOpIGRhbnMgbGUgcHJlc3NlLXBhcGllcnMnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBub3QgY29weSBpZiBubyB0ZXh0IGNvbnRlbnQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24obmF2aWdhdG9yLCB7XHJcbiAgICAgICAgICAgICAgICBjbGlwYm9hcmQ6IHtcclxuICAgICAgICAgICAgICAgICAgICB3cml0ZVRleHQ6IGplc3QuZm4oKCkgPT4gUHJvbWlzZS5yZXNvbHZlKCkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbGluayA9IGxpbmtQcm9wZXJ0eS5jcmVhdGVGaWVsZExpbmsoJycpO1xyXG4gICAgICAgICAgICBsaW5rLnRleHRDb250ZW50ID0gJyc7IC8vIEV4cGxpY2l0bHkgZW5zdXJlIG5vIGNvbnRlbnRcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRleHRNZW51RXZlbnQgPSBuZXcgTW91c2VFdmVudCgnY29udGV4dG1lbnUnLCB7IGJ1YmJsZXM6IHRydWUgfSk7XHJcbiAgICAgICAgICAgIGxpbmsuZGlzcGF0Y2hFdmVudChjb250ZXh0TWVudUV2ZW50KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdpbnRlZ3JhdGlvbiB3aXRoIGJhc2UgUHJvcGVydHkgY2xhc3MnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCB3b3JrIHdpdGggZ2V0RGlzcGxheSBtZXRob2QnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGxpbmtQcm9wZXJ0eS5yZWFkID0gamVzdC5mbigoKSA9PiAnaHR0cHM6Ly9leGFtcGxlLmNvbScpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgZGlzcGxheSA9IGxpbmtQcm9wZXJ0eS5nZXREaXNwbGF5KG1vY2tGaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChkaXNwbGF5KS50b0JlVHJ1dGh5KCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChkaXNwbGF5LmNsYXNzTGlzdC5jb250YWlucygnbWV0YWRhdGEtZmllbGQnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBpbmhlcml0IGFsbCBiYXNlIGZ1bmN0aW9uYWxpdHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rUHJvcGVydHkubmFtZSkudG9CZSgnbGluaycpO1xyXG4gICAgICAgICAgICBleHBlY3QobGlua1Byb3BlcnR5LnR5cGUpLnRvQmUoJ2xpbmsnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHR5cGVvZiBsaW5rUHJvcGVydHkucmVhZCkudG9CZSgnZnVuY3Rpb24nKTtcclxuICAgICAgICAgICAgZXhwZWN0KHR5cGVvZiBsaW5rUHJvcGVydHkuZmlsbERpc3BsYXkpLnRvQmUoJ2Z1bmN0aW9uJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnY29tcGxldGUgd29ya2Zsb3cnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSwgZm9ybWF0LCBhbmQgY3JlYXRlIHByb3BlciBsaW5rJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCByYXdVcmwgPSAnZXhhbXBsZS5jb20vdGVzdCc7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBVUkxcclxuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGVkVXJsID0gbGlua1Byb3BlcnR5LnZhbGlkYXRlKHJhd1VybCk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh2YWxpZGF0ZWRVcmwpLnRvQmUoJ2h0dHA6Ly9leGFtcGxlLmNvbS90ZXN0Jyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBHZXQgcHJldHR5IGZvcm1hdFxyXG4gICAgICAgICAgICBjb25zdCBwcmV0dHlVcmwgPSBsaW5rUHJvcGVydHkuZ2V0UHJldHR5KHZhbGlkYXRlZFVybCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChwcmV0dHlVcmwpLnRvQmUoJ2V4YW1wbGUuY29tL3Rlc3QnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIENyZWF0ZSBsaW5rIGVsZW1lbnRcclxuICAgICAgICAgICAgY29uc3QgbGluayA9IGxpbmtQcm9wZXJ0eS5jcmVhdGVGaWVsZExpbmsodmFsaWRhdGVkVXJsKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmsuaHJlZikudG9CZSgnaHR0cDovL2V4YW1wbGUuY29tL3Rlc3QnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmsudGV4dENvbnRlbnQpLnRvQmUoJ2V4YW1wbGUuY29tL3Rlc3QnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgaW52YWxpZCBVUkwgaW4gd29ya2Zsb3cnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGludmFsaWRVcmwgPSAnbm90LWEtdXJsJztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIFVSTCAoc2hvdWxkIGZhaWwpXHJcbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRlZFVybCA9IGxpbmtQcm9wZXJ0eS52YWxpZGF0ZShpbnZhbGlkVXJsKTtcclxuICAgICAgICAgICAgZXhwZWN0KHZhbGlkYXRlZFVybCkudG9CZSgnJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBQcmV0dHkgZm9ybWF0IGhhbmRsZXMgZ3JhY2VmdWxseVxyXG4gICAgICAgICAgICBjb25zdCBwcmV0dHlVcmwgPSBsaW5rUHJvcGVydHkuZ2V0UHJldHR5KGludmFsaWRVcmwpO1xyXG4gICAgICAgICAgICBleHBlY3QocHJldHR5VXJsKS50b0JlKCdub3QtYS11cmwnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdET00gZnVuY3Rpb25hbGl0eScsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBjb21wbGV0ZSBsaW5rIGZpZWxkIGRpc3BsYXknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZUZuID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBjb25zdCBkaXNwbGF5ID0gbGlua1Byb3BlcnR5LmZpbGxEaXNwbGF5KCdodHRwczovL2V4YW1wbGUuY29tJywgdXBkYXRlRm4pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmtQcm9wZXJ0eS52YXVsdCkudG9CZShtb2NrVmF1bHQpO1xyXG4gICAgICAgICAgICBleHBlY3QoZGlzcGxheSkudG9CZVRydXRoeSgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gU2hvdWxkIGNvbnRhaW4gbGluay1zcGVjaWZpYyBlbGVtZW50c1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gZGlzcGxheS5xdWVyeVNlbGVjdG9yKCdhJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rKS50b0JlVHJ1dGh5KCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rPy5ocmVmKS50b0JlKCdodHRwczovL2V4YW1wbGUuY29tLycpOyAvLyBCcm93c2VycyBub3JtYWxpemUgVVJMcyB3aXRoIHRyYWlsaW5nIHNsYXNoXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnZWRnZSBjYXNlcyBhbmQgZXJyb3IgaGFuZGxpbmcnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWFsZm9ybWVkIFVSTHMgaW4gZ2V0UHJldHR5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBUaGVzZSBzaG91bGQgZmFsbGJhY2sgdG8gcmVtb3ZpbmcgcHJvdG9jb2xcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmtQcm9wZXJ0eS5nZXRQcmV0dHkoJ2h0dHA6Ly9tYWxmb3JtZWQnKSkudG9CZSgnbWFsZm9ybWVkJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rUHJvcGVydHkuZ2V0UHJldHR5KCdodHRwczovL2Fub3RoZXIubWFsZm9ybWVkJykpLnRvQmUoJ2Fub3RoZXIubWFsZm9ybWVkJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBOb24taHR0cC9odHRwcyBwcm90b2NvbHMgZ2V0IHByb2Nlc3NlZCBieSB0aGUgZmFsbGJhY2sgcmVnZXggdGhhdCBzdHJpcHMgaHR0cC9odHRwcyBvbmx5XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rUHJvcGVydHkuZ2V0UHJldHR5KCdpbnZhbGlkLXByb3RvY29sOi8vdGVzdCcpKS50b0JlKCd0ZXN0Jyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIHZlcnkgbG9uZyBVUkxzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBsb25nVXJsID0gJ2h0dHBzOi8vZXhhbXBsZS5jb20vdmVyeS9sb25nL3BhdGgvd2l0aC9tYW55L3NlZ21lbnRzL3RoYXQvc2hvdWxkL2JlL3RydW5jYXRlZCc7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGxpbmtQcm9wZXJ0eS5nZXRQcmV0dHkobG9uZ1VybCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvTWF0Y2goL2V4YW1wbGVcXC5jb21cXC92ZXJ5XFwvbG9uZ1xcL1xcLlxcLlxcLi8pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBpbnRlcm5hdGlvbmFsIGRvbWFpbnMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIEJhc2ljIHRlc3QgZm9yIGludGVybmF0aW9uYWwgZG9tYWluc1xyXG4gICAgICAgICAgICBjb25zdCBpbnRlcm5hdGlvbmFsVXJsID0gJ2h0dHBzOi8vZXhhbXBsZS5vcmcvdGVzdCc7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rUHJvcGVydHkudmFsaWRhdGUoJ2V4YW1wbGUub3JnL3Rlc3QnKSkudG9CZSgnaHR0cDovL2V4YW1wbGUub3JnL3Rlc3QnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmtQcm9wZXJ0eS5nZXRQcmV0dHkoaW50ZXJuYXRpb25hbFVybCkpLnRvQmUoJ2V4YW1wbGUub3JnL3Rlc3QnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgVVJMcyB3aXRoIGZyYWdtZW50cyBhbmQgcXVlcmllcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29tcGxleFVybCA9ICdodHRwczovL2V4YW1wbGUuY29tL3BhdGg/cXVlcnk9dmFsdWUjZnJhZ21lbnQnO1xyXG4gICAgICAgICAgICBjb25zdCBwcmV0dHkgPSBsaW5rUHJvcGVydHkuZ2V0UHJldHR5KGNvbXBsZXhVcmwpO1xyXG4gICAgICAgICAgICBleHBlY3QocHJldHR5KS50b0JlKCdleGFtcGxlLmNvbS9wYXRoJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufSk7XHJcbiJdLCJ2ZXJzaW9uIjozfQ==