{"file":"C:\\Users\\leodu\\Documents\\1 - Pro\\Test plugin obsidian\\.obsidian\\plugins\\obsidian-CRM\\dynamic-fields\\src\\properties\\ObjectProperty.ts","mappings":"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","names":[],"sources":["C:\\Users\\leodu\\Documents\\1 - Pro\\Test plugin obsidian\\.obsidian\\plugins\\obsidian-CRM\\dynamic-fields\\src\\properties\\ObjectProperty.ts"],"sourcesContent":["\r\nimport { Property } from \"./Property\";\r\nimport { File } from \"../vault/File\";\r\nimport { FileProperty } from \"./FileProperty\";\r\nimport { TextProperty } from \"./TextProperty\";\r\nimport { MultiFileProperty } from \"./MultiFileProperty\";\r\nimport { Vault } from \"../vault/Vault\";\r\n\r\nexport class ObjectProperty extends Property{\r\n    // Used for property object\r\n\r\n    public properties : {[key : string] : Property};\r\n    public override type : string = \"object\";\r\n    public override flexSpan = 2;\r\n    public appendFirst : boolean = false;\r\n    public allowMove : boolean = true;\r\n    public display : string = \"object\"; // Can be \"object\", \"table\" or \"list\"\r\n\r\n    constructor(name: string, vault: Vault, properties: { [key: string]: Property }, args: { allowMove?: boolean, appendFirst?: boolean, [key: string]: any} = {}) {\r\n        super(name, vault, args);\r\n        this.appendFirst = args?.appendFirst || false;\r\n        this.properties = properties;\r\n        this.allowMove = args?.allowMove || true;\r\n\r\n        // Assign any additional arguments to the instance\r\n        Object.assign(this, args);\r\n    }\r\n\r\n    getClasses(): string[]{\r\n        for (let prop of Object.values(this.properties)){\r\n            if (prop instanceof FileProperty || prop instanceof ObjectProperty || prop.type == \"multiFile\"){\r\n                return (prop as any).getClasses()\r\n            }\r\n        }\r\n        throw new Error(\"No class found\")\r\n      }\r\n\r\n    // Used by the ClasseProperty to get the parent file\r\n    getParentValue(values : any) : File | undefined{\r\n        if (values && values.length){\r\n          for (let prop of Object.values(this.properties)){\r\n            if (prop instanceof FileProperty || prop instanceof ObjectProperty || prop.type == \"multiFile\"){\r\n              return (prop as any).getParentValue(values[0][prop.name])\r\n            }\r\n          }\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    async findValue(file: any, value: string, propertyName: string): Promise <any> {\r\n        let values = await this.read(file);\r\n        if (values && values.length){\r\n            for (let i = 0; i < values.length; i++) {\r\n                for (let prop of Object.values(this.properties)){\r\n                    let propValue = values[i][prop.name];\r\n                    if (propValue && (propValue == value || (typeof propValue === \"string\" && propValue.includes(value)))) {\r\n                        return values[i][propertyName]\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n\r\n    async getDisplayProperties(file: File, propertyClasseName : string, propertyName : string, isStatic: boolean = true): Promise<{classe : any , display : any}[]> {\r\n        let properties: {classe : any , display : any}[] = [];\r\n        this.vault = file.vault;\r\n        let values = await this.read(file);\r\n        if (!(propertyName in this.properties)){\r\n            throw new Error(\"Property \" + propertyName + \" not found in ObjectProperty \" + this.name);\r\n        }\r\n        let property = this.properties[propertyName];\r\n\r\n        if (values && values.length){\r\n            for (let [index, row] of values.entries()) {\r\n                property.static = isStatic;\r\n                let display = property.fillDisplay(row[property.name],\r\n                    async (value : any ) => await this.updateObject(values, async (value) => await file.updateMetadata(this.name, value), index, property, value));\r\n                \r\n                let classe = this.vault.getFromLink(row[this.properties[propertyClasseName].name])\r\n                properties.push({classe: classe, display : display});\r\n            }\r\n        }\r\n        return properties;\r\n    }\r\n\r\n    formatParentValue(value : string){\r\n        let newObject: any = {};\r\n        Object.values(this.properties).forEach(prop => {\r\n            if (value && prop instanceof FileProperty || prop instanceof ObjectProperty || prop.type == \"multiFile\"){\r\n                newObject[prop.name] = value\r\n                value = \"\" // Only one parent\r\n            }\r\n            else {\r\n                newObject[prop.name] = \"\"\r\n            }\r\n        });\r\n        return [newObject]\r\n    }\r\n\r\n    override getDisplay(file: any, args?: { staticMode?: boolean; title?: string; display? : string}): HTMLDivElement {\r\n        this.display = args?.display || this.display;\r\n        return super.getDisplay(file, args);\r\n    }\r\n\r\n     // Méthode principale pour obtenir l'affichage\r\n     override fillDisplay(values: any, update: (value: any) => Promise<void>) {\r\n        const container = document.createElement(\"div\");\r\n        container.classList.add(\"metadata-object-container-\"+this.name.toLowerCase());\r\n\r\n        // Créer l'en-tête\r\n        this.createHeader(values, update, container);\r\n\r\n        if (this.display == \"table\") {\r\n            this.createTable(values, update, container);\r\n        }\r\n        else {\r\n            // Affichage par défaut (objet)\r\n            this.createObjects(values, update, container);\r\n        }\r\n        // Créer les lignes d'objet\r\n        \r\n\r\n        return container;\r\n      }\r\n    createTable(values: any, update: (value: any) => Promise<void>, container: HTMLDivElement) {\r\n        // Créer un tableau pour les objets\r\n        const tableWrapper = document.createElement(\"div\");\r\n        tableWrapper.style.position = \"relative\";\r\n        container.appendChild(tableWrapper);\r\n\r\n        let addButton = this.createAddButton(values, update, container)\r\n        addButton.style.position = \"absolute\";\r\n        addButton.style.top = \"0\";\r\n        addButton.style.right = \"0\";\r\n        tableWrapper.appendChild(addButton);\r\n\r\n\r\n        const table = document.createElement(\"table\");\r\n        table.classList.add(\"metadata-object-table\");\r\n        tableWrapper.appendChild(table);\r\n\r\n\r\n        // Créer l'en-tête du tableau\r\n        const headerRow = document.createElement(\"tr\");\r\n        Object.values(this.properties).forEach(property => {\r\n            const th = document.createElement(\"th\");\r\n            th.textContent = property.name;\r\n            headerRow.appendChild(th);\r\n        });\r\n        // Ajouter une colonne pour le bouton de suppression\r\n        const thDelete = document.createElement(\"th\");\r\n        headerRow.appendChild(thDelete);\r\n\r\n        table.appendChild(headerRow);\r\n\r\n        if (values && values.length) {\r\n            // Créer les lignes d'objet\r\n            values.forEach((objects: any, index: number) => {\r\n                const row = document.createElement(\"tr\");\r\n                Object.values(this.properties).forEach(property => {\r\n                    const td = document.createElement(\"td\");\r\n                    td.appendChild(property.fillDisplay(objects[property.name],\r\n                        async (value : any) => await this.updateObject(values, update, index, property, value)));\r\n                    row.appendChild(td);\r\n                });\r\n\r\n                // Cellule pour le bouton de suppression\r\n                const tdDelete = document.createElement(\"td\");\r\n                tdDelete.classList.add(\"metadata-object-delete-cell\");\r\n                const deleteButton = this.createDeleteButton(values, update, index, container);\r\n                deleteButton.classList.add(\"metadata-object-delete-button\");\r\n                tdDelete.appendChild(deleteButton);\r\n\r\n                row.appendChild(tdDelete);\r\n                table.appendChild(row);\r\n            });\r\n        }\r\n    }\r\n  \r\n      // Crée l'en-tête avec les propriétés\r\n      createHeader(values : any, update : (value: any) => Promise<void>, container: HTMLDivElement) {\r\n          const headerRow = document.createElement(\"div\");\r\n          headerRow.classList.add(\"metadata-object-header-row\");\r\n\r\n          let title = document.createElement(\"div\");\r\n          title.textContent = this.title ? this.title : this.name + \" : \";\r\n          title.classList.add(\"metadata-header\");\r\n          headerRow.appendChild(title);\r\n  \r\n          // Ajouter le bouton d'ajout\r\n          const addButton = this.createAddButton(values, update, container);\r\n          headerRow.appendChild(addButton);\r\n  \r\n          container.appendChild(headerRow);\r\n      }\r\n  \r\n      // Crée le bouton d'ajout d'un nouvel objet\r\n      createAddButton(values : any, update : (value: any) => Promise<void>, container: HTMLDivElement): HTMLButtonElement {\r\n          const addButton = document.createElement(\"button\");\r\n          this.vault.app.setIcon(addButton, \"circle-plus\")\r\n          addButton.classList.add(\"metadata-add-button\");\r\n          addButton.onclick = async () => await this.addProperty(values, update, container);\r\n          return addButton;\r\n      }\r\n  \r\n      // Crée les objets et les lignes à afficher\r\n      createObjects(values: any, update : (value: any) => Promise<void>,  container: HTMLDivElement) {\r\n          if (!values){return}\r\n          values.forEach((objects: any, index: number) => {\r\n              const row = this.createObjectRow(values, update, objects, index, container);\r\n              container.appendChild(row);\r\n          });\r\n          if (this.allowMove){\r\n              this.enableDragAndDrop(values, update, container);\r\n          }\r\n         \r\n      }\r\n  \r\n      // Crée une ligne d'objet avec ses propriétés\r\n    createObjectRow(values : any, update : (value: any) => Promise<void>, objects: any, index: number, container: HTMLDivElement): HTMLDivElement {\r\n        const row = document.createElement(\"div\");\r\n        row.classList.add(\"metadata-object-row\");\r\n\r\n        if (this.allowMove){\r\n            row.draggable = true;\r\n            row.dataset.index = index.toString();\r\n            row.style.cursor = \"grab\";\r\n        }\r\n        // Ajouter le bouton de suppression\r\n        const deleteButton = this.createDeleteButton(values, update, index, container);\r\n        deleteButton.style.position = \"absolute\";\r\n        deleteButton.style.top = \"0\";\r\n        deleteButton.style.right = \"0\";\r\n        row.style.position = \"relative\";\r\n        row.appendChild(deleteButton);\r\n\r\n        Object.values(this.properties).forEach(property => {\r\n            let value = objects[property.name]\r\n            let propertyContainer = document.createElement(\"div\");\r\n            propertyContainer.classList.add(\"metadata-object-property\");\r\n\r\n            if (property.flexSpan){\r\n                propertyContainer.style.gridColumn = \"span \"+property.flexSpan;\r\n            }\r\n\r\n            const title = document.createElement(\"div\");\r\n            title.textContent = property.name;\r\n            title.classList.add(\"metadata-title\");\r\n            propertyContainer.appendChild(title);\r\n            propertyContainer.appendChild(property.fillDisplay(value,\r\n                async (value: any) => await this.updateObject(values, update, index, property, value)));\r\n            row.appendChild(propertyContainer);\r\n\r\n        });\r\n\r\n        return row;\r\n      }\r\n  \r\n      // Crée un bouton de suppression pour une ligne d'objet\r\n      createDeleteButton(values : any, update : (value: any) => Promise<void>, index: number, container: HTMLDivElement): HTMLButtonElement {\r\n          const deleteButton = document.createElement(\"button\");\r\n          this.vault.app.setIcon(deleteButton, \"circle-minus\");\r\n          deleteButton.classList.add(\"metadata-delete-button\");\r\n          deleteButton.onclick = async () => await this.removeProperty(values, update, index, container);\r\n          return deleteButton;\r\n      }\r\n  \r\n      // Gère le glisser-déposer pour réordonner les objets\r\n      enableDragAndDrop(values : any, update : (value: any) => Promise<void>, container: HTMLDivElement) {\r\n          let draggedElement: HTMLElement | null = null;\r\n\r\n          let isEditing = false;\r\n\r\n          // Lorsque l'utilisateur clique dans un champ d'édition (input), on active l'édition\r\n          document.addEventListener(\"focus\", (event) => {\r\n              const input = event.target as HTMLElement;\r\n              if (input?.classList.contains('field-input')) {\r\n                  isEditing = true;  // Le champ est en mode édition\r\n              }\r\n          }, true);\r\n\r\n          // Lorsque l'utilisateur quitte un champ d'édition (blur), on désactive l'édition\r\n          document.addEventListener(\"blur\", (event) => {\r\n              const input = event.target as HTMLElement;\r\n              if (input?.classList.contains('field-input')) {\r\n                  isEditing = false;  // Le champ n'est plus en mode édition\r\n              }\r\n          }, true);\r\n\r\n          container.addEventListener(\"dragstart\", (event) => {\r\n            if (isEditing) {\r\n              event.preventDefault();\r\n              return;\r\n            }\r\n            draggedElement = event.target as HTMLElement;\r\n            draggedElement.classList.add(\"dragging\");\r\n          });\r\n  \r\n          container.addEventListener(\"dragover\", (event) => {\r\n              event.preventDefault();\r\n              const afterElement = this.getDragAfterElement(container, event.clientY);\r\n              if (afterElement == null) {\r\n                  container.appendChild(draggedElement!);\r\n              } else {\r\n                container.insertBefore(draggedElement!, afterElement);\r\n              }\r\n          });\r\n  \r\n          container.addEventListener(\"dragend\", async () => {\r\n              if (!draggedElement) return;\r\n              draggedElement.classList.remove(\"dragging\");\r\n  \r\n              // Récupérer le nouvel ordre des éléments\r\n              await this.updateOrder(values, update, container);\r\n          });\r\n      }\r\n  \r\n      // Trouver l'élément après lequel insérer (pour le Drag & Drop)\r\n      getDragAfterElement(container: HTMLDivElement, y: number): Element | null {\r\n          const draggableElements = Array.from(container.querySelectorAll(\".metadata-object-row:not(.dragging)\"));\r\n  \r\n          const result = draggableElements.reduce((closest: { offset: number; element: Element | null }, child) => {\r\n              const box = child.getBoundingClientRect();\r\n              const offset = y - box.top - box.height / 2;\r\n              return offset < 0 && offset > closest.offset ? { offset, element: child } : closest;\r\n          }, { offset: Number.NEGATIVE_INFINITY, element: null as Element | null });\r\n          \r\n          return result.element;\r\n      }\r\n  \r\n      // Met à jour l'ordre des éléments après un glisser-déposer\r\n      async updateOrder(values : any, update : (value: any) => Promise<void>, container: HTMLDivElement) {\r\n        console.log(\"Update order\")\r\n          let newOrder: any[] = [];\r\n          Array.from(container.querySelectorAll(\".metadata-object-row\")).forEach((row) => {\r\n              // Assurer qu'on travaille avec un HTMLElement pour accéder à dataset\r\n              if (row instanceof HTMLElement && row.dataset.index) {\r\n                  let index = parseInt(row.dataset.index);\r\n                  newOrder.push(values[index]);\r\n              }\r\n          });\r\n          // Mettre à jour les métadonnées\r\n          await update(newOrder);\r\n          await this.reloadObjects(newOrder, update)\r\n      }\r\n  \r\n      // Fonction pour supprimer un objet\r\n      async removeProperty(values : any, update : (value: any) => Promise<void>, index: number, container: HTMLDivElement) {\r\n          console.log(\"Remove index : \", index)\r\n          values.splice(index, 1);\r\n          await update(values);\r\n          await this.reloadObjects(values, update)\r\n      }\r\n  \r\n      // Fonction pour ajouter un objet\r\n      async addProperty(values : any, update : (value: any) => Promise<void>, container: HTMLDivElement) {\r\n          console.log(\"Add new\")\r\n          let newObject: any = {};\r\n          for (let prop of Object.values(this.properties)) {\r\n            let defaultValue = prop.getDefaultValue()\r\n            console.log(\"Default value : \", defaultValue)\r\n            if (Object.values(this.properties)[0] == prop && (prop instanceof FileProperty)) {\r\n                prop.vault = this.vault; // Assurez-vous que vault est défini pour le premier FileProperty\r\n                const fileProp = prop as any; // Cast pour accéder à handleIconClick\r\n                defaultValue = await new Promise(async (resolve) => {\r\n                    await fileProp.handleIconClick(async (value: any) => {\r\n                        resolve(value);\r\n                        console.log(\"Default value after click : \", value);\r\n                    }, new MouseEvent(\"click\"));\r\n                });\r\n            }\r\n            console.log(\"Default value after click : \", defaultValue);\r\n\r\n            if (defaultValue == \"like-precedent\"){\r\n                if (values && values.length){\r\n                    if (this.appendFirst){\r\n                        defaultValue = values[0][prop.name]\r\n                    }\r\n                    else {\r\n                        defaultValue = values[values.length-1][prop.name]\r\n                    }\r\n                }\r\n                else {defaultValue = \"\"}\r\n            }\r\n            newObject[prop.name] = defaultValue\r\n        \r\n        }; \r\n        // Valeurs par défaut\r\n        if (!values){values = []}\r\n        if (this.appendFirst) {\r\n            values.unshift(newObject);\r\n        } else {\r\n            values.push(newObject);\r\n        }\r\n          await update(values);\r\n          await this.reloadObjects(values, update)\r\n      }\r\n  \r\n      // Mise à jour des métadonnées\r\n      async updateObject(values : any, update : (value: any) => Promise<void>, index: number, property: Property, value: string) {\r\n        console.log(\"Update index : \", index)\r\n          if (values){\r\n            values[index][property.name] = value;\r\n          }\r\n          else {\r\n            values = [{[property.name] : value}]\r\n          }\r\n          console.log(\"Updated Values : \", values)\r\n          await update(values);\r\n          await this.reloadObjects(values, update)\r\n      }\r\n\r\n    // Recharge dynamiquement les objets\r\n    async reloadObjects(values : any, update : (value: any) => Promise<void>,) {\r\n        const container = document.querySelector(\".metadata-object-container-\"+this.name.toLowerCase()) as HTMLDivElement;\r\n        if (container) {\r\n            container.innerHTML = \"\";\r\n            // Recréer l'en-tête et les objets\r\n            console.log(\"Values : \", values)\r\n            this.createHeader(values, update, container);\r\n            if (this.display == \"table\") {\r\n                this.createTable(values, update, container);\r\n            }\r\n            else {\r\n                // Affichage par défaut (objet)\r\n                this.createObjects(values, update, container);\r\n            }\r\n        }\r\n        \r\n    }\r\n  }\r\n  "],"version":3}