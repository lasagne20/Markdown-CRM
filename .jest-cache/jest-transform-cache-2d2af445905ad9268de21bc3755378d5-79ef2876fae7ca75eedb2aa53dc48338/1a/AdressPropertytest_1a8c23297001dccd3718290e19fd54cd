bcb2e3dc154505e717f8334e9ce475a2
"use strict";
/**
 * @jest-environment jsdom
 */
Object.defineProperty(exports, "__esModule", { value: true });
jest.mock('../../src/vault/Utils', () => ({
    setIcon: jest.fn()
}));
const AdressProperty_1 = require("../../src/properties/AdressProperty");
const LinkProperty_1 = require("../../src/properties/LinkProperty");
describe('AdressProperty', () => {
    let adressProperty;
    beforeEach(() => {
        // Reset DOM mocks
        document.body.innerHTML = '';
        jest.clearAllMocks();
    });
    beforeEach(() => {
        adressProperty = new AdressProperty_1.AdressProperty('testAdress', mockVault, mockVault);
    });
    describe('constructor', () => {
        it('should create AdressProperty with correct type', () => {
            expect(adressProperty.type).toBe('adress');
        });
        it('should inherit from LinkProperty', () => {
            expect(adressProperty).toBeInstanceOf(LinkProperty_1.LinkProperty);
        });
        it('should use default icon when no args provided', () => {
            const defaultProperty = new AdressProperty_1.AdressProperty('defaultTest', mockVault, mockVault);
            expect(defaultProperty.name).toBe('defaultTest');
            expect(defaultProperty.type).toBe('adress');
        });
        it('should pass custom args to parent constructor', () => {
            const customArgs = { icon: 'custom-icon', flexSpan: 3 };
            const customProperty = new AdressProperty_1.AdressProperty('customName', mockVault, customArgs);
            expect(customProperty.name).toBe('customName');
        });
    });
    describe('validate', () => {
        it('should return input value unchanged', () => {
            const testAddress = '123 Main St, Paris, France';
            expect(adressProperty.validate(testAddress)).toBe(testAddress);
        });
        it('should handle empty string', () => {
            expect(adressProperty.validate('')).toBe('');
        });
        it('should handle special characters in address', () => {
            const specialAddress = 'Rue de l\'Église, 75001 Paris';
            expect(adressProperty.validate(specialAddress)).toBe(specialAddress);
        });
        it('should handle unicode characters', () => {
            const unicodeAddress = '北京市朝阳区';
            expect(adressProperty.validate(unicodeAddress)).toBe(unicodeAddress);
        });
        it('should handle multiline addresses', () => {
            const multilineAddress = '123 Main St\\nApt 4B\\nParis, France';
            expect(adressProperty.validate(multilineAddress)).toBe(multilineAddress);
        });
    });
    describe('getLink', () => {
        it('should generate Google Maps search URL for simple address', () => {
            const address = '123 Main St, Paris';
            const expectedUrl = 'https://www.google.com/maps/search/123%20Main%20St%2C%20Paris';
            expect(adressProperty.getLink(address)).toBe(expectedUrl);
        });
        it('should properly encode special characters', () => {
            const address = 'Rue de l\'Église & Café';
            const expectedUrl = 'https://www.google.com/maps/search/Rue%20de%20l\'%C3%89glise%20%26%20Caf%C3%A9';
            expect(adressProperty.getLink(address)).toBe(expectedUrl);
        });
        it('should handle empty address', () => {
            const address = '';
            const expectedUrl = 'https://www.google.com/maps/search/';
            expect(adressProperty.getLink(address)).toBe(expectedUrl);
        });
        it('should encode spaces correctly', () => {
            const address = 'New York City';
            const expectedUrl = 'https://www.google.com/maps/search/New%20York%20City';
            expect(adressProperty.getLink(address)).toBe(expectedUrl);
        });
        it('should handle complex international address', () => {
            const address = '東京都渋谷区, Japan';
            const result = adressProperty.getLink(address);
            expect(result).toContain('https://www.google.com/maps/search/');
            expect(result).toContain('%E6%9D%B1%E4%BA%AC%E9%83%BD'); // Encoded Tokyo characters
        });
        it('should handle address with numbers and symbols', () => {
            const address = '123-45 Main St #456';
            const result = adressProperty.getLink(address);
            expect(result).toContain('https://www.google.com/maps/search/');
            expect(result).toContain('123-45%20Main%20St%20%23456');
        });
        it('should handle very long address', () => {
            const longAddress = 'Very Long Street Name With Many Words And Details Including Building Number 12345 Apartment Complex Building A Unit 456 City State Postal Code Country';
            const result = adressProperty.getLink(longAddress);
            expect(result).toContain('https://www.google.com/maps/search/');
            expect(result.length).toBeGreaterThan(50); // Should be encoded and long
        });
    });
    describe('inheritance from LinkProperty', () => {
        it('should have fillDisplay method from parent', () => {
            expect(typeof adressProperty.fillDisplay).toBe('function');
        });
        it('should have validate method from parent', () => {
            expect(typeof adressProperty.validate).toBe('function');
        });
        it('should have getLink method', () => {
            expect(typeof adressProperty.getLink).toBe('function');
        });
        it('should have createFieldLink method from parent', () => {
            expect(typeof adressProperty.createFieldLink).toBe('function');
        });
        it('should have getPretty method from parent', () => {
            expect(typeof adressProperty.getPretty).toBe('function');
        });
        it('should have name property from parent', () => {
            expect(adressProperty.name).toBe('testAdress');
        });
    });
    describe('link functionality integration', () => {
        it('should create clickable link with Google Maps URL', () => {
            const mockFile = {};
            const mockUpdate = jest.fn();
            const address = 'Paris, France';
            const result = adressProperty.fillDisplay(null, address, mockUpdate, mockFile);
            expect(result).toBeTruthy();
            expect(result.tagName).toBe('DIV');
        });
        it('should handle null value in fillDisplay', () => {
            const mockFile = {};
            const mockUpdate = jest.fn();
            const result = adressProperty.fillDisplay(null, null, mockUpdate, mockFile);
            expect(result).toBeTruthy();
            expect(result.tagName).toBe('DIV');
        });
        it('should handle undefined value in fillDisplay', () => {
            const mockFile = {};
            const mockUpdate = jest.fn();
            const result = adressProperty.fillDisplay(null, undefined, mockUpdate, mockFile);
            expect(result).toBeTruthy();
            expect(result.tagName).toBe('DIV');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxfX3Rlc3RzX19cXFByb3BlcnRpZXNcXEFkcmVzc1Byb3BlcnR5LnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOztHQUVHOztBQUtILElBQUksQ0FBQyxJQUFJLENBQUMsdUJBQXVCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUN0QyxPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUNyQixDQUFDLENBQUMsQ0FBQztBQUxKLHdFQUFxRTtBQUNyRSxvRUFBaUU7QUFNakUsUUFBUSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRTtJQUM1QixJQUFJLGNBQThCLENBQUM7SUFFbkMsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNaLGtCQUFrQjtRQUNsQixRQUFRLENBQUMsSUFBSSxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUM7UUFDN0IsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBQ3pCLENBQUMsQ0FBQyxDQUFDO0lBRUgsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNaLGNBQWMsR0FBRyxJQUFJLCtCQUFjLENBQUMsWUFBWSxFQUFFLFNBQVMsRUFBRSxTQUFTLENBQUMsQ0FBQztJQUM1RSxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxhQUFhLEVBQUUsR0FBRyxFQUFFO1FBQ3pCLEVBQUUsQ0FBQyxnREFBZ0QsRUFBRSxHQUFHLEVBQUU7WUFDdEQsTUFBTSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDL0MsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsa0NBQWtDLEVBQUUsR0FBRyxFQUFFO1lBQ3hDLE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxjQUFjLENBQUMsMkJBQVksQ0FBQyxDQUFDO1FBQ3hELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLCtDQUErQyxFQUFFLEdBQUcsRUFBRTtZQUNyRCxNQUFNLGVBQWUsR0FBRyxJQUFJLCtCQUFjLENBQUMsYUFBYSxFQUFFLFNBQVMsRUFBRSxTQUFTLENBQUMsQ0FBQztZQUNoRixNQUFNLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUNqRCxNQUFNLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNoRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywrQ0FBK0MsRUFBRSxHQUFHLEVBQUU7WUFDckQsTUFBTSxVQUFVLEdBQUcsRUFBRSxJQUFJLEVBQUUsYUFBYSxFQUFFLFFBQVEsRUFBRSxDQUFDLEVBQUUsQ0FBQztZQUN4RCxNQUFNLGNBQWMsR0FBRyxJQUFJLCtCQUFjLENBQUMsWUFBWSxFQUFFLFNBQVMsRUFBRSxVQUFVLENBQUMsQ0FBQztZQUMvRSxNQUFNLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUNuRCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLFVBQVUsRUFBRSxHQUFHLEVBQUU7UUFDdEIsRUFBRSxDQUFDLHFDQUFxQyxFQUFFLEdBQUcsRUFBRTtZQUMzQyxNQUFNLFdBQVcsR0FBRyw0QkFBNEIsQ0FBQztZQUNqRCxNQUFNLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUNuRSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw0QkFBNEIsRUFBRSxHQUFHLEVBQUU7WUFDbEMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDakQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNkNBQTZDLEVBQUUsR0FBRyxFQUFFO1lBQ25ELE1BQU0sY0FBYyxHQUFHLCtCQUErQixDQUFDO1lBQ3ZELE1BQU0sQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDO1FBQ3pFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGtDQUFrQyxFQUFFLEdBQUcsRUFBRTtZQUN4QyxNQUFNLGNBQWMsR0FBRyxRQUFRLENBQUM7WUFDaEMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDekUsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsbUNBQW1DLEVBQUUsR0FBRyxFQUFFO1lBQ3pDLE1BQU0sZ0JBQWdCLEdBQUcsc0NBQXNDLENBQUM7WUFDaEUsTUFBTSxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1FBQzdFLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsU0FBUyxFQUFFLEdBQUcsRUFBRTtRQUNyQixFQUFFLENBQUMsMkRBQTJELEVBQUUsR0FBRyxFQUFFO1lBQ2pFLE1BQU0sT0FBTyxHQUFHLG9CQUFvQixDQUFDO1lBQ3JDLE1BQU0sV0FBVyxHQUFHLCtEQUErRCxDQUFDO1lBQ3BGLE1BQU0sQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQzlELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDJDQUEyQyxFQUFFLEdBQUcsRUFBRTtZQUNqRCxNQUFNLE9BQU8sR0FBRyx5QkFBeUIsQ0FBQztZQUMxQyxNQUFNLFdBQVcsR0FBRyxnRkFBZ0YsQ0FBQztZQUNyRyxNQUFNLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUM5RCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw2QkFBNkIsRUFBRSxHQUFHLEVBQUU7WUFDbkMsTUFBTSxPQUFPLEdBQUcsRUFBRSxDQUFDO1lBQ25CLE1BQU0sV0FBVyxHQUFHLHFDQUFxQyxDQUFDO1lBQzFELE1BQU0sQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQzlELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGdDQUFnQyxFQUFFLEdBQUcsRUFBRTtZQUN0QyxNQUFNLE9BQU8sR0FBRyxlQUFlLENBQUM7WUFDaEMsTUFBTSxXQUFXLEdBQUcsc0RBQXNELENBQUM7WUFDM0UsTUFBTSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDOUQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNkNBQTZDLEVBQUUsR0FBRyxFQUFFO1lBQ25ELE1BQU0sT0FBTyxHQUFHLGVBQWUsQ0FBQztZQUNoQyxNQUFNLE1BQU0sR0FBRyxjQUFjLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQy9DLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMscUNBQXFDLENBQUMsQ0FBQztZQUNoRSxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsU0FBUyxDQUFDLDZCQUE2QixDQUFDLENBQUMsQ0FBQywyQkFBMkI7UUFDeEYsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsZ0RBQWdELEVBQUUsR0FBRyxFQUFFO1lBQ3RELE1BQU0sT0FBTyxHQUFHLHFCQUFxQixDQUFDO1lBQ3RDLE1BQU0sTUFBTSxHQUFHLGNBQWMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDL0MsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFNBQVMsQ0FBQyxxQ0FBcUMsQ0FBQyxDQUFDO1lBQ2hFLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsNkJBQTZCLENBQUMsQ0FBQztRQUM1RCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxpQ0FBaUMsRUFBRSxHQUFHLEVBQUU7WUFDdkMsTUFBTSxXQUFXLEdBQUcsd0pBQXdKLENBQUM7WUFDN0ssTUFBTSxNQUFNLEdBQUcsY0FBYyxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUNuRCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsU0FBUyxDQUFDLHFDQUFxQyxDQUFDLENBQUM7WUFDaEUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxlQUFlLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyw2QkFBNkI7UUFDNUUsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQywrQkFBK0IsRUFBRSxHQUFHLEVBQUU7UUFDM0MsRUFBRSxDQUFDLDRDQUE0QyxFQUFFLEdBQUcsRUFBRTtZQUNsRCxNQUFNLENBQUMsT0FBTyxjQUFjLENBQUMsV0FBVyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQy9ELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHlDQUF5QyxFQUFFLEdBQUcsRUFBRTtZQUMvQyxNQUFNLENBQUMsT0FBTyxjQUFjLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQzVELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDRCQUE0QixFQUFFLEdBQUcsRUFBRTtZQUNsQyxNQUFNLENBQUMsT0FBTyxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQzNELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGdEQUFnRCxFQUFFLEdBQUcsRUFBRTtZQUN0RCxNQUFNLENBQUMsT0FBTyxjQUFjLENBQUMsZUFBZSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ25FLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDBDQUEwQyxFQUFFLEdBQUcsRUFBRTtZQUNoRCxNQUFNLENBQUMsT0FBTyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQzdELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHVDQUF1QyxFQUFFLEdBQUcsRUFBRTtZQUM3QyxNQUFNLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUNuRCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGdDQUFnQyxFQUFFLEdBQUcsRUFBRTtRQUM1QyxFQUFFLENBQUMsbURBQW1ELEVBQUUsR0FBRyxFQUFFO1lBQ3pELE1BQU0sUUFBUSxHQUFHLEVBQUUsQ0FBQztZQUNwQixNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7WUFDN0IsTUFBTSxPQUFPLEdBQUcsZUFBZSxDQUFDO1lBRWhDLE1BQU0sTUFBTSxHQUFHLGNBQWMsQ0FBQyxXQUFXLENBQUMsSUFBSSxFQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFFL0UsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1lBQzVCLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3ZDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHlDQUF5QyxFQUFFLEdBQUcsRUFBRTtZQUMvQyxNQUFNLFFBQVEsR0FBRyxFQUFFLENBQUM7WUFDcEIsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO1lBRTdCLE1BQU0sTUFBTSxHQUFHLGNBQWMsQ0FBQyxXQUFXLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFFNUUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1lBQzVCLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3ZDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDhDQUE4QyxFQUFFLEdBQUcsRUFBRTtZQUNwRCxNQUFNLFFBQVEsR0FBRyxFQUFFLENBQUM7WUFDcEIsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO1lBRTdCLE1BQU0sTUFBTSxHQUFHLGNBQWMsQ0FBQyxXQUFXLENBQUMsSUFBSSxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFFakYsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1lBQzVCLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3ZDLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGxlb2R1XFxEb2N1bWVudHNcXDEgLSBQcm9cXFRlc3QgcGx1Z2luIG9ic2lkaWFuXFwub2JzaWRpYW5cXHBsdWdpbnNcXG9ic2lkaWFuLUNSTVxcZHluYW1pYy1maWVsZHNcXF9fdGVzdHNfX1xcUHJvcGVydGllc1xcQWRyZXNzUHJvcGVydHkudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQGplc3QtZW52aXJvbm1lbnQganNkb21cclxuICovXHJcblxyXG5pbXBvcnQgeyBBZHJlc3NQcm9wZXJ0eSB9IGZyb20gJy4uLy4uL3NyYy9wcm9wZXJ0aWVzL0FkcmVzc1Byb3BlcnR5JztcclxuaW1wb3J0IHsgTGlua1Byb3BlcnR5IH0gZnJvbSAnLi4vLi4vc3JjL3Byb3BlcnRpZXMvTGlua1Byb3BlcnR5JztcclxuXHJcbmplc3QubW9jaygnLi4vLi4vc3JjL3ZhdWx0L1V0aWxzJywgKCkgPT4gKHtcclxuICAgIHNldEljb246IGplc3QuZm4oKVxyXG59KSk7XHJcblxyXG5kZXNjcmliZSgnQWRyZXNzUHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICBsZXQgYWRyZXNzUHJvcGVydHk6IEFkcmVzc1Byb3BlcnR5O1xyXG5cclxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgIC8vIFJlc2V0IERPTSBtb2Nrc1xyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICBhZHJlc3NQcm9wZXJ0eSA9IG5ldyBBZHJlc3NQcm9wZXJ0eSgndGVzdEFkcmVzcycsIG1vY2tWYXVsdCwgbW9ja1ZhdWx0KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdjb25zdHJ1Y3RvcicsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBBZHJlc3NQcm9wZXJ0eSB3aXRoIGNvcnJlY3QgdHlwZScsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KGFkcmVzc1Byb3BlcnR5LnR5cGUpLnRvQmUoJ2FkcmVzcycpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGluaGVyaXQgZnJvbSBMaW5rUHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChhZHJlc3NQcm9wZXJ0eSkudG9CZUluc3RhbmNlT2YoTGlua1Byb3BlcnR5KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCB1c2UgZGVmYXVsdCBpY29uIHdoZW4gbm8gYXJncyBwcm92aWRlZCcsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZGVmYXVsdFByb3BlcnR5ID0gbmV3IEFkcmVzc1Byb3BlcnR5KCdkZWZhdWx0VGVzdCcsIG1vY2tWYXVsdCwgbW9ja1ZhdWx0KTtcclxuICAgICAgICAgICAgZXhwZWN0KGRlZmF1bHRQcm9wZXJ0eS5uYW1lKS50b0JlKCdkZWZhdWx0VGVzdCcpO1xyXG4gICAgICAgICAgICBleHBlY3QoZGVmYXVsdFByb3BlcnR5LnR5cGUpLnRvQmUoJ2FkcmVzcycpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHBhc3MgY3VzdG9tIGFyZ3MgdG8gcGFyZW50IGNvbnN0cnVjdG9yJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjdXN0b21BcmdzID0geyBpY29uOiAnY3VzdG9tLWljb24nLCBmbGV4U3BhbjogMyB9O1xyXG4gICAgICAgICAgICBjb25zdCBjdXN0b21Qcm9wZXJ0eSA9IG5ldyBBZHJlc3NQcm9wZXJ0eSgnY3VzdG9tTmFtZScsIG1vY2tWYXVsdCwgY3VzdG9tQXJncyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChjdXN0b21Qcm9wZXJ0eS5uYW1lKS50b0JlKCdjdXN0b21OYW1lJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgndmFsaWRhdGUnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gaW5wdXQgdmFsdWUgdW5jaGFuZ2VkJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB0ZXN0QWRkcmVzcyA9ICcxMjMgTWFpbiBTdCwgUGFyaXMsIEZyYW5jZSc7XHJcbiAgICAgICAgICAgIGV4cGVjdChhZHJlc3NQcm9wZXJ0eS52YWxpZGF0ZSh0ZXN0QWRkcmVzcykpLnRvQmUodGVzdEFkZHJlc3MpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBzdHJpbmcnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChhZHJlc3NQcm9wZXJ0eS52YWxpZGF0ZSgnJykpLnRvQmUoJycpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBzcGVjaWFsIGNoYXJhY3RlcnMgaW4gYWRkcmVzcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgc3BlY2lhbEFkZHJlc3MgPSAnUnVlIGRlIGxcXCfDiWdsaXNlLCA3NTAwMSBQYXJpcyc7XHJcbiAgICAgICAgICAgIGV4cGVjdChhZHJlc3NQcm9wZXJ0eS52YWxpZGF0ZShzcGVjaWFsQWRkcmVzcykpLnRvQmUoc3BlY2lhbEFkZHJlc3MpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSB1bmljb2RlIGNoYXJhY3RlcnMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVuaWNvZGVBZGRyZXNzID0gJ+WMl+S6rOW4guacnemYs+WMuic7XHJcbiAgICAgICAgICAgIGV4cGVjdChhZHJlc3NQcm9wZXJ0eS52YWxpZGF0ZSh1bmljb2RlQWRkcmVzcykpLnRvQmUodW5pY29kZUFkZHJlc3MpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBtdWx0aWxpbmUgYWRkcmVzc2VzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtdWx0aWxpbmVBZGRyZXNzID0gJzEyMyBNYWluIFN0XFxcXG5BcHQgNEJcXFxcblBhcmlzLCBGcmFuY2UnO1xyXG4gICAgICAgICAgICBleHBlY3QoYWRyZXNzUHJvcGVydHkudmFsaWRhdGUobXVsdGlsaW5lQWRkcmVzcykpLnRvQmUobXVsdGlsaW5lQWRkcmVzcyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnZ2V0TGluaycsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGdlbmVyYXRlIEdvb2dsZSBNYXBzIHNlYXJjaCBVUkwgZm9yIHNpbXBsZSBhZGRyZXNzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBhZGRyZXNzID0gJzEyMyBNYWluIFN0LCBQYXJpcyc7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkVXJsID0gJ2h0dHBzOi8vd3d3Lmdvb2dsZS5jb20vbWFwcy9zZWFyY2gvMTIzJTIwTWFpbiUyMFN0JTJDJTIwUGFyaXMnO1xyXG4gICAgICAgICAgICBleHBlY3QoYWRyZXNzUHJvcGVydHkuZ2V0TGluayhhZGRyZXNzKSkudG9CZShleHBlY3RlZFVybCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcHJvcGVybHkgZW5jb2RlIHNwZWNpYWwgY2hhcmFjdGVycycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgYWRkcmVzcyA9ICdSdWUgZGUgbFxcJ8OJZ2xpc2UgJiBDYWbDqSc7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkVXJsID0gJ2h0dHBzOi8vd3d3Lmdvb2dsZS5jb20vbWFwcy9zZWFyY2gvUnVlJTIwZGUlMjBsXFwnJUMzJTg5Z2xpc2UlMjAlMjYlMjBDYWYlQzMlQTknO1xyXG4gICAgICAgICAgICBleHBlY3QoYWRyZXNzUHJvcGVydHkuZ2V0TGluayhhZGRyZXNzKSkudG9CZShleHBlY3RlZFVybCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IGFkZHJlc3MnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFkZHJlc3MgPSAnJztcclxuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRVcmwgPSAnaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9tYXBzL3NlYXJjaC8nO1xyXG4gICAgICAgICAgICBleHBlY3QoYWRyZXNzUHJvcGVydHkuZ2V0TGluayhhZGRyZXNzKSkudG9CZShleHBlY3RlZFVybCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgZW5jb2RlIHNwYWNlcyBjb3JyZWN0bHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFkZHJlc3MgPSAnTmV3IFlvcmsgQ2l0eSc7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkVXJsID0gJ2h0dHBzOi8vd3d3Lmdvb2dsZS5jb20vbWFwcy9zZWFyY2gvTmV3JTIwWW9yayUyMENpdHknO1xyXG4gICAgICAgICAgICBleHBlY3QoYWRyZXNzUHJvcGVydHkuZ2V0TGluayhhZGRyZXNzKSkudG9CZShleHBlY3RlZFVybCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbXBsZXggaW50ZXJuYXRpb25hbCBhZGRyZXNzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBhZGRyZXNzID0gJ+adseS6rOmDvea4i+iwt+WMuiwgSmFwYW4nO1xyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhZHJlc3NQcm9wZXJ0eS5nZXRMaW5rKGFkZHJlc3MpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0NvbnRhaW4oJ2h0dHBzOi8vd3d3Lmdvb2dsZS5jb20vbWFwcy9zZWFyY2gvJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQ29udGFpbignJUU2JTlEJUIxJUU0JUJBJUFDJUU5JTgzJUJEJyk7IC8vIEVuY29kZWQgVG9reW8gY2hhcmFjdGVyc1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBhZGRyZXNzIHdpdGggbnVtYmVycyBhbmQgc3ltYm9scycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgYWRkcmVzcyA9ICcxMjMtNDUgTWFpbiBTdCAjNDU2JztcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYWRyZXNzUHJvcGVydHkuZ2V0TGluayhhZGRyZXNzKTtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9Db250YWluKCdodHRwczovL3d3dy5nb29nbGUuY29tL21hcHMvc2VhcmNoLycpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0NvbnRhaW4oJzEyMy00NSUyME1haW4lMjBTdCUyMCUyMzQ1NicpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSB2ZXJ5IGxvbmcgYWRkcmVzcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbG9uZ0FkZHJlc3MgPSAnVmVyeSBMb25nIFN0cmVldCBOYW1lIFdpdGggTWFueSBXb3JkcyBBbmQgRGV0YWlscyBJbmNsdWRpbmcgQnVpbGRpbmcgTnVtYmVyIDEyMzQ1IEFwYXJ0bWVudCBDb21wbGV4IEJ1aWxkaW5nIEEgVW5pdCA0NTYgQ2l0eSBTdGF0ZSBQb3N0YWwgQ29kZSBDb3VudHJ5JztcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYWRyZXNzUHJvcGVydHkuZ2V0TGluayhsb25nQWRkcmVzcyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQ29udGFpbignaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9tYXBzL3NlYXJjaC8nKTtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbig1MCk7IC8vIFNob3VsZCBiZSBlbmNvZGVkIGFuZCBsb25nXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnaW5oZXJpdGFuY2UgZnJvbSBMaW5rUHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYXZlIGZpbGxEaXNwbGF5IG1ldGhvZCBmcm9tIHBhcmVudCcsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KHR5cGVvZiBhZHJlc3NQcm9wZXJ0eS5maWxsRGlzcGxheSkudG9CZSgnZnVuY3Rpb24nKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYXZlIHZhbGlkYXRlIG1ldGhvZCBmcm9tIHBhcmVudCcsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KHR5cGVvZiBhZHJlc3NQcm9wZXJ0eS52YWxpZGF0ZSkudG9CZSgnZnVuY3Rpb24nKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYXZlIGdldExpbmsgbWV0aG9kJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QodHlwZW9mIGFkcmVzc1Byb3BlcnR5LmdldExpbmspLnRvQmUoJ2Z1bmN0aW9uJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGF2ZSBjcmVhdGVGaWVsZExpbmsgbWV0aG9kIGZyb20gcGFyZW50JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QodHlwZW9mIGFkcmVzc1Byb3BlcnR5LmNyZWF0ZUZpZWxkTGluaykudG9CZSgnZnVuY3Rpb24nKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYXZlIGdldFByZXR0eSBtZXRob2QgZnJvbSBwYXJlbnQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0eXBlb2YgYWRyZXNzUHJvcGVydHkuZ2V0UHJldHR5KS50b0JlKCdmdW5jdGlvbicpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhdmUgbmFtZSBwcm9wZXJ0eSBmcm9tIHBhcmVudCcsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KGFkcmVzc1Byb3BlcnR5Lm5hbWUpLnRvQmUoJ3Rlc3RBZHJlc3MnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdsaW5rIGZ1bmN0aW9uYWxpdHkgaW50ZWdyYXRpb24nLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgY2xpY2thYmxlIGxpbmsgd2l0aCBHb29nbGUgTWFwcyBVUkwnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tGaWxlID0ge307XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGFkZHJlc3MgPSAnUGFyaXMsIEZyYW5jZSc7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhZHJlc3NQcm9wZXJ0eS5maWxsRGlzcGxheShudWxsLCBhZGRyZXNzLCBtb2NrVXBkYXRlLCBtb2NrRmlsZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlVHJ1dGh5KCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQudGFnTmFtZSkudG9CZSgnRElWJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIG51bGwgdmFsdWUgaW4gZmlsbERpc3BsYXknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tGaWxlID0ge307XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhZHJlc3NQcm9wZXJ0eS5maWxsRGlzcGxheShudWxsLCBudWxsLCBtb2NrVXBkYXRlLCBtb2NrRmlsZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlVHJ1dGh5KCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQudGFnTmFtZSkudG9CZSgnRElWJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIHVuZGVmaW5lZCB2YWx1ZSBpbiBmaWxsRGlzcGxheScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja0ZpbGUgPSB7fTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VwZGF0ZSA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGFkcmVzc1Byb3BlcnR5LmZpbGxEaXNwbGF5KG51bGwsIHVuZGVmaW5lZCwgbW9ja1VwZGF0ZSwgbW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZVRydXRoeSgpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LnRhZ05hbWUpLnRvQmUoJ0RJVicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn0pO1xyXG4iXSwidmVyc2lvbiI6M30=