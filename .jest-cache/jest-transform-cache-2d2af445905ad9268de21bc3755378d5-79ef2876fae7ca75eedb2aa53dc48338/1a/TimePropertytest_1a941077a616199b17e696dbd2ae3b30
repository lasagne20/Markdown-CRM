d8810a85f084df7f822e32653a6013ba
"use strict";
/**
 * @jest-environment jsdom
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock flatpickr
jest.mock('flatpickr', () => {
    return jest.fn().mockImplementation((element, options) => {
        // Simuler l'initialization flatpickr
        element.setAttribute('data-flatpickr', 'true');
        // Simuler le trigger des événements flatpickr
        if (options?.onChange) {
            element._flatpickrOnChange = options.onChange;
        }
        if (options?.onClose) {
            element._flatpickrOnClose = options.onClose;
        }
        return {
            destroy: jest.fn(),
            clear: jest.fn(),
            setDate: jest.fn()
        };
    });
});
// Mock French locale
jest.mock('flatpickr/dist/l10n/fr.js', () => ({
    French: {}
}), { virtual: true });
const TimeProperty_1 = require("../src/properties/TimeProperty ");
describe('TimeProperty', () => {
    let timeProperty;
    beforeEach(() => {
        // Reset DOM mocks
        document.body.innerHTML = '';
        jest.clearAllMocks();
        // Mock focus pour tous les éléments HTML
        HTMLElement.prototype.focus = jest.fn();
    });
    describe('constructor', () => {
        it('should create TimeProperty with default format', () => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
            expect(timeProperty.name).toBe('testTime');
            expect(timeProperty.type).toBe('time');
            expect(timeProperty['format']).toBe('HH:mm'); // format par défaut
        });
        it('should create TimeProperty with custom format', () => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime', { format: 'HH:mm:ss', icon: 'clock' });
            expect(timeProperty.name).toBe('testTime');
            expect(timeProperty.type).toBe('time');
            expect(timeProperty['format']).toBe('HH:mm:ss');
            expect(timeProperty.icon).toBe('clock');
        });
    });
    describe('validate', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should validate correct time format HH:mm', () => {
            expect(timeProperty.validate('14:30')).toBe('14:30');
            expect(timeProperty.validate('09:15')).toBe('09:15');
            expect(timeProperty.validate('00:00')).toBe('00:00');
            expect(timeProperty.validate('23:59')).toBe('23:59');
        });
        it('should return empty string for invalid time format', () => {
            expect(timeProperty.validate('25:00')).toBe('25:00'); // Format valide même si heure invalide
            expect(timeProperty.validate('14:70')).toBe('14:70'); // Format valide même si minutes invalides
            expect(timeProperty.validate('14')).toBe(''); // Format incomplet
            expect(timeProperty.validate('14:3')).toBe(''); // Format incorrect (pas 2 digits)
            expect(timeProperty.validate('abc')).toBe(''); // Texte invalide
            expect(timeProperty.validate('')).toBe(''); // Chaîne vide
        });
    });
    describe('formatTimeForDisplay', () => {
        it('should format time for HH:mm format', () => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime', { format: 'HH:mm' });
            expect(timeProperty.formatTimeForDisplay('14:30')).toBe('14:30');
            expect(timeProperty.formatTimeForDisplay('09:15')).toBe('09:15');
            expect(timeProperty.formatTimeForDisplay('')).toBe('Aucune heure sélectionnée');
        });
        it('should format time for custom format with units', () => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime', { format: 'custom' });
            expect(timeProperty.formatTimeForDisplay('14:30')).toBe('14h 30 min');
            expect(timeProperty.formatTimeForDisplay('09:00')).toBe('9h');
            expect(timeProperty.formatTimeForDisplay('00:15')).toBe('15 min');
            expect(timeProperty.formatTimeForDisplay('00:00')).toBe('0 min');
            expect(timeProperty.formatTimeForDisplay('')).toBe('');
        });
        it('should handle time with seconds', () => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime', { format: 'custom' });
            expect(timeProperty.formatTimeForDisplay('14:30:45')).toBe('14h 30 min 45s');
            expect(timeProperty.formatTimeForDisplay('00:00:30')).toBe('30s');
        });
    });
    describe('formatTimeForStorage', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should format Date to HH:mm string', () => {
            const date1 = new Date('2024-01-01T14:30:00');
            const date2 = new Date('2024-01-01T09:15:00');
            expect(timeProperty.formatTimeForStorage(date1)).toBe('14:30');
            expect(timeProperty.formatTimeForStorage(date2)).toBe('09:15');
        });
    });
    describe('createFieldLink', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should create link element with time value', () => {
            const link = timeProperty.createFieldLink('14:30');
            expect(link.tagName).toBe('DIV');
            expect(link.textContent).toBe('14:30');
            expect(link.classList.contains('time-field-link')).toBe(true);
            expect(link.classList.contains('field-link')).toBe(true);
            expect(link.style.cursor).toBe('pointer');
        });
        it('should create link with default text when no value', () => {
            const link = timeProperty.createFieldLink('');
            expect(link.textContent).toBe('Aucune heure sélectionnée');
        });
        it('should handle click event to trigger modifyField', () => {
            const spy = jest.spyOn(timeProperty, 'modifyField');
            const link = timeProperty.createFieldLink('14:30');
            // Simulate the click event more accurately
            const clickEvent = new MouseEvent('click', {
                bubbles: true,
                cancelable: true,
            });
            Object.defineProperty(clickEvent, 'currentTarget', {
                value: link,
                writable: false
            });
            link.dispatchEvent(clickEvent);
            expect(spy).toHaveBeenCalledWith(expect.objectContaining({
                type: 'click',
                currentTarget: link
            }));
        });
    });
    describe('createFieldTime', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should create input element with flatpickr', () => {
            const mockUpdate = jest.fn();
            const mockLink = document.createElement('div');
            const input = timeProperty.createFieldTime('14:30', mockUpdate, mockLink);
            expect(input.tagName).toBe('INPUT');
            expect(input.type).toBe('text');
            expect(input.value).toBe('14:30');
            expect(input.classList.contains('field-input')).toBe(true);
            expect(input.hasAttribute('data-flatpickr')).toBe(true);
        });
        it('should create input with empty value when no initial value', () => {
            const mockUpdate = jest.fn();
            const mockLink = document.createElement('div');
            const input = timeProperty.createFieldTime('', mockUpdate, mockLink);
            expect(input.value).toBe('');
        });
        it('should handle flatpickr onChange event', async () => {
            const mockUpdate = jest.fn().mockResolvedValue(undefined);
            const mockLink = document.createElement('div');
            const spy = jest.spyOn(timeProperty, 'updateField').mockResolvedValue(undefined);
            const input = timeProperty.createFieldTime('', mockUpdate, mockLink);
            // Simuler le changement flatpickr
            const mockDate = new Date('2024-01-01T15:45:00');
            if (input._flatpickrOnChange) {
                await input._flatpickrOnChange([mockDate]);
            }
            expect(input.value).toBe('15:45');
            expect(spy).toHaveBeenCalledWith(mockUpdate, input, mockLink);
        });
        it('should handle flatpickr onClose event', async () => {
            const mockUpdate = jest.fn().mockResolvedValue(undefined);
            const mockLink = document.createElement('div');
            const spy = jest.spyOn(timeProperty, 'updateField').mockResolvedValue(undefined);
            const input = timeProperty.createFieldTime('invalid', mockUpdate, mockLink);
            // Simuler la fermeture flatpickr
            if (input._flatpickrOnClose) {
                await input._flatpickrOnClose();
            }
            expect(input.value).toBe(''); // Valeur invalide effacée
            expect(spy).toHaveBeenCalledWith(mockUpdate, input, mockLink);
        });
    });
    describe('fillDisplay', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should create container with link and input for valid value', () => {
            const mockUpdate = jest.fn();
            const container = timeProperty.fillDisplay({}, '14:30', mockUpdate);
            expect(container.tagName).toBe('DIV');
            expect(container.classList.contains('field-container')).toBe(true);
            const link = container.querySelector('.time-field-link');
            const input = container.querySelector('input');
            expect(link).toBeTruthy();
            expect(input).toBeTruthy();
            expect(link?.style.display).toBe('block');
            // L'input est initialisé par flatpickr, donc on vérifie qu'il existe mais pas nécessairement qu'il soit caché
            expect(input).toBeTruthy();
        });
        it('should show input for invalid value', () => {
            const mockUpdate = jest.fn();
            const container = timeProperty.fillDisplay({}, 'invalid', mockUpdate);
            const link = container.querySelector('.time-field-link');
            const input = container.querySelector('input');
            expect(input?.style.display).toBe('block');
            expect(link?.style.display).toBe('none');
        });
        it('should show input for empty value', () => {
            const mockUpdate = jest.fn();
            const container = timeProperty.fillDisplay({}, '', mockUpdate);
            const link = container.querySelector('.time-field-link');
            const input = container.querySelector('input');
            expect(input?.style.display).toBe('block');
            expect(link?.style.display).toBe('none');
        });
    });
    describe('updateField', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should update field with valid value', async () => {
            const mockUpdate = jest.fn().mockResolvedValue(undefined);
            const input = document.createElement('input');
            input.value = '14:30';
            const link = document.createElement('div');
            await timeProperty.updateField(mockUpdate, input, link);
            expect(mockUpdate).toHaveBeenCalledWith('14:30');
            expect(input.style.display).toBe('none');
            expect(link.style.display).toBe('block');
            expect(link.textContent).toBe('14:30');
        });
        it('should handle invalid value', async () => {
            const mockUpdate = jest.fn().mockResolvedValue(undefined);
            const input = document.createElement('input');
            input.value = 'invalid';
            const link = document.createElement('div');
            await timeProperty.updateField(mockUpdate, input, link);
            expect(mockUpdate).toHaveBeenCalledWith('');
            expect(link.textContent).toBe('Aucune heure sélectionnée');
        });
    });
    describe('modifyField', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should call modifyField without throwing errors', () => {
            // Test que modifyField peut être appelé sans erreur
            const container = document.createElement('div');
            const link = document.createElement('div');
            const input = document.createElement('input');
            container.appendChild(link);
            container.appendChild(input);
            const event = { currentTarget: link };
            // Vérifier que modifyField ne lance pas d'erreur
            expect(() => timeProperty.modifyField(event)).not.toThrow();
        });
        it('should handle missing container', () => {
            const link = document.createElement('div'); // Pas de parent
            const event = { currentTarget: link };
            // Ne devrait pas lever d'erreur
            expect(() => timeProperty.modifyField(event)).not.toThrow();
        });
        it('should handle missing input in container', () => {
            const container = document.createElement('div');
            const link = document.createElement('div');
            container.appendChild(link); // Pas d'input
            const event = { currentTarget: link };
            // Ne devrait pas lever d'erreur
            expect(() => timeProperty.modifyField(event)).not.toThrow();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxfX3Rlc3RzX19cXFByb3BlcnRpZXNcXFRpbWVQcm9wZXJ0eS50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7QUFJSCxpQkFBaUI7QUFDakIsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsR0FBRyxFQUFFO0lBQ3hCLE9BQU8sSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGtCQUFrQixDQUFDLENBQUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxFQUFFO1FBQ3JELHFDQUFxQztRQUNyQyxPQUFPLENBQUMsWUFBWSxDQUFDLGdCQUFnQixFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBRS9DLDhDQUE4QztRQUM5QyxJQUFJLE9BQU8sRUFBRSxRQUFRLEVBQUUsQ0FBQztZQUNwQixPQUFPLENBQUMsa0JBQWtCLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQztRQUNsRCxDQUFDO1FBQ0QsSUFBSSxPQUFPLEVBQUUsT0FBTyxFQUFFLENBQUM7WUFDbkIsT0FBTyxDQUFDLGlCQUFpQixHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUM7UUFDaEQsQ0FBQztRQUVELE9BQU87WUFDSCxPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNsQixLQUFLLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNoQixPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtTQUNyQixDQUFDO0lBQ04sQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQztBQUVILHFCQUFxQjtBQUNyQixJQUFJLENBQUMsSUFBSSxDQUFDLDJCQUEyQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDMUMsTUFBTSxFQUFFLEVBQUU7Q0FDYixDQUFDLEVBQUUsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FB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UUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNoRCxNQUFNLElBQUksR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQzNDLFNBQVMsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxjQUFjO1lBRTNDLE1BQU0sS0FBSyxHQUFHLEVBQUUsYUFBYSxFQUFFLElBQUksRUFBc0IsQ0FBQztZQUUxRCxnQ0FBZ0M7WUFDaEMsTUFBTSxDQUFDLEdBQUcsRUFBRSxDQUFDLFlBQVksQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDaEUsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbGVvZHVcXERvY3VtZW50c1xcMSAtIFByb1xcVGVzdCBwbHVnaW4gb2JzaWRpYW5cXC5vYnNpZGlhblxccGx1Z2luc1xcb2JzaWRpYW4tQ1JNXFxkeW5hbWljLWZpZWxkc1xcX190ZXN0c19fXFxQcm9wZXJ0aWVzXFxUaW1lUHJvcGVydHkudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQGplc3QtZW52aXJvbm1lbnQganNkb21cclxuICovXHJcblxyXG5pbXBvcnQgeyBUaW1lUHJvcGVydHkgfSBmcm9tICcuLi9zcmMvcHJvcGVydGllcy9UaW1lUHJvcGVydHkgJztcclxuXHJcbi8vIE1vY2sgZmxhdHBpY2tyXHJcbmplc3QubW9jaygnZmxhdHBpY2tyJywgKCkgPT4ge1xyXG4gICAgcmV0dXJuIGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKGVsZW1lbnQsIG9wdGlvbnMpID0+IHtcclxuICAgICAgICAvLyBTaW11bGVyIGwnaW5pdGlhbGl6YXRpb24gZmxhdHBpY2tyXHJcbiAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtZmxhdHBpY2tyJywgJ3RydWUnKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBTaW11bGVyIGxlIHRyaWdnZXIgZGVzIMOpdsOpbmVtZW50cyBmbGF0cGlja3JcclxuICAgICAgICBpZiAob3B0aW9ucz8ub25DaGFuZ2UpIHtcclxuICAgICAgICAgICAgZWxlbWVudC5fZmxhdHBpY2tyT25DaGFuZ2UgPSBvcHRpb25zLm9uQ2hhbmdlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob3B0aW9ucz8ub25DbG9zZSkge1xyXG4gICAgICAgICAgICBlbGVtZW50Ll9mbGF0cGlja3JPbkNsb3NlID0gb3B0aW9ucy5vbkNsb3NlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBkZXN0cm95OiBqZXN0LmZuKCksXHJcbiAgICAgICAgICAgIGNsZWFyOiBqZXN0LmZuKCksXHJcbiAgICAgICAgICAgIHNldERhdGU6IGplc3QuZm4oKVxyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxufSk7XHJcblxyXG4vLyBNb2NrIEZyZW5jaCBsb2NhbGVcclxuamVzdC5tb2NrKCdmbGF0cGlja3IvZGlzdC9sMTBuL2ZyLmpzJywgKCkgPT4gKHtcclxuICAgIEZyZW5jaDoge31cclxufSksIHsgdmlydHVhbDogdHJ1ZSB9KTtcclxuXHJcbmRlc2NyaWJlKCdUaW1lUHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICBsZXQgdGltZVByb3BlcnR5OiBUaW1lUHJvcGVydHk7XHJcblxyXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgLy8gUmVzZXQgRE9NIG1vY2tzXHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBNb2NrIGZvY3VzIHBvdXIgdG91cyBsZXMgw6lsw6ltZW50cyBIVE1MXHJcbiAgICAgICAgSFRNTEVsZW1lbnQucHJvdG90eXBlLmZvY3VzID0gamVzdC5mbigpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2NvbnN0cnVjdG9yJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIFRpbWVQcm9wZXJ0eSB3aXRoIGRlZmF1bHQgZm9ybWF0JywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lUHJvcGVydHkgPSBuZXcgVGltZVByb3BlcnR5KCd0ZXN0VGltZScpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eS5uYW1lKS50b0JlKCd0ZXN0VGltZScpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LnR5cGUpLnRvQmUoJ3RpbWUnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eVsnZm9ybWF0J10pLnRvQmUoJ0hIOm1tJyk7IC8vIGZvcm1hdCBwYXIgZMOpZmF1dFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBUaW1lUHJvcGVydHkgd2l0aCBjdXN0b20gZm9ybWF0JywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lUHJvcGVydHkgPSBuZXcgVGltZVByb3BlcnR5KCd0ZXN0VGltZScsIHsgZm9ybWF0OiAnSEg6bW06c3MnLCBpY29uOiAnY2xvY2snIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eS5uYW1lKS50b0JlKCd0ZXN0VGltZScpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LnR5cGUpLnRvQmUoJ3RpbWUnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eVsnZm9ybWF0J10pLnRvQmUoJ0hIOm1tOnNzJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkuaWNvbikudG9CZSgnY2xvY2snKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCd2YWxpZGF0ZScsICgpID0+IHtcclxuICAgICAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICAgICAgdGltZVByb3BlcnR5ID0gbmV3IFRpbWVQcm9wZXJ0eSgndGVzdFRpbWUnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBjb3JyZWN0IHRpbWUgZm9ybWF0IEhIOm1tJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LnZhbGlkYXRlKCcxNDozMCcpKS50b0JlKCcxNDozMCcpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LnZhbGlkYXRlKCcwOToxNScpKS50b0JlKCcwOToxNScpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LnZhbGlkYXRlKCcwMDowMCcpKS50b0JlKCcwMDowMCcpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LnZhbGlkYXRlKCcyMzo1OScpKS50b0JlKCcyMzo1OScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBlbXB0eSBzdHJpbmcgZm9yIGludmFsaWQgdGltZSBmb3JtYXQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkudmFsaWRhdGUoJzI1OjAwJykpLnRvQmUoJzI1OjAwJyk7IC8vIEZvcm1hdCB2YWxpZGUgbcOqbWUgc2kgaGV1cmUgaW52YWxpZGVcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eS52YWxpZGF0ZSgnMTQ6NzAnKSkudG9CZSgnMTQ6NzAnKTsgLy8gRm9ybWF0IHZhbGlkZSBtw6ptZSBzaSBtaW51dGVzIGludmFsaWRlc1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LnZhbGlkYXRlKCcxNCcpKS50b0JlKCcnKTsgLy8gRm9ybWF0IGluY29tcGxldFxyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LnZhbGlkYXRlKCcxNDozJykpLnRvQmUoJycpOyAvLyBGb3JtYXQgaW5jb3JyZWN0IChwYXMgMiBkaWdpdHMpXHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkudmFsaWRhdGUoJ2FiYycpKS50b0JlKCcnKTsgLy8gVGV4dGUgaW52YWxpZGVcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eS52YWxpZGF0ZSgnJykpLnRvQmUoJycpOyAvLyBDaGHDrm5lIHZpZGVcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdmb3JtYXRUaW1lRm9yRGlzcGxheScsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGZvcm1hdCB0aW1lIGZvciBISDptbSBmb3JtYXQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRpbWVQcm9wZXJ0eSA9IG5ldyBUaW1lUHJvcGVydHkoJ3Rlc3RUaW1lJywgeyBmb3JtYXQ6ICdISDptbScgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LmZvcm1hdFRpbWVGb3JEaXNwbGF5KCcxNDozMCcpKS50b0JlKCcxNDozMCcpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LmZvcm1hdFRpbWVGb3JEaXNwbGF5KCcwOToxNScpKS50b0JlKCcwOToxNScpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LmZvcm1hdFRpbWVGb3JEaXNwbGF5KCcnKSkudG9CZSgnQXVjdW5lIGhldXJlIHPDqWxlY3Rpb25uw6llJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgZm9ybWF0IHRpbWUgZm9yIGN1c3RvbSBmb3JtYXQgd2l0aCB1bml0cycsICgpID0+IHtcclxuICAgICAgICAgICAgdGltZVByb3BlcnR5ID0gbmV3IFRpbWVQcm9wZXJ0eSgndGVzdFRpbWUnLCB7IGZvcm1hdDogJ2N1c3RvbScgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LmZvcm1hdFRpbWVGb3JEaXNwbGF5KCcxNDozMCcpKS50b0JlKCcxNGggMzAgbWluJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkuZm9ybWF0VGltZUZvckRpc3BsYXkoJzA5OjAwJykpLnRvQmUoJzloJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkuZm9ybWF0VGltZUZvckRpc3BsYXkoJzAwOjE1JykpLnRvQmUoJzE1IG1pbicpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LmZvcm1hdFRpbWVGb3JEaXNwbGF5KCcwMDowMCcpKS50b0JlKCcwIG1pbicpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LmZvcm1hdFRpbWVGb3JEaXNwbGF5KCcnKSkudG9CZSgnJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIHRpbWUgd2l0aCBzZWNvbmRzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lUHJvcGVydHkgPSBuZXcgVGltZVByb3BlcnR5KCd0ZXN0VGltZScsIHsgZm9ybWF0OiAnY3VzdG9tJyB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkuZm9ybWF0VGltZUZvckRpc3BsYXkoJzE0OjMwOjQ1JykpLnRvQmUoJzE0aCAzMCBtaW4gNDVzJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkuZm9ybWF0VGltZUZvckRpc3BsYXkoJzAwOjAwOjMwJykpLnRvQmUoJzMwcycpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2Zvcm1hdFRpbWVGb3JTdG9yYWdlJywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lUHJvcGVydHkgPSBuZXcgVGltZVByb3BlcnR5KCd0ZXN0VGltZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGZvcm1hdCBEYXRlIHRvIEhIOm1tIHN0cmluZycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZGF0ZTEgPSBuZXcgRGF0ZSgnMjAyNC0wMS0wMVQxNDozMDowMCcpO1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlMiA9IG5ldyBEYXRlKCcyMDI0LTAxLTAxVDA5OjE1OjAwJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LmZvcm1hdFRpbWVGb3JTdG9yYWdlKGRhdGUxKSkudG9CZSgnMTQ6MzAnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eS5mb3JtYXRUaW1lRm9yU3RvcmFnZShkYXRlMikpLnRvQmUoJzA5OjE1Jyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnY3JlYXRlRmllbGRMaW5rJywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lUHJvcGVydHkgPSBuZXcgVGltZVByb3BlcnR5KCd0ZXN0VGltZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBsaW5rIGVsZW1lbnQgd2l0aCB0aW1lIHZhbHVlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gdGltZVByb3BlcnR5LmNyZWF0ZUZpZWxkTGluaygnMTQ6MzAnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rLnRhZ05hbWUpLnRvQmUoJ0RJVicpO1xyXG4gICAgICAgICAgICBleHBlY3QobGluay50ZXh0Q29udGVudCkudG9CZSgnMTQ6MzAnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmsuY2xhc3NMaXN0LmNvbnRhaW5zKCd0aW1lLWZpZWxkLWxpbmsnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmsuY2xhc3NMaXN0LmNvbnRhaW5zKCdmaWVsZC1saW5rJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rLnN0eWxlLmN1cnNvcikudG9CZSgncG9pbnRlcicpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBsaW5rIHdpdGggZGVmYXVsdCB0ZXh0IHdoZW4gbm8gdmFsdWUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSB0aW1lUHJvcGVydHkuY3JlYXRlRmllbGRMaW5rKCcnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rLnRleHRDb250ZW50KS50b0JlKCdBdWN1bmUgaGV1cmUgc8OpbGVjdGlvbm7DqWUnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgY2xpY2sgZXZlbnQgdG8gdHJpZ2dlciBtb2RpZnlGaWVsZCcsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgc3B5ID0gamVzdC5zcHlPbih0aW1lUHJvcGVydHksICdtb2RpZnlGaWVsZCcpO1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gdGltZVByb3BlcnR5LmNyZWF0ZUZpZWxkTGluaygnMTQ6MzAnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFNpbXVsYXRlIHRoZSBjbGljayBldmVudCBtb3JlIGFjY3VyYXRlbHlcclxuICAgICAgICAgICAgY29uc3QgY2xpY2tFdmVudCA9IG5ldyBNb3VzZUV2ZW50KCdjbGljaycsIHtcclxuICAgICAgICAgICAgICAgIGJ1YmJsZXM6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBjYW5jZWxhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNsaWNrRXZlbnQsICdjdXJyZW50VGFyZ2V0Jywge1xyXG4gICAgICAgICAgICAgICAgdmFsdWU6IGxpbmssXHJcbiAgICAgICAgICAgICAgICB3cml0YWJsZTogZmFsc2VcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBsaW5rLmRpc3BhdGNoRXZlbnQoY2xpY2tFdmVudCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3Qoc3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiAnY2xpY2snLFxyXG4gICAgICAgICAgICAgICAgY3VycmVudFRhcmdldDogbGlua1xyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnY3JlYXRlRmllbGRUaW1lJywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lUHJvcGVydHkgPSBuZXcgVGltZVByb3BlcnR5KCd0ZXN0VGltZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBpbnB1dCBlbGVtZW50IHdpdGggZmxhdHBpY2tyJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrTGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSB0aW1lUHJvcGVydHkuY3JlYXRlRmllbGRUaW1lKCcxNDozMCcsIG1vY2tVcGRhdGUsIG1vY2tMaW5rKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChpbnB1dC50YWdOYW1lKS50b0JlKCdJTlBVVCcpO1xyXG4gICAgICAgICAgICBleHBlY3QoaW5wdXQudHlwZSkudG9CZSgndGV4dCcpO1xyXG4gICAgICAgICAgICBleHBlY3QoaW5wdXQudmFsdWUpLnRvQmUoJzE0OjMwJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChpbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoJ2ZpZWxkLWlucHV0JykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChpbnB1dC5oYXNBdHRyaWJ1dGUoJ2RhdGEtZmxhdHBpY2tyJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIGlucHV0IHdpdGggZW1wdHkgdmFsdWUgd2hlbiBubyBpbml0aWFsIHZhbHVlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrTGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSB0aW1lUHJvcGVydHkuY3JlYXRlRmllbGRUaW1lKCcnLCBtb2NrVXBkYXRlLCBtb2NrTGluayk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QoaW5wdXQudmFsdWUpLnRvQmUoJycpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBmbGF0cGlja3Igb25DaGFuZ2UgZXZlbnQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja0xpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29uc3Qgc3B5ID0gamVzdC5zcHlPbih0aW1lUHJvcGVydHksICd1cGRhdGVGaWVsZCcpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBpbnB1dCA9IHRpbWVQcm9wZXJ0eS5jcmVhdGVGaWVsZFRpbWUoJycsIG1vY2tVcGRhdGUsIG1vY2tMaW5rKSBhcyBhbnk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBTaW11bGVyIGxlIGNoYW5nZW1lbnQgZmxhdHBpY2tyXHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tEYXRlID0gbmV3IERhdGUoJzIwMjQtMDEtMDFUMTU6NDU6MDAnKTtcclxuICAgICAgICAgICAgaWYgKGlucHV0Ll9mbGF0cGlja3JPbkNoYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgaW5wdXQuX2ZsYXRwaWNrck9uQ2hhbmdlKFttb2NrRGF0ZV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QoaW5wdXQudmFsdWUpLnRvQmUoJzE1OjQ1Jyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChzcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1vY2tVcGRhdGUsIGlucHV0LCBtb2NrTGluayk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGZsYXRwaWNrciBvbkNsb3NlIGV2ZW50JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tMaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHNweSA9IGplc3Quc3B5T24odGltZVByb3BlcnR5LCAndXBkYXRlRmllbGQnKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSB0aW1lUHJvcGVydHkuY3JlYXRlRmllbGRUaW1lKCdpbnZhbGlkJywgbW9ja1VwZGF0ZSwgbW9ja0xpbmspIGFzIGFueTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFNpbXVsZXIgbGEgZmVybWV0dXJlIGZsYXRwaWNrclxyXG4gICAgICAgICAgICBpZiAoaW5wdXQuX2ZsYXRwaWNrck9uQ2xvc2UpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IGlucHV0Ll9mbGF0cGlja3JPbkNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChpbnB1dC52YWx1ZSkudG9CZSgnJyk7IC8vIFZhbGV1ciBpbnZhbGlkZSBlZmZhY8OpZVxyXG4gICAgICAgICAgICBleHBlY3Qoc3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChtb2NrVXBkYXRlLCBpbnB1dCwgbW9ja0xpbmspO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2ZpbGxEaXNwbGF5JywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lUHJvcGVydHkgPSBuZXcgVGltZVByb3BlcnR5KCd0ZXN0VGltZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBjb250YWluZXIgd2l0aCBsaW5rIGFuZCBpbnB1dCBmb3IgdmFsaWQgdmFsdWUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRpbWVQcm9wZXJ0eS5maWxsRGlzcGxheSh7fSwgJzE0OjMwJywgbW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QoY29udGFpbmVyLnRhZ05hbWUpLnRvQmUoJ0RJVicpO1xyXG4gICAgICAgICAgICBleHBlY3QoY29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucygnZmllbGQtY29udGFpbmVyJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy50aW1lLWZpZWxkLWxpbmsnKSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignaW5wdXQnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmspLnRvQmVUcnV0aHkoKTtcclxuICAgICAgICAgICAgZXhwZWN0KGlucHV0KS50b0JlVHJ1dGh5KCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rPy5zdHlsZS5kaXNwbGF5KS50b0JlKCdibG9jaycpO1xyXG4gICAgICAgICAgICAvLyBMJ2lucHV0IGVzdCBpbml0aWFsaXPDqSBwYXIgZmxhdHBpY2tyLCBkb25jIG9uIHbDqXJpZmllIHF1J2lsIGV4aXN0ZSBtYWlzIHBhcyBuw6ljZXNzYWlyZW1lbnQgcXUnaWwgc29pdCBjYWNow6lcclxuICAgICAgICAgICAgZXhwZWN0KGlucHV0KS50b0JlVHJ1dGh5KCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgc2hvdyBpbnB1dCBmb3IgaW52YWxpZCB2YWx1ZScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VwZGF0ZSA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGltZVByb3BlcnR5LmZpbGxEaXNwbGF5KHt9LCAnaW52YWxpZCcsIG1vY2tVcGRhdGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgbGluayA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcudGltZS1maWVsZC1saW5rJykgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0JykgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChpbnB1dD8uc3R5bGUuZGlzcGxheSkudG9CZSgnYmxvY2snKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbms/LnN0eWxlLmRpc3BsYXkpLnRvQmUoJ25vbmUnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBzaG93IGlucHV0IGZvciBlbXB0eSB2YWx1ZScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VwZGF0ZSA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGltZVByb3BlcnR5LmZpbGxEaXNwbGF5KHt9LCAnJywgbW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy50aW1lLWZpZWxkLWxpbmsnKSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignaW5wdXQnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGlucHV0Py5zdHlsZS5kaXNwbGF5KS50b0JlKCdibG9jaycpO1xyXG4gICAgICAgICAgICBleHBlY3QobGluaz8uc3R5bGUuZGlzcGxheSkudG9CZSgnbm9uZScpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ3VwZGF0ZUZpZWxkJywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lUHJvcGVydHkgPSBuZXcgVGltZVByb3BlcnR5KCd0ZXN0VGltZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHVwZGF0ZSBmaWVsZCB3aXRoIHZhbGlkIHZhbHVlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcclxuICAgICAgICAgICAgaW5wdXQudmFsdWUgPSAnMTQ6MzAnO1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBhd2FpdCB0aW1lUHJvcGVydHkudXBkYXRlRmllbGQobW9ja1VwZGF0ZSwgaW5wdXQsIGxpbmspO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tVcGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcxNDozMCcpO1xyXG4gICAgICAgICAgICBleHBlY3QoaW5wdXQuc3R5bGUuZGlzcGxheSkudG9CZSgnbm9uZScpO1xyXG4gICAgICAgICAgICBleHBlY3QobGluay5zdHlsZS5kaXNwbGF5KS50b0JlKCdibG9jaycpO1xyXG4gICAgICAgICAgICBleHBlY3QobGluay50ZXh0Q29udGVudCkudG9CZSgnMTQ6MzAnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgaW52YWxpZCB2YWx1ZScsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VwZGF0ZSA9IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xyXG4gICAgICAgICAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XHJcbiAgICAgICAgICAgIGlucHV0LnZhbHVlID0gJ2ludmFsaWQnO1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBhd2FpdCB0aW1lUHJvcGVydHkudXBkYXRlRmllbGQobW9ja1VwZGF0ZSwgaW5wdXQsIGxpbmspO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tVcGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmsudGV4dENvbnRlbnQpLnRvQmUoJ0F1Y3VuZSBoZXVyZSBzw6lsZWN0aW9ubsOpZScpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ21vZGlmeUZpZWxkJywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lUHJvcGVydHkgPSBuZXcgVGltZVByb3BlcnR5KCd0ZXN0VGltZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGNhbGwgbW9kaWZ5RmllbGQgd2l0aG91dCB0aHJvd2luZyBlcnJvcnMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIFRlc3QgcXVlIG1vZGlmeUZpZWxkIHBldXQgw6p0cmUgYXBwZWzDqSBzYW5zIGVycmV1clxyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQobGluayk7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChpbnB1dCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBldmVudCA9IHsgY3VycmVudFRhcmdldDogbGluayB9IGFzIHVua25vd24gYXMgRXZlbnQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBWw6lyaWZpZXIgcXVlIG1vZGlmeUZpZWxkIG5lIGxhbmNlIHBhcyBkJ2VycmV1clxyXG4gICAgICAgICAgICBleHBlY3QoKCkgPT4gdGltZVByb3BlcnR5Lm1vZGlmeUZpZWxkKGV2ZW50KSkubm90LnRvVGhyb3coKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWlzc2luZyBjb250YWluZXInLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsgLy8gUGFzIGRlIHBhcmVudFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSB7IGN1cnJlbnRUYXJnZXQ6IGxpbmsgfSBhcyB1bmtub3duIGFzIEV2ZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gTmUgZGV2cmFpdCBwYXMgbGV2ZXIgZCdlcnJldXJcclxuICAgICAgICAgICAgZXhwZWN0KCgpID0+IHRpbWVQcm9wZXJ0eS5tb2RpZnlGaWVsZChldmVudCkpLm5vdC50b1Rocm93KCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIG1pc3NpbmcgaW5wdXQgaW4gY29udGFpbmVyJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQobGluayk7IC8vIFBhcyBkJ2lucHV0XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBldmVudCA9IHsgY3VycmVudFRhcmdldDogbGluayB9IGFzIHVua25vd24gYXMgRXZlbnQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBOZSBkZXZyYWl0IHBhcyBsZXZlciBkJ2VycmV1clxyXG4gICAgICAgICAgICBleHBlY3QoKCkgPT4gdGltZVByb3BlcnR5Lm1vZGlmeUZpZWxkKGV2ZW50KSkubm90LnRvVGhyb3coKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59KTtcclxuIl0sInZlcnNpb24iOjN9