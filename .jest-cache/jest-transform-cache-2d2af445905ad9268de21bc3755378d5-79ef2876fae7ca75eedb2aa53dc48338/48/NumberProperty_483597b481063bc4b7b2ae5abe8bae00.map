{"file":"C:\\Users\\leodu\\Documents\\1 - Pro\\Test plugin obsidian\\.obsidian\\plugins\\obsidian-CRM\\dynamic-fields\\src\\properties\\NumberProperty.ts","mappings":";;;AAAA,uDAAoD;AACpD,yCAAsC;AAEtC,MAAa,cAAe,SAAQ,mBAAQ;IAMxC,YAAY,IAAY,EAAE,OAAe,EAAE,EAAE,OAA6D,EAAC,IAAI,EAAE,EAAE,EAAE,MAAM,EAAE,IAAI,EAAC;QAC9H,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QALf,SAAI,GAAW,EAAE,CAAC;QACT,SAAI,GAAY,QAAQ,CAAC;QAClC,oBAAe,GAA4B,IAAI,CAAC;QAInD,IAAI,IAAI,CAAC,OAAO,EAAE,CAAC;YACf,IAAI,CAAC,eAAe,GAAG,IAAI,iCAAe,CAAC,IAAI,EAAE,IAAI,CAAC,OAAO,EAAE,EAAC,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,MAAM,EAAE,IAAI,CAAC,MAAM,EAAE,KAAK,EAAE,IAAI,EAAC,CAAC,CAAC;QACxH,CAAC;QACD,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;IACrB,CAAC;IAEQ,QAAQ,CAAC,KAAa;QAC3B,wBAAwB;QACxB,IAAI,KAAK,IAAI,IAAI,EAAE,CAAC;YAChB,OAAO,EAAE,CAAC;QACd,CAAC;QAED,mCAAmC;QACnC,MAAM,WAAW,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;QAElC,kBAAkB;QAClB,MAAM,YAAY,GAAG,WAAW,CAAC,IAAI,EAAE,CAAC;QAExC,yDAAyD;QACzD,IAAI,CAAC,YAAY,EAAE,CAAC;YAChB,OAAO,EAAE,CAAC;QACd,CAAC;QAED,wEAAwE;QACxE,MAAM,WAAW,GAAG,UAAU,CAAC,YAAY,CAAC,CAAC;QAC7C,IAAI,KAAK,CAAC,WAAW,CAAC,EAAE,CAAC;YACrB,OAAO,EAAE,CAAC;QACd,CAAC;QAED,sEAAsE;QACtE,IAAI,CAAC,4BAA4B,CAAC,IAAI,CAAC,YAAY,CAAC;YAChD,YAAY,KAAK,WAAW,CAAC,QAAQ,EAAE,EAAE,CAAC;YAC1C,OAAO,EAAE,CAAC;QACd,CAAC;QAED,OAAO,WAAW,CAAC,QAAQ,EAAE,CAAC;IAClC,CAAC;IAEQ,UAAU,CAAC,IAAS,EAAE,OAAiD,EAAC,UAAU,EAAG,KAAK,EAAE,KAAK,EAAC,EAAE,EAAC;QAC1G,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC;QACnD,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC;QAC1C,IAAI,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC5B,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,eAAe,EAAE,CAAC;YACjC,KAAK,GAAG,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC5C,CAAC;QACD,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,EAAE,CAAC,MAAM,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC;IAC7G,CAAC;IAEQ,WAAW,CAAC,KAAW,EAAE,KAAU,EAAE,MAAqC;QAC/E,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,MAAM,KAAK,GAAG,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAE1C,IAAI,IAAI,CAAC,KAAK,EAAE,CAAC;YACb,MAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAC5C,KAAK,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC;YAC/B,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;YACtC,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;QAC7B,CAAC;QAED,MAAM,aAAa,GAAG,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;QACvD,MAAM,cAAc,GAAG,IAAI,CAAC,2BAA2B,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;QAEvE,KAAK,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;QACjC,KAAK,CAAC,WAAW,CAAC,cAAc,CAAC,CAAC;QAElC,OAAO,KAAK,CAAC;IACjB,CAAC;IAEQ,2BAA2B,CAAC,MAAwC,EAAE,KAAa;QACxF,MAAM,cAAc,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QACrD,cAAc,CAAC,SAAS,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC;QAEhD,MAAM,YAAY,GAAG,KAAK,CAAC;QAC3B,MAAM,KAAK,GAAG,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,CAAC;QAClD,MAAM,IAAI,GAAG,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC;QAEhD,IAAI,IAAI,CAAC,MAAM,EAAE,CAAC;YACd,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;YAC7B,KAAK,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;QACjC,CAAC;aAAM,CAAC;YACJ,IAAI,YAAY,IAAI,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC;gBACvC,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;gBAC7B,KAAK,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;YACjC,CAAC;iBAAM,CAAC;gBACJ,KAAK,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;gBAC9B,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;YAChC,CAAC;QACL,CAAC;QAED,cAAc,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;QACjC,cAAc,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;QAElC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC;YACf,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;QAC/C,CAAC;QAED,OAAO,cAAc,CAAC;IAC1B,CAAC;IAEQ,eAAe,CAAC,KAAa;QAClC,MAAM,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC3C,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,IAAI,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;QACxD,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;QACjC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,MAAM,CAAC;QACrD,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC;YACf,IAAI,CAAC,OAAO,GAAG,CAAC,KAAK,EAAE,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;QACtD,CAAC;QACD,OAAO,IAAI,CAAC;IAChB,CAAC;IAEQ,KAAK,CAAC,WAAW,CAAC,MAAwC,EAAE,KAAuB,EAAE,IAAiB;QAC3G,IAAI,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;QACxB,IAAI,KAAK,EAAE,CAAC;YACR,MAAM,MAAM,CAAC,KAAK,CAAC,CAAC;YACpB,KAAK,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;YAC7B,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,IAAI,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;YACxD,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;QACjC,CAAC;aAAM,CAAC;YACJ,MAAM,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QAC9B,CAAC;IACL,CAAC;IAEQ,gBAAgB,CAAC,KAAa;QACnC,MAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;QAC9C,KAAK,CAAC,IAAI,GAAG,QAAQ,CAAC;QACtB,KAAK,CAAC,KAAK,GAAG,KAAK,IAAI,EAAE,CAAC;QAC1B,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;QACnC,OAAO,KAAK,CAAC;IACjB,CAAC;CACJ;AAzID,wCAyIC","names":[],"sources":["C:\\Users\\leodu\\Documents\\1 - Pro\\Test plugin obsidian\\.obsidian\\plugins\\obsidian-CRM\\dynamic-fields\\src\\properties\\NumberProperty.ts"],"sourcesContent":["import { FormulaProperty } from \"./FormulaProperty\";\r\nimport { Property } from \"./Property\";\r\n\r\nexport class NumberProperty extends Property {\r\n\r\n    public unit: string = \"\";\r\n    public override type : string = \"number\";\r\n    public formulaProperty : FormulaProperty | null = null;\r\n\r\n    constructor(name: string, unit: string = \"\", args : {icon: string, static?: boolean, formula? : string} = {icon: \"\", static: true}) {\r\n        super(name, args);\r\n        if (args.formula) {\r\n            this.formulaProperty = new FormulaProperty(name, args.formula, {icon: args.icon, static: args.static, write: true});\r\n        }\r\n        this.unit = unit;\r\n    }\r\n\r\n    override validate(value: string): string {\r\n        // Handle null/undefined\r\n        if (value == null) {\r\n            return \"\";\r\n        }\r\n        \r\n        // Convert to string if not already\r\n        const stringValue = String(value);\r\n        \r\n        // Trim whitespace\r\n        const trimmedValue = stringValue.trim();\r\n        \r\n        // Return empty string for empty or whitespace-only input\r\n        if (!trimmedValue) {\r\n            return \"\";\r\n        }\r\n        \r\n        // Check if the entire string is a valid number (not just the beginning)\r\n        const numberValue = parseFloat(trimmedValue);\r\n        if (isNaN(numberValue)) {\r\n            return \"\";\r\n        }\r\n        \r\n        // Check if it's a valid number format (including scientific notation)\r\n        if (!/^-?\\d*\\.?\\d+(e[+-]?\\d+)?$/i.test(trimmedValue) && \r\n            trimmedValue !== numberValue.toString()) {\r\n            return \"\";\r\n        }\r\n        \r\n        return numberValue.toString();\r\n    }\r\n\r\n    override getDisplay(file: any, args : {staticMode? : boolean, title?: string} = {staticMode : false, title:\"\"}) {\r\n        this.static = args.staticMode ? true : this.static;\r\n        this.title = args.title ? args.title : \"\";\r\n        let value = this.read(file);\r\n        if (!value && this.formulaProperty) {\r\n            value = this.formulaProperty.read(file);\r\n        }\r\n        return this.fillDisplay(file.vault, value, async (value) => await file.updateMetadata(this.name, value));\r\n    } \r\n\r\n    override fillDisplay(vault : any, value: any, update: (value: any) => Promise<void>) {\r\n        this.vault = vault;\r\n        const field = this.createFieldContainer();\r\n\r\n        if (this.title) {\r\n            const title = document.createElement(\"div\");\r\n            title.textContent = this.title;\r\n            title.classList.add(\"metadata-title\");\r\n            field.appendChild(title);\r\n        }\r\n\r\n        const iconContainer = this.createIconContainer(update);\r\n        const fieldContainer = this.createFieldContainerContent(update, value);\r\n\r\n        field.appendChild(iconContainer);\r\n        field.appendChild(fieldContainer);\r\n\r\n        return field;\r\n    }\r\n\r\n    override createFieldContainerContent(update: (value: string) => Promise<void>, value: string): HTMLDivElement {\r\n        const fieldContainer = document.createElement(\"div\");\r\n        fieldContainer.classList.add(\"field-container\");\r\n\r\n        const currentField = value;\r\n        const input = this.createFieldInput(currentField);\r\n        const link = this.createFieldLink(currentField);\r\n\r\n        if (this.static) {\r\n            link.style.display = \"block\";\r\n            input.style.display = \"none\";\r\n        } else {\r\n            if (currentField && this.validate(value)) {\r\n                link.style.display = \"block\";\r\n                input.style.display = \"none\";\r\n            } else {\r\n                input.style.display = \"block\";\r\n                link.style.display = \"none\";\r\n            }\r\n        }\r\n\r\n        fieldContainer.appendChild(link);\r\n        fieldContainer.appendChild(input);\r\n\r\n        if (!this.static) {\r\n            this.handleFieldInput(update, input, link);\r\n        }\r\n\r\n        return fieldContainer;\r\n    }\r\n\r\n    override createFieldLink(value: string) {\r\n        const link = document.createElement(\"div\");\r\n        link.textContent = value ? `${value} ${this.unit}` : \"\";\r\n        link.classList.add(\"field-link\");\r\n        link.style.cursor = this.static ? \"default\" : \"text\";\r\n        if (!this.static) {\r\n            link.onclick = (event) => this.modifyField(event);\r\n        }\r\n        return link;\r\n    }\r\n\r\n    override async updateField(update: (value: string) => Promise<void>, input: HTMLInputElement, link: HTMLElement) {\r\n        let value = input.value;\r\n        if (value) {\r\n            await update(value);\r\n            input.style.display = \"none\";\r\n            link.textContent = value ? `${value} ${this.unit}` : \"\";\r\n            link.style.display = \"block\";\r\n        } else {\r\n            await update(input.value);\r\n        }\r\n    }\r\n\r\n    override createFieldInput(value: string) {\r\n        const input = document.createElement(\"input\");\r\n        input.type = \"number\";\r\n        input.value = value || \"\";\r\n        input.classList.add(\"field-input\");\r\n        return input;\r\n    }\r\n}"],"version":3}