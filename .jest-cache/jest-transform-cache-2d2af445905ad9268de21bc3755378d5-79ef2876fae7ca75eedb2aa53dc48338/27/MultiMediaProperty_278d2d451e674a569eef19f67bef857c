99045dcc2863a37645364e291c6e7e0e
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.MultiMediaProperty = void 0;
const Utils_1 = require("../vault/Utils");
const Modals_1 = require("Utils/Modals/Modals");
const MultiFileProperty_1 = require("./MultiFileProperty");
const MediaProperty_1 = require("./MediaProperty");
class MultiMediaProperty extends MultiFileProperty_1.MultiFileProperty {
    constructor(name, args = {}) {
        super(name, [], args);
        this.type = "multiMedia";
        this.flexSpan = 2;
        this.property = new MediaProperty_1.MediaProperty(name, args);
    }
    // Méthode principale pour obtenir l'affichage
    fillDisplay(vault, values, update) {
        this.vault = vault;
        const container = document.createElement("div");
        container.classList.add("metadata-multiFiles-container-" + this.name.toLowerCase());
        container.classList.add("metadata-multiFiles-container");
        // Créer les lignes d'objet
        this.createObjects(values, update, container);
        const addButton = this.createAddButton(values, update, container);
        container.appendChild(addButton);
        return container;
    }
    createObjects(values, update, container) {
        if (!Array.isArray(values) || values.length === 0)
            return;
        values.forEach((objects, index) => {
            const row = this.createObjectRow(values, update, objects, index, container);
            container.appendChild(row);
        });
    }
    createObjectRow(values, update, value, index, container) {
        const row = document.createElement("div");
        row.classList.add("metadata-multiFiles-row-inline");
        // Ajouter le bouton de suppression
        const deleteButton = this.createDeleteButton(values, update, index, container);
        row.appendChild(deleteButton);
        let propertyContainer = document.createElement("div");
        propertyContainer.classList.add("metadata-multiFiles-property-inline");
        propertyContainer.appendChild(this.property.fillDisplay(this.vault, value, async (value) => await this.updateObject(values, update, index, this.property, value)));
        row.appendChild(propertyContainer);
        return row;
    }
    createDeleteButton(values, update, index, container) {
        const deleteButton = document.createElement("button");
        (0, Utils_1.setIcon)(deleteButton, "minus");
        deleteButton.classList.add("metadata-delete-button-inline-small");
        deleteButton.onclick = async () => await this.removeProperty(values, update, index, container);
        return deleteButton;
    }
    async addProperty(values, update, container) {
        let newFile = await (0, Modals_1.selectMedia)(this.vault, "Choisissez un media ");
        if (newFile) {
            if (!values) {
                values = [];
            }
            values.push(`[[${newFile.path}|${newFile.name}]]`);
            await update(values);
            await this.reloadObjects(values, update);
        }
    }
    createAddButton(values, update, container) {
        const addButton = document.createElement("button");
        (0, Utils_1.setIcon)(addButton, "plus");
        addButton.classList.add("metadata-add-button-inline-small");
        addButton.onclick = async () => await this.addProperty(values, update, container);
        return addButton;
    }
    enableDragAndDrop() {
        // Disable drag and drop
    }
}
exports.MultiMediaProperty = MultiMediaProperty;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxzcmNcXHByb3BlcnRpZXNcXE11bHRpTWVkaWFQcm9wZXJ0eS50cyIsIm1hcHBpbmdzIjoiOzs7QUFHQSwwQ0FBeUM7QUFDekMsZ0RBQWtEO0FBR2xELDJEQUF3RDtBQUN4RCxtREFBZ0Q7QUFHaEQsTUFBYSxrQkFBbUIsU0FBUSxxQ0FBaUI7SUFPckQsWUFBWSxJQUFZLEVBQUUsSUFBSSxHQUFHLEVBQUU7UUFDL0IsS0FBSyxDQUFDLElBQUksRUFBRSxFQUFFLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFOVixTQUFJLEdBQVksWUFBWSxDQUFDO1FBRTdCLGFBQVEsR0FBRyxDQUFDLENBQUM7UUFLekIsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLDZCQUFhLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ2xELENBQUM7SUFFRCw4Q0FBOEM7SUFDckMsV0FBVyxDQUFDLEtBQVcsRUFBQyxNQUFXLEVBQUUsTUFBcUM7UUFDL0UsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7UUFDbkIsTUFBTSxTQUFTLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNoRCxTQUFTLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxnQ0FBZ0MsR0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7UUFDbEYsU0FBUyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsK0JBQStCLENBQUMsQ0FBQztRQUV6RCwyQkFBMkI7UUFDM0IsSUFBSSxDQUFDLGFBQWEsQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1FBRTlDLE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxTQUFTLENB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SSxDQUFDLENBQUM7WUFDbkQsTUFBTSxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDckIsTUFBTSxJQUFJLENBQUMsYUFBYSxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQTtRQUM1QyxDQUFDO0lBQ0wsQ0FBQztJQUVRLGVBQWUsQ0FBQyxNQUFXLEVBQUUsTUFBcUMsRUFBRSxTQUF5QjtRQUNsRyxNQUFNLFNBQVMsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ25ELElBQUEsZUFBTyxFQUFDLFNBQVMsRUFBRSxNQUFNLENBQUMsQ0FBQztRQUMzQixTQUFTLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxrQ0FBa0MsQ0FBQyxDQUFDO1FBQzVELFNBQVMsQ0FBQyxPQUFPLEdBQUcsS0FBSyxJQUFJLEVBQUUsQ0FBQyxNQUFNLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxTQUFTLENBQUMsQ0FBQztRQUNsRixPQUFPLFNBQVMsQ0FBQztJQUNyQixDQUFDO0lBRVEsaUJBQWlCO1FBQ3RCLHdCQUF3QjtJQUM1QixDQUFDO0NBQ0o7QUFuRkQsZ0RBbUZDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbGVvZHVcXERvY3VtZW50c1xcMSAtIFByb1xcVGVzdCBwbHVnaW4gb2JzaWRpYW5cXC5vYnNpZGlhblxccGx1Z2luc1xcb2JzaWRpYW4tQ1JNXFxkeW5hbWljLWZpZWxkc1xcc3JjXFxwcm9wZXJ0aWVzXFxNdWx0aU1lZGlhUHJvcGVydHkudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXHJcbmltcG9ydCB7IE9iamVjdFByb3BlcnR5IH0gZnJvbSBcIi4vT2JqZWN0UHJvcGVydHlcIjtcclxuaW1wb3J0IHsgRmlsZVByb3BlcnR5IH0gZnJvbSBcIi4vRmlsZVByb3BlcnR5XCI7XHJcbmltcG9ydCB7IHNldEljb24gfSBmcm9tIFwiLi4vdmF1bHQvVXRpbHNcIjtcclxuaW1wb3J0IHsgc2VsZWN0TWVkaWEgfSBmcm9tIFwiVXRpbHMvTW9kYWxzL01vZGFsc1wiO1xyXG5pbXBvcnQgeyBGaWxlIH0gZnJvbSBcIi4uL3ZhdWx0L0ZpbGVcIjtcclxuaW1wb3J0IHsgTXlWYXVsdCB9IGZyb20gXCIuLi92YXVsdC9NeVZhdWx0XCI7XHJcbmltcG9ydCB7IE11bHRpRmlsZVByb3BlcnR5IH0gZnJvbSBcIi4vTXVsdGlGaWxlUHJvcGVydHlcIjtcclxuaW1wb3J0IHsgTWVkaWFQcm9wZXJ0eSB9IGZyb20gXCIuL01lZGlhUHJvcGVydHlcIjtcclxuXHJcblxyXG5leHBvcnQgY2xhc3MgTXVsdGlNZWRpYVByb3BlcnR5IGV4dGVuZHMgTXVsdGlGaWxlUHJvcGVydHkge1xyXG5cclxuICAgIHB1YmxpYyBvdmVycmlkZSB0eXBlIDogc3RyaW5nID0gXCJtdWx0aU1lZGlhXCI7XHJcbiAgICBwdWJsaWMgb3ZlcnJpZGUgcHJvcGVydHkgOiBNZWRpYVByb3BlcnR5O1xyXG4gICAgcHVibGljIG92ZXJyaWRlIGZsZXhTcGFuID0gMjtcclxuXHJcblxyXG4gICAgY29uc3RydWN0b3IobmFtZTogc3RyaW5nLCBhcmdzID0ge30pe1xyXG4gICAgICAgIHN1cGVyKG5hbWUsIFtdLCBhcmdzKTtcclxuICAgICAgICB0aGlzLnByb3BlcnR5ID0gbmV3IE1lZGlhUHJvcGVydHkobmFtZSwgYXJncyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gTcOpdGhvZGUgcHJpbmNpcGFsZSBwb3VyIG9idGVuaXIgbCdhZmZpY2hhZ2VcclxuICAgIG92ZXJyaWRlIGZpbGxEaXNwbGF5KHZhdWx0IDogYW55LHZhbHVlczogYW55LCB1cGRhdGU6ICh2YWx1ZTogYW55KSA9PiBQcm9taXNlPHZvaWQ+KSB7XHJcbiAgICAgICAgdGhpcy52YXVsdCA9IHZhdWx0O1xyXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJtZXRhZGF0YS1tdWx0aUZpbGVzLWNvbnRhaW5lci1cIit0aGlzLm5hbWUudG9Mb3dlckNhc2UoKSk7XHJcbiAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJtZXRhZGF0YS1tdWx0aUZpbGVzLWNvbnRhaW5lclwiKTtcclxuXHJcbiAgICAgICAgLy8gQ3LDqWVyIGxlcyBsaWduZXMgZCdvYmpldFxyXG4gICAgICAgIHRoaXMuY3JlYXRlT2JqZWN0cyh2YWx1ZXMsIHVwZGF0ZSwgY29udGFpbmVyKTtcclxuXHJcbiAgICAgICAgY29uc3QgYWRkQnV0dG9uID0gdGhpcy5jcmVhdGVBZGRCdXR0b24odmFsdWVzLCB1cGRhdGUsIGNvbnRhaW5lcik7XHJcbiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGFkZEJ1dHRvbik7XHJcblxyXG4gICAgICAgIHJldHVybiBjb250YWluZXI7XHJcbiAgICB9XHJcblxyXG4gICAgb3ZlcnJpZGUgY3JlYXRlT2JqZWN0cyh2YWx1ZXM6IGFueSwgdXBkYXRlOiAodmFsdWU6IGFueSkgPT4gUHJvbWlzZTx2b2lkPiwgY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCkge1xyXG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZXMpIHx8IHZhbHVlcy5sZW5ndGggPT09IDApIHJldHVybjtcclxuICAgICAgICB2YWx1ZXMuZm9yRWFjaCgob2JqZWN0czogYW55LCBpbmRleDogbnVtYmVyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJvdyA9IHRoaXMuY3JlYXRlT2JqZWN0Um93KHZhbHVlcywgdXBkYXRlLCBvYmplY3RzLCBpbmRleCwgY29udGFpbmVyKTtcclxuICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHJvdyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb3ZlcnJpZGUgY3JlYXRlT2JqZWN0Um93KHZhbHVlczogYW55LCB1cGRhdGU6ICh2YWx1ZTogYW55KSA9PiBQcm9taXNlPHZvaWQ+LCB2YWx1ZTogYW55LCBpbmRleDogbnVtYmVyLCBjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogSFRNTERpdkVsZW1lbnQge1xyXG4gICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgcm93LmNsYXNzTGlzdC5hZGQoXCJtZXRhZGF0YS1tdWx0aUZpbGVzLXJvdy1pbmxpbmVcIik7XHJcblxyXG4gICAgICAgIC8vIEFqb3V0ZXIgbGUgYm91dG9uIGRlIHN1cHByZXNzaW9uXHJcbiAgICAgICAgY29uc3QgZGVsZXRlQnV0dG9uID0gdGhpcy5jcmVhdGVEZWxldGVCdXR0b24odmFsdWVzLCB1cGRhdGUsIGluZGV4LCBjb250YWluZXIpO1xyXG4gICAgICAgIHJvdy5hcHBlbmRDaGlsZChkZWxldGVCdXR0b24pO1xyXG5cclxuXHJcbiBcclxuICAgICAgICBsZXQgcHJvcGVydHlDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIHByb3BlcnR5Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJtZXRhZGF0YS1tdWx0aUZpbGVzLXByb3BlcnR5LWlubGluZVwiKTtcclxuICAgICAgICBwcm9wZXJ0eUNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLnByb3BlcnR5LmZpbGxEaXNwbGF5KHRoaXMudmF1bHQsIHZhbHVlLCBhc3luYyAodmFsdWUpID0+IGF3YWl0IHRoaXMudXBkYXRlT2JqZWN0KHZhbHVlcywgdXBkYXRlLCBpbmRleCwgdGhpcy5wcm9wZXJ0eSwgdmFsdWUpKSk7XHJcbiAgICAgICAgcm93LmFwcGVuZENoaWxkKHByb3BlcnR5Q29udGFpbmVyKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJvdztcclxuICAgIH1cclxuXHJcbiAgICBvdmVycmlkZSBjcmVhdGVEZWxldGVCdXR0b24odmFsdWVzOiBhbnksIHVwZGF0ZTogKHZhbHVlOiBhbnkpID0+IFByb21pc2U8dm9pZD4sIGluZGV4OiBudW1iZXIsIGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiBIVE1MQnV0dG9uRWxlbWVudCB7XHJcbiAgICAgICAgY29uc3QgZGVsZXRlQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcclxuICAgICAgICBzZXRJY29uKGRlbGV0ZUJ1dHRvbiwgXCJtaW51c1wiKTtcclxuICAgICAgICBkZWxldGVCdXR0b24uY2xhc3NMaXN0LmFkZChcIm1ldGFkYXRhLWRlbGV0ZS1idXR0b24taW5saW5lLXNtYWxsXCIpO1xyXG4gICAgICAgIGRlbGV0ZUJ1dHRvbi5vbmNsaWNrID0gYXN5bmMgKCkgPT4gYXdhaXQgdGhpcy5yZW1vdmVQcm9wZXJ0eSh2YWx1ZXMsIHVwZGF0ZSwgaW5kZXgsIGNvbnRhaW5lcik7XHJcbiAgICAgICAgcmV0dXJuIGRlbGV0ZUJ1dHRvbjtcclxuICAgIH1cclxuXHJcbiAgICBvdmVycmlkZSBhc3luYyBhZGRQcm9wZXJ0eSh2YWx1ZXM6IGFueSwgdXBkYXRlOiAodmFsdWU6IGFueSkgPT4gUHJvbWlzZTx2b2lkPiwgY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCkge1xyXG4gICAgICAgIGxldCBuZXdGaWxlID0gYXdhaXQgc2VsZWN0TWVkaWEodGhpcy52YXVsdCwgXCJDaG9pc2lzc2V6IHVuIG1lZGlhIFwiKTtcclxuICAgICAgICBpZiAobmV3RmlsZSkge1xyXG4gICAgICAgICAgICBpZiAoIXZhbHVlcyl7dmFsdWVzID0gW119XHJcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKGBbWyR7bmV3RmlsZS5wYXRofXwke25ld0ZpbGUubmFtZX1dXWApO1xyXG4gICAgICAgICAgICBhd2FpdCB1cGRhdGUodmFsdWVzKTtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5yZWxvYWRPYmplY3RzKHZhbHVlcywgdXBkYXRlKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvdmVycmlkZSBjcmVhdGVBZGRCdXR0b24odmFsdWVzOiBhbnksIHVwZGF0ZTogKHZhbHVlOiBhbnkpID0+IFByb21pc2U8dm9pZD4sIGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiBIVE1MQnV0dG9uRWxlbWVudCB7XHJcbiAgICAgICAgY29uc3QgYWRkQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcclxuICAgICAgICBzZXRJY29uKGFkZEJ1dHRvbiwgXCJwbHVzXCIpO1xyXG4gICAgICAgIGFkZEJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwibWV0YWRhdGEtYWRkLWJ1dHRvbi1pbmxpbmUtc21hbGxcIik7XHJcbiAgICAgICAgYWRkQnV0dG9uLm9uY2xpY2sgPSBhc3luYyAoKSA9PiBhd2FpdCB0aGlzLmFkZFByb3BlcnR5KHZhbHVlcywgdXBkYXRlLCBjb250YWluZXIpO1xyXG4gICAgICAgIHJldHVybiBhZGRCdXR0b247XHJcbiAgICB9XHJcblxyXG4gICAgb3ZlcnJpZGUgZW5hYmxlRHJhZ0FuZERyb3AoKSB7XHJcbiAgICAgICAgLy8gRGlzYWJsZSBkcmFnIGFuZCBkcm9wXHJcbiAgICB9XHJcbn0iXSwidmVyc2lvbiI6M30=