12063a5c84b6a1a8970ce288d5489d2d
"use strict";
/**
 * @jest-environment jsdom
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock axios
jest.mock('axios');
// Mock App module
jest.mock('../../vault/Utils', () => ({
    setIcon: jest.fn((element, iconName) => {
        element.setAttribute('data-icon', iconName);
    }),
    default: {},
    TFile: jest.fn(),
    Notice: jest.fn()
}));
const TextProperty_1 = require("../../properties/TextProperty");
describe('TextProperty', () => {
    let textProperty;
    let mockVault;
    let mockFile;
    beforeEach(() => {
        // Reset DOM
        document.body.innerHTML = '';
        // Mock vault with app and files
        mockVault = {
            app: {
                vault: {
                    getFiles: jest.fn(() => [
                        {
                            basename: 'Test File',
                            path: 'test-file.md',
                            name: 'test-file.md',
                            getName: () => 'Test File'
                        },
                        {
                            basename: 'Another File',
                            path: 'another-file.md',
                            name: 'another-file.md',
                            getName: () => 'Another File'
                        }
                    ])
                },
                metadataCache: {
                    getFileCache: jest.fn(() => ({
                        frontmatter: { Classe: 'TestClass' }
                    }))
                },
                workspace: {
                    getLeaf: jest.fn(() => ({
                        openFile: jest.fn()
                    }))
                }
            },
            getFromLink: jest.fn((target) => ({
                file: { path: `${target}.md` }
            }))
        };
        // Mock file
        mockFile = {
            getMetadata: jest.fn(() => ({ testProp: 'test value with [[link]]' })),
            getMetadataValue: jest.fn((key) => key === 'testProp' ? 'test value with [[link]]' : undefined),
            updateMetadata: jest.fn(),
            vault: mockVault
        };
        textProperty = new TextProperty_1.TextProperty('testProp');
        textProperty.vault = mockVault;
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    describe('constructor', () => {
        it('should create TextProperty with correct type', () => {
            const prop = new TextProperty_1.TextProperty('test');
            expect(prop.name).toBe('test');
            expect(prop.type).toBe('text');
        });
        it('should accept additional arguments', () => {
            const args = { icon: 'text', staticProperty: true };
            const prop = new TextProperty_1.TextProperty('test', args);
            expect(prop.name).toBe('test');
            expect(prop.static).toBe(true);
        });
    });
    describe('createFieldInput', () => {
        it('should create textarea element with correct properties', () => {
            const textarea = textProperty.createFieldInput('test content');
            expect(textarea.tagName).toBe('TEXTAREA');
            expect(textarea.value).toBe('test content');
            expect(textarea.classList.contains('field-textarea')).toBe(true);
            expect(textarea.rows).toBe(4);
            expect(textarea.style.resize).toBe('vertical');
        });
        it('should handle empty value', () => {
            const textarea = textProperty.createFieldInput('');
            expect(textarea.value).toBe('');
        });
        it('should setup autocomplete functionality', () => {
            const textarea = textProperty.createFieldInput('test');
            expect(textarea.getAttribute('data-keydown-listener')).toBe('false');
            expect(textarea.oninput).toBeDefined();
            // Test that oninput triggers autocomplete
            const autocompleteSpy = jest.spyOn(textProperty, 'handleAutocomplete').mockImplementation(() => { });
            if (textarea.oninput) {
                textarea.oninput(new Event('input'));
            }
            expect(autocompleteSpy).toHaveBeenCalledWith(textarea);
        });
    });
    describe('createFieldContainer', () => {
        it('should create container with correct class', () => {
            const container = textProperty.createFieldContainer();
            expect(container.tagName).toBe('DIV');
            expect(container.classList.contains('metadata-textfield')).toBe(true);
        });
    });
    describe('createFieldLink', () => {
        it('should create link element with formatted content', () => {
            const content = 'Text with [[internal link|alias]] and [[another link]]';
            const link = textProperty.createFieldLink(content);
            expect(link.tagName).toBe('DIV');
            expect(link.classList.contains('field-textlink')).toBe(true);
            expect(link.innerHTML).toContain('<strong><a href="#">alias</a></strong>');
            expect(link.innerHTML).toContain('<strong><a href="#">another link</a></strong>');
        });
        it('should handle content without links', () => {
            const content = 'Simple text without links';
            const link = textProperty.createFieldLink(content);
            expect(link.innerHTML).toBe(content);
        });
        it('should handle empty content', () => {
            const link = textProperty.createFieldLink('');
            expect(link.innerHTML).toBe('');
        });
        it('should setup click handlers for links', () => {
            const content = 'Text with [[test-file|Test File]]';
            const link = textProperty.createFieldLink(content);
            // Find the anchor element
            const anchor = link.querySelector('a');
            expect(anchor).toBeTruthy();
            // Mock DOM event
            Object.defineProperty(anchor, 'textContent', {
                value: 'Test File',
                writable: true
            });
            // Click the link
            const clickEvent = new MouseEvent('click', { bubbles: true });
            const preventDefaultSpy = jest.spyOn(clickEvent, 'preventDefault');
            anchor?.dispatchEvent(clickEvent);
            expect(preventDefaultSpy).toHaveBeenCalled();
        });
        it('should have correct cursor style based on static property', () => {
            textProperty.static = false;
            const link = textProperty.createFieldLink('test');
            expect(link.style.cursor).toBe('text');
            textProperty.static = true;
            const linkStatic = textProperty.createFieldLink('test');
            expect(linkStatic.style.cursor).toBe('default');
        });
    });
    describe('modifyField', () => {
        it('should toggle visibility between link and textarea', () => {
            // Setup DOM structure for TextProperty
            const field = document.createElement('div');
            field.classList.add('metadata-textfield');
            const link = document.createElement('div');
            link.classList.add('field-textlink');
            link.style.display = 'block';
            const textarea = document.createElement('textarea');
            textarea.classList.add('field-textarea');
            textarea.style.display = 'none';
            field.appendChild(link);
            field.appendChild(textarea);
            document.body.appendChild(field);
            const mockEvent = { target: link };
            textProperty.modifyField(mockEvent);
            expect(link.style.display).toBe('none');
            expect(textarea.style.display).toBe('block');
        });
    });
    describe('handleFieldInput', () => {
        it('should setup event listeners', () => {
            const updateFn = jest.fn();
            const textarea = document.createElement('textarea');
            const link = document.createElement('div');
            textProperty.handleFieldInput(updateFn, textarea, link);
            // Check that onblur and onkeydown are set
            expect(textarea.onblur).toBeDefined();
            expect(textarea.onkeydown).toBeDefined();
        });
        it('should handle blur event when no autocomplete dropdown exists', async () => {
            const updateFn = jest.fn();
            const textarea = document.createElement('textarea');
            const link = document.createElement('div');
            const parent = document.createElement('div');
            parent.appendChild(textarea);
            textarea.value = 'test value';
            textProperty.updateField = jest.fn();
            textProperty.handleFieldInput(updateFn, textarea, link);
            // Trigger blur event via onblur callback
            if (textarea.onblur) {
                await textarea.onblur(new Event('blur'));
            }
            expect(textProperty.updateField).toHaveBeenCalled();
        });
        it('should not handle blur when autocomplete dropdown exists', async () => {
            const updateFn = jest.fn();
            const textarea = document.createElement('textarea');
            const link = document.createElement('div');
            const parent = document.createElement('div');
            const dropdown = document.createElement('div');
            dropdown.classList.add('autocomplete-dropdown');
            parent.appendChild(textarea);
            parent.appendChild(dropdown);
            textProperty.updateField = jest.fn();
            textProperty.handleFieldInput(updateFn, textarea, link);
            // Trigger blur event
            textarea.dispatchEvent(new Event('blur'));
            // Wait for async operation
            await new Promise(resolve => setTimeout(resolve, 0));
            expect(textProperty.updateField).not.toHaveBeenCalled();
        });
        it('should handle Escape key', async () => {
            const updateFn = jest.fn();
            const textarea = document.createElement('textarea');
            const link = document.createElement('div');
            textProperty.updateField = jest.fn();
            textProperty.handleFieldInput(updateFn, textarea, link);
            // Create event with mockable preventDefault
            const preventDefault = jest.fn();
            const event = { key: 'Escape', preventDefault };
            // Trigger the keydown event handler directly via onkeydown
            if (textarea.onkeydown) {
                await textarea.onkeydown(event);
            }
            expect(preventDefault).toHaveBeenCalled();
            expect(textProperty.updateField).toHaveBeenCalled();
        });
    });
    describe('handleAutocomplete', () => {
        let textarea;
        beforeEach(() => {
            textarea = document.createElement('textarea');
            textarea.value = 'test fi';
            textarea.selectionStart = 7;
            textarea.selectionEnd = 7;
            const parent = document.createElement('div');
            parent.appendChild(textarea);
            document.body.appendChild(parent);
        });
        it('should create autocomplete dropdown with suggestions', () => {
            textProperty.handleAutocomplete(textarea);
            const dropdown = textarea.parentElement?.querySelector('.autocomplete-dropdown');
            expect(dropdown).toBeTruthy();
            const items = dropdown?.querySelectorAll('.autocomplete-item');
            expect(items?.length).toBeGreaterThan(0);
        });
        it('should not show dropdown when no query', () => {
            textarea.value = 'test ';
            textarea.selectionStart = 5;
            textProperty.handleAutocomplete(textarea);
            const dropdown = textarea.parentElement?.querySelector('.autocomplete-dropdown');
            expect(dropdown).toBeFalsy();
        });
        it('should not show dropdown when no suggestions', () => {
            // Mock no matching files
            mockVault.app.vault.getFiles.mockReturnValue([]);
            textProperty.handleAutocomplete(textarea);
            const dropdown = textarea.parentElement?.querySelector('.autocomplete-dropdown');
            expect(dropdown).toBeFalsy();
        });
        it('should handle suggestion selection via click', () => {
            const insertSpy = jest.spyOn(textProperty, 'insertSuggestion').mockImplementation(() => { });
            textProperty.handleAutocomplete(textarea);
            const dropdown = textarea.parentElement?.querySelector('.autocomplete-dropdown');
            const firstItem = dropdown?.querySelector('.autocomplete-item');
            // Trigger onclick directly since we're using onclick instead of addEventListener
            if (firstItem && firstItem.onclick) {
                firstItem.onclick(new MouseEvent('click'));
            }
            expect(insertSpy).toHaveBeenCalled();
            expect(dropdown?.parentElement).toBeFalsy(); // Dropdown should be removed
        });
        it('should handle keyboard navigation', () => {
            textProperty.handleAutocomplete(textarea);
            const dropdown = textarea.parentElement?.querySelector('.autocomplete-dropdown');
            expect(dropdown).toBeTruthy();
            // Create event with mockable preventDefault
            const preventDefault = jest.fn();
            const event = { key: 'ArrowDown', preventDefault };
            // Trigger the keydown event handler directly
            const listeners = textarea._eventListeners?.keydown || [];
            if (listeners.length > 0) {
                listeners[0](event);
            }
            expect(preventDefault).toHaveBeenCalled();
            const selectedItem = dropdown?.querySelector('.autocomplete-item.selected');
            expect(selectedItem).toBeTruthy();
        });
        it('should handle Enter key to select suggestion', () => {
            const insertSpy = jest.spyOn(textProperty, 'insertSuggestion').mockImplementation(() => { });
            textProperty.handleAutocomplete(textarea);
            // First select an item with ArrowDown
            const preventDefault1 = jest.fn();
            const arrowDownEvent = { key: 'ArrowDown', preventDefault: preventDefault1 };
            const listeners = textarea._eventListeners?.keydown || [];
            if (listeners.length > 0) {
                listeners[0](arrowDownEvent);
            }
            // Then press Enter - use the second handler (handleEnter)
            const preventDefault2 = jest.fn();
            const enterEvent = { key: 'Enter', preventDefault: preventDefault2 };
            if (listeners.length > 1) {
                listeners[1](enterEvent); // Call handleEnter, not handleKeyDown
            }
            expect(preventDefault2).toHaveBeenCalled();
            expect(insertSpy).toHaveBeenCalled();
        });
        it('should remove dropdown on Escape key', () => {
            textProperty.handleAutocomplete(textarea);
            const dropdown = textarea.parentElement?.querySelector('.autocomplete-dropdown');
            expect(dropdown).toBeTruthy();
            // Create event with mockable preventDefault
            const preventDefault = jest.fn();
            const event = { key: 'Escape', preventDefault };
            // Trigger the keydown event handler directly (handleKeyDown is the first one)
            const listeners = textarea._eventListeners?.keydown || [];
            if (listeners.length > 0) {
                // Call the first keydown listener (handleKeyDown) for Escape
                listeners[0](event);
            }
            expect(dropdown?.parentElement).toBeFalsy();
        });
        it('should remove existing dropdown before creating new one', () => {
            // Create first dropdown
            textProperty.handleAutocomplete(textarea);
            const firstDropdown = textarea.parentElement?.querySelector('.autocomplete-dropdown');
            expect(firstDropdown).toBeTruthy();
            // Create second dropdown (should replace first)
            textProperty.handleAutocomplete(textarea);
            const dropdowns = textarea.parentElement?.querySelectorAll('.autocomplete-dropdown');
            expect(dropdowns?.length).toBe(1);
        });
    });
    describe('insertSuggestion', () => {
        it('should insert suggestion at correct position', () => {
            const textarea = document.createElement('textarea');
            textarea.value = 'test fi more text';
            const setSelectionRangeSpy = jest.spyOn(textarea, 'setSelectionRange');
            const focusSpy = jest.spyOn(textarea, 'focus');
            textProperty.insertSuggestion(textarea, '[[Test File]]', 5, 2);
            expect(textarea.value).toBe('test [[Test File]] more text');
            // Position = 5 (avant) + 13 (longueur de '[[Test File]]') = 18
            expect(setSelectionRangeSpy).toHaveBeenCalledWith(18, 18);
            expect(focusSpy).toHaveBeenCalled();
        });
        it('should handle insertion at beginning', () => {
            const textarea = document.createElement('textarea');
            textarea.value = 'fi more text';
            textProperty.insertSuggestion(textarea, '[[Test File]]', 0, 2);
            expect(textarea.value).toBe('[[Test File]] more text');
        });
        it('should handle insertion at end', () => {
            const textarea = document.createElement('textarea');
            textarea.value = 'test fi';
            textProperty.insertSuggestion(textarea, '[[Test File]]', 5, 2);
            expect(textarea.value).toBe('test [[Test File]]');
        });
    });
    describe('integration with base Property class', () => {
        it('should inherit all base functionality', () => {
            expect(textProperty).toBeInstanceOf(textProperty.constructor);
            expect(textProperty.name).toBe('testProp');
            expect(textProperty.type).toBe('text');
        });
        it('should override createFieldInput method', () => {
            const Property = require('../../properties/Property').Property;
            const baseProperty = new Property('base');
            const textInput = textProperty.createFieldInput('test');
            const baseInput = baseProperty.createFieldInput('test');
            expect(textInput.tagName).toBe('TEXTAREA');
            expect(baseInput.tagName).toBe('INPUT');
        });
        it('should work with getDisplay method', () => {
            textProperty.read = jest.fn(() => 'test content');
            const display = textProperty.getDisplay(mockFile);
            expect(display).toBeTruthy();
            expect(display.classList.contains('metadata-textfield')).toBe(true);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxzcmNcXF9fdGVzdHNfX1xcUHJvcGVydGllc1xcVGV4dFByb3BlcnR5LnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOztHQUVHOztBQUlILGFBQWE7QUFDYixJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBRW5CLGtCQUFrQjtBQUNsQixJQUFJLENBQUMsSUFBSSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDbEMsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxPQUFvQixFQUFFLFFBQWdCLEVBQUUsRUFBRTtRQUN4RCxPQUFPLENBQUMsWUFBWSxDQUFDLFdBQVcsRUFBRSxRQUFRLENBQUMsQ0FBQztJQUNoRCxDQUFDLENBQUM7SUFDRixPQUFPLEVBQUUsRUFBRTtJQUNYLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ2hCLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0NBQ3BCLENBQUMsQ0FBQyxDQUFDO0FBYkosZ0VBQTZEO0FBZTdELFFBQVEsQ0FBQyxjQUFjLEVBQUUsR0FBRyxFQUFFO0lBQzFCLElBQUksWUFBMEIsQ0FBQztJQUMvQixJQUFJLFNBQWMsQ0FBQztJQUNuQixJQUFJLFFBQWEsQ0FBQztJQUVsQixVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ1osWUFBWTtRQUNaLFFBQVEsQ0FBQyxJQUFJLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQztRQUU3QixnQ0FBZ0M7UUFDaEMsU0FBUyxHQUFHO1lBQ1IsR0FBRyxFQUFFO2dCQUNELEtBQUssRUFBRTtvQkFDSCxRQUFRLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQzt3QkFDcEI7NEJBQ0ksUUFBUSxFQUFFLFdBQVc7NEJBQ3JC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QVksQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLENBQUM7WUFFbEQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1lBQzdCLE1BQU0sQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3hFLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGxlb2R1XFxEb2N1bWVudHNcXDEgLSBQcm9cXFRlc3QgcGx1Z2luIG9ic2lkaWFuXFwub2JzaWRpYW5cXHBsdWdpbnNcXG9ic2lkaWFuLUNSTVxcZHluYW1pYy1maWVsZHNcXHNyY1xcX190ZXN0c19fXFxQcm9wZXJ0aWVzXFxUZXh0UHJvcGVydHkudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQGplc3QtZW52aXJvbm1lbnQganNkb21cclxuICovXHJcblxyXG5pbXBvcnQgeyBUZXh0UHJvcGVydHkgfSBmcm9tICcuLi8uLi9wcm9wZXJ0aWVzL1RleHRQcm9wZXJ0eSc7XHJcblxyXG4vLyBNb2NrIGF4aW9zXHJcbmplc3QubW9jaygnYXhpb3MnKTtcclxuXHJcbi8vIE1vY2sgQXBwIG1vZHVsZVxyXG5qZXN0Lm1vY2soJy4uLy4uL3ZhdWx0L1V0aWxzJywgKCkgPT4gKHtcclxuICAgIHNldEljb246IGplc3QuZm4oKGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBpY29uTmFtZTogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtaWNvbicsIGljb25OYW1lKTtcclxuICAgIH0pLFxyXG4gICAgZGVmYXVsdDoge30sXHJcbiAgICBURmlsZTogamVzdC5mbigpLFxyXG4gICAgTm90aWNlOiBqZXN0LmZuKClcclxufSkpO1xyXG5cclxuZGVzY3JpYmUoJ1RleHRQcm9wZXJ0eScsICgpID0+IHtcclxuICAgIGxldCB0ZXh0UHJvcGVydHk6IFRleHRQcm9wZXJ0eTtcclxuICAgIGxldCBtb2NrVmF1bHQ6IGFueTtcclxuICAgIGxldCBtb2NrRmlsZTogYW55O1xyXG5cclxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgIC8vIFJlc2V0IERPTVxyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gTW9jayB2YXVsdCB3aXRoIGFwcCBhbmQgZmlsZXNcclxuICAgICAgICBtb2NrVmF1bHQgPSB7XHJcbiAgICAgICAgICAgIGFwcDoge1xyXG4gICAgICAgICAgICAgICAgdmF1bHQ6IHtcclxuICAgICAgICAgICAgICAgICAgICBnZXRGaWxlczogamVzdC5mbigoKSA9PiBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlbmFtZTogJ1Rlc3QgRmlsZScsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDogJ3Rlc3QtZmlsZS5tZCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAndGVzdC1maWxlLm1kJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldE5hbWU6ICgpID0+ICdUZXN0IEZpbGUnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlbmFtZTogJ0Fub3RoZXIgRmlsZScsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDogJ2Fub3RoZXItZmlsZS5tZCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnYW5vdGhlci1maWxlLm1kJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldE5hbWU6ICgpID0+ICdBbm90aGVyIEZpbGUnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBdKVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG1ldGFkYXRhQ2FjaGU6IHtcclxuICAgICAgICAgICAgICAgICAgICBnZXRGaWxlQ2FjaGU6IGplc3QuZm4oKCkgPT4gKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZnJvbnRtYXR0ZXI6IHsgQ2xhc3NlOiAnVGVzdENsYXNzJyB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgd29ya3NwYWNlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0TGVhZjogamVzdC5mbigoKSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcGVuRmlsZTogamVzdC5mbigpXHJcbiAgICAgICAgICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGdldEZyb21MaW5rOiBqZXN0LmZuKCh0YXJnZXQ6IHN0cmluZykgPT4gKHtcclxuICAgICAgICAgICAgICAgIGZpbGU6IHsgcGF0aDogYCR7dGFyZ2V0fS5tZGAgfVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBNb2NrIGZpbGVcclxuICAgICAgICBtb2NrRmlsZSA9IHtcclxuICAgICAgICAgICAgZ2V0TWV0YWRhdGE6IGplc3QuZm4oKCkgPT4gKHsgdGVzdFByb3A6ICd0ZXN0IHZhbHVlIHdpdGggW1tsaW5rXV0nIH0pKSxcclxuICAgICAgICAgICAgZ2V0TWV0YWRhdGFWYWx1ZTogamVzdC5mbigoa2V5OiBzdHJpbmcpID0+IGtleSA9PT0gJ3Rlc3RQcm9wJyA/ICd0ZXN0IHZhbHVlIHdpdGggW1tsaW5rXV0nIDogdW5kZWZpbmVkKSxcclxuICAgICAgICAgICAgdXBkYXRlTWV0YWRhdGE6IGplc3QuZm4oKSxcclxuICAgICAgICAgICAgdmF1bHQ6IG1vY2tWYXVsdFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRleHRQcm9wZXJ0eSA9IG5ldyBUZXh0UHJvcGVydHkoJ3Rlc3RQcm9wJyk7XHJcbiAgICAgICAgdGV4dFByb3BlcnR5LnZhdWx0ID0gbW9ja1ZhdWx0O1xyXG4gICAgfSk7XHJcblxyXG4gICAgYWZ0ZXJFYWNoKCgpID0+IHtcclxuICAgICAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdjb25zdHJ1Y3RvcicsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBUZXh0UHJvcGVydHkgd2l0aCBjb3JyZWN0IHR5cGUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHByb3AgPSBuZXcgVGV4dFByb3BlcnR5KCd0ZXN0Jyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocHJvcC5uYW1lKS50b0JlKCd0ZXN0Jyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChwcm9wLnR5cGUpLnRvQmUoJ3RleHQnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBhY2NlcHQgYWRkaXRpb25hbCBhcmd1bWVudHMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFyZ3MgPSB7IGljb246ICd0ZXh0Jywgc3RhdGljUHJvcGVydHk6IHRydWUgfTtcclxuICAgICAgICAgICAgY29uc3QgcHJvcCA9IG5ldyBUZXh0UHJvcGVydHkoJ3Rlc3QnLCBhcmdzKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChwcm9wLm5hbWUpLnRvQmUoJ3Rlc3QnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHByb3Auc3RhdGljKS50b0JlKHRydWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2NyZWF0ZUZpZWxkSW5wdXQnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgdGV4dGFyZWEgZWxlbWVudCB3aXRoIGNvcnJlY3QgcHJvcGVydGllcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdGV4dGFyZWEgPSB0ZXh0UHJvcGVydHkuY3JlYXRlRmllbGRJbnB1dCgndGVzdCBjb250ZW50Jyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QodGV4dGFyZWEudGFnTmFtZSkudG9CZSgnVEVYVEFSRUEnKTtcclxuICAgICAgICAgICAgZXhwZWN0KCh0ZXh0YXJlYSBhcyBIVE1MVGV4dEFyZWFFbGVtZW50KS52YWx1ZSkudG9CZSgndGVzdCBjb250ZW50Jyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0ZXh0YXJlYS5jbGFzc0xpc3QuY29udGFpbnMoJ2ZpZWxkLXRleHRhcmVhJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdCgodGV4dGFyZWEgYXMgSFRNTFRleHRBcmVhRWxlbWVudCkucm93cykudG9CZSg0KTtcclxuICAgICAgICAgICAgZXhwZWN0KCh0ZXh0YXJlYSBhcyBIVE1MVGV4dEFyZWFFbGVtZW50KS5zdHlsZS5yZXNpemUpLnRvQmUoJ3ZlcnRpY2FsJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IHZhbHVlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB0ZXh0YXJlYSA9IHRleHRQcm9wZXJ0eS5jcmVhdGVGaWVsZElucHV0KCcnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdCgodGV4dGFyZWEgYXMgSFRNTFRleHRBcmVhRWxlbWVudCkudmFsdWUpLnRvQmUoJycpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHNldHVwIGF1dG9jb21wbGV0ZSBmdW5jdGlvbmFsaXR5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB0ZXh0YXJlYSA9IHRleHRQcm9wZXJ0eS5jcmVhdGVGaWVsZElucHV0KCd0ZXN0Jyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QodGV4dGFyZWEuZ2V0QXR0cmlidXRlKCdkYXRhLWtleWRvd24tbGlzdGVuZXInKSkudG9CZSgnZmFsc2UnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHRleHRhcmVhLm9uaW5wdXQpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBUZXN0IHRoYXQgb25pbnB1dCB0cmlnZ2VycyBhdXRvY29tcGxldGVcclxuICAgICAgICAgICAgY29uc3QgYXV0b2NvbXBsZXRlU3B5ID0gamVzdC5zcHlPbih0ZXh0UHJvcGVydHksICdoYW5kbGVBdXRvY29tcGxldGUnKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge30pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHRleHRhcmVhLm9uaW5wdXQpIHtcclxuICAgICAgICAgICAgICAgIHRleHRhcmVhLm9uaW5wdXQobmV3IEV2ZW50KCdpbnB1dCcpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGF1dG9jb21wbGV0ZVNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgodGV4dGFyZWEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2NyZWF0ZUZpZWxkQ29udGFpbmVyJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIGNvbnRhaW5lciB3aXRoIGNvcnJlY3QgY2xhc3MnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRleHRQcm9wZXJ0eS5jcmVhdGVGaWVsZENvbnRhaW5lcigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci50YWdOYW1lKS50b0JlKCdESVYnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci5jbGFzc0xpc3QuY29udGFpbnMoJ21ldGFkYXRhLXRleHRmaWVsZCcpKS50b0JlKHRydWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2NyZWF0ZUZpZWxkTGluaycsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBsaW5rIGVsZW1lbnQgd2l0aCBmb3JtYXR0ZWQgY29udGVudCcsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29udGVudCA9ICdUZXh0IHdpdGggW1tpbnRlcm5hbCBsaW5rfGFsaWFzXV0gYW5kIFtbYW5vdGhlciBsaW5rXV0nO1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gdGV4dFByb3BlcnR5LmNyZWF0ZUZpZWxkTGluayhjb250ZW50KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rLnRhZ05hbWUpLnRvQmUoJ0RJVicpO1xyXG4gICAgICAgICAgICBleHBlY3QobGluay5jbGFzc0xpc3QuY29udGFpbnMoJ2ZpZWxkLXRleHRsaW5rJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rLmlubmVySFRNTCkudG9Db250YWluKCc8c3Ryb25nPjxhIGhyZWY9XCIjXCI+YWxpYXM8L2E+PC9zdHJvbmc+Jyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rLmlubmVySFRNTCkudG9Db250YWluKCc8c3Ryb25nPjxhIGhyZWY9XCIjXCI+YW5vdGhlciBsaW5rPC9hPjwvc3Ryb25nPicpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb250ZW50IHdpdGhvdXQgbGlua3MnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSAnU2ltcGxlIHRleHQgd2l0aG91dCBsaW5rcyc7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSB0ZXh0UHJvcGVydHkuY3JlYXRlRmllbGRMaW5rKGNvbnRlbnQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmsuaW5uZXJIVE1MKS50b0JlKGNvbnRlbnQpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBjb250ZW50JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gdGV4dFByb3BlcnR5LmNyZWF0ZUZpZWxkTGluaygnJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QobGluay5pbm5lckhUTUwpLnRvQmUoJycpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHNldHVwIGNsaWNrIGhhbmRsZXJzIGZvciBsaW5rcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29udGVudCA9ICdUZXh0IHdpdGggW1t0ZXN0LWZpbGV8VGVzdCBGaWxlXV0nO1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gdGV4dFByb3BlcnR5LmNyZWF0ZUZpZWxkTGluayhjb250ZW50KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEZpbmQgdGhlIGFuY2hvciBlbGVtZW50XHJcbiAgICAgICAgICAgIGNvbnN0IGFuY2hvciA9IGxpbmsucXVlcnlTZWxlY3RvcignYScpO1xyXG4gICAgICAgICAgICBleHBlY3QoYW5jaG9yKS50b0JlVHJ1dGh5KCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBNb2NrIERPTSBldmVudFxyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoYW5jaG9yLCAndGV4dENvbnRlbnQnLCB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogJ1Rlc3QgRmlsZScsXHJcbiAgICAgICAgICAgICAgICB3cml0YWJsZTogdHJ1ZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIENsaWNrIHRoZSBsaW5rXHJcbiAgICAgICAgICAgIGNvbnN0IGNsaWNrRXZlbnQgPSBuZXcgTW91c2VFdmVudCgnY2xpY2snLCB7IGJ1YmJsZXM6IHRydWUgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHByZXZlbnREZWZhdWx0U3B5ID0gamVzdC5zcHlPbihjbGlja0V2ZW50LCAncHJldmVudERlZmF1bHQnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGFuY2hvcj8uZGlzcGF0Y2hFdmVudChjbGlja0V2ZW50KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChwcmV2ZW50RGVmYXVsdFNweSkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhdmUgY29ycmVjdCBjdXJzb3Igc3R5bGUgYmFzZWQgb24gc3RhdGljIHByb3BlcnR5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0ZXh0UHJvcGVydHkuc3RhdGljID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSB0ZXh0UHJvcGVydHkuY3JlYXRlRmllbGRMaW5rKCd0ZXN0Jyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rLnN0eWxlLmN1cnNvcikudG9CZSgndGV4dCcpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGV4dFByb3BlcnR5LnN0YXRpYyA9IHRydWU7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmtTdGF0aWMgPSB0ZXh0UHJvcGVydHkuY3JlYXRlRmllbGRMaW5rKCd0ZXN0Jyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rU3RhdGljLnN0eWxlLmN1cnNvcikudG9CZSgnZGVmYXVsdCcpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ21vZGlmeUZpZWxkJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgdG9nZ2xlIHZpc2liaWxpdHkgYmV0d2VlbiBsaW5rIGFuZCB0ZXh0YXJlYScsICgpID0+IHtcclxuICAgICAgICAgICAgLy8gU2V0dXAgRE9NIHN0cnVjdHVyZSBmb3IgVGV4dFByb3BlcnR5XHJcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGZpZWxkLmNsYXNzTGlzdC5hZGQoJ21ldGFkYXRhLXRleHRmaWVsZCcpO1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGxpbmsuY2xhc3NMaXN0LmFkZCgnZmllbGQtdGV4dGxpbmsnKTtcclxuICAgICAgICAgICAgbGluay5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcclxuICAgICAgICAgICAgY29uc3QgdGV4dGFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpO1xyXG4gICAgICAgICAgICB0ZXh0YXJlYS5jbGFzc0xpc3QuYWRkKCdmaWVsZC10ZXh0YXJlYScpO1xyXG4gICAgICAgICAgICB0ZXh0YXJlYS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZmllbGQuYXBwZW5kQ2hpbGQobGluayk7XHJcbiAgICAgICAgICAgIGZpZWxkLmFwcGVuZENoaWxkKHRleHRhcmVhKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChmaWVsZCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBtb2NrRXZlbnQgPSB7IHRhcmdldDogbGluayB9IGFzIHVua25vd24gYXMgRXZlbnQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0ZXh0UHJvcGVydHkubW9kaWZ5RmllbGQobW9ja0V2ZW50KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rLnN0eWxlLmRpc3BsYXkpLnRvQmUoJ25vbmUnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHRleHRhcmVhLnN0eWxlLmRpc3BsYXkpLnRvQmUoJ2Jsb2NrJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnaGFuZGxlRmllbGRJbnB1dCcsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIHNldHVwIGV2ZW50IGxpc3RlbmVycycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlRm4gPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRleHRhcmVhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGV4dGFyZWEnKSBhcyBIVE1MVGV4dEFyZWFFbGVtZW50O1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0ZXh0UHJvcGVydHkuaGFuZGxlRmllbGRJbnB1dCh1cGRhdGVGbiwgdGV4dGFyZWEsIGxpbmspO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gQ2hlY2sgdGhhdCBvbmJsdXIgYW5kIG9ua2V5ZG93biBhcmUgc2V0XHJcbiAgICAgICAgICAgIGV4cGVjdCh0ZXh0YXJlYS5vbmJsdXIpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0ZXh0YXJlYS5vbmtleWRvd24pLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGJsdXIgZXZlbnQgd2hlbiBubyBhdXRvY29tcGxldGUgZHJvcGRvd24gZXhpc3RzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVGbiA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgY29uc3QgdGV4dGFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpIGFzIEhUTUxUZXh0QXJlYUVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29uc3QgcGFyZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIHBhcmVudC5hcHBlbmRDaGlsZCh0ZXh0YXJlYSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0ZXh0YXJlYS52YWx1ZSA9ICd0ZXN0IHZhbHVlJztcclxuICAgICAgICAgICAgdGV4dFByb3BlcnR5LnVwZGF0ZUZpZWxkID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGV4dFByb3BlcnR5LmhhbmRsZUZpZWxkSW5wdXQodXBkYXRlRm4sIHRleHRhcmVhLCBsaW5rKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFRyaWdnZXIgYmx1ciBldmVudCB2aWEgb25ibHVyIGNhbGxiYWNrXHJcbiAgICAgICAgICAgIGlmICh0ZXh0YXJlYS5vbmJsdXIpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHRleHRhcmVhLm9uYmx1cihuZXcgRXZlbnQoJ2JsdXInKSBhcyBhbnkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QodGV4dFByb3BlcnR5LnVwZGF0ZUZpZWxkKS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgbm90IGhhbmRsZSBibHVyIHdoZW4gYXV0b2NvbXBsZXRlIGRyb3Bkb3duIGV4aXN0cycsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlRm4gPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRleHRhcmVhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGV4dGFyZWEnKSBhcyBIVE1MVGV4dEFyZWFFbGVtZW50O1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBjb25zdCBkcm9wZG93biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBkcm9wZG93bi5jbGFzc0xpc3QuYWRkKCdhdXRvY29tcGxldGUtZHJvcGRvd24nKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHBhcmVudC5hcHBlbmRDaGlsZCh0ZXh0YXJlYSk7XHJcbiAgICAgICAgICAgIHBhcmVudC5hcHBlbmRDaGlsZChkcm9wZG93bik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0ZXh0UHJvcGVydHkudXBkYXRlRmllbGQgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0ZXh0UHJvcGVydHkuaGFuZGxlRmllbGRJbnB1dCh1cGRhdGVGbiwgdGV4dGFyZWEsIGxpbmspO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVHJpZ2dlciBibHVyIGV2ZW50XHJcbiAgICAgICAgICAgIHRleHRhcmVhLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdibHVyJykpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gV2FpdCBmb3IgYXN5bmMgb3BlcmF0aW9uXHJcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAwKSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QodGV4dFByb3BlcnR5LnVwZGF0ZUZpZWxkKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBFc2NhcGUga2V5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVGbiA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgY29uc3QgdGV4dGFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpIGFzIEhUTUxUZXh0QXJlYUVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRleHRQcm9wZXJ0eS51cGRhdGVGaWVsZCA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRleHRQcm9wZXJ0eS5oYW5kbGVGaWVsZElucHV0KHVwZGF0ZUZuLCB0ZXh0YXJlYSwgbGluayk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBDcmVhdGUgZXZlbnQgd2l0aCBtb2NrYWJsZSBwcmV2ZW50RGVmYXVsdFxyXG4gICAgICAgICAgICBjb25zdCBwcmV2ZW50RGVmYXVsdCA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSB7IGtleTogJ0VzY2FwZScsIHByZXZlbnREZWZhdWx0IH0gYXMgYW55O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVHJpZ2dlciB0aGUga2V5ZG93biBldmVudCBoYW5kbGVyIGRpcmVjdGx5IHZpYSBvbmtleWRvd25cclxuICAgICAgICAgICAgaWYgKHRleHRhcmVhLm9ua2V5ZG93bikge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGV4dGFyZWEub25rZXlkb3duKGV2ZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHByZXZlbnREZWZhdWx0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0ZXh0UHJvcGVydHkudXBkYXRlRmllbGQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdoYW5kbGVBdXRvY29tcGxldGUnLCAoKSA9PiB7XHJcbiAgICAgICAgbGV0IHRleHRhcmVhOiBIVE1MVGV4dEFyZWFFbGVtZW50O1xyXG5cclxuICAgICAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICAgICAgdGV4dGFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpO1xyXG4gICAgICAgICAgICB0ZXh0YXJlYS52YWx1ZSA9ICd0ZXN0IGZpJztcclxuICAgICAgICAgICAgdGV4dGFyZWEuc2VsZWN0aW9uU3RhcnQgPSA3O1xyXG4gICAgICAgICAgICB0ZXh0YXJlYS5zZWxlY3Rpb25FbmQgPSA3O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcGFyZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIHBhcmVudC5hcHBlbmRDaGlsZCh0ZXh0YXJlYSk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocGFyZW50KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgYXV0b2NvbXBsZXRlIGRyb3Bkb3duIHdpdGggc3VnZ2VzdGlvbnMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRleHRQcm9wZXJ0eS5oYW5kbGVBdXRvY29tcGxldGUodGV4dGFyZWEpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgZHJvcGRvd24gPSB0ZXh0YXJlYS5wYXJlbnRFbGVtZW50Py5xdWVyeVNlbGVjdG9yKCcuYXV0b2NvbXBsZXRlLWRyb3Bkb3duJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChkcm9wZG93bikudG9CZVRydXRoeSgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgaXRlbXMgPSBkcm9wZG93bj8ucXVlcnlTZWxlY3RvckFsbCgnLmF1dG9jb21wbGV0ZS1pdGVtJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChpdGVtcz8ubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgbm90IHNob3cgZHJvcGRvd24gd2hlbiBubyBxdWVyeScsICgpID0+IHtcclxuICAgICAgICAgICAgdGV4dGFyZWEudmFsdWUgPSAndGVzdCAnO1xyXG4gICAgICAgICAgICB0ZXh0YXJlYS5zZWxlY3Rpb25TdGFydCA9IDU7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0ZXh0UHJvcGVydHkuaGFuZGxlQXV0b2NvbXBsZXRlKHRleHRhcmVhKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGRyb3Bkb3duID0gdGV4dGFyZWEucGFyZW50RWxlbWVudD8ucXVlcnlTZWxlY3RvcignLmF1dG9jb21wbGV0ZS1kcm9wZG93bicpO1xyXG4gICAgICAgICAgICBleHBlY3QoZHJvcGRvd24pLnRvQmVGYWxzeSgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIG5vdCBzaG93IGRyb3Bkb3duIHdoZW4gbm8gc3VnZ2VzdGlvbnMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIE1vY2sgbm8gbWF0Y2hpbmcgZmlsZXNcclxuICAgICAgICAgICAgbW9ja1ZhdWx0LmFwcC52YXVsdC5nZXRGaWxlcy5tb2NrUmV0dXJuVmFsdWUoW10pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGV4dFByb3BlcnR5LmhhbmRsZUF1dG9jb21wbGV0ZSh0ZXh0YXJlYSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBkcm9wZG93biA9IHRleHRhcmVhLnBhcmVudEVsZW1lbnQ/LnF1ZXJ5U2VsZWN0b3IoJy5hdXRvY29tcGxldGUtZHJvcGRvd24nKTtcclxuICAgICAgICAgICAgZXhwZWN0KGRyb3Bkb3duKS50b0JlRmFsc3koKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgc3VnZ2VzdGlvbiBzZWxlY3Rpb24gdmlhIGNsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpbnNlcnRTcHkgPSBqZXN0LnNweU9uKHRleHRQcm9wZXJ0eSwgJ2luc2VydFN1Z2dlc3Rpb24nKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge30pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGV4dFByb3BlcnR5LmhhbmRsZUF1dG9jb21wbGV0ZSh0ZXh0YXJlYSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBkcm9wZG93biA9IHRleHRhcmVhLnBhcmVudEVsZW1lbnQ/LnF1ZXJ5U2VsZWN0b3IoJy5hdXRvY29tcGxldGUtZHJvcGRvd24nKTtcclxuICAgICAgICAgICAgY29uc3QgZmlyc3RJdGVtID0gZHJvcGRvd24/LnF1ZXJ5U2VsZWN0b3IoJy5hdXRvY29tcGxldGUtaXRlbScpIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVHJpZ2dlciBvbmNsaWNrIGRpcmVjdGx5IHNpbmNlIHdlJ3JlIHVzaW5nIG9uY2xpY2sgaW5zdGVhZCBvZiBhZGRFdmVudExpc3RlbmVyXHJcbiAgICAgICAgICAgIGlmIChmaXJzdEl0ZW0gJiYgZmlyc3RJdGVtLm9uY2xpY2spIHtcclxuICAgICAgICAgICAgICAgIGZpcnN0SXRlbS5vbmNsaWNrKG5ldyBNb3VzZUV2ZW50KCdjbGljaycpIGFzIGFueSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChpbnNlcnRTcHkpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgICAgICAgICAgZXhwZWN0KGRyb3Bkb3duPy5wYXJlbnRFbGVtZW50KS50b0JlRmFsc3koKTsgLy8gRHJvcGRvd24gc2hvdWxkIGJlIHJlbW92ZWRcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUga2V5Ym9hcmQgbmF2aWdhdGlvbicsICgpID0+IHtcclxuICAgICAgICAgICAgdGV4dFByb3BlcnR5LmhhbmRsZUF1dG9jb21wbGV0ZSh0ZXh0YXJlYSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBkcm9wZG93biA9IHRleHRhcmVhLnBhcmVudEVsZW1lbnQ/LnF1ZXJ5U2VsZWN0b3IoJy5hdXRvY29tcGxldGUtZHJvcGRvd24nKTtcclxuICAgICAgICAgICAgZXhwZWN0KGRyb3Bkb3duKS50b0JlVHJ1dGh5KCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBDcmVhdGUgZXZlbnQgd2l0aCBtb2NrYWJsZSBwcmV2ZW50RGVmYXVsdFxyXG4gICAgICAgICAgICBjb25zdCBwcmV2ZW50RGVmYXVsdCA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSB7IGtleTogJ0Fycm93RG93bicsIHByZXZlbnREZWZhdWx0IH0gYXMgYW55O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVHJpZ2dlciB0aGUga2V5ZG93biBldmVudCBoYW5kbGVyIGRpcmVjdGx5XHJcbiAgICAgICAgICAgIGNvbnN0IGxpc3RlbmVycyA9ICh0ZXh0YXJlYSBhcyBhbnkpLl9ldmVudExpc3RlbmVycz8ua2V5ZG93biB8fCBbXTtcclxuICAgICAgICAgICAgaWYgKGxpc3RlbmVycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBsaXN0ZW5lcnNbMF0oZXZlbnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocHJldmVudERlZmF1bHQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkSXRlbSA9IGRyb3Bkb3duPy5xdWVyeVNlbGVjdG9yKCcuYXV0b2NvbXBsZXRlLWl0ZW0uc2VsZWN0ZWQnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHNlbGVjdGVkSXRlbSkudG9CZVRydXRoeSgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBFbnRlciBrZXkgdG8gc2VsZWN0IHN1Z2dlc3Rpb24nLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGluc2VydFNweSA9IGplc3Quc3B5T24odGV4dFByb3BlcnR5LCAnaW5zZXJ0U3VnZ2VzdGlvbicpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7fSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0ZXh0UHJvcGVydHkuaGFuZGxlQXV0b2NvbXBsZXRlKHRleHRhcmVhKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEZpcnN0IHNlbGVjdCBhbiBpdGVtIHdpdGggQXJyb3dEb3duXHJcbiAgICAgICAgICAgIGNvbnN0IHByZXZlbnREZWZhdWx0MSA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgY29uc3QgYXJyb3dEb3duRXZlbnQgPSB7IGtleTogJ0Fycm93RG93bicsIHByZXZlbnREZWZhdWx0OiBwcmV2ZW50RGVmYXVsdDEgfSBhcyBhbnk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpc3RlbmVycyA9ICh0ZXh0YXJlYSBhcyBhbnkpLl9ldmVudExpc3RlbmVycz8ua2V5ZG93biB8fCBbXTtcclxuICAgICAgICAgICAgaWYgKGxpc3RlbmVycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBsaXN0ZW5lcnNbMF0oYXJyb3dEb3duRXZlbnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBUaGVuIHByZXNzIEVudGVyIC0gdXNlIHRoZSBzZWNvbmQgaGFuZGxlciAoaGFuZGxlRW50ZXIpXHJcbiAgICAgICAgICAgIGNvbnN0IHByZXZlbnREZWZhdWx0MiA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgY29uc3QgZW50ZXJFdmVudCA9IHsga2V5OiAnRW50ZXInLCBwcmV2ZW50RGVmYXVsdDogcHJldmVudERlZmF1bHQyIH0gYXMgYW55O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKGxpc3RlbmVycy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgICAgICBsaXN0ZW5lcnNbMV0oZW50ZXJFdmVudCk7IC8vIENhbGwgaGFuZGxlRW50ZXIsIG5vdCBoYW5kbGVLZXlEb3duXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChwcmV2ZW50RGVmYXVsdDIpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgICAgICAgICAgZXhwZWN0KGluc2VydFNweSkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJlbW92ZSBkcm9wZG93biBvbiBFc2NhcGUga2V5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0ZXh0UHJvcGVydHkuaGFuZGxlQXV0b2NvbXBsZXRlKHRleHRhcmVhKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGRyb3Bkb3duID0gdGV4dGFyZWEucGFyZW50RWxlbWVudD8ucXVlcnlTZWxlY3RvcignLmF1dG9jb21wbGV0ZS1kcm9wZG93bicpO1xyXG4gICAgICAgICAgICBleHBlY3QoZHJvcGRvd24pLnRvQmVUcnV0aHkoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIENyZWF0ZSBldmVudCB3aXRoIG1vY2thYmxlIHByZXZlbnREZWZhdWx0XHJcbiAgICAgICAgICAgIGNvbnN0IHByZXZlbnREZWZhdWx0ID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBjb25zdCBldmVudCA9IHsga2V5OiAnRXNjYXBlJywgcHJldmVudERlZmF1bHQgfSBhcyBhbnk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBUcmlnZ2VyIHRoZSBrZXlkb3duIGV2ZW50IGhhbmRsZXIgZGlyZWN0bHkgKGhhbmRsZUtleURvd24gaXMgdGhlIGZpcnN0IG9uZSlcclxuICAgICAgICAgICAgY29uc3QgbGlzdGVuZXJzID0gKHRleHRhcmVhIGFzIGFueSkuX2V2ZW50TGlzdGVuZXJzPy5rZXlkb3duIHx8IFtdO1xyXG4gICAgICAgICAgICBpZiAobGlzdGVuZXJzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIC8vIENhbGwgdGhlIGZpcnN0IGtleWRvd24gbGlzdGVuZXIgKGhhbmRsZUtleURvd24pIGZvciBFc2NhcGVcclxuICAgICAgICAgICAgICAgIGxpc3RlbmVyc1swXShldmVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChkcm9wZG93bj8ucGFyZW50RWxlbWVudCkudG9CZUZhbHN5KCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmVtb3ZlIGV4aXN0aW5nIGRyb3Bkb3duIGJlZm9yZSBjcmVhdGluZyBuZXcgb25lJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBDcmVhdGUgZmlyc3QgZHJvcGRvd25cclxuICAgICAgICAgICAgdGV4dFByb3BlcnR5LmhhbmRsZUF1dG9jb21wbGV0ZSh0ZXh0YXJlYSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGZpcnN0RHJvcGRvd24gPSB0ZXh0YXJlYS5wYXJlbnRFbGVtZW50Py5xdWVyeVNlbGVjdG9yKCcuYXV0b2NvbXBsZXRlLWRyb3Bkb3duJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChmaXJzdERyb3Bkb3duKS50b0JlVHJ1dGh5KCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBDcmVhdGUgc2Vjb25kIGRyb3Bkb3duIChzaG91bGQgcmVwbGFjZSBmaXJzdClcclxuICAgICAgICAgICAgdGV4dFByb3BlcnR5LmhhbmRsZUF1dG9jb21wbGV0ZSh0ZXh0YXJlYSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGRyb3Bkb3ducyA9IHRleHRhcmVhLnBhcmVudEVsZW1lbnQ/LnF1ZXJ5U2VsZWN0b3JBbGwoJy5hdXRvY29tcGxldGUtZHJvcGRvd24nKTtcclxuICAgICAgICAgICAgZXhwZWN0KGRyb3Bkb3ducz8ubGVuZ3RoKS50b0JlKDEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2luc2VydFN1Z2dlc3Rpb24nLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBpbnNlcnQgc3VnZ2VzdGlvbiBhdCBjb3JyZWN0IHBvc2l0aW9uJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB0ZXh0YXJlYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJykgYXMgSFRNTFRleHRBcmVhRWxlbWVudDtcclxuICAgICAgICAgICAgdGV4dGFyZWEudmFsdWUgPSAndGVzdCBmaSBtb3JlIHRleHQnO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3Qgc2V0U2VsZWN0aW9uUmFuZ2VTcHkgPSBqZXN0LnNweU9uKHRleHRhcmVhLCAnc2V0U2VsZWN0aW9uUmFuZ2UnKTtcclxuICAgICAgICAgICAgY29uc3QgZm9jdXNTcHkgPSBqZXN0LnNweU9uKHRleHRhcmVhLCAnZm9jdXMnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRleHRQcm9wZXJ0eS5pbnNlcnRTdWdnZXN0aW9uKHRleHRhcmVhLCAnW1tUZXN0IEZpbGVdXScsIDUsIDIpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHRleHRhcmVhLnZhbHVlKS50b0JlKCd0ZXN0IFtbVGVzdCBGaWxlXV0gbW9yZSB0ZXh0Jyk7XHJcbiAgICAgICAgICAgIC8vIFBvc2l0aW9uID0gNSAoYXZhbnQpICsgMTMgKGxvbmd1ZXVyIGRlICdbW1Rlc3QgRmlsZV1dJykgPSAxOFxyXG4gICAgICAgICAgICBleHBlY3Qoc2V0U2VsZWN0aW9uUmFuZ2VTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDE4LCAxOCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChmb2N1c1NweSkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBpbnNlcnRpb24gYXQgYmVnaW5uaW5nJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB0ZXh0YXJlYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJykgYXMgSFRNTFRleHRBcmVhRWxlbWVudDtcclxuICAgICAgICAgICAgdGV4dGFyZWEudmFsdWUgPSAnZmkgbW9yZSB0ZXh0JztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRleHRQcm9wZXJ0eS5pbnNlcnRTdWdnZXN0aW9uKHRleHRhcmVhLCAnW1tUZXN0IEZpbGVdXScsIDAsIDIpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHRleHRhcmVhLnZhbHVlKS50b0JlKCdbW1Rlc3QgRmlsZV1dIG1vcmUgdGV4dCcpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBpbnNlcnRpb24gYXQgZW5kJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB0ZXh0YXJlYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJykgYXMgSFRNTFRleHRBcmVhRWxlbWVudDtcclxuICAgICAgICAgICAgdGV4dGFyZWEudmFsdWUgPSAndGVzdCBmaSc7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0ZXh0UHJvcGVydHkuaW5zZXJ0U3VnZ2VzdGlvbih0ZXh0YXJlYSwgJ1tbVGVzdCBGaWxlXV0nLCA1LCAyKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdCh0ZXh0YXJlYS52YWx1ZSkudG9CZSgndGVzdCBbW1Rlc3QgRmlsZV1dJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnaW50ZWdyYXRpb24gd2l0aCBiYXNlIFByb3BlcnR5IGNsYXNzJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgaW5oZXJpdCBhbGwgYmFzZSBmdW5jdGlvbmFsaXR5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QodGV4dFByb3BlcnR5KS50b0JlSW5zdGFuY2VPZih0ZXh0UHJvcGVydHkuY29uc3RydWN0b3IpO1xyXG4gICAgICAgICAgICBleHBlY3QodGV4dFByb3BlcnR5Lm5hbWUpLnRvQmUoJ3Rlc3RQcm9wJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0ZXh0UHJvcGVydHkudHlwZSkudG9CZSgndGV4dCcpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIG92ZXJyaWRlIGNyZWF0ZUZpZWxkSW5wdXQgbWV0aG9kJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBQcm9wZXJ0eSA9IHJlcXVpcmUoJy4uLy4uL3Byb3BlcnRpZXMvUHJvcGVydHknKS5Qcm9wZXJ0eTtcclxuICAgICAgICAgICAgY29uc3QgYmFzZVByb3BlcnR5ID0gbmV3IFByb3BlcnR5KCdiYXNlJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRleHRJbnB1dCA9IHRleHRQcm9wZXJ0eS5jcmVhdGVGaWVsZElucHV0KCd0ZXN0Jyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGJhc2VJbnB1dCA9IGJhc2VQcm9wZXJ0eS5jcmVhdGVGaWVsZElucHV0KCd0ZXN0Jyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QodGV4dElucHV0LnRhZ05hbWUpLnRvQmUoJ1RFWFRBUkVBJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChiYXNlSW5wdXQudGFnTmFtZSkudG9CZSgnSU5QVVQnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCB3b3JrIHdpdGggZ2V0RGlzcGxheSBtZXRob2QnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRleHRQcm9wZXJ0eS5yZWFkID0gamVzdC5mbigoKSA9PiAndGVzdCBjb250ZW50Jyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBkaXNwbGF5ID0gdGV4dFByb3BlcnR5LmdldERpc3BsYXkobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGRpc3BsYXkpLnRvQmVUcnV0aHkoKTtcclxuICAgICAgICAgICAgZXhwZWN0KGRpc3BsYXkuY2xhc3NMaXN0LmNvbnRhaW5zKCdtZXRhZGF0YS10ZXh0ZmllbGQnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59KTsiXSwidmVyc2lvbiI6M30=