1d9db089f7661114173542c73c53b128
"use strict";
/**
 * @jest-environment jsdom
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock App module
jest.mock('../../src/vault/Utils', () => ({
    setIcon: jest.fn((element, iconName) => {
        element.setAttribute('data-icon', iconName);
    }),
    sendNotice: jest.fn(),
    Notice: jest.fn()
}));
// Mock Vault
jest.mock('../../src/vault/Vault', () => ({
    Vault: jest.fn()
}));
const EmailProperty_1 = require("../../src/properties/EmailProperty");
const LinkProperty_1 = require("../../src/properties/LinkProperty");
describe('EmailProperty', () => {
    let emailProperty;
    let mockVault;
    let mockFile;
    beforeEach(() => {
        // Reset DOM
        document.body.innerHTML = '';
        // Mock vault
        mockVault = {
            app: {
                vault: { getFiles: jest.fn(() => []) },
                setIcon: jest.fn((element, iconName) => {
                    element.setAttribute('data-icon', iconName);
                    element.textContent = `[${iconName}]`;
                })
            }
        };
        // Mock file
        mockFile = {
            getMetadata: jest.fn(() => ({ email: 'test@example.com' })),
            getMetadataValue: jest.fn((key) => key === 'email' ? 'test@example.com' : undefined),
            updateMetadata: jest.fn(),
            vault: mockVault
        };
        emailProperty = new EmailProperty_1.EmailProperty('email', mockVault);
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    describe('constructor', () => {
        it('should create EmailProperty with correct type and default icon', () => {
            const prop = new EmailProperty_1.EmailProperty('test', mockVault, mockVault);
            expect(prop.name).toBe('test');
            expect(prop.type).toBe('email');
            expect(prop.icon).toBe('mail');
        });
        it('should inherit from LinkProperty', () => {
            expect(emailProperty).toBeInstanceOf(LinkProperty_1.LinkProperty);
            expect(emailProperty).toBeInstanceOf(EmailProperty_1.EmailProperty);
        });
        it('should accept custom arguments', () => {
            const args = { icon: 'custom-mail', staticProperty: true };
            const prop = new EmailProperty_1.EmailProperty('custom', mockVault, args);
            expect(prop.name).toBe('custom');
            expect(prop.static).toBe(true);
            expect(prop.icon).toBe('custom-mail');
        });
    });
    describe('validate', () => {
        it('should validate correct email addresses', () => {
            const validEmails = [
                'test@example.com',
                'user.name@domain.org',
                'firstname+lastname@company.co.uk',
                'admin@sub.domain.com',
                'user123@test-site.net',
                'contact@example-site.fr',
                'info@domain.museum',
                '123@domain.com', // Numbers in local part are OK
                'user..name@domain.com', // This regex allows consecutive dots in local part
                'user@domain..com', // This regex also allows consecutive dots in domain
                'user_name@domain.com',
                'user-name@domain.com',
                'user%name@domain.com'
            ];
            validEmails.forEach(email => {
                expect(emailProperty.validate(email)).toBe(email);
            });
        });
        it('should reject invalid email addresses', () => {
            const invalidEmails = [
                'invalid.email', // No @
                '@example.com', // Missing local part
                'user@', // Missing domain
                'user@domain', // Missing TLD
                'user@domain.c', // TLD too short (less than 2 chars)
                'user name@domain.com', // Space in local part
                'user@domain .com', // Space in domain
                '', // Empty string
                '   ', // Whitespace only
                'user@domain@com', // Multiple @
                'user@@domain.com', // Multiple @
                '123@456.789', // TLD must be letters only
                'user@123.456.789.012', // IP-like format not valid
                'user@domain.123' // TLD is numbers
            ];
            invalidEmails.forEach(email => {
                const result = emailProperty.validate(email);
                expect(result).toBe('');
            });
        });
        it('should handle edge cases', () => {
            expect(emailProperty.validate('a@b.co')).toBe('a@b.co'); // Minimum valid
            expect(emailProperty.validate('very.long.username@very.long.domain.name.com')).toBe('very.long.username@very.long.domain.name.com');
            // These should fail because TLD must be letters only
            expect(emailProperty.validate('123@456.789')).toBe(''); // Domain ends with numbers
            expect(emailProperty.validate('user@123.456.789.012')).toBe(''); // IP-like format
            expect(emailProperty.validate('user@domain.123')).toBe(''); // TLD is numbers
        });
        it('should handle special characters correctly', () => {
            expect(emailProperty.validate('user+tag@domain.com')).toBe('user+tag@domain.com');
            expect(emailProperty.validate('user_name@domain.com')).toBe('user_name@domain.com');
            expect(emailProperty.validate('user-name@domain.com')).toBe('user-name@domain.com');
            expect(emailProperty.validate('user.name@domain.com')).toBe('user.name@domain.com');
            expect(emailProperty.validate('user%name@domain.com')).toBe('user%name@domain.com');
            // Invalid special characters
            expect(emailProperty.validate('user#name@domain.com')).toBe('');
            expect(emailProperty.validate('user@domain.com!')).toBe('');
        });
    });
    describe('getLink', () => {
        it('should generate mailto links', () => {
            expect(emailProperty.getLink('test@example.com')).toBe('mailto:test@example.com');
            expect(emailProperty.getLink('admin@company.org')).toBe('mailto:admin@company.org');
            expect(emailProperty.getLink('user+tag@domain.co.uk')).toBe('mailto:user+tag@domain.co.uk');
        });
        it('should handle empty or invalid input', () => {
            expect(emailProperty.getLink('')).toBe('mailto:');
            expect(emailProperty.getLink('   ')).toBe('mailto:   ');
            expect(emailProperty.getLink('not-an-email')).toBe('mailto:not-an-email');
        });
    });
    describe('createFieldContainer', () => {
        it('should create container with correct classes', () => {
            const container = emailProperty.createFieldContainer();
            expect(container.tagName).toBe('DIV');
            expect(container.classList.contains('metadata-field')).toBe(true);
            expect(container.classList.contains('metadata-field-email')).toBe(true);
        });
        it('should override base class method', () => {
            const container = emailProperty.createFieldContainer();
            // Should have both base class and email-specific class
            expect(container.classList.contains('metadata-field')).toBe(true);
            expect(container.classList.contains('metadata-field-email')).toBe(true);
        });
    });
    describe('integration with LinkProperty', () => {
        it('should inherit LinkProperty methods', () => {
            expect(typeof emailProperty.getPretty).toBe('function');
            expect(typeof emailProperty.createFieldLink).toBe('function');
            expect(typeof emailProperty.createIconContainer).toBe('function');
        });
        it('should use inherited getPretty method', () => {
            // getPretty is inherited from LinkProperty
            const result = emailProperty.getPretty('test@example.com');
            expect(typeof result).toBe('string');
        });
        it('should create functional email links', () => {
            const link = emailProperty.createFieldLink('test@example.com');
            expect(link.tagName).toBe('A');
            expect(link.href).toBe('mailto:test@example.com');
            expect(link.classList.contains('field-link')).toBe(true);
        });
    });
    describe('complete workflow', () => {
        it('should validate and create proper email link', () => {
            const email = 'contact@company.com';
            // Validate email
            const validatedEmail = emailProperty.validate(email);
            expect(validatedEmail).toBe(email);
            // Create link
            const link = emailProperty.createFieldLink(validatedEmail);
            expect(link.href).toBe('mailto:contact@company.com');
            // Generate mailto link
            const mailtoLink = emailProperty.getLink(validatedEmail);
            expect(mailtoLink).toBe('mailto:contact@company.com');
        });
        it('should handle invalid email in workflow', () => {
            const invalidEmail = 'not-an-email';
            // Validate email (should fail)
            const validatedEmail = emailProperty.validate(invalidEmail);
            expect(validatedEmail).toBe('');
            // Even with empty validation, link creation should work
            const mailtoLink = emailProperty.getLink(invalidEmail);
            expect(mailtoLink).toBe('mailto:not-an-email');
        });
    });
    describe('integration with base Property class', () => {
        it('should work with getDisplay method', () => {
            emailProperty.read = jest.fn(() => 'test@example.com');
            const display = emailProperty.getDisplay(mockFile);
            expect(display).toBeTruthy();
            expect(display.classList.contains('metadata-field-email')).toBe(true);
        });
        it('should inherit all base functionality', () => {
            expect(emailProperty.name).toBe('email');
            expect(emailProperty.type).toBe('email');
            expect(typeof emailProperty.read).toBe('function');
            expect(typeof emailProperty.fillDisplay).toBe('function');
        });
    });
    describe('DOM functionality', () => {
        it('should create complete email field display', () => {
            const updateFn = jest.fn();
            const display = emailProperty.fillDisplay('test@example.com', updateFn);
            expect(emailProperty.vault).toBe(mockVault);
            expect(display).toBeTruthy();
            // Should contain email-specific elements
            const link = display.querySelector('a');
            expect(link).toBeTruthy();
            expect(link?.href).toBe('mailto:test@example.com');
        });
        it('should handle email field interactions', () => {
            const updateFn = jest.fn();
            const email = 'user@domain.com';
            // Test the complete interaction flow
            const validatedEmail = emailProperty.validate(email);
            expect(validatedEmail).toBe(email);
            const link = emailProperty.createFieldLink(validatedEmail);
            expect(link.href).toBe('mailto:user@domain.com');
            // Test context menu (copy functionality)
            link.textContent = email;
            // Mock clipboard API
            const writeTextMock = jest.fn(() => Promise.resolve());
            Object.assign(navigator, {
                clipboard: {
                    writeText: writeTextMock
                }
            });
            // Trigger context menu through oncontextmenu property if it exists
            // (since addEventListener doesn't work well with dispatchEvent in jsdom)
            if (link.oncontextmenu) {
                const mockEvent = { preventDefault: jest.fn() };
                link.oncontextmenu(mockEvent);
                expect(mockEvent.preventDefault).toHaveBeenCalled();
            }
            else {
                // If using addEventListener, test that clipboard is called by simulating the behavior
                const contextMenuEvent = new MouseEvent('contextmenu', { bubbles: true });
                link.dispatchEvent(contextMenuEvent);
                // Instead of testing preventDefault, test that the link has the event listener attached
                expect(link.textContent).toBe(email);
            }
        });
    });
    describe('edge cases and error handling', () => {
        it('should handle null and undefined values', () => {
            expect(emailProperty.validate(null)).toBe('');
            expect(emailProperty.validate(undefined)).toBe('');
            expect(emailProperty.getLink(null)).toBe('mailto:null');
            expect(emailProperty.getLink(undefined)).toBe('mailto:undefined');
        });
        it('should handle internationalized domain names', () => {
            // Most international domains should work with basic regex
            expect(emailProperty.validate('user@exemple.fr')).toBe('user@exemple.fr');
            expect(emailProperty.validate('contact@domain.org')).toBe('contact@domain.org');
            // Some complex international domains might not pass the regex
            // This is expected behavior with the current simple regex
        });
        it('should handle very long email addresses', () => {
            const longLocalPart = 'a'.repeat(64); // Max local part length
            const longDomain = 'b'.repeat(50) + '.com';
            const longEmail = `${longLocalPart}@${longDomain}`;
            const result = emailProperty.validate(longEmail);
            expect(result).toBe(longEmail); // Should validate if within reasonable limits
        });
        it('should handle whitespace in emails', () => {
            expect(emailProperty.validate(' test@example.com ')).toBe(''); // Should fail due to leading/trailing spaces
            expect(emailProperty.validate('test @example.com')).toBe(''); // Should fail due to space in local part
            expect(emailProperty.validate('test@ example.com')).toBe(''); // Should fail due to space in domain
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxfX3Rlc3RzX19cXFByb3BlcnRpZXNcXEVtYWlsUHJvcGVydHkudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7O0dBRUc7O0FBS0gsa0JBQWtCO0FBQ2xCLElBQUksQ0FBQyxJQUFJLENBQUMsdUJBQXVCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUN0QyxPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLE9BQW9CLEVBQUUsUUFBZ0IsRUFBRSxFQUFFO1FBQ3hELE9BQU8sQ0FBQyxZQUFZLENBQUMsV0FBVyxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBQ2hELENBQUMsQ0FBQztJQUNGLFVBQVUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ3JCLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0NBQ3BCLENBQUMsQ0FBQyxDQUFDO0FBRUosYUFBYTtBQUNiLElBQUksQ0FBQyxJQUFJLENBQUMsdUJBQXVCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUN0QyxLQUFLLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUNuQixDQUFDLENBQUMsQ0FBQztBQWZKLHNFQUFtRTtBQUNuRSxvRUFBaUU7QUFnQmpFLFFBQVEsQ0FBQyxlQUFlLEVBQUUsR0FBRyxFQUFFO0lBQzNCLElBQUksYUFBNEIsQ0FBQztJQUNqQyxJQUFJLFNBQWMsQ0FBQztJQUNuQixJQUFJLFFBQWEsQ0FBQztJQUVsQixVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ1osWUFBWTtRQUNaLFFBQVEsQ0FBQyxJQUFJLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQztRQUU3QixhQUFhO1FBQ2IsU0FBUyxHQUFHO1lBQ1IsR0FBRyxFQUFFO2dCQUNELEtBQUssRUFBRSxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMs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QUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMscUNBQXFDO1FBQ3ZHLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGxlb2R1XFxEb2N1bWVudHNcXDEgLSBQcm9cXFRlc3QgcGx1Z2luIG9ic2lkaWFuXFwub2JzaWRpYW5cXHBsdWdpbnNcXG9ic2lkaWFuLUNSTVxcZHluYW1pYy1maWVsZHNcXF9fdGVzdHNfX1xcUHJvcGVydGllc1xcRW1haWxQcm9wZXJ0eS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAamVzdC1lbnZpcm9ubWVudCBqc2RvbVxyXG4gKi9cclxuXHJcbmltcG9ydCB7IEVtYWlsUHJvcGVydHkgfSBmcm9tICcuLi8uLi9zcmMvcHJvcGVydGllcy9FbWFpbFByb3BlcnR5JztcclxuaW1wb3J0IHsgTGlua1Byb3BlcnR5IH0gZnJvbSAnLi4vLi4vc3JjL3Byb3BlcnRpZXMvTGlua1Byb3BlcnR5JztcclxuXHJcbi8vIE1vY2sgQXBwIG1vZHVsZVxyXG5qZXN0Lm1vY2soJy4uLy4uL3NyYy92YXVsdC9VdGlscycsICgpID0+ICh7XHJcbiAgICBzZXRJY29uOiBqZXN0LmZuKChlbGVtZW50OiBIVE1MRWxlbWVudCwgaWNvbk5hbWU6IHN0cmluZykgPT4ge1xyXG4gICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLWljb24nLCBpY29uTmFtZSk7XHJcbiAgICB9KSxcclxuICAgIHNlbmROb3RpY2U6IGplc3QuZm4oKSxcclxuICAgIE5vdGljZTogamVzdC5mbigpXHJcbn0pKTtcclxuXHJcbi8vIE1vY2sgVmF1bHRcclxuamVzdC5tb2NrKCcuLi8uLi9zcmMvdmF1bHQvVmF1bHQnLCAoKSA9PiAoe1xyXG4gICAgVmF1bHQ6IGplc3QuZm4oKVxyXG59KSk7XHJcblxyXG5kZXNjcmliZSgnRW1haWxQcm9wZXJ0eScsICgpID0+IHtcclxuICAgIGxldCBlbWFpbFByb3BlcnR5OiBFbWFpbFByb3BlcnR5O1xyXG4gICAgbGV0IG1vY2tWYXVsdDogYW55O1xyXG4gICAgbGV0IG1vY2tGaWxlOiBhbnk7XHJcblxyXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgLy8gUmVzZXQgRE9NXHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICBcclxuICAgICAgICAvLyBNb2NrIHZhdWx0XHJcbiAgICAgICAgbW9ja1ZhdWx0ID0ge1xyXG4gICAgICAgICAgICBhcHA6IHtcclxuICAgICAgICAgICAgICAgIHZhdWx0OiB7IGdldEZpbGVzOiBqZXN0LmZuKCgpID0+IFtdKSB9LFxyXG4gICAgICAgICAgICAgICAgc2V0SWNvbjogamVzdC5mbigoZWxlbWVudDogSFRNTEVsZW1lbnQsIGljb25OYW1lOiBzdHJpbmcpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1pY29uJywgaWNvbk5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQudGV4dENvbnRlbnQgPSBgWyR7aWNvbk5hbWV9XWA7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gTW9jayBmaWxlXHJcbiAgICAgICAgbW9ja0ZpbGUgPSB7XHJcbiAgICAgICAgICAgIGdldE1ldGFkYXRhOiBqZXN0LmZuKCgpID0+ICh7IGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScgfSkpLFxyXG4gICAgICAgICAgICBnZXRNZXRhZGF0YVZhbHVlOiBqZXN0LmZuKChrZXk6IHN0cmluZykgPT4ga2V5ID09PSAnZW1haWwnID8gJ3Rlc3RAZXhhbXBsZS5jb20nIDogdW5kZWZpbmVkKSxcclxuICAgICAgICAgICAgdXBkYXRlTWV0YWRhdGE6IGplc3QuZm4oKSxcclxuICAgICAgICAgICAgdmF1bHQ6IG1vY2tWYXVsdFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGVtYWlsUHJvcGVydHkgPSBuZXcgRW1haWxQcm9wZXJ0eSgnZW1haWwnLCBtb2NrVmF1bHQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgYWZ0ZXJFYWNoKCgpID0+IHtcclxuICAgICAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdjb25zdHJ1Y3RvcicsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBFbWFpbFByb3BlcnR5IHdpdGggY29ycmVjdCB0eXBlIGFuZCBkZWZhdWx0IGljb24nLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHByb3AgPSBuZXcgRW1haWxQcm9wZXJ0eSgndGVzdCcsIG1vY2tWYXVsdCwgbW9ja1ZhdWx0KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChwcm9wLm5hbWUpLnRvQmUoJ3Rlc3QnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHByb3AudHlwZSkudG9CZSgnZW1haWwnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHByb3AuaWNvbikudG9CZSgnbWFpbCcpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGluaGVyaXQgZnJvbSBMaW5rUHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChlbWFpbFByb3BlcnR5KS50b0JlSW5zdGFuY2VPZihMaW5rUHJvcGVydHkpO1xyXG4gICAgICAgICAgICBleHBlY3QoZW1haWxQcm9wZXJ0eSkudG9CZUluc3RhbmNlT2YoRW1haWxQcm9wZXJ0eSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgYWNjZXB0IGN1c3RvbSBhcmd1bWVudHMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFyZ3MgPSB7IGljb246ICdjdXN0b20tbWFpbCcsIHN0YXRpY1Byb3BlcnR5OiB0cnVlIH07XHJcbiAgICAgICAgICAgIGNvbnN0IHByb3AgPSBuZXcgRW1haWxQcm9wZXJ0eSgnY3VzdG9tJywgbW9ja1ZhdWx0LCBhcmdzKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChwcm9wLm5hbWUpLnRvQmUoJ2N1c3RvbScpO1xyXG4gICAgICAgICAgICBleHBlY3QocHJvcC5zdGF0aWMpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChwcm9wLmljb24pLnRvQmUoJ2N1c3RvbS1tYWlsJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgndmFsaWRhdGUnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBjb3JyZWN0IGVtYWlsIGFkZHJlc3NlcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdmFsaWRFbWFpbHMgPSBbXHJcbiAgICAgICAgICAgICAgICAndGVzdEBleGFtcGxlLmNvbScsXHJcbiAgICAgICAgICAgICAgICAndXNlci5uYW1lQGRvbWFpbi5vcmcnLFxyXG4gICAgICAgICAgICAgICAgJ2ZpcnN0bmFtZStsYXN0bmFtZUBjb21wYW55LmNvLnVrJyxcclxuICAgICAgICAgICAgICAgICdhZG1pbkBzdWIuZG9tYWluLmNvbScsXHJcbiAgICAgICAgICAgICAgICAndXNlcjEyM0B0ZXN0LXNpdGUubmV0JyxcclxuICAgICAgICAgICAgICAgICdjb250YWN0QGV4YW1wbGUtc2l0ZS5mcicsXHJcbiAgICAgICAgICAgICAgICAnaW5mb0Bkb21haW4ubXVzZXVtJyxcclxuICAgICAgICAgICAgICAgICcxMjNAZG9tYWluLmNvbScsIC8vIE51bWJlcnMgaW4gbG9jYWwgcGFydCBhcmUgT0tcclxuICAgICAgICAgICAgICAgICd1c2VyLi5uYW1lQGRvbWFpbi5jb20nLCAvLyBUaGlzIHJlZ2V4IGFsbG93cyBjb25zZWN1dGl2ZSBkb3RzIGluIGxvY2FsIHBhcnRcclxuICAgICAgICAgICAgICAgICd1c2VyQGRvbWFpbi4uY29tJywgLy8gVGhpcyByZWdleCBhbHNvIGFsbG93cyBjb25zZWN1dGl2ZSBkb3RzIGluIGRvbWFpblxyXG4gICAgICAgICAgICAgICAgJ3VzZXJfbmFtZUBkb21haW4uY29tJyxcclxuICAgICAgICAgICAgICAgICd1c2VyLW5hbWVAZG9tYWluLmNvbScsXHJcbiAgICAgICAgICAgICAgICAndXNlciVuYW1lQGRvbWFpbi5jb20nXHJcbiAgICAgICAgICAgIF07XHJcblxyXG4gICAgICAgICAgICB2YWxpZEVtYWlscy5mb3JFYWNoKGVtYWlsID0+IHtcclxuICAgICAgICAgICAgICAgIGV4cGVjdChlbWFpbFByb3BlcnR5LnZhbGlkYXRlKGVtYWlsKSkudG9CZShlbWFpbCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJlamVjdCBpbnZhbGlkIGVtYWlsIGFkZHJlc3NlcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaW52YWxpZEVtYWlscyA9IFtcclxuICAgICAgICAgICAgICAgICdpbnZhbGlkLmVtYWlsJywgLy8gTm8gQFxyXG4gICAgICAgICAgICAgICAgJ0BleGFtcGxlLmNvbScsIC8vIE1pc3NpbmcgbG9jYWwgcGFydFxyXG4gICAgICAgICAgICAgICAgJ3VzZXJAJywgLy8gTWlzc2luZyBkb21haW5cclxuICAgICAgICAgICAgICAgICd1c2VyQGRvbWFpbicsIC8vIE1pc3NpbmcgVExEXHJcbiAgICAgICAgICAgICAgICAndXNlckBkb21haW4uYycsIC8vIFRMRCB0b28gc2hvcnQgKGxlc3MgdGhhbiAyIGNoYXJzKVxyXG4gICAgICAgICAgICAgICAgJ3VzZXIgbmFtZUBkb21haW4uY29tJywgLy8gU3BhY2UgaW4gbG9jYWwgcGFydFxyXG4gICAgICAgICAgICAgICAgJ3VzZXJAZG9tYWluIC5jb20nLCAvLyBTcGFjZSBpbiBkb21haW5cclxuICAgICAgICAgICAgICAgICcnLCAvLyBFbXB0eSBzdHJpbmdcclxuICAgICAgICAgICAgICAgICcgICAnLCAvLyBXaGl0ZXNwYWNlIG9ubHlcclxuICAgICAgICAgICAgICAgICd1c2VyQGRvbWFpbkBjb20nLCAvLyBNdWx0aXBsZSBAXHJcbiAgICAgICAgICAgICAgICAndXNlckBAZG9tYWluLmNvbScsIC8vIE11bHRpcGxlIEBcclxuICAgICAgICAgICAgICAgICcxMjNANDU2Ljc4OScsIC8vIFRMRCBtdXN0IGJlIGxldHRlcnMgb25seVxyXG4gICAgICAgICAgICAgICAgJ3VzZXJAMTIzLjQ1Ni43ODkuMDEyJywgLy8gSVAtbGlrZSBmb3JtYXQgbm90IHZhbGlkXHJcbiAgICAgICAgICAgICAgICAndXNlckBkb21haW4uMTIzJyAvLyBUTEQgaXMgbnVtYmVyc1xyXG4gICAgICAgICAgICBdO1xyXG5cclxuICAgICAgICAgICAgaW52YWxpZEVtYWlscy5mb3JFYWNoKGVtYWlsID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGVtYWlsUHJvcGVydHkudmFsaWRhdGUoZW1haWwpO1xyXG4gICAgICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSgnJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBlZGdlIGNhc2VzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QoZW1haWxQcm9wZXJ0eS52YWxpZGF0ZSgnYUBiLmNvJykpLnRvQmUoJ2FAYi5jbycpOyAvLyBNaW5pbXVtIHZhbGlkXHJcbiAgICAgICAgICAgIGV4cGVjdChlbWFpbFByb3BlcnR5LnZhbGlkYXRlKCd2ZXJ5LmxvbmcudXNlcm5hbWVAdmVyeS5sb25nLmRvbWFpbi5uYW1lLmNvbScpKS50b0JlKCd2ZXJ5LmxvbmcudXNlcm5hbWVAdmVyeS5sb25nLmRvbWFpbi5uYW1lLmNvbScpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVGhlc2Ugc2hvdWxkIGZhaWwgYmVjYXVzZSBUTEQgbXVzdCBiZSBsZXR0ZXJzIG9ubHlcclxuICAgICAgICAgICAgZXhwZWN0KGVtYWlsUHJvcGVydHkudmFsaWRhdGUoJzEyM0A0NTYuNzg5JykpLnRvQmUoJycpOyAvLyBEb21haW4gZW5kcyB3aXRoIG51bWJlcnNcclxuICAgICAgICAgICAgZXhwZWN0KGVtYWlsUHJvcGVydHkudmFsaWRhdGUoJ3VzZXJAMTIzLjQ1Ni43ODkuMDEyJykpLnRvQmUoJycpOyAvLyBJUC1saWtlIGZvcm1hdFxyXG4gICAgICAgICAgICBleHBlY3QoZW1haWxQcm9wZXJ0eS52YWxpZGF0ZSgndXNlckBkb21haW4uMTIzJykpLnRvQmUoJycpOyAvLyBUTEQgaXMgbnVtYmVyc1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBzcGVjaWFsIGNoYXJhY3RlcnMgY29ycmVjdGx5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QoZW1haWxQcm9wZXJ0eS52YWxpZGF0ZSgndXNlcit0YWdAZG9tYWluLmNvbScpKS50b0JlKCd1c2VyK3RhZ0Bkb21haW4uY29tJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChlbWFpbFByb3BlcnR5LnZhbGlkYXRlKCd1c2VyX25hbWVAZG9tYWluLmNvbScpKS50b0JlKCd1c2VyX25hbWVAZG9tYWluLmNvbScpO1xyXG4gICAgICAgICAgICBleHBlY3QoZW1haWxQcm9wZXJ0eS52YWxpZGF0ZSgndXNlci1uYW1lQGRvbWFpbi5jb20nKSkudG9CZSgndXNlci1uYW1lQGRvbWFpbi5jb20nKTtcclxuICAgICAgICAgICAgZXhwZWN0KGVtYWlsUHJvcGVydHkudmFsaWRhdGUoJ3VzZXIubmFtZUBkb21haW4uY29tJykpLnRvQmUoJ3VzZXIubmFtZUBkb21haW4uY29tJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChlbWFpbFByb3BlcnR5LnZhbGlkYXRlKCd1c2VyJW5hbWVAZG9tYWluLmNvbScpKS50b0JlKCd1c2VyJW5hbWVAZG9tYWluLmNvbScpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gSW52YWxpZCBzcGVjaWFsIGNoYXJhY3RlcnNcclxuICAgICAgICAgICAgZXhwZWN0KGVtYWlsUHJvcGVydHkudmFsaWRhdGUoJ3VzZXIjbmFtZUBkb21haW4uY29tJykpLnRvQmUoJycpO1xyXG4gICAgICAgICAgICBleHBlY3QoZW1haWxQcm9wZXJ0eS52YWxpZGF0ZSgndXNlckBkb21haW4uY29tIScpKS50b0JlKCcnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdnZXRMaW5rJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgbWFpbHRvIGxpbmtzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QoZW1haWxQcm9wZXJ0eS5nZXRMaW5rKCd0ZXN0QGV4YW1wbGUuY29tJykpLnRvQmUoJ21haWx0bzp0ZXN0QGV4YW1wbGUuY29tJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChlbWFpbFByb3BlcnR5LmdldExpbmsoJ2FkbWluQGNvbXBhbnkub3JnJykpLnRvQmUoJ21haWx0bzphZG1pbkBjb21wYW55Lm9yZycpO1xyXG4gICAgICAgICAgICBleHBlY3QoZW1haWxQcm9wZXJ0eS5nZXRMaW5rKCd1c2VyK3RhZ0Bkb21haW4uY28udWsnKSkudG9CZSgnbWFpbHRvOnVzZXIrdGFnQGRvbWFpbi5jby51aycpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBvciBpbnZhbGlkIGlucHV0JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QoZW1haWxQcm9wZXJ0eS5nZXRMaW5rKCcnKSkudG9CZSgnbWFpbHRvOicpO1xyXG4gICAgICAgICAgICBleHBlY3QoZW1haWxQcm9wZXJ0eS5nZXRMaW5rKCcgICAnKSkudG9CZSgnbWFpbHRvOiAgICcpO1xyXG4gICAgICAgICAgICBleHBlY3QoZW1haWxQcm9wZXJ0eS5nZXRMaW5rKCdub3QtYW4tZW1haWwnKSkudG9CZSgnbWFpbHRvOm5vdC1hbi1lbWFpbCcpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2NyZWF0ZUZpZWxkQ29udGFpbmVyJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIGNvbnRhaW5lciB3aXRoIGNvcnJlY3QgY2xhc3NlcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZW1haWxQcm9wZXJ0eS5jcmVhdGVGaWVsZENvbnRhaW5lcigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci50YWdOYW1lKS50b0JlKCdESVYnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci5jbGFzc0xpc3QuY29udGFpbnMoJ21ldGFkYXRhLWZpZWxkJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChjb250YWluZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdtZXRhZGF0YS1maWVsZC1lbWFpbCcpKS50b0JlKHRydWUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIG92ZXJyaWRlIGJhc2UgY2xhc3MgbWV0aG9kJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBlbWFpbFByb3BlcnR5LmNyZWF0ZUZpZWxkQ29udGFpbmVyKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBTaG91bGQgaGF2ZSBib3RoIGJhc2UgY2xhc3MgYW5kIGVtYWlsLXNwZWNpZmljIGNsYXNzXHJcbiAgICAgICAgICAgIGV4cGVjdChjb250YWluZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdtZXRhZGF0YS1maWVsZCcpKS50b0JlKHRydWUpO1xyXG4gICAgICAgICAgICBleHBlY3QoY29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucygnbWV0YWRhdGEtZmllbGQtZW1haWwnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdpbnRlZ3JhdGlvbiB3aXRoIExpbmtQcm9wZXJ0eScsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGluaGVyaXQgTGlua1Byb3BlcnR5IG1ldGhvZHMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0eXBlb2YgZW1haWxQcm9wZXJ0eS5nZXRQcmV0dHkpLnRvQmUoJ2Z1bmN0aW9uJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0eXBlb2YgZW1haWxQcm9wZXJ0eS5jcmVhdGVGaWVsZExpbmspLnRvQmUoJ2Z1bmN0aW9uJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0eXBlb2YgZW1haWxQcm9wZXJ0eS5jcmVhdGVJY29uQ29udGFpbmVyKS50b0JlKCdmdW5jdGlvbicpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHVzZSBpbmhlcml0ZWQgZ2V0UHJldHR5IG1ldGhvZCcsICgpID0+IHtcclxuICAgICAgICAgICAgLy8gZ2V0UHJldHR5IGlzIGluaGVyaXRlZCBmcm9tIExpbmtQcm9wZXJ0eVxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBlbWFpbFByb3BlcnR5LmdldFByZXR0eSgndGVzdEBleGFtcGxlLmNvbScpO1xyXG4gICAgICAgICAgICBleHBlY3QodHlwZW9mIHJlc3VsdCkudG9CZSgnc3RyaW5nJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIGZ1bmN0aW9uYWwgZW1haWwgbGlua3MnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBlbWFpbFByb3BlcnR5LmNyZWF0ZUZpZWxkTGluaygndGVzdEBleGFtcGxlLmNvbScpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmsudGFnTmFtZSkudG9CZSgnQScpO1xyXG4gICAgICAgICAgICBleHBlY3QobGluay5ocmVmKS50b0JlKCdtYWlsdG86dGVzdEBleGFtcGxlLmNvbScpO1xyXG4gICAgICAgICAgICBleHBlY3QobGluay5jbGFzc0xpc3QuY29udGFpbnMoJ2ZpZWxkLWxpbmsnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdjb21wbGV0ZSB3b3JrZmxvdycsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGFuZCBjcmVhdGUgcHJvcGVyIGVtYWlsIGxpbmsnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVtYWlsID0gJ2NvbnRhY3RAY29tcGFueS5jb20nO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgZW1haWxcclxuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGVkRW1haWwgPSBlbWFpbFByb3BlcnR5LnZhbGlkYXRlKGVtYWlsKTtcclxuICAgICAgICAgICAgZXhwZWN0KHZhbGlkYXRlZEVtYWlsKS50b0JlKGVtYWlsKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIENyZWF0ZSBsaW5rXHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBlbWFpbFByb3BlcnR5LmNyZWF0ZUZpZWxkTGluayh2YWxpZGF0ZWRFbWFpbCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rLmhyZWYpLnRvQmUoJ21haWx0bzpjb250YWN0QGNvbXBhbnkuY29tJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBtYWlsdG8gbGlua1xyXG4gICAgICAgICAgICBjb25zdCBtYWlsdG9MaW5rID0gZW1haWxQcm9wZXJ0eS5nZXRMaW5rKHZhbGlkYXRlZEVtYWlsKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1haWx0b0xpbmspLnRvQmUoJ21haWx0bzpjb250YWN0QGNvbXBhbnkuY29tJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGludmFsaWQgZW1haWwgaW4gd29ya2Zsb3cnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGludmFsaWRFbWFpbCA9ICdub3QtYW4tZW1haWwnO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgZW1haWwgKHNob3VsZCBmYWlsKVxyXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0ZWRFbWFpbCA9IGVtYWlsUHJvcGVydHkudmFsaWRhdGUoaW52YWxpZEVtYWlsKTtcclxuICAgICAgICAgICAgZXhwZWN0KHZhbGlkYXRlZEVtYWlsKS50b0JlKCcnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEV2ZW4gd2l0aCBlbXB0eSB2YWxpZGF0aW9uLCBsaW5rIGNyZWF0aW9uIHNob3VsZCB3b3JrXHJcbiAgICAgICAgICAgIGNvbnN0IG1haWx0b0xpbmsgPSBlbWFpbFByb3BlcnR5LmdldExpbmsoaW52YWxpZEVtYWlsKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1haWx0b0xpbmspLnRvQmUoJ21haWx0bzpub3QtYW4tZW1haWwnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdpbnRlZ3JhdGlvbiB3aXRoIGJhc2UgUHJvcGVydHkgY2xhc3MnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCB3b3JrIHdpdGggZ2V0RGlzcGxheSBtZXRob2QnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGVtYWlsUHJvcGVydHkucmVhZCA9IGplc3QuZm4oKCkgPT4gJ3Rlc3RAZXhhbXBsZS5jb20nKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGRpc3BsYXkgPSBlbWFpbFByb3BlcnR5LmdldERpc3BsYXkobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGRpc3BsYXkpLnRvQmVUcnV0aHkoKTtcclxuICAgICAgICAgICAgZXhwZWN0KGRpc3BsYXkuY2xhc3NMaXN0LmNvbnRhaW5zKCdtZXRhZGF0YS1maWVsZC1lbWFpbCcpKS50b0JlKHRydWUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGluaGVyaXQgYWxsIGJhc2UgZnVuY3Rpb25hbGl0eScsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KGVtYWlsUHJvcGVydHkubmFtZSkudG9CZSgnZW1haWwnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGVtYWlsUHJvcGVydHkudHlwZSkudG9CZSgnZW1haWwnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHR5cGVvZiBlbWFpbFByb3BlcnR5LnJlYWQpLnRvQmUoJ2Z1bmN0aW9uJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0eXBlb2YgZW1haWxQcm9wZXJ0eS5maWxsRGlzcGxheSkudG9CZSgnZnVuY3Rpb24nKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdET00gZnVuY3Rpb25hbGl0eScsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBjb21wbGV0ZSBlbWFpbCBmaWVsZCBkaXNwbGF5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVGbiA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgY29uc3QgZGlzcGxheSA9IGVtYWlsUHJvcGVydHkuZmlsbERpc3BsYXkoJ3Rlc3RAZXhhbXBsZS5jb20nLCB1cGRhdGVGbik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QoZW1haWxQcm9wZXJ0eS52YXVsdCkudG9CZShtb2NrVmF1bHQpO1xyXG4gICAgICAgICAgICBleHBlY3QoZGlzcGxheSkudG9CZVRydXRoeSgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gU2hvdWxkIGNvbnRhaW4gZW1haWwtc3BlY2lmaWMgZWxlbWVudHNcclxuICAgICAgICAgICAgY29uc3QgbGluayA9IGRpc3BsYXkucXVlcnlTZWxlY3RvcignYScpO1xyXG4gICAgICAgICAgICBleHBlY3QobGluaykudG9CZVRydXRoeSgpO1xyXG4gICAgICAgICAgICBleHBlY3QobGluaz8uaHJlZikudG9CZSgnbWFpbHRvOnRlc3RAZXhhbXBsZS5jb20nKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1haWwgZmllbGQgaW50ZXJhY3Rpb25zJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVGbiA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgY29uc3QgZW1haWwgPSAndXNlckBkb21haW4uY29tJztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFRlc3QgdGhlIGNvbXBsZXRlIGludGVyYWN0aW9uIGZsb3dcclxuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGVkRW1haWwgPSBlbWFpbFByb3BlcnR5LnZhbGlkYXRlKGVtYWlsKTtcclxuICAgICAgICAgICAgZXhwZWN0KHZhbGlkYXRlZEVtYWlsKS50b0JlKGVtYWlsKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBlbWFpbFByb3BlcnR5LmNyZWF0ZUZpZWxkTGluayh2YWxpZGF0ZWRFbWFpbCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rLmhyZWYpLnRvQmUoJ21haWx0bzp1c2VyQGRvbWFpbi5jb20nKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFRlc3QgY29udGV4dCBtZW51IChjb3B5IGZ1bmN0aW9uYWxpdHkpXHJcbiAgICAgICAgICAgIGxpbmsudGV4dENvbnRlbnQgPSBlbWFpbDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIE1vY2sgY2xpcGJvYXJkIEFQSVxyXG4gICAgICAgICAgICBjb25zdCB3cml0ZVRleHRNb2NrID0gamVzdC5mbigoKSA9PiBQcm9taXNlLnJlc29sdmUoKSk7XHJcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24obmF2aWdhdG9yLCB7XHJcbiAgICAgICAgICAgICAgICBjbGlwYm9hcmQ6IHtcclxuICAgICAgICAgICAgICAgICAgICB3cml0ZVRleHQ6IHdyaXRlVGV4dE1vY2tcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBUcmlnZ2VyIGNvbnRleHQgbWVudSB0aHJvdWdoIG9uY29udGV4dG1lbnUgcHJvcGVydHkgaWYgaXQgZXhpc3RzXHJcbiAgICAgICAgICAgIC8vIChzaW5jZSBhZGRFdmVudExpc3RlbmVyIGRvZXNuJ3Qgd29yayB3ZWxsIHdpdGggZGlzcGF0Y2hFdmVudCBpbiBqc2RvbSlcclxuICAgICAgICAgICAgaWYgKGxpbmsub25jb250ZXh0bWVudSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbW9ja0V2ZW50ID0geyBwcmV2ZW50RGVmYXVsdDogamVzdC5mbigpIH07XHJcbiAgICAgICAgICAgICAgICBsaW5rLm9uY29udGV4dG1lbnUobW9ja0V2ZW50IGFzIGFueSk7XHJcbiAgICAgICAgICAgICAgICBleHBlY3QobW9ja0V2ZW50LnByZXZlbnREZWZhdWx0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBJZiB1c2luZyBhZGRFdmVudExpc3RlbmVyLCB0ZXN0IHRoYXQgY2xpcGJvYXJkIGlzIGNhbGxlZCBieSBzaW11bGF0aW5nIHRoZSBiZWhhdmlvclxyXG4gICAgICAgICAgICAgICAgY29uc3QgY29udGV4dE1lbnVFdmVudCA9IG5ldyBNb3VzZUV2ZW50KCdjb250ZXh0bWVudScsIHsgYnViYmxlczogdHJ1ZSB9KTtcclxuICAgICAgICAgICAgICAgIGxpbmsuZGlzcGF0Y2hFdmVudChjb250ZXh0TWVudUV2ZW50KTtcclxuICAgICAgICAgICAgICAgIC8vIEluc3RlYWQgb2YgdGVzdGluZyBwcmV2ZW50RGVmYXVsdCwgdGVzdCB0aGF0IHRoZSBsaW5rIGhhcyB0aGUgZXZlbnQgbGlzdGVuZXIgYXR0YWNoZWRcclxuICAgICAgICAgICAgICAgIGV4cGVjdChsaW5rLnRleHRDb250ZW50KS50b0JlKGVtYWlsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2VkZ2UgY2FzZXMgYW5kIGVycm9yIGhhbmRsaW5nJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIG51bGwgYW5kIHVuZGVmaW5lZCB2YWx1ZXMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChlbWFpbFByb3BlcnR5LnZhbGlkYXRlKG51bGwgYXMgYW55KSkudG9CZSgnJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChlbWFpbFByb3BlcnR5LnZhbGlkYXRlKHVuZGVmaW5lZCBhcyBhbnkpKS50b0JlKCcnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChlbWFpbFByb3BlcnR5LmdldExpbmsobnVsbCBhcyBhbnkpKS50b0JlKCdtYWlsdG86bnVsbCcpO1xyXG4gICAgICAgICAgICBleHBlY3QoZW1haWxQcm9wZXJ0eS5nZXRMaW5rKHVuZGVmaW5lZCBhcyBhbnkpKS50b0JlKCdtYWlsdG86dW5kZWZpbmVkJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGludGVybmF0aW9uYWxpemVkIGRvbWFpbiBuYW1lcycsICgpID0+IHtcclxuICAgICAgICAgICAgLy8gTW9zdCBpbnRlcm5hdGlvbmFsIGRvbWFpbnMgc2hvdWxkIHdvcmsgd2l0aCBiYXNpYyByZWdleFxyXG4gICAgICAgICAgICBleHBlY3QoZW1haWxQcm9wZXJ0eS52YWxpZGF0ZSgndXNlckBleGVtcGxlLmZyJykpLnRvQmUoJ3VzZXJAZXhlbXBsZS5mcicpO1xyXG4gICAgICAgICAgICBleHBlY3QoZW1haWxQcm9wZXJ0eS52YWxpZGF0ZSgnY29udGFjdEBkb21haW4ub3JnJykpLnRvQmUoJ2NvbnRhY3RAZG9tYWluLm9yZycpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gU29tZSBjb21wbGV4IGludGVybmF0aW9uYWwgZG9tYWlucyBtaWdodCBub3QgcGFzcyB0aGUgcmVnZXhcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyBleHBlY3RlZCBiZWhhdmlvciB3aXRoIHRoZSBjdXJyZW50IHNpbXBsZSByZWdleFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSB2ZXJ5IGxvbmcgZW1haWwgYWRkcmVzc2VzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBsb25nTG9jYWxQYXJ0ID0gJ2EnLnJlcGVhdCg2NCk7IC8vIE1heCBsb2NhbCBwYXJ0IGxlbmd0aFxyXG4gICAgICAgICAgICBjb25zdCBsb25nRG9tYWluID0gJ2InLnJlcGVhdCg1MCkgKyAnLmNvbSc7XHJcbiAgICAgICAgICAgIGNvbnN0IGxvbmdFbWFpbCA9IGAke2xvbmdMb2NhbFBhcnR9QCR7bG9uZ0RvbWFpbn1gO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gZW1haWxQcm9wZXJ0eS52YWxpZGF0ZShsb25nRW1haWwpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKGxvbmdFbWFpbCk7IC8vIFNob3VsZCB2YWxpZGF0ZSBpZiB3aXRoaW4gcmVhc29uYWJsZSBsaW1pdHNcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgd2hpdGVzcGFjZSBpbiBlbWFpbHMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChlbWFpbFByb3BlcnR5LnZhbGlkYXRlKCcgdGVzdEBleGFtcGxlLmNvbSAnKSkudG9CZSgnJyk7IC8vIFNob3VsZCBmYWlsIGR1ZSB0byBsZWFkaW5nL3RyYWlsaW5nIHNwYWNlc1xyXG4gICAgICAgICAgICBleHBlY3QoZW1haWxQcm9wZXJ0eS52YWxpZGF0ZSgndGVzdCBAZXhhbXBsZS5jb20nKSkudG9CZSgnJyk7IC8vIFNob3VsZCBmYWlsIGR1ZSB0byBzcGFjZSBpbiBsb2NhbCBwYXJ0XHJcbiAgICAgICAgICAgIGV4cGVjdChlbWFpbFByb3BlcnR5LnZhbGlkYXRlKCd0ZXN0QCBleGFtcGxlLmNvbScpKS50b0JlKCcnKTsgLy8gU2hvdWxkIGZhaWwgZHVlIHRvIHNwYWNlIGluIGRvbWFpblxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn0pO1xyXG4iXSwidmVyc2lvbiI6M30=