3b0ff7f3c12ee7d1a41839b0cfd633e2
"use strict";
/**
 * @jest-environment jsdom
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mocks
jest.mock('../../../src/vault/Vault');
const MultiSelectProperty_1 = require("../../../src/properties/MultiSelectProperty");
describe('MultiSelectProperty', () => {
    let multiSelectProperty;
    let mockVault;
    let mockUpdate;
    let options;
    beforeEach(() => {
        // Reset DOM
        document.body.innerHTML = '';
        // Reset all mocks
        jest.clearAllMocks();
        // Setup test options
        options = [
            { name: 'Option 1', color: '#FF0000' },
            { name: 'Option 2', color: '#00FF00' },
            { name: 'Option 3', color: '#0000FF' }
        ];
        // Setup mocks
        mockVault = {
            getPersonalName: jest.fn().mockReturnValue('John Doe')
        };
        mockUpdate = jest.fn().mockResolvedValue(undefined);
    });
    describe('Constructor', () => {
        test('should create MultiSelectProperty with required parameters', () => {
            multiSelectProperty = new MultiSelectProperty_1.MultiSelectProperty('testSelect', options);
            expect(multiSelectProperty.name).toBe('testSelect');
            expect(multiSelectProperty.type).toBe('multiSelect');
            expect(multiSelectProperty.options).toEqual(options);
        });
        test('should handle custom arguments', () => {
            const args = { icon: 'list', defaultValue: ['Option 1'] };
            multiSelectProperty = new MultiSelectProperty_1.MultiSelectProperty('testSelect', options, args);
            expect(multiSelectProperty.name).toBe('testSelect');
            expect(multiSelectProperty.options).toEqual(options);
            expect(multiSelectProperty.icon).toBe('list');
        });
        test('should handle empty options array', () => {
            multiSelectProperty = new MultiSelectProperty_1.MultiSelectProperty('testSelect', []);
            expect(multiSelectProperty.options).toEqual([]);
        });
    });
    describe('fillDisplay', () => {
        beforeEach(() => {
            multiSelectProperty = new MultiSelectProperty_1.MultiSelectProperty('testSelect', options);
        });
        test('should create field container with correct structure', () => {
            const value = [];
            const container = multiSelectProperty.fillDisplay(mockVault, value, mockUpdate);
            expect(container).toBeDefined();
            expect(container.classList.contains('metadata-field')).toBe(true);
        });
        test('should set vault property', () => {
            const value = [];
            multiSelectProperty.fillDisplay(mockVault, value, mockUpdate);
            expect(multiSelectProperty.vault).toBe(mockVault);
        });
        test('should create header with correct text', () => {
            const value = [];
            const container = multiSelectProperty.fillDisplay(mockVault, value, mockUpdate);
            const header = container.querySelector('.metadata-header');
            expect(header).toBeDefined();
            expect(header?.textContent).toBe('testSelect');
        });
        test('should create button container', () => {
            const value = [];
            const container = multiSelectProperty.fillDisplay(mockVault, value, mockUpdate);
            const buttonContainer = container.querySelector('.multi-select-container');
            expect(buttonContainer).toBeDefined();
        });
        test('should handle null/undefined value', () => {
            const container1 = multiSelectProperty.fillDisplay(mockVault, null, mockUpdate);
            const container2 = multiSelectProperty.fillDisplay(mockVault, undefined, mockUpdate);
            expect(container1).toBeDefined();
            expect(container2).toBeDefined();
        });
    });
    describe('getDefaultValue', () => {
        test('should replace personalName with actual name from vault', () => {
            multiSelectProperty = new MultiSelectProperty_1.MultiSelectProperty('testSelect', options);
            multiSelectProperty.default = ['personalName', 'Option 1'];
            const result = multiSelectProperty.getDefaultValue(mockVault);
            expect(result).toEqual(['John Doe', 'Option 1']);
            expect(mockVault.getPersonalName).toHaveBeenCalled();
        });
        test('should not modify values that are not personalName', () => {
            multiSelectProperty = new MultiSelectProperty_1.MultiSelectProperty('testSelect', options);
            multiSelectProperty.default = ['Option 1', 'Option 2'];
            const result = multiSelectProperty.getDefaultValue(mockVault);
            expect(result).toEqual(['Option 1', 'Option 2']);
        });
        test('should handle array with no personalName', () => {
            multiSelectProperty = new MultiSelectProperty_1.MultiSelectProperty('testSelect', options);
            multiSelectProperty.default = ['Option 3'];
            const result = multiSelectProperty.getDefaultValue(mockVault);
            expect(result).toEqual(['Option 3']);
            expect(mockVault.getPersonalName).not.toHaveBeenCalled();
        });
        test('should handle empty default array', () => {
            multiSelectProperty = new MultiSelectProperty_1.MultiSelectProperty('testSelect', options);
            multiSelectProperty.default = [];
            const result = multiSelectProperty.getDefaultValue(mockVault);
            expect(result).toEqual([]);
        });
        test('should handle multiple personalName entries', () => {
            multiSelectProperty = new MultiSelectProperty_1.MultiSelectProperty('testSelect', options);
            multiSelectProperty.default = ['personalName', 'Option 1', 'personalName'];
            const result = multiSelectProperty.getDefaultValue(mockVault);
            expect(result).toEqual(['John Doe', 'Option 1', 'John Doe']);
            expect(mockVault.getPersonalName).toHaveBeenCalledTimes(2);
        });
    });
    describe('createButtonGroup', () => {
        beforeEach(() => {
            multiSelectProperty = new MultiSelectProperty_1.MultiSelectProperty('testSelect', options);
        });
        test('should create button for each option', () => {
            const value = [];
            const buttonContainer = multiSelectProperty.createButtonGroup(value, mockUpdate);
            const buttons = buttonContainer.querySelectorAll('.multi-select-button');
            expect(buttons.length).toBe(3);
            expect(buttons[0].textContent).toBe('Option 1');
            expect(buttons[1].textContent).toBe('Option 2');
            expect(buttons[2].textContent).toBe('Option 3');
        });
        test('should mark selected options as selected', () => {
            const value = ['Option 1', 'Option 3'];
            const buttonContainer = multiSelectProperty.createButtonGroup(value, mockUpdate);
            const buttons = buttonContainer.querySelectorAll('.multi-select-button');
            expect(buttons[0].classList.contains('selected')).toBe(true);
            expect(buttons[1].classList.contains('selected')).toBe(false);
            expect(buttons[2].classList.contains('selected')).toBe(true);
        });
        test('should handle empty selection', () => {
            const value = [];
            const buttonContainer = multiSelectProperty.createButtonGroup(value, mockUpdate);
            const buttons = buttonContainer.querySelectorAll('.multi-select-button');
            buttons.forEach(button => {
                expect(button.classList.contains('selected')).toBe(false);
            });
        });
        test('should handle all options selected', () => {
            const value = ['Option 1', 'Option 2', 'Option 3'];
            const buttonContainer = multiSelectProperty.createButtonGroup(value, mockUpdate);
            const buttons = buttonContainer.querySelectorAll('.multi-select-button');
            buttons.forEach(button => {
                expect(button.classList.contains('selected')).toBe(true);
            });
        });
        test('should add container class', () => {
            const value = [];
            const buttonContainer = multiSelectProperty.createButtonGroup(value, mockUpdate);
            expect(buttonContainer.classList.contains('multi-select-container')).toBe(true);
        });
    });
    describe('Button click functionality', () => {
        beforeEach(() => {
            multiSelectProperty = new MultiSelectProperty_1.MultiSelectProperty('testSelect', options);
        });
        test('should select unselected option on click', async () => {
            const value = [];
            const buttonContainer = multiSelectProperty.createButtonGroup(value, mockUpdate);
            const firstButton = buttonContainer.querySelector('.multi-select-button');
            await firstButton.click();
            expect(mockUpdate).toHaveBeenCalledWith(['Option 1']);
        });
        test('should deselect selected option on click', async () => {
            const value = ['Option 1', 'Option 2'];
            const buttonContainer = multiSelectProperty.createButtonGroup(value, mockUpdate);
            const firstButton = buttonContainer.querySelector('.multi-select-button');
            await firstButton.click();
            expect(mockUpdate).toHaveBeenCalledWith(['Option 2']);
        });
        test('should handle multiple selections', async () => {
            const value = [];
            const buttonContainer = multiSelectProperty.createButtonGroup(value, mockUpdate);
            const buttons = buttonContainer.querySelectorAll('.multi-select-button');
            // Click first button
            await buttons[0].click();
            expect(mockUpdate).toHaveBeenCalledWith(['Option 1']);
            // Reset mock for next test
            mockUpdate.mockClear();
            // Simulate value update
            const newValue = ['Option 1'];
            const newButtonContainer = multiSelectProperty.createButtonGroup(newValue, mockUpdate);
            const newButtons = newButtonContainer.querySelectorAll('.multi-select-button');
            // Click second button
            await newButtons[1].click();
            expect(mockUpdate).toHaveBeenCalledWith(['Option 1', 'Option 2']);
        });
        test('should handle button click with update error', async () => {
            mockUpdate.mockRejectedValue(new Error('Update failed'));
            const value = [];
            const buttonContainer = multiSelectProperty.createButtonGroup(value, mockUpdate);
            const firstButton = buttonContainer.querySelector('.multi-select-button');
            // Mock click event to test error handling
            const clickHandler = async () => {
                try {
                    const selectedValues = new Set(['Option 1']);
                    await mockUpdate([...selectedValues]);
                    multiSelectProperty.updateButtonState(buttonContainer, selectedValues);
                }
                catch (error) {
                    // Error should be handled gracefully
                }
            };
            // Should not throw unhandled error
            await expect(clickHandler()).resolves.toBeUndefined();
            expect(mockUpdate).toHaveBeenCalled();
        });
    });
    describe('updateButtonState', () => {
        beforeEach(() => {
            multiSelectProperty = new MultiSelectProperty_1.MultiSelectProperty('testSelect', options);
        });
        test('should update button classes based on selected values', () => {
            const value = [];
            const buttonContainer = multiSelectProperty.createButtonGroup(value, mockUpdate);
            const selectedValues = new Set(['Option 1', 'Option 3']);
            multiSelectProperty.updateButtonState(buttonContainer, selectedValues);
            const buttons = buttonContainer.querySelectorAll('.multi-select-button');
            expect(buttons[0].classList.contains('selected')).toBe(true);
            expect(buttons[1].classList.contains('selected')).toBe(false);
            expect(buttons[2].classList.contains('selected')).toBe(true);
        });
        test('should remove all selections when set is empty', () => {
            const value = ['Option 1', 'Option 2', 'Option 3'];
            const buttonContainer = multiSelectProperty.createButtonGroup(value, mockUpdate);
            const selectedValues = new Set([]);
            multiSelectProperty.updateButtonState(buttonContainer, selectedValues);
            const buttons = buttonContainer.querySelectorAll('.multi-select-button');
            buttons.forEach(button => {
                expect(button.classList.contains('selected')).toBe(false);
            });
        });
        test('should handle buttons with no text content', () => {
            const value = [];
            const buttonContainer = multiSelectProperty.createButtonGroup(value, mockUpdate);
            // Manually create a button with no text content
            const emptyButton = document.createElement('button');
            emptyButton.classList.add('multi-select-button');
            buttonContainer.appendChild(emptyButton);
            const selectedValues = new Set(['Option 1']);
            // Should not throw error
            expect(() => {
                multiSelectProperty.updateButtonState(buttonContainer, selectedValues);
            }).not.toThrow();
        });
    });
    describe('Integration tests', () => {
        test('should work with real DOM interactions', () => {
            multiSelectProperty = new MultiSelectProperty_1.MultiSelectProperty('Categories', [
                { name: 'Work', color: '#FF0000' },
                { name: 'Personal', color: '#00FF00' }
            ]);
            const container = multiSelectProperty.fillDisplay(mockVault, ['Work'], mockUpdate);
            document.body.appendChild(container);
            const workButton = document.querySelector('[textContent="Work"]');
            const personalButton = document.querySelector('[textContent="Personal"]');
            expect(workButton).toBeDefined();
            expect(personalButton).toBeDefined();
        });
        test('should handle edge case with no options', () => {
            multiSelectProperty = new MultiSelectProperty_1.MultiSelectProperty('Empty', []);
            const container = multiSelectProperty.fillDisplay(mockVault, [], mockUpdate);
            const buttons = container.querySelectorAll('.multi-select-button');
            expect(buttons.length).toBe(0);
        });
        test('should maintain state consistency', async () => {
            multiSelectProperty = new MultiSelectProperty_1.MultiSelectProperty('testSelect', options);
            const value = ['Option 2'];
            const buttonContainer = multiSelectProperty.createButtonGroup(value, mockUpdate);
            const buttons = buttonContainer.querySelectorAll('.multi-select-button');
            // Verify initial state
            expect(buttons[1].classList.contains('selected')).toBe(true);
            // Click to deselect
            await buttons[1].click();
            expect(mockUpdate).toHaveBeenCalledWith([]);
            // Click to select again
            mockUpdate.mockClear();
            const newButtonContainer = multiSelectProperty.createButtonGroup([], mockUpdate);
            const newButtons = newButtonContainer.querySelectorAll('.multi-select-button');
            await newButtons[1].click();
            expect(mockUpdate).toHaveBeenCalledWith(['Option 2']);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxfX3Rlc3RzX19cXFByb3BlcnRpZXNcXE11bHRpU2VsZWN0UHJvcGVydHkudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7O0dBRUc7O0FBS0gsUUFBUTtBQUNSLElBQUksQ0FBQyxJQUFJLENBQUMsMEJBQTBCLENBQUMsQ0FBQztBQUh0QyxxRkFBa0Y7QUFLbEYsUUFBUSxDQUFDLHFCQUFxQixFQUFFLEdBQUcsRUFBRTtJQUNqQyxJQUFJLG1CQUF3QyxDQUFDO0lBQzdDLElBQUksU0FBNkIsQ0FBQztJQUNsQyxJQUFJLFVBQWdELENBQUM7SUFDckQsSUFBSSxPQUF3QyxDQUFDO0lBRTdDLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDWixZQUFZO1FBQ1osUUFBUSxDQUFDLElBQUksQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDO1FBQzdCLGtCQUFrQjtRQUNsQixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFFckIscUJBQXFCO1FBQ3JCLE9BQU8sR0FBRztZQUNOLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFO1lBQ3RDLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFO1lBQ3RDLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFO1NBQ3pDLENBQUM7UUFFRixjQUFjO1FBQ2QsU0FBUyxHQUFHO1lBQ1IsZUFBZSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsVUFBVSxDQUFDO1NBQ2xELENBQUM7UUFFVCxVQUFVLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQ3hELENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxD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XERvY3VtZW50c1xcMSAtIFByb1xcVGVzdCBwbHVnaW4gb2JzaWRpYW5cXC5vYnNpZGlhblxccGx1Z2luc1xcb2JzaWRpYW4tQ1JNXFxkeW5hbWljLWZpZWxkc1xcX190ZXN0c19fXFxQcm9wZXJ0aWVzXFxNdWx0aVNlbGVjdFByb3BlcnR5LnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBqZXN0LWVudmlyb25tZW50IGpzZG9tXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgVmF1bHQgfSBmcm9tICcuLi8uLi8uLi9zcmMvdmF1bHQvVmF1bHQnO1xyXG5pbXBvcnQgeyBNdWx0aVNlbGVjdFByb3BlcnR5IH0gZnJvbSAnLi4vLi4vLi4vc3JjL3Byb3BlcnRpZXMvTXVsdGlTZWxlY3RQcm9wZXJ0eSc7XHJcblxyXG4vLyBNb2Nrc1xyXG5qZXN0Lm1vY2soJy4uLy4uLy4uL3NyYy92YXVsdC9WYXVsdCcpO1xyXG5cclxuZGVzY3JpYmUoJ011bHRpU2VsZWN0UHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICBsZXQgbXVsdGlTZWxlY3RQcm9wZXJ0eTogTXVsdGlTZWxlY3RQcm9wZXJ0eTtcclxuICAgIGxldCBtb2NrVmF1bHQ6IGplc3QuTW9ja2VkPFZhdWx0PjtcclxuICAgIGxldCBtb2NrVXBkYXRlOiBqZXN0Lk1vY2s8UHJvbWlzZTx2b2lkPiwgW3N0cmluZ1tdXT47XHJcbiAgICBsZXQgb3B0aW9uczoge25hbWU6IHN0cmluZywgY29sb3I6IHN0cmluZ31bXTtcclxuXHJcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICAvLyBSZXNldCBET01cclxuICAgICAgICBkb2N1bWVudC5ib2R5LmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgIC8vIFJlc2V0IGFsbCBtb2Nrc1xyXG4gICAgICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xyXG5cclxuICAgICAgICAvLyBTZXR1cCB0ZXN0IG9wdGlvbnNcclxuICAgICAgICBvcHRpb25zID0gW1xyXG4gICAgICAgICAgICB7IG5hbWU6ICdPcHRpb24gMScsIGNvbG9yOiAnI0ZGMDAwMCcgfSxcclxuICAgICAgICAgICAgeyBuYW1lOiAnT3B0aW9uIDInLCBjb2xvcjogJyMwMEZGMDAnIH0sXHJcbiAgICAgICAgICAgIHsgbmFtZTogJ09wdGlvbiAzJywgY29sb3I6ICcjMDAwMEZGJyB9XHJcbiAgICAgICAgXTtcclxuXHJcbiAgICAgICAgLy8gU2V0dXAgbW9ja3NcclxuICAgICAgICBtb2NrVmF1bHQgPSB7XHJcbiAgICAgICAgICAgIGdldFBlcnNvbmFsTmFtZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnSm9obiBEb2UnKVxyXG4gICAgICAgIH0gYXMgYW55O1xyXG5cclxuICAgICAgICBtb2NrVXBkYXRlID0gamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnQ29uc3RydWN0b3InLCAoKSA9PiB7XHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGNyZWF0ZSBNdWx0aVNlbGVjdFByb3BlcnR5IHdpdGggcmVxdWlyZWQgcGFyYW1ldGVycycsICgpID0+IHtcclxuICAgICAgICAgICAgbXVsdGlTZWxlY3RQcm9wZXJ0eSA9IG5ldyBNdWx0aVNlbGVjdFByb3BlcnR5KCd0ZXN0U2VsZWN0Jywgb3B0aW9ucyk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobXVsdGlTZWxlY3RQcm9wZXJ0eS5uYW1lKS50b0JlKCd0ZXN0U2VsZWN0Jyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtdWx0aVNlbGVjdFByb3BlcnR5LnR5cGUpLnRvQmUoJ211bHRpU2VsZWN0Jyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtdWx0aVNlbGVjdFByb3BlcnR5Lm9wdGlvbnMpLnRvRXF1YWwob3B0aW9ucyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgY3VzdG9tIGFyZ3VtZW50cycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgYXJncyA9IHsgaWNvbjogJ2xpc3QnLCBkZWZhdWx0VmFsdWU6IFsnT3B0aW9uIDEnXSB9O1xyXG4gICAgICAgICAgICBtdWx0aVNlbGVjdFByb3BlcnR5ID0gbmV3IE11bHRpU2VsZWN0UHJvcGVydHkoJ3Rlc3RTZWxlY3QnLCBvcHRpb25zLCBhcmdzKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtdWx0aVNlbGVjdFByb3BlcnR5Lm5hbWUpLnRvQmUoJ3Rlc3RTZWxlY3QnKTtcclxuICAgICAgICAgICAgZXhwZWN0KG11bHRpU2VsZWN0UHJvcGVydHkub3B0aW9ucykudG9FcXVhbChvcHRpb25zKTtcclxuICAgICAgICAgICAgZXhwZWN0KG11bHRpU2VsZWN0UHJvcGVydHkuaWNvbikudG9CZSgnbGlzdCcpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIGVtcHR5IG9wdGlvbnMgYXJyYXknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIG11bHRpU2VsZWN0UHJvcGVydHkgPSBuZXcgTXVsdGlTZWxlY3RQcm9wZXJ0eSgndGVzdFNlbGVjdCcsIFtdKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtdWx0aVNlbGVjdFByb3BlcnR5Lm9wdGlvbnMpLnRvRXF1YWwoW10pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2ZpbGxEaXNwbGF5JywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICBtdWx0aVNlbGVjdFByb3BlcnR5ID0gbmV3IE11bHRpU2VsZWN0UHJvcGVydHkoJ3Rlc3RTZWxlY3QnLCBvcHRpb25zKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGNyZWF0ZSBmaWVsZCBjb250YWluZXIgd2l0aCBjb3JyZWN0IHN0cnVjdHVyZScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWU6IHN0cmluZ1tdID0gW107XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBtdWx0aVNlbGVjdFByb3BlcnR5LmZpbGxEaXNwbGF5KG1vY2tWYXVsdCwgdmFsdWUsIG1vY2tVcGRhdGUpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lcikudG9CZURlZmluZWQoKTtcclxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci5jbGFzc0xpc3QuY29udGFpbnMoJ21ldGFkYXRhLWZpZWxkJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBzZXQgdmF1bHQgcHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbXVsdGlTZWxlY3RQcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsIHZhbHVlLCBtb2NrVXBkYXRlKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtdWx0aVNlbGVjdFByb3BlcnR5LnZhdWx0KS50b0JlKG1vY2tWYXVsdCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBjcmVhdGUgaGVhZGVyIHdpdGggY29ycmVjdCB0ZXh0JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZTogc3RyaW5nW10gPSBbXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IG11bHRpU2VsZWN0UHJvcGVydHkuZmlsbERpc3BsYXkobW9ja1ZhdWx0LCB2YWx1ZSwgbW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGhlYWRlciA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcubWV0YWRhdGEtaGVhZGVyJyk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QoaGVhZGVyKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICAgICAgICBleHBlY3QoaGVhZGVyPy50ZXh0Q29udGVudCkudG9CZSgndGVzdFNlbGVjdCcpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgY3JlYXRlIGJ1dHRvbiBjb250YWluZXInLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gbXVsdGlTZWxlY3RQcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsIHZhbHVlLCBtb2NrVXBkYXRlKTtcclxuICAgICAgICAgICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5tdWx0aS1zZWxlY3QtY29udGFpbmVyJyk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uQ29udGFpbmVyKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIG51bGwvdW5kZWZpbmVkIHZhbHVlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIxID0gbXVsdGlTZWxlY3RQcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsIG51bGwsIG1vY2tVcGRhdGUpO1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIyID0gbXVsdGlTZWxlY3RQcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsIHVuZGVmaW5lZCwgbW9ja1VwZGF0ZSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QoY29udGFpbmVyMSkudG9CZURlZmluZWQoKTtcclxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lcjIpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnZ2V0RGVmYXVsdFZhbHVlJywgKCkgPT4ge1xyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCByZXBsYWNlIHBlcnNvbmFsTmFtZSB3aXRoIGFjdHVhbCBuYW1lIGZyb20gdmF1bHQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIG11bHRpU2VsZWN0UHJvcGVydHkgPSBuZXcgTXVsdGlTZWxlY3RQcm9wZXJ0eSgndGVzdFNlbGVjdCcsIG9wdGlvbnMpO1xyXG4gICAgICAgICAgICBtdWx0aVNlbGVjdFByb3BlcnR5LmRlZmF1bHQgPSBbJ3BlcnNvbmFsTmFtZScsICdPcHRpb24gMSddO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gbXVsdGlTZWxlY3RQcm9wZXJ0eS5nZXREZWZhdWx0VmFsdWUobW9ja1ZhdWx0KTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoWydKb2huIERvZScsICdPcHRpb24gMSddKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tWYXVsdC5nZXRQZXJzb25hbE5hbWUpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIG5vdCBtb2RpZnkgdmFsdWVzIHRoYXQgYXJlIG5vdCBwZXJzb25hbE5hbWUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIG11bHRpU2VsZWN0UHJvcGVydHkgPSBuZXcgTXVsdGlTZWxlY3RQcm9wZXJ0eSgndGVzdFNlbGVjdCcsIG9wdGlvbnMpO1xyXG4gICAgICAgICAgICBtdWx0aVNlbGVjdFByb3BlcnR5LmRlZmF1bHQgPSBbJ09wdGlvbiAxJywgJ09wdGlvbiAyJ107XHJcblxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBtdWx0aVNlbGVjdFByb3BlcnR5LmdldERlZmF1bHRWYWx1ZShtb2NrVmF1bHQpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbJ09wdGlvbiAxJywgJ09wdGlvbiAyJ10pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIGFycmF5IHdpdGggbm8gcGVyc29uYWxOYW1lJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBtdWx0aVNlbGVjdFByb3BlcnR5ID0gbmV3IE11bHRpU2VsZWN0UHJvcGVydHkoJ3Rlc3RTZWxlY3QnLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgbXVsdGlTZWxlY3RQcm9wZXJ0eS5kZWZhdWx0ID0gWydPcHRpb24gMyddO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gbXVsdGlTZWxlY3RQcm9wZXJ0eS5nZXREZWZhdWx0VmFsdWUobW9ja1ZhdWx0KTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoWydPcHRpb24gMyddKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tWYXVsdC5nZXRQZXJzb25hbE5hbWUpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgZGVmYXVsdCBhcnJheScsICgpID0+IHtcclxuICAgICAgICAgICAgbXVsdGlTZWxlY3RQcm9wZXJ0eSA9IG5ldyBNdWx0aVNlbGVjdFByb3BlcnR5KCd0ZXN0U2VsZWN0Jywgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgIG11bHRpU2VsZWN0UHJvcGVydHkuZGVmYXVsdCA9IFtdO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gbXVsdGlTZWxlY3RQcm9wZXJ0eS5nZXREZWZhdWx0VmFsdWUobW9ja1ZhdWx0KTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoW10pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIG11bHRpcGxlIHBlcnNvbmFsTmFtZSBlbnRyaWVzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBtdWx0aVNlbGVjdFByb3BlcnR5ID0gbmV3IE11bHRpU2VsZWN0UHJvcGVydHkoJ3Rlc3RTZWxlY3QnLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgbXVsdGlTZWxlY3RQcm9wZXJ0eS5kZWZhdWx0ID0gWydwZXJzb25hbE5hbWUnLCAnT3B0aW9uIDEnLCAncGVyc29uYWxOYW1lJ107XHJcblxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBtdWx0aVNlbGVjdFByb3BlcnR5LmdldERlZmF1bHRWYWx1ZShtb2NrVmF1bHQpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbJ0pvaG4gRG9lJywgJ09wdGlvbiAxJywgJ0pvaG4gRG9lJ10pO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1ZhdWx0LmdldFBlcnNvbmFsTmFtZSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2NyZWF0ZUJ1dHRvbkdyb3VwJywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICBtdWx0aVNlbGVjdFByb3BlcnR5ID0gbmV3IE11bHRpU2VsZWN0UHJvcGVydHkoJ3Rlc3RTZWxlY3QnLCBvcHRpb25zKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGNyZWF0ZSBidXR0b24gZm9yIGVhY2ggb3B0aW9uJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZTogc3RyaW5nW10gPSBbXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IG11bHRpU2VsZWN0UHJvcGVydHkuY3JlYXRlQnV0dG9uR3JvdXAodmFsdWUsIG1vY2tVcGRhdGUpO1xyXG4gICAgICAgICAgICBjb25zdCBidXR0b25zID0gYnV0dG9uQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5tdWx0aS1zZWxlY3QtYnV0dG9uJyk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9ucy5sZW5ndGgpLnRvQmUoMyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b25zWzBdLnRleHRDb250ZW50KS50b0JlKCdPcHRpb24gMScpO1xyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uc1sxXS50ZXh0Q29udGVudCkudG9CZSgnT3B0aW9uIDInKTtcclxuICAgICAgICAgICAgZXhwZWN0KGJ1dHRvbnNbMl0udGV4dENvbnRlbnQpLnRvQmUoJ09wdGlvbiAzJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBtYXJrIHNlbGVjdGVkIG9wdGlvbnMgYXMgc2VsZWN0ZWQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlOiBzdHJpbmdbXSA9IFsnT3B0aW9uIDEnLCAnT3B0aW9uIDMnXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IG11bHRpU2VsZWN0UHJvcGVydHkuY3JlYXRlQnV0dG9uR3JvdXAodmFsdWUsIG1vY2tVcGRhdGUpO1xyXG4gICAgICAgICAgICBjb25zdCBidXR0b25zID0gYnV0dG9uQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5tdWx0aS1zZWxlY3QtYnV0dG9uJyk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uc1swXS5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b25zWzFdLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSkudG9CZShmYWxzZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b25zWzJdLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBzZWxlY3Rpb24nLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gbXVsdGlTZWxlY3RQcm9wZXJ0eS5jcmVhdGVCdXR0b25Hcm91cCh2YWx1ZSwgbW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbnMgPSBidXR0b25Db250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLm11bHRpLXNlbGVjdC1idXR0b24nKTtcclxuXHJcbiAgICAgICAgICAgIGJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4ge1xyXG4gICAgICAgICAgICAgICAgZXhwZWN0KGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpLnRvQmUoZmFsc2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBhbGwgb3B0aW9ucyBzZWxlY3RlZCcsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWU6IHN0cmluZ1tdID0gWydPcHRpb24gMScsICdPcHRpb24gMicsICdPcHRpb24gMyddO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gbXVsdGlTZWxlY3RQcm9wZXJ0eS5jcmVhdGVCdXR0b25Hcm91cCh2YWx1ZSwgbW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbnMgPSBidXR0b25Db250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLm11bHRpLXNlbGVjdC1idXR0b24nKTtcclxuXHJcbiAgICAgICAgICAgIGJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4ge1xyXG4gICAgICAgICAgICAgICAgZXhwZWN0KGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgYWRkIGNvbnRhaW5lciBjbGFzcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWU6IHN0cmluZ1tdID0gW107XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBidXR0b25Db250YWluZXIgPSBtdWx0aVNlbGVjdFByb3BlcnR5LmNyZWF0ZUJ1dHRvbkdyb3VwKHZhbHVlLCBtb2NrVXBkYXRlKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b25Db250YWluZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdtdWx0aS1zZWxlY3QtY29udGFpbmVyJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnQnV0dG9uIGNsaWNrIGZ1bmN0aW9uYWxpdHknLCAoKSA9PiB7XHJcbiAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgIG11bHRpU2VsZWN0UHJvcGVydHkgPSBuZXcgTXVsdGlTZWxlY3RQcm9wZXJ0eSgndGVzdFNlbGVjdCcsIG9wdGlvbnMpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgc2VsZWN0IHVuc2VsZWN0ZWQgb3B0aW9uIG9uIGNsaWNrJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZTogc3RyaW5nW10gPSBbXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IG11bHRpU2VsZWN0UHJvcGVydHkuY3JlYXRlQnV0dG9uR3JvdXAodmFsdWUsIG1vY2tVcGRhdGUpO1xyXG4gICAgICAgICAgICBjb25zdCBmaXJzdEJ1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcubXVsdGktc2VsZWN0LWJ1dHRvbicpIGFzIEhUTUxFbGVtZW50O1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgZmlyc3RCdXR0b24uY2xpY2soKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrVXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChbJ09wdGlvbiAxJ10pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgZGVzZWxlY3Qgc2VsZWN0ZWQgb3B0aW9uIG9uIGNsaWNrJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZTogc3RyaW5nW10gPSBbJ09wdGlvbiAxJywgJ09wdGlvbiAyJ107XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBidXR0b25Db250YWluZXIgPSBtdWx0aVNlbGVjdFByb3BlcnR5LmNyZWF0ZUJ1dHRvbkdyb3VwKHZhbHVlLCBtb2NrVXBkYXRlKTtcclxuICAgICAgICAgICAgY29uc3QgZmlyc3RCdXR0b24gPSBidXR0b25Db250YWluZXIucXVlcnlTZWxlY3RvcignLm11bHRpLXNlbGVjdC1idXR0b24nKSBhcyBIVE1MRWxlbWVudDtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGZpcnN0QnV0dG9uLmNsaWNrKCk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1VwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoWydPcHRpb24gMiddKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBtdWx0aXBsZSBzZWxlY3Rpb25zJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZTogc3RyaW5nW10gPSBbXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IG11bHRpU2VsZWN0UHJvcGVydHkuY3JlYXRlQnV0dG9uR3JvdXAodmFsdWUsIG1vY2tVcGRhdGUpO1xyXG4gICAgICAgICAgICBjb25zdCBidXR0b25zID0gYnV0dG9uQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5tdWx0aS1zZWxlY3QtYnV0dG9uJykgYXMgTm9kZUxpc3RPZjxIVE1MRWxlbWVudD47XHJcblxyXG4gICAgICAgICAgICAvLyBDbGljayBmaXJzdCBidXR0b25cclxuICAgICAgICAgICAgYXdhaXQgYnV0dG9uc1swXS5jbGljaygpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1VwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoWydPcHRpb24gMSddKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlc2V0IG1vY2sgZm9yIG5leHQgdGVzdFxyXG4gICAgICAgICAgICBtb2NrVXBkYXRlLm1vY2tDbGVhcigpO1xyXG5cclxuICAgICAgICAgICAgLy8gU2ltdWxhdGUgdmFsdWUgdXBkYXRlXHJcbiAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gWydPcHRpb24gMSddO1xyXG4gICAgICAgICAgICBjb25zdCBuZXdCdXR0b25Db250YWluZXIgPSBtdWx0aVNlbGVjdFByb3BlcnR5LmNyZWF0ZUJ1dHRvbkdyb3VwKG5ld1ZhbHVlLCBtb2NrVXBkYXRlKTtcclxuICAgICAgICAgICAgY29uc3QgbmV3QnV0dG9ucyA9IG5ld0J1dHRvbkNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcubXVsdGktc2VsZWN0LWJ1dHRvbicpIGFzIE5vZGVMaXN0T2Y8SFRNTEVsZW1lbnQ+O1xyXG5cclxuICAgICAgICAgICAgLy8gQ2xpY2sgc2Vjb25kIGJ1dHRvblxyXG4gICAgICAgICAgICBhd2FpdCBuZXdCdXR0b25zWzFdLmNsaWNrKCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrVXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChbJ09wdGlvbiAxJywgJ09wdGlvbiAyJ10pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIGJ1dHRvbiBjbGljayB3aXRoIHVwZGF0ZSBlcnJvcicsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgbW9ja1VwZGF0ZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ1VwZGF0ZSBmYWlsZWQnKSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gbXVsdGlTZWxlY3RQcm9wZXJ0eS5jcmVhdGVCdXR0b25Hcm91cCh2YWx1ZSwgbW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGZpcnN0QnV0dG9uID0gYnV0dG9uQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5tdWx0aS1zZWxlY3QtYnV0dG9uJykgYXMgSFRNTEVsZW1lbnQ7XHJcblxyXG4gICAgICAgICAgICAvLyBNb2NrIGNsaWNrIGV2ZW50IHRvIHRlc3QgZXJyb3IgaGFuZGxpbmdcclxuICAgICAgICAgICAgY29uc3QgY2xpY2tIYW5kbGVyID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZFZhbHVlcyA9IG5ldyBTZXQoWydPcHRpb24gMSddKTtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBtb2NrVXBkYXRlKFsuLi5zZWxlY3RlZFZhbHVlc10pO1xyXG4gICAgICAgICAgICAgICAgICAgIG11bHRpU2VsZWN0UHJvcGVydHkudXBkYXRlQnV0dG9uU3RhdGUoYnV0dG9uQ29udGFpbmVyLCBzZWxlY3RlZFZhbHVlcyk7XHJcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEVycm9yIHNob3VsZCBiZSBoYW5kbGVkIGdyYWNlZnVsbHlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIC8vIFNob3VsZCBub3QgdGhyb3cgdW5oYW5kbGVkIGVycm9yXHJcbiAgICAgICAgICAgIGF3YWl0IGV4cGVjdChjbGlja0hhbmRsZXIoKSkucmVzb2x2ZXMudG9CZVVuZGVmaW5lZCgpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1VwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ3VwZGF0ZUJ1dHRvblN0YXRlJywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICBtdWx0aVNlbGVjdFByb3BlcnR5ID0gbmV3IE11bHRpU2VsZWN0UHJvcGVydHkoJ3Rlc3RTZWxlY3QnLCBvcHRpb25zKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIHVwZGF0ZSBidXR0b24gY2xhc3NlcyBiYXNlZCBvbiBzZWxlY3RlZCB2YWx1ZXMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgICAgICAgICBjb25zdCBidXR0b25Db250YWluZXIgPSBtdWx0aVNlbGVjdFByb3BlcnR5LmNyZWF0ZUJ1dHRvbkdyb3VwKHZhbHVlLCBtb2NrVXBkYXRlKTtcclxuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRWYWx1ZXMgPSBuZXcgU2V0KFsnT3B0aW9uIDEnLCAnT3B0aW9uIDMnXSk7XHJcblxyXG4gICAgICAgICAgICBtdWx0aVNlbGVjdFByb3BlcnR5LnVwZGF0ZUJ1dHRvblN0YXRlKGJ1dHRvbkNvbnRhaW5lciwgc2VsZWN0ZWRWYWx1ZXMpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgYnV0dG9ucyA9IGJ1dHRvbkNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcubXVsdGktc2VsZWN0LWJ1dHRvbicpO1xyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uc1swXS5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b25zWzFdLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSkudG9CZShmYWxzZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b25zWzJdLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIHJlbW92ZSBhbGwgc2VsZWN0aW9ucyB3aGVuIHNldCBpcyBlbXB0eScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWU6IHN0cmluZ1tdID0gWydPcHRpb24gMScsICdPcHRpb24gMicsICdPcHRpb24gMyddO1xyXG4gICAgICAgICAgICBjb25zdCBidXR0b25Db250YWluZXIgPSBtdWx0aVNlbGVjdFByb3BlcnR5LmNyZWF0ZUJ1dHRvbkdyb3VwKHZhbHVlLCBtb2NrVXBkYXRlKTtcclxuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRWYWx1ZXMgPSBuZXcgU2V0PHN0cmluZz4oW10pO1xyXG5cclxuICAgICAgICAgICAgbXVsdGlTZWxlY3RQcm9wZXJ0eS51cGRhdGVCdXR0b25TdGF0ZShidXR0b25Db250YWluZXIsIHNlbGVjdGVkVmFsdWVzKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbnMgPSBidXR0b25Db250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLm11bHRpLXNlbGVjdC1idXR0b24nKTtcclxuICAgICAgICAgICAgYnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICBleHBlY3QoYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSkudG9CZShmYWxzZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIGJ1dHRvbnMgd2l0aCBubyB0ZXh0IGNvbnRlbnQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgICAgICAgICBjb25zdCBidXR0b25Db250YWluZXIgPSBtdWx0aVNlbGVjdFByb3BlcnR5LmNyZWF0ZUJ1dHRvbkdyb3VwKHZhbHVlLCBtb2NrVXBkYXRlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIE1hbnVhbGx5IGNyZWF0ZSBhIGJ1dHRvbiB3aXRoIG5vIHRleHQgY29udGVudFxyXG4gICAgICAgICAgICBjb25zdCBlbXB0eUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xyXG4gICAgICAgICAgICBlbXB0eUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdtdWx0aS1zZWxlY3QtYnV0dG9uJyk7XHJcbiAgICAgICAgICAgIGJ1dHRvbkNvbnRhaW5lci5hcHBlbmRDaGlsZChlbXB0eUJ1dHRvbik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzZWxlY3RlZFZhbHVlcyA9IG5ldyBTZXQoWydPcHRpb24gMSddKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFNob3VsZCBub3QgdGhyb3cgZXJyb3JcclxuICAgICAgICAgICAgZXhwZWN0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIG11bHRpU2VsZWN0UHJvcGVydHkudXBkYXRlQnV0dG9uU3RhdGUoYnV0dG9uQ29udGFpbmVyLCBzZWxlY3RlZFZhbHVlcyk7XHJcbiAgICAgICAgICAgIH0pLm5vdC50b1Rocm93KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnSW50ZWdyYXRpb24gdGVzdHMnLCAoKSA9PiB7XHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIHdvcmsgd2l0aCByZWFsIERPTSBpbnRlcmFjdGlvbnMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIG11bHRpU2VsZWN0UHJvcGVydHkgPSBuZXcgTXVsdGlTZWxlY3RQcm9wZXJ0eSgnQ2F0ZWdvcmllcycsIFtcclxuICAgICAgICAgICAgICAgIHsgbmFtZTogJ1dvcmsnLCBjb2xvcjogJyNGRjAwMDAnIH0sXHJcbiAgICAgICAgICAgICAgICB7IG5hbWU6ICdQZXJzb25hbCcsIGNvbG9yOiAnIzAwRkYwMCcgfVxyXG4gICAgICAgICAgICBdKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IG11bHRpU2VsZWN0UHJvcGVydHkuZmlsbERpc3BsYXkobW9ja1ZhdWx0LCBbJ1dvcmsnXSwgbW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHdvcmtCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbdGV4dENvbnRlbnQ9XCJXb3JrXCJdJykgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHBlcnNvbmFsQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW3RleHRDb250ZW50PVwiUGVyc29uYWxcIl0nKSBhcyBIVE1MRWxlbWVudDtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdCh3b3JrQnV0dG9uKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICAgICAgICBleHBlY3QocGVyc29uYWxCdXR0b24pLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgZWRnZSBjYXNlIHdpdGggbm8gb3B0aW9ucycsICgpID0+IHtcclxuICAgICAgICAgICAgbXVsdGlTZWxlY3RQcm9wZXJ0eSA9IG5ldyBNdWx0aVNlbGVjdFByb3BlcnR5KCdFbXB0eScsIFtdKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IG11bHRpU2VsZWN0UHJvcGVydHkuZmlsbERpc3BsYXkobW9ja1ZhdWx0LCBbXSwgbW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbnMgPSBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLm11bHRpLXNlbGVjdC1idXR0b24nKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b25zLmxlbmd0aCkudG9CZSgwKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIG1haW50YWluIHN0YXRlIGNvbnNpc3RlbmN5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBtdWx0aVNlbGVjdFByb3BlcnR5ID0gbmV3IE11bHRpU2VsZWN0UHJvcGVydHkoJ3Rlc3RTZWxlY3QnLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWU6IHN0cmluZ1tdID0gWydPcHRpb24gMiddO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gbXVsdGlTZWxlY3RQcm9wZXJ0eS5jcmVhdGVCdXR0b25Hcm91cCh2YWx1ZSwgbW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbnMgPSBidXR0b25Db250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLm11bHRpLXNlbGVjdC1idXR0b24nKSBhcyBOb2RlTGlzdE9mPEhUTUxFbGVtZW50PjtcclxuXHJcbiAgICAgICAgICAgIC8vIFZlcmlmeSBpbml0aWFsIHN0YXRlXHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b25zWzFdLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSkudG9CZSh0cnVlKTtcclxuXHJcbiAgICAgICAgICAgIC8vIENsaWNrIHRvIGRlc2VsZWN0XHJcbiAgICAgICAgICAgIGF3YWl0IGJ1dHRvbnNbMV0uY2xpY2soKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tVcGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFtdKTtcclxuXHJcbiAgICAgICAgICAgIC8vIENsaWNrIHRvIHNlbGVjdCBhZ2FpblxyXG4gICAgICAgICAgICBtb2NrVXBkYXRlLm1vY2tDbGVhcigpO1xyXG4gICAgICAgICAgICBjb25zdCBuZXdCdXR0b25Db250YWluZXIgPSBtdWx0aVNlbGVjdFByb3BlcnR5LmNyZWF0ZUJ1dHRvbkdyb3VwKFtdLCBtb2NrVXBkYXRlKTtcclxuICAgICAgICAgICAgY29uc3QgbmV3QnV0dG9ucyA9IG5ld0J1dHRvbkNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcubXVsdGktc2VsZWN0LWJ1dHRvbicpIGFzIE5vZGVMaXN0T2Y8SFRNTEVsZW1lbnQ+O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgYXdhaXQgbmV3QnV0dG9uc1sxXS5jbGljaygpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1VwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoWydPcHRpb24gMiddKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59KTtcclxuIl0sInZlcnNpb24iOjN9