{"file":"C:\\Users\\leodu\\Documents\\1 - Pro\\Test plugin obsidian\\.obsidian\\plugins\\obsidian-CRM\\dynamic-fields\\src\\properties\\LinkProperty.ts","mappings":"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","names":[],"sources":["C:\\Users\\leodu\\Documents\\1 - Pro\\Test plugin obsidian\\.obsidian\\plugins\\obsidian-CRM\\dynamic-fields\\src\\properties\\LinkProperty.ts"],"sourcesContent":["import { Property } from \"./Property\";\r\nimport { setIcon, sendNotice } from \"../vault/Utils\";\r\nimport { Vault } from \"../vault/Vault\";\r\n\r\n\r\n\r\nexport class LinkProperty extends Property{\r\n\r\n  override type : string = \"link\";\r\n\r\n  constructor(name: string, vault: Vault, args: { icon?: string} = { icon: \"square-arrow-out-up-right\" }) {\r\n    super(name, vault, args);\r\n  }\r\n\r\n  override createIconContainer(update: (value: string) => Promise<void>) {\r\n    const iconContainer = super.createIconContainer(update);\r\n    iconContainer.style.cursor = \"pointer\";\r\n\r\n    if (!this.static) {\r\n      iconContainer.onclick = (event) => this.modifyField(event);\r\n    }\r\n\r\n    return iconContainer;\r\n  }\r\n\r\n\r\n    override validate(url: string) {\r\n      // Ajoute le préfixe \"http://\" si l'URL ne commence pas par http:// ou https://\r\n      let fixedUrl = url.trim();\r\n  \r\n      // Si le lien ne commence pas par http:// ou https://, ajoute \"http://\"\r\n      if (!/^https?:\\/\\//i.test(fixedUrl)) {\r\n          fixedUrl = \"http://\" + fixedUrl;\r\n      }\r\n      const urlRegex = /^(https?:\\/\\/)?([a-zA-Z0-9_-]+\\.)+[a-zA-Z]{2,6}(\\/[a-zA-Z0-9_-]+)*\\/?$/;\r\n      if (!urlRegex.test(fixedUrl)) {\r\n          return \"\";\r\n      }\r\n      return fixedUrl;\r\n    }\r\n\r\n\r\n    override getPretty(value: string) {\r\n      if (!value) return value;\r\n      try {\r\n        const urlObj = new URL(value);\r\n        // Garde le domaine, puis les premiers segments du chemin si trop long\r\n        let pretty = urlObj.hostname;\r\n        if (urlObj.pathname && urlObj.pathname !== \"/\") {\r\n          const segments = urlObj.pathname.split(\"/\").filter(Boolean);\r\n          if (segments.length > 2) {\r\n            pretty += \"/\" + segments.slice(0, 2).join(\"/\") + \"/...\";\r\n          } else {\r\n            pretty += urlObj.pathname;\r\n          }\r\n        }\r\n        return pretty;\r\n      } catch {\r\n        // Si ce n'est pas une URL valide, retourne la valeur d'origine sans protocole\r\n        return value.replace(/^https?:\\/\\//, \"\");\r\n      }\r\n    }\r\n\r\n    // Fonction pour créer le lien de l'field\r\n    override createFieldLink(value: string) : any {\r\n      const link = document.createElement(\"a\");\r\n      link.href = this.getLink(value);\r\n      link.textContent = this.getPretty(value) || \"\";\r\n      link.classList.add(\"field-link\");\r\n      link.oncontextmenu = (event) => {\r\n        event.preventDefault();\r\n        const value = link.textContent;\r\n        if (value) {\r\n          navigator.clipboard.writeText(value).then(() => {\r\n        sendNotice(\"Lien copié dans le presse-papiers\");\r\n          });\r\n        }\r\n      };\r\n      return link;\r\n    }\r\n}"],"version":3}