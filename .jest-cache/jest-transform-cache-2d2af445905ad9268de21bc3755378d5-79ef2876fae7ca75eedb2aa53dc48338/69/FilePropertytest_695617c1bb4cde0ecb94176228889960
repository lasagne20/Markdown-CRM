02111491ff0d535bbd8d87a3095bb9d0
"use strict";
/**
 * @jest-environment jsdom
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock entire modules
jest.mock('../../src/vault/Utils', () => ({
    setIcon: jest.fn(),
    Notice: jest.fn(),
    selectFile: jest.fn()
}));
const FileProperty_1 = require("../../src/properties/FileProperty");
const LinkProperty_1 = require("../../src/properties/LinkProperty");
// Mock global functions
global.selectFile = jest.fn();
// Get reference to mocked function
const { selectFile } = require('../../src/vault/Utils');
describe('FileProperty', () => {
    let fileProperty;
    let mockVault;
    beforeEach(() => {
        // Reset DOM mocks
        document.body.innerHTML = '';
        jest.clearAllMocks();
        // Mock vault with necessary methods
        mockVault = {
            readLinkFile: jest.fn(),
            getFromLink: jest.fn(),
            getFromFile: jest.fn(),
            app: {
                vault: {
                    getName: jest.fn().mockReturnValue('TestVault'),
                    getAbstractFileByPath: jest.fn()
                },
                workspace: {
                    getLeaf: jest.fn().mockReturnValue({
                        openFile: jest.fn()
                    })
                },
                setIcon: jest.fn(),
                selectFile: jest.fn()
            }
        };
    });
    beforeEach(() => {
        fileProperty = new FileProperty_1.FileProperty('testFile', mockVault, ['class1', 'class2']);
    });
    describe('constructor', () => {
        it('should create FileProperty with correct type', () => {
            expect(fileProperty.type).toBe('file');
        });
        it('should inherit from LinkProperty', () => {
            expect(fileProperty).toBeInstanceOf(LinkProperty_1.LinkProperty);
        });
        it('should store classes correctly', () => {
            expect(fileProperty.classes).toEqual(['class1', 'class2']);
        });
        it('should pass args to parent constructor', () => {
            const customArgs = { icon: 'custom-icon' };
            const customProperty = new FileProperty_1.FileProperty('customName', mockVault, ['class1'], customArgs);
            expect(customProperty.name).toBe('customName');
            expect(customProperty.classes).toEqual(['class1']);
        });
        it('should handle empty classes array', () => {
            const emptyClassProperty = new FileProperty_1.FileProperty('empty', mockVault, []);
            expect(emptyClassProperty.classes).toEqual([]);
        });
    });
    describe('getClasses', () => {
        it('should return classes array', () => {
            expect(fileProperty.getClasses()).toEqual(['class1', 'class2']);
        });
        it('should return empty array when no classes', () => {
            const emptyProperty = new FileProperty_1.FileProperty('test', mockVault, []);
            expect(emptyProperty.getClasses()).toEqual([]);
        });
        it('should return same reference to classes array', () => {
            const classes = ['test1', 'test2'];
            const property = new FileProperty_1.FileProperty('test', mockVault, classes);
            expect(property.getClasses()).toBe(classes);
        });
    });
    //     it('should handle object values', () => {
    //         const objectValue = { test: 'value' };
    //         expect(fileProperty.getParentValue(objectValue)).toBe(objectValue);
    //     });
    // });
    describe('getPretty', () => {
        it('should call vault.readLinkFile with value', () => {
            const testValue = '[[TestFile]]';
            mockVault.readLinkFile.mockReturnValue('TestFile');
            fileProperty.vault = mockVault;
            const result = fileProperty.getPretty(testValue);
            expect(mockVault.readLinkFile).toHaveBeenCalledWith(testValue);
            expect(result).toBe('TestFile');
        });
        it('should handle empty value', () => {
            mockVault.readLinkFile.mockReturnValue('');
            fileProperty.vault = mockVault;
            const result = fileProperty.getPretty('');
            expect(mockVault.readLinkFile).toHaveBeenCalledWith('');
            expect(result).toBe('');
        });
    });
    describe('getClasse', () => {
        it('should return classe when found', () => {
            const mockClasse = { name: 'TestClass' };
            const mockRead = {};
            const testLink = '[[TestFile]]';
            fileProperty.read = jest.fn().mockReturnValue(testLink);
            mockVault.getFromLink.mockReturnValue(mockClasse);
            fileProperty.vault = mockVault;
            const result = fileProperty.getClasse(mockRead);
            expect(fileProperty.read).toHaveBeenCalledWith(mockRead);
            expect(mockVault.getFromLink).toHaveBeenCalledWith(testLink);
            expect(result).toBe(mockClasse);
        });
        it('should return undefined when no link found', () => {
            const mockRead = {};
            fileProperty.read = jest.fn().mockReturnValue(null);
            fileProperty.vault = mockVault;
            const result = fileProperty.getClasse(mockRead);
            expect(result).toBeUndefined();
        });
        it('should return undefined when classe not found', () => {
            const mockRead = {};
            const testLink = '[[TestFile]]';
            fileProperty.read = jest.fn().mockReturnValue(testLink);
            mockVault.getFromLink.mockReturnValue(null);
            fileProperty.vault = mockVault;
            const result = fileProperty.getClasse(mockRead);
            expect(result).toBeUndefined();
        });
    });
    describe('validate', () => {
        it('should extract and return valid Obsidian link', () => {
            const input = '[[TestFile]]';
            expect(fileProperty.validate(input)).toBe('[[TestFile]]');
        });
        it('should extract link from text with link', () => {
            const input = 'Some text [[TestFile]] more text';
            expect(fileProperty.validate(input)).toBe('[[TestFile]]');
        });
        it('should handle link with alias', () => {
            const input = '[[TestFile|Alias]]';
            expect(fileProperty.validate(input)).toBe('[[TestFile|Alias]]');
        });
        it('should return empty string for invalid format', () => {
            const input = 'Just plain text';
            expect(fileProperty.validate(input)).toBe('');
        });
        it('should return empty string for malformed links', () => {
            const input = '[[TestFile';
            expect(fileProperty.validate(input)).toBe('');
        });
        it('should handle empty string', () => {
            expect(fileProperty.validate('')).toBe('');
        });
        it('should handle multiple links and return first', () => {
            const input = '[[FirstFile]] and [[SecondFile]]';
            expect(fileProperty.validate(input)).toBe('[[FirstFile]]');
        });
    });
    describe('getLink', () => {
        beforeEach(() => {
            fileProperty.vault = mockVault;
        });
        it('should generate obsidian URL with file path when file exists', () => {
            const testValue = '[[TestFile]]';
            const filePath = 'path/to/TestFile.md';
            mockVault.readLinkFile.mockReturnValueOnce(filePath).mockReturnValueOnce('TestFile');
            mockVault.app.vault.getAbstractFileByPath.mockReturnValue(true);
            const result = fileProperty.getLink(testValue);
            expect(result).toBe('obsidian://open?vault=TestVault&file=path%2Fto%2FTestFile.md');
        });
        it('should use fallback when file does not exist', () => {
            const testValue = '[[TestFile]]';
            const filePath = 'path/to/TestFile.md';
            mockVault.readLinkFile.mockReturnValueOnce(filePath).mockReturnValueOnce('TestFile');
            mockVault.app.vault.getAbstractFileByPath.mockReturnValue(null);
            const result = fileProperty.getLink(testValue);
            expect(result).toBe('obsidian://open?vault=TestVault&file=TestFile');
        });
        it('should set vault when provided as parameter', () => {
            const newVault = { ...mockVault };
            fileProperty.vault = null;
            mockVault.readLinkFile.mockReturnValue('TestFile');
            mockVault.app.vault.getAbstractFileByPath.mockReturnValue(null);
            fileProperty.getLink('[[TestFile]]', newVault);
            expect(fileProperty.vault).toBe(newVault);
        });
        it('should encode special characters in vault name', () => {
            const testValue = '[[TestFile]]';
            mockVault.app.vault.getName.mockReturnValue('My Vault & Stuff');
            mockVault.readLinkFile.mockReturnValue('TestFile');
            mockVault.app.vault.getAbstractFileByPath.mockReturnValue(null);
            const result = fileProperty.getLink(testValue);
            expect(result).toContain('vault=My%20Vault%20%26%20Stuff');
        });
    });
    describe('createIconContainer', () => {
        it('should create icon container with correct structure', () => {
            const mockUpdate = jest.fn();
            const result = fileProperty.createIconContainer(mockUpdate);
            expect(result.tagName).toBe('DIV');
            expect(result.classList.contains('icon-container')).toBe(true);
            expect(result.children.length).toBe(1);
        });
        it('should set cursor pointer when not static', () => {
            const mockUpdate = jest.fn();
            fileProperty.static = false;
            const result = fileProperty.createIconContainer(mockUpdate);
            const icon = result.children[0];
            expect(icon.style.cursor).toBe('pointer');
        });
        it('should not set cursor pointer when static', () => {
            const mockUpdate = jest.fn();
            fileProperty.static = true;
            const result = fileProperty.createIconContainer(mockUpdate);
            const icon = result.children[0];
            expect(icon.style.cursor).toBe('');
        });
    });
    describe('handleIconClick', () => {
        beforeEach(() => {
            fileProperty.vault = mockVault;
        });
        it('should call selectFile with correct parameters', async () => {
            const mockUpdate = jest.fn();
            const mockEvent = {
                target: document.createElement('div')
            };
            mockVault.app.selectFile.mockResolvedValue(null);
            await fileProperty.handleIconClick(mockUpdate, mockEvent);
            expect(mockVault.app.selectFile).toHaveBeenCalledWith(mockVault, ['class1', 'class2'], { hint: "Choisissez un fichier class1 ou class2" });
        });
        it('should update value when file selected', async () => {
            const mockUpdate = jest.fn();
            const mockFile = {
                getLink: jest.fn().mockReturnValue('[[SelectedFile]]')
            };
            const mockEvent = {
                target: document.createElement('div')
            };
            mockVault.app.selectFile.mockResolvedValue(mockFile);
            await fileProperty.handleIconClick(mockUpdate, mockEvent);
            expect(mockUpdate).toHaveBeenCalledWith('[[SelectedFile]]');
        });
        it('should not update when no file selected', async () => {
            const mockUpdate = jest.fn();
            const mockEvent = {
                target: document.createElement('div')
            };
            mockVault.app.selectFile.mockResolvedValue(null);
            await fileProperty.handleIconClick(mockUpdate, mockEvent);
            expect(mockUpdate).not.toHaveBeenCalled();
        });
    });
    describe('createFieldContainerContent', () => {
        beforeEach(() => {
            fileProperty.vault = mockVault;
        });
        it('should create field container with correct structure', () => {
            const mockUpdate = jest.fn();
            const testValue = '[[TestFile]]';
            mockVault.readLinkFile.mockReturnValue('TestFile');
            fileProperty.getLink = jest.fn().mockReturnValue('obsidian://test');
            const result = fileProperty.createFieldContainerContent(mockUpdate, testValue);
            expect(result.tagName).toBe('DIV');
            expect(result.classList.contains('field-container')).toBe(true);
        });
        it('should create link with correct href and text', () => {
            const mockUpdate = jest.fn();
            const testValue = '[[TestFile]]';
            mockVault.readLinkFile.mockReturnValue('TestFile');
            fileProperty.getLink = jest.fn().mockReturnValue('obsidian://test');
            const result = fileProperty.createFieldContainerContent(mockUpdate, testValue);
            const link = result.querySelector('a');
            expect(link?.href).toBe('obsidian://test');
            expect(link?.textContent).toBe('TestFile');
            expect(link?.classList.contains('field-link')).toBe(true);
        });
        it('should handle empty value', () => {
            const mockUpdate = jest.fn();
            const testValue = '';
            mockVault.readLinkFile.mockReturnValue('');
            fileProperty.getLink = jest.fn().mockReturnValue('obsidian://test');
            const result = fileProperty.createFieldContainerContent(mockUpdate, testValue);
            const link = result.querySelector('a');
            expect(link?.textContent).toBe('');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxfX3Rlc3RzX19cXFByb3BlcnRpZXNcXEZpbGVQcm9wZXJ0eS50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7QUFLSCxzQkFBc0I7QUFDdEIsSUFBSSxDQUFDLElBQUksQ0FBQyx1QkFBdUIsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ3RDLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ2xCLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ2pCLFVBQVUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0NBQ3hCLENBQUMsQ0FBQyxDQUFDO0FBUkosb0VBQWlFO0FBQ2pFLG9FQUFpRTtBQVNqRSx3QkFBd0I7QUFDdkIsTUFBYyxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7QUFFdkMsbUNBQW1DO0FBQ25DLE1BQU0sRUFBRSxVQUFVLEVBQUUsR0FBRyxPQUFPLENBQUMsdUJBQXVCLENBQUMsQ0FBQztBQUV4RCxRQUFRLENBQUMsY0FBYyxFQUFFLEdBQUcsRUFBRTtJQUMxQixJQUFJLFlBQTBCLENBQUM7SUFDL0IsSUFBSSxTQUFjLENBQUM7SUFFbkIsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNaLGtCQUFrQjtRQUNsQixRQUFRLENBQUMsSUFBSSxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUM7UUFDN0IsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBRXJCLG9DQUFvQztRQUNwQyxTQUFTLEdBQUc7WUFDUixZQUFZLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUN2QixXQUFXLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUN0QixXQUFXLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUN0QixHQUFHLEVBQUU7Z0JBQ0Qs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QUMzQyxNQUFNLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDOUQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMkJBQTJCLEVBQUUsR0FBRyxFQUFFO1lBQ2pDLE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQztZQUM3QixNQUFNLFNBQVMsR0FBRyxFQUFFLENBQUM7WUFFckIsU0FBUyxDQUFDLFlBQVksQ0FBQyxlQUFlLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDM0MsWUFBWSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLGlCQUFpQixDQUFDLENBQUM7WUFFcEUsTUFBTSxNQUFNLEdBQUcsWUFBWSxDQUFDLDJCQUEyQixDQUFDLFVBQVUsRUFBRSxTQUFTLENBQUMsQ0FBQztZQUMvRSxNQUFNLElBQUksR0FBRyxNQUFNLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBRXZDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsV0FBVyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ3ZDLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGxlb2R1XFxEb2N1bWVudHNcXDEgLSBQcm9cXFRlc3QgcGx1Z2luIG9ic2lkaWFuXFwub2JzaWRpYW5cXHBsdWdpbnNcXG9ic2lkaWFuLUNSTVxcZHluYW1pYy1maWVsZHNcXF9fdGVzdHNfX1xcUHJvcGVydGllc1xcRmlsZVByb3BlcnR5LnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBqZXN0LWVudmlyb25tZW50IGpzZG9tXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgRmlsZVByb3BlcnR5IH0gZnJvbSAnLi4vLi4vc3JjL3Byb3BlcnRpZXMvRmlsZVByb3BlcnR5JztcclxuaW1wb3J0IHsgTGlua1Byb3BlcnR5IH0gZnJvbSAnLi4vLi4vc3JjL3Byb3BlcnRpZXMvTGlua1Byb3BlcnR5JztcclxuXHJcbi8vIE1vY2sgZW50aXJlIG1vZHVsZXNcclxuamVzdC5tb2NrKCcuLi8uLi9zcmMvdmF1bHQvVXRpbHMnLCAoKSA9PiAoe1xyXG4gICAgc2V0SWNvbjogamVzdC5mbigpLFxyXG4gICAgTm90aWNlOiBqZXN0LmZuKCksXHJcbiAgICBzZWxlY3RGaWxlOiBqZXN0LmZuKClcclxufSkpO1xyXG5cclxuLy8gTW9jayBnbG9iYWwgZnVuY3Rpb25zXHJcbihnbG9iYWwgYXMgYW55KS5zZWxlY3RGaWxlID0gamVzdC5mbigpO1xyXG5cclxuLy8gR2V0IHJlZmVyZW5jZSB0byBtb2NrZWQgZnVuY3Rpb25cclxuY29uc3QgeyBzZWxlY3RGaWxlIH0gPSByZXF1aXJlKCcuLi8uLi9zcmMvdmF1bHQvVXRpbHMnKTtcclxuXHJcbmRlc2NyaWJlKCdGaWxlUHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICBsZXQgZmlsZVByb3BlcnR5OiBGaWxlUHJvcGVydHk7XHJcbiAgICBsZXQgbW9ja1ZhdWx0OiBhbnk7XHJcblxyXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgLy8gUmVzZXQgRE9NIG1vY2tzXHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBNb2NrIHZhdWx0IHdpdGggbmVjZXNzYXJ5IG1ldGhvZHNcclxuICAgICAgICBtb2NrVmF1bHQgPSB7XHJcbiAgICAgICAgICAgIHJlYWRMaW5rRmlsZTogamVzdC5mbigpLFxyXG4gICAgICAgICAgICBnZXRGcm9tTGluazogamVzdC5mbigpLFxyXG4gICAgICAgICAgICBnZXRGcm9tRmlsZTogamVzdC5mbigpLFxyXG4gICAgICAgICAgICBhcHA6IHtcclxuICAgICAgICAgICAgICAgIHZhdWx0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0TmFtZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnVGVzdFZhdWx0JyksXHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0QWJzdHJhY3RGaWxlQnlQYXRoOiBqZXN0LmZuKClcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB3b3Jrc3BhY2U6IHtcclxuICAgICAgICAgICAgICAgICAgICBnZXRMZWFmOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3BlbkZpbGU6IGplc3QuZm4oKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc2V0SWNvbjogamVzdC5mbigpLFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0RmlsZTogamVzdC5mbigpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcblxyXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgZmlsZVByb3BlcnR5ID0gbmV3IEZpbGVQcm9wZXJ0eSgndGVzdEZpbGUnLCBtb2NrVmF1bHQsIFsnY2xhc3MxJywgJ2NsYXNzMiddKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdjb25zdHJ1Y3RvcicsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBGaWxlUHJvcGVydHkgd2l0aCBjb3JyZWN0IHR5cGUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChmaWxlUHJvcGVydHkudHlwZSkudG9CZSgnZmlsZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGluaGVyaXQgZnJvbSBMaW5rUHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChmaWxlUHJvcGVydHkpLnRvQmVJbnN0YW5jZU9mKExpbmtQcm9wZXJ0eSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgc3RvcmUgY2xhc3NlcyBjb3JyZWN0bHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChmaWxlUHJvcGVydHkuY2xhc3NlcykudG9FcXVhbChbJ2NsYXNzMScsICdjbGFzczInXSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcGFzcyBhcmdzIHRvIHBhcmVudCBjb25zdHJ1Y3RvcicsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VzdG9tQXJncyA9IHsgaWNvbjogJ2N1c3RvbS1pY29uJyB9O1xyXG4gICAgICAgICAgICBjb25zdCBjdXN0b21Qcm9wZXJ0eSA9IG5ldyBGaWxlUHJvcGVydHkoJ2N1c3RvbU5hbWUnLCBtb2NrVmF1bHQsIFsnY2xhc3MxJ10sIGN1c3RvbUFyZ3MpO1xyXG4gICAgICAgICAgICBleHBlY3QoY3VzdG9tUHJvcGVydHkubmFtZSkudG9CZSgnY3VzdG9tTmFtZScpO1xyXG4gICAgICAgICAgICBleHBlY3QoY3VzdG9tUHJvcGVydHkuY2xhc3NlcykudG9FcXVhbChbJ2NsYXNzMSddKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgY2xhc3NlcyBhcnJheScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZW1wdHlDbGFzc1Byb3BlcnR5ID0gbmV3IEZpbGVQcm9wZXJ0eSgnZW1wdHknLCBtb2NrVmF1bHQsIFtdKTtcclxuICAgICAgICAgICAgZXhwZWN0KGVtcHR5Q2xhc3NQcm9wZXJ0eS5jbGFzc2VzKS50b0VxdWFsKFtdKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdnZXRDbGFzc2VzJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGNsYXNzZXMgYXJyYXknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChmaWxlUHJvcGVydHkuZ2V0Q2xhc3NlcygpKS50b0VxdWFsKFsnY2xhc3MxJywgJ2NsYXNzMiddKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gZW1wdHkgYXJyYXkgd2hlbiBubyBjbGFzc2VzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBlbXB0eVByb3BlcnR5ID0gbmV3IEZpbGVQcm9wZXJ0eSgndGVzdCcsIG1vY2tWYXVsdCwgW10pO1xyXG4gICAgICAgICAgICBleHBlY3QoZW1wdHlQcm9wZXJ0eS5nZXRDbGFzc2VzKCkpLnRvRXF1YWwoW10pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBzYW1lIHJlZmVyZW5jZSB0byBjbGFzc2VzIGFycmF5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjbGFzc2VzID0gWyd0ZXN0MScsICd0ZXN0MiddO1xyXG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0eSA9IG5ldyBGaWxlUHJvcGVydHkoJ3Rlc3QnLCBtb2NrVmF1bHQsIGNsYXNzZXMpO1xyXG4gICAgICAgICAgICBleHBlY3QocHJvcGVydHkuZ2V0Q2xhc3NlcygpKS50b0JlKGNsYXNzZXMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG5cclxuICAgIC8vICAgICBpdCgnc2hvdWxkIGhhbmRsZSBvYmplY3QgdmFsdWVzJywgKCkgPT4ge1xyXG4gICAgLy8gICAgICAgICBjb25zdCBvYmplY3RWYWx1ZSA9IHsgdGVzdDogJ3ZhbHVlJyB9O1xyXG4gICAgLy8gICAgICAgICBleHBlY3QoZmlsZVByb3BlcnR5LmdldFBhcmVudFZhbHVlKG9iamVjdFZhbHVlKSkudG9CZShvYmplY3RWYWx1ZSk7XHJcbiAgICAvLyAgICAgfSk7XHJcbiAgICAvLyB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnZ2V0UHJldHR5JywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgY2FsbCB2YXVsdC5yZWFkTGlua0ZpbGUgd2l0aCB2YWx1ZScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdGVzdFZhbHVlID0gJ1tbVGVzdEZpbGVdXSc7XHJcbiAgICAgICAgICAgIG1vY2tWYXVsdC5yZWFkTGlua0ZpbGUubW9ja1JldHVyblZhbHVlKCdUZXN0RmlsZScpO1xyXG4gICAgICAgICAgICBmaWxlUHJvcGVydHkudmF1bHQgPSBtb2NrVmF1bHQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBmaWxlUHJvcGVydHkuZ2V0UHJldHR5KHRlc3RWYWx1ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1ZhdWx0LnJlYWRMaW5rRmlsZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgodGVzdFZhbHVlKTtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSgnVGVzdEZpbGUnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgdmFsdWUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIG1vY2tWYXVsdC5yZWFkTGlua0ZpbGUubW9ja1JldHVyblZhbHVlKCcnKTtcclxuICAgICAgICAgICAgZmlsZVByb3BlcnR5LnZhdWx0ID0gbW9ja1ZhdWx0O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gZmlsZVByb3BlcnR5LmdldFByZXR0eSgnJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1ZhdWx0LnJlYWRMaW5rRmlsZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJycpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKCcnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdnZXRDbGFzc2UnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gY2xhc3NlIHdoZW4gZm91bmQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tDbGFzc2UgPSB7IG5hbWU6ICdUZXN0Q2xhc3MnIH07XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZWFkID0ge30gYXMgYW55O1xyXG4gICAgICAgICAgICBjb25zdCB0ZXN0TGluayA9ICdbW1Rlc3RGaWxlXV0nO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZmlsZVByb3BlcnR5LnJlYWQgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHRlc3RMaW5rKTtcclxuICAgICAgICAgICAgbW9ja1ZhdWx0LmdldEZyb21MaW5rLm1vY2tSZXR1cm5WYWx1ZShtb2NrQ2xhc3NlKTtcclxuICAgICAgICAgICAgZmlsZVByb3BlcnR5LnZhdWx0ID0gbW9ja1ZhdWx0O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gZmlsZVByb3BlcnR5LmdldENsYXNzZShtb2NrUmVhZCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QoZmlsZVByb3BlcnR5LnJlYWQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1vY2tSZWFkKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tWYXVsdC5nZXRGcm9tTGluaykudG9IYXZlQmVlbkNhbGxlZFdpdGgodGVzdExpbmspO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKG1vY2tDbGFzc2UpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiB1bmRlZmluZWQgd2hlbiBubyBsaW5rIGZvdW5kJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVhZCA9IHt9IGFzIGFueTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGZpbGVQcm9wZXJ0eS5yZWFkID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShudWxsKTtcclxuICAgICAgICAgICAgZmlsZVByb3BlcnR5LnZhdWx0ID0gbW9ja1ZhdWx0O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gZmlsZVByb3BlcnR5LmdldENsYXNzZShtb2NrUmVhZCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlVW5kZWZpbmVkKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIHVuZGVmaW5lZCB3aGVuIGNsYXNzZSBub3QgZm91bmQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZWFkID0ge30gYXMgYW55O1xyXG4gICAgICAgICAgICBjb25zdCB0ZXN0TGluayA9ICdbW1Rlc3RGaWxlXV0nO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZmlsZVByb3BlcnR5LnJlYWQgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHRlc3RMaW5rKTtcclxuICAgICAgICAgICAgbW9ja1ZhdWx0LmdldEZyb21MaW5rLm1vY2tSZXR1cm5WYWx1ZShudWxsKTtcclxuICAgICAgICAgICAgZmlsZVByb3BlcnR5LnZhdWx0ID0gbW9ja1ZhdWx0O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gZmlsZVByb3BlcnR5LmdldENsYXNzZShtb2NrUmVhZCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlVW5kZWZpbmVkKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgndmFsaWRhdGUnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBleHRyYWN0IGFuZCByZXR1cm4gdmFsaWQgT2JzaWRpYW4gbGluaycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSAnW1tUZXN0RmlsZV1dJztcclxuICAgICAgICAgICAgZXhwZWN0KGZpbGVQcm9wZXJ0eS52YWxpZGF0ZShpbnB1dCkpLnRvQmUoJ1tbVGVzdEZpbGVdXScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGV4dHJhY3QgbGluayBmcm9tIHRleHQgd2l0aCBsaW5rJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpbnB1dCA9ICdTb21lIHRleHQgW1tUZXN0RmlsZV1dIG1vcmUgdGV4dCc7XHJcbiAgICAgICAgICAgIGV4cGVjdChmaWxlUHJvcGVydHkudmFsaWRhdGUoaW5wdXQpKS50b0JlKCdbW1Rlc3RGaWxlXV0nKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgbGluayB3aXRoIGFsaWFzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpbnB1dCA9ICdbW1Rlc3RGaWxlfEFsaWFzXV0nO1xyXG4gICAgICAgICAgICBleHBlY3QoZmlsZVByb3BlcnR5LnZhbGlkYXRlKGlucHV0KSkudG9CZSgnW1tUZXN0RmlsZXxBbGlhc11dJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGVtcHR5IHN0cmluZyBmb3IgaW52YWxpZCBmb3JtYXQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gJ0p1c3QgcGxhaW4gdGV4dCc7XHJcbiAgICAgICAgICAgIGV4cGVjdChmaWxlUHJvcGVydHkudmFsaWRhdGUoaW5wdXQpKS50b0JlKCcnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gZW1wdHkgc3RyaW5nIGZvciBtYWxmb3JtZWQgbGlua3MnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gJ1tbVGVzdEZpbGUnO1xyXG4gICAgICAgICAgICBleHBlY3QoZmlsZVByb3BlcnR5LnZhbGlkYXRlKGlucHV0KSkudG9CZSgnJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IHN0cmluZycsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KGZpbGVQcm9wZXJ0eS52YWxpZGF0ZSgnJykpLnRvQmUoJycpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBtdWx0aXBsZSBsaW5rcyBhbmQgcmV0dXJuIGZpcnN0JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpbnB1dCA9ICdbW0ZpcnN0RmlsZV1dIGFuZCBbW1NlY29uZEZpbGVdXSc7XHJcbiAgICAgICAgICAgIGV4cGVjdChmaWxlUHJvcGVydHkudmFsaWRhdGUoaW5wdXQpKS50b0JlKCdbW0ZpcnN0RmlsZV1dJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnZ2V0TGluaycsICgpID0+IHtcclxuICAgICAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICAgICAgZmlsZVByb3BlcnR5LnZhdWx0ID0gbW9ja1ZhdWx0O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGdlbmVyYXRlIG9ic2lkaWFuIFVSTCB3aXRoIGZpbGUgcGF0aCB3aGVuIGZpbGUgZXhpc3RzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB0ZXN0VmFsdWUgPSAnW1tUZXN0RmlsZV1dJztcclxuICAgICAgICAgICAgY29uc3QgZmlsZVBhdGggPSAncGF0aC90by9UZXN0RmlsZS5tZCc7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBtb2NrVmF1bHQucmVhZExpbmtGaWxlLm1vY2tSZXR1cm5WYWx1ZU9uY2UoZmlsZVBhdGgpLm1vY2tSZXR1cm5WYWx1ZU9uY2UoJ1Rlc3RGaWxlJyk7XHJcbiAgICAgICAgICAgIG1vY2tWYXVsdC5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoLm1vY2tSZXR1cm5WYWx1ZSh0cnVlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGZpbGVQcm9wZXJ0eS5nZXRMaW5rKHRlc3RWYWx1ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKCdvYnNpZGlhbjovL29wZW4/dmF1bHQ9VGVzdFZhdWx0JmZpbGU9cGF0aCUyRnRvJTJGVGVzdEZpbGUubWQnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCB1c2UgZmFsbGJhY2sgd2hlbiBmaWxlIGRvZXMgbm90IGV4aXN0JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB0ZXN0VmFsdWUgPSAnW1tUZXN0RmlsZV1dJztcclxuICAgICAgICAgICAgY29uc3QgZmlsZVBhdGggPSAncGF0aC90by9UZXN0RmlsZS5tZCc7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBtb2NrVmF1bHQucmVhZExpbmtGaWxlLm1vY2tSZXR1cm5WYWx1ZU9uY2UoZmlsZVBhdGgpLm1vY2tSZXR1cm5WYWx1ZU9uY2UoJ1Rlc3RGaWxlJyk7XHJcbiAgICAgICAgICAgIG1vY2tWYXVsdC5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoLm1vY2tSZXR1cm5WYWx1ZShudWxsKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGZpbGVQcm9wZXJ0eS5nZXRMaW5rKHRlc3RWYWx1ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKCdvYnNpZGlhbjovL29wZW4/dmF1bHQ9VGVzdFZhdWx0JmZpbGU9VGVzdEZpbGUnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBzZXQgdmF1bHQgd2hlbiBwcm92aWRlZCBhcyBwYXJhbWV0ZXInLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld1ZhdWx0ID0geyAuLi5tb2NrVmF1bHQgfTtcclxuICAgICAgICAgICAgZmlsZVByb3BlcnR5LnZhdWx0ID0gbnVsbDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIG1vY2tWYXVsdC5yZWFkTGlua0ZpbGUubW9ja1JldHVyblZhbHVlKCdUZXN0RmlsZScpO1xyXG4gICAgICAgICAgICBtb2NrVmF1bHQuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aC5tb2NrUmV0dXJuVmFsdWUobnVsbCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBmaWxlUHJvcGVydHkuZ2V0TGluaygnW1tUZXN0RmlsZV1dJywgbmV3VmF1bHQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGZpbGVQcm9wZXJ0eS52YXVsdCkudG9CZShuZXdWYXVsdCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgZW5jb2RlIHNwZWNpYWwgY2hhcmFjdGVycyBpbiB2YXVsdCBuYW1lJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB0ZXN0VmFsdWUgPSAnW1tUZXN0RmlsZV1dJztcclxuICAgICAgICAgICAgbW9ja1ZhdWx0LmFwcC52YXVsdC5nZXROYW1lLm1vY2tSZXR1cm5WYWx1ZSgnTXkgVmF1bHQgJiBTdHVmZicpO1xyXG4gICAgICAgICAgICBtb2NrVmF1bHQucmVhZExpbmtGaWxlLm1vY2tSZXR1cm5WYWx1ZSgnVGVzdEZpbGUnKTtcclxuICAgICAgICAgICAgbW9ja1ZhdWx0LmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgubW9ja1JldHVyblZhbHVlKG51bGwpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gZmlsZVByb3BlcnR5LmdldExpbmsodGVzdFZhbHVlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQ29udGFpbigndmF1bHQ9TXklMjBWYXVsdCUyMCUyNiUyMFN0dWZmJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnY3JlYXRlSWNvbkNvbnRhaW5lcicsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBpY29uIGNvbnRhaW5lciB3aXRoIGNvcnJlY3Qgc3RydWN0dXJlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gZmlsZVByb3BlcnR5LmNyZWF0ZUljb25Db250YWluZXIobW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LnRhZ05hbWUpLnRvQmUoJ0RJVicpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LmNsYXNzTGlzdC5jb250YWlucygnaWNvbi1jb250YWluZXInKSkudG9CZSh0cnVlKTtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC5jaGlsZHJlbi5sZW5ndGgpLnRvQmUoMSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgc2V0IGN1cnNvciBwb2ludGVyIHdoZW4gbm90IHN0YXRpYycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VwZGF0ZSA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgZmlsZVByb3BlcnR5LnN0YXRpYyA9IGZhbHNlO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gZmlsZVByb3BlcnR5LmNyZWF0ZUljb25Db250YWluZXIobW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGljb24gPSByZXN1bHQuY2hpbGRyZW5bMF0gYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QoaWNvbi5zdHlsZS5jdXJzb3IpLnRvQmUoJ3BvaW50ZXInKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBub3Qgc2V0IGN1cnNvciBwb2ludGVyIHdoZW4gc3RhdGljJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBmaWxlUHJvcGVydHkuc3RhdGljID0gdHJ1ZTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGZpbGVQcm9wZXJ0eS5jcmVhdGVJY29uQ29udGFpbmVyKG1vY2tVcGRhdGUpO1xyXG4gICAgICAgICAgICBjb25zdCBpY29uID0gcmVzdWx0LmNoaWxkcmVuWzBdIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGljb24uc3R5bGUuY3Vyc29yKS50b0JlKCcnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdoYW5kbGVJY29uQ2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGZpbGVQcm9wZXJ0eS52YXVsdCA9IG1vY2tWYXVsdDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBjYWxsIHNlbGVjdEZpbGUgd2l0aCBjb3JyZWN0IHBhcmFtZXRlcnMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tFdmVudCA9IHtcclxuICAgICAgICAgICAgICAgIHRhcmdldDogZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcclxuICAgICAgICAgICAgfSBhcyBhbnk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBtb2NrVmF1bHQuYXBwLnNlbGVjdEZpbGUubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBhd2FpdCBmaWxlUHJvcGVydHkuaGFuZGxlSWNvbkNsaWNrKG1vY2tVcGRhdGUsIG1vY2tFdmVudCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1ZhdWx0LmFwcC5zZWxlY3RGaWxlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcclxuICAgICAgICAgICAgICAgIG1vY2tWYXVsdCxcclxuICAgICAgICAgICAgICAgIFsnY2xhc3MxJywgJ2NsYXNzMiddLFxyXG4gICAgICAgICAgICAgICAgeyBoaW50OiBcIkNob2lzaXNzZXogdW4gZmljaGllciBjbGFzczEgb3UgY2xhc3MyXCIgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHVwZGF0ZSB2YWx1ZSB3aGVuIGZpbGUgc2VsZWN0ZWQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tGaWxlID0ge1xyXG4gICAgICAgICAgICAgICAgZ2V0TGluazogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnW1tTZWxlY3RlZEZpbGVdXScpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tFdmVudCA9IHtcclxuICAgICAgICAgICAgICAgIHRhcmdldDogZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcclxuICAgICAgICAgICAgfSBhcyBhbnk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBtb2NrVmF1bHQuYXBwLnNlbGVjdEZpbGUubW9ja1Jlc29sdmVkVmFsdWUobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgYXdhaXQgZmlsZVByb3BlcnR5LmhhbmRsZUljb25DbGljayhtb2NrVXBkYXRlLCBtb2NrRXZlbnQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tVcGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdbW1NlbGVjdGVkRmlsZV1dJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgbm90IHVwZGF0ZSB3aGVuIG5vIGZpbGUgc2VsZWN0ZWQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tFdmVudCA9IHtcclxuICAgICAgICAgICAgICAgIHRhcmdldDogZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcclxuICAgICAgICAgICAgfSBhcyBhbnk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBtb2NrVmF1bHQuYXBwLnNlbGVjdEZpbGUubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBhd2FpdCBmaWxlUHJvcGVydHkuaGFuZGxlSWNvbkNsaWNrKG1vY2tVcGRhdGUsIG1vY2tFdmVudCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1VwZGF0ZSkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdjcmVhdGVGaWVsZENvbnRhaW5lckNvbnRlbnQnLCAoKSA9PiB7XHJcbiAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGZpbGVQcm9wZXJ0eS52YXVsdCA9IG1vY2tWYXVsdDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgZmllbGQgY29udGFpbmVyIHdpdGggY29ycmVjdCBzdHJ1Y3R1cmUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRlc3RWYWx1ZSA9ICdbW1Rlc3RGaWxlXV0nO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbW9ja1ZhdWx0LnJlYWRMaW5rRmlsZS5tb2NrUmV0dXJuVmFsdWUoJ1Rlc3RGaWxlJyk7XHJcbiAgICAgICAgICAgIGZpbGVQcm9wZXJ0eS5nZXRMaW5rID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnb2JzaWRpYW46Ly90ZXN0Jyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBmaWxlUHJvcGVydHkuY3JlYXRlRmllbGRDb250YWluZXJDb250ZW50KG1vY2tVcGRhdGUsIHRlc3RWYWx1ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LnRhZ05hbWUpLnRvQmUoJ0RJVicpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LmNsYXNzTGlzdC5jb250YWlucygnZmllbGQtY29udGFpbmVyJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIGxpbmsgd2l0aCBjb3JyZWN0IGhyZWYgYW5kIHRleHQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRlc3RWYWx1ZSA9ICdbW1Rlc3RGaWxlXV0nO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbW9ja1ZhdWx0LnJlYWRMaW5rRmlsZS5tb2NrUmV0dXJuVmFsdWUoJ1Rlc3RGaWxlJyk7XHJcbiAgICAgICAgICAgIGZpbGVQcm9wZXJ0eS5nZXRMaW5rID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnb2JzaWRpYW46Ly90ZXN0Jyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBmaWxlUHJvcGVydHkuY3JlYXRlRmllbGRDb250YWluZXJDb250ZW50KG1vY2tVcGRhdGUsIHRlc3RWYWx1ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSByZXN1bHQucXVlcnlTZWxlY3RvcignYScpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGxpbms/LmhyZWYpLnRvQmUoJ29ic2lkaWFuOi8vdGVzdCcpO1xyXG4gICAgICAgICAgICBleHBlY3QobGluaz8udGV4dENvbnRlbnQpLnRvQmUoJ1Rlc3RGaWxlJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rPy5jbGFzc0xpc3QuY29udGFpbnMoJ2ZpZWxkLWxpbmsnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgdmFsdWUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRlc3RWYWx1ZSA9ICcnO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbW9ja1ZhdWx0LnJlYWRMaW5rRmlsZS5tb2NrUmV0dXJuVmFsdWUoJycpO1xyXG4gICAgICAgICAgICBmaWxlUHJvcGVydHkuZ2V0TGluayA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ29ic2lkaWFuOi8vdGVzdCcpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gZmlsZVByb3BlcnR5LmNyZWF0ZUZpZWxkQ29udGFpbmVyQ29udGVudChtb2NrVXBkYXRlLCB0ZXN0VmFsdWUpO1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gcmVzdWx0LnF1ZXJ5U2VsZWN0b3IoJ2EnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rPy50ZXh0Q29udGVudCkudG9CZSgnJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufSk7XHJcbiJdLCJ2ZXJzaW9uIjozfQ==