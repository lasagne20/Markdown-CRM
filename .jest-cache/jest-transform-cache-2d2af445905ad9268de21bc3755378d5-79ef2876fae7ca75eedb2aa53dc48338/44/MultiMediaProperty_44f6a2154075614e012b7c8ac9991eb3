3c905dcb7fcf12b7c9f0865142e48dcc
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.MultiMediaProperty = void 0;
const MultiFileProperty_1 = require("./MultiFileProperty");
const MediaProperty_1 = require("./MediaProperty");
class MultiMediaProperty extends MultiFileProperty_1.MultiFileProperty {
    constructor(name, vault, args = {}) {
        super(name, vault, [], args);
        this.type = "multiMedia";
        this.flexSpan = 2;
        this.property = new MediaProperty_1.MediaProperty(name, vault, args);
    }
    // Méthode principale pour obtenir l'affichage
    fillDisplay(values, update) {
        const container = document.createElement("div");
        container.classList.add("metadata-multiFiles-container-" + this.name.toLowerCase());
        container.classList.add("metadata-multiFiles-container");
        // Créer les lignes d'objet
        this.createObjects(values, update, container);
        const addButton = this.createAddButton(values, update, container);
        container.appendChild(addButton);
        return container;
    }
    createObjects(values, update, container) {
        if (!Array.isArray(values) || values.length === 0)
            return;
        values.forEach((objects, index) => {
            const row = this.createObjectRow(values, update, objects, index, container);
            container.appendChild(row);
        });
    }
    createObjectRow(values, update, value, index, container) {
        const row = document.createElement("div");
        row.classList.add("metadata-multiFiles-row-inline");
        // Ajouter le bouton de suppression
        const deleteButton = this.createDeleteButton(values, update, index, container);
        row.appendChild(deleteButton);
        let propertyContainer = document.createElement("div");
        propertyContainer.classList.add("metadata-multiFiles-property-inline");
        propertyContainer.appendChild(this.property.fillDisplay(value, async (value) => await this.updateObject(values, update, index, this.property, value)));
        row.appendChild(propertyContainer);
        return row;
    }
    createDeleteButton(values, update, index, container) {
        const deleteButton = document.createElement("button");
        this.vault.app.setIcon(deleteButton, "minus");
        deleteButton.classList.add("metadata-delete-button-inline-small");
        deleteButton.onclick = async () => await this.removeProperty(values, update, index, container);
        return deleteButton;
    }
    async addProperty(values, update, container) {
        let newFile = await globalThis.selectMedia(this.vault, "Choisissez un media ");
        if (newFile) {
            if (!values) {
                values = [];
            }
            values.push(`[[${newFile.path}|${newFile.name}]]`);
            await update(values);
            await this.reloadObjects(values, update);
        }
    }
    createAddButton(values, update, container) {
        const addButton = document.createElement("button");
        this.vault.app.setIcon(addButton, "plus");
        addButton.classList.add("metadata-add-button-inline-small");
        addButton.onclick = async () => await this.addProperty(values, update, container);
        return addButton;
    }
    enableDragAndDrop() {
        // Disable drag and drop
    }
}
exports.MultiMediaProperty = MultiMediaProperty;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxzcmNcXHByb3BlcnRpZXNcXE11bHRpTWVkaWFQcm9wZXJ0eS50cyIsIm1hcHBpbmdzIjoiOzs7QUFJQSwyREFBd0Q7QUFDeEQsbURBQWdEO0FBU2hELE1BQWEsa0JBQW1CLFNBQVEscUNBQWlCO0lBT3JELFlBQVksSUFBWSxFQUFFLEtBQWEsRUFBRSxJQUFJLEdBQUcsRUFBRTtRQUM5QyxLQUFLLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFOakIsU0FBSSxHQUFZLFlBQVksQ0FBQztRQUU3QixhQUFRLEdBQUcsQ0FBQyxDQUFDO1FBS3pCLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSw2QkFBYSxDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDekQsQ0FBQztJQUVELDhDQUE4QztJQUNyQyxXQUFXLENBQUMsTUFBVyxFQUFFLE1BQXFDO1FBQ25FLE1BQU0sU0FBUyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDaEQsU0FBUyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsZ0NBQWdDLEdBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDO1FBQ2xGLFNBQVMsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLCtCQUErQixDQUFDLENBQUM7UUFFekQsMkJBQTJCO1FBQzNCLElBQUksQ0FBQyxhQUFhLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxTQUFTLENBQUMsQ0FBQztRQUU5QyxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU0sRUFBRSxNQUFNLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDbEUsU0FBUyxDQUFDLFdBQVcsQ0FBQyxTQUFTLENB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LE1BQU0sQ0FBQyxDQUFDO1lBQ3JCLE1BQU0sSUFBSSxDQUFDLGFBQWEsQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUE7UUFDNUMsQ0FBQztJQUNMLENBQUM7SUFFUSxlQUFlLENBQUMsTUFBVyxFQUFFLE1BQXFDLEVBQUUsU0FBeUI7UUFDbEcsTUFBTSxTQUFTLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNuRCxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQzFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLGtDQUFrQyxDQUFDLENBQUM7UUFDNUQsU0FBUyxDQUFDLE9BQU8sR0FBRyxLQUFLLElBQUksRUFBRSxDQUFDLE1BQU0sSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1FBQ2xGLE9BQU8sU0FBUyxDQUFDO0lBQ3JCLENBQUM7SUFFUSxpQkFBaUI7UUFDdEIsd0JBQXdCO0lBQzVCLENBQUM7Q0FDSjtBQWxGRCxnREFrRkMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxzcmNcXHByb3BlcnRpZXNcXE11bHRpTWVkaWFQcm9wZXJ0eS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJcclxuaW1wb3J0IHsgT2JqZWN0UHJvcGVydHkgfSBmcm9tIFwiLi9PYmplY3RQcm9wZXJ0eVwiO1xyXG5pbXBvcnQgeyBGaWxlUHJvcGVydHkgfSBmcm9tIFwiLi9GaWxlUHJvcGVydHlcIjtcclxuaW1wb3J0IHsgRmlsZSB9IGZyb20gXCIuLi92YXVsdC9GaWxlXCI7XHJcbmltcG9ydCB7IE11bHRpRmlsZVByb3BlcnR5IH0gZnJvbSBcIi4vTXVsdGlGaWxlUHJvcGVydHlcIjtcclxuaW1wb3J0IHsgTWVkaWFQcm9wZXJ0eSB9IGZyb20gXCIuL01lZGlhUHJvcGVydHlcIjtcclxuaW1wb3J0IHsgVmF1bHQgfSBmcm9tIFwiLi4vdmF1bHQvVmF1bHRcIjtcclxuXHJcbi8vIERlY2xhcmUgc2VsZWN0TWVkaWEgYXMgZXh0ZXJuYWwgZnVuY3Rpb24gZm9yIFR5cGVTY3JpcHRcclxuZGVjbGFyZSBnbG9iYWwge1xyXG4gICAgdmFyIHNlbGVjdE1lZGlhOiAodmF1bHQ6IGFueSwgdGl0bGU6IHN0cmluZykgPT4gUHJvbWlzZTxhbnk+O1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIE11bHRpTWVkaWFQcm9wZXJ0eSBleHRlbmRzIE11bHRpRmlsZVByb3BlcnR5IHtcclxuXHJcbiAgICBwdWJsaWMgb3ZlcnJpZGUgdHlwZSA6IHN0cmluZyA9IFwibXVsdGlNZWRpYVwiO1xyXG4gICAgcHVibGljIG92ZXJyaWRlIHByb3BlcnR5IDogTWVkaWFQcm9wZXJ0eTtcclxuICAgIHB1YmxpYyBvdmVycmlkZSBmbGV4U3BhbiA9IDI7XHJcblxyXG5cclxuICAgIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgdmF1bHQgOiBWYXVsdCwgYXJncyA9IHt9KXtcclxuICAgICAgICBzdXBlcihuYW1lLCB2YXVsdCwgW10sIGFyZ3MpO1xyXG4gICAgICAgIHRoaXMucHJvcGVydHkgPSBuZXcgTWVkaWFQcm9wZXJ0eShuYW1lLCB2YXVsdCwgYXJncyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gTcOpdGhvZGUgcHJpbmNpcGFsZSBwb3VyIG9idGVuaXIgbCdhZmZpY2hhZ2VcclxuICAgIG92ZXJyaWRlIGZpbGxEaXNwbGF5KHZhbHVlczogYW55LCB1cGRhdGU6ICh2YWx1ZTogYW55KSA9PiBQcm9taXNlPHZvaWQ+KSB7XHJcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICBjb250YWluZXIuY2xhc3NMaXN0LmFkZChcIm1ldGFkYXRhLW11bHRpRmlsZXMtY29udGFpbmVyLVwiK3RoaXMubmFtZS50b0xvd2VyQ2FzZSgpKTtcclxuICAgICAgICBjb250YWluZXIuY2xhc3NMaXN0LmFkZChcIm1ldGFkYXRhLW11bHRpRmlsZXMtY29udGFpbmVyXCIpO1xyXG5cclxuICAgICAgICAvLyBDcsOpZXIgbGVzIGxpZ25lcyBkJ29iamV0XHJcbiAgICAgICAgdGhpcy5jcmVhdGVPYmplY3RzKHZhbHVlcywgdXBkYXRlLCBjb250YWluZXIpO1xyXG5cclxuICAgICAgICBjb25zdCBhZGRCdXR0b24gPSB0aGlzLmNyZWF0ZUFkZEJ1dHRvbih2YWx1ZXMsIHVwZGF0ZSwgY29udGFpbmVyKTtcclxuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoYWRkQnV0dG9uKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGNvbnRhaW5lcjtcclxuICAgIH1cclxuXHJcbiAgICBvdmVycmlkZSBjcmVhdGVPYmplY3RzKHZhbHVlczogYW55LCB1cGRhdGU6ICh2YWx1ZTogYW55KSA9PiBQcm9taXNlPHZvaWQ+LCBjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlcykgfHwgdmFsdWVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xyXG4gICAgICAgIHZhbHVlcy5mb3JFYWNoKChvYmplY3RzOiBhbnksIGluZGV4OiBudW1iZXIpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgcm93ID0gdGhpcy5jcmVhdGVPYmplY3RSb3codmFsdWVzLCB1cGRhdGUsIG9iamVjdHMsIGluZGV4LCBjb250YWluZXIpO1xyXG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocm93KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBvdmVycmlkZSBjcmVhdGVPYmplY3RSb3codmFsdWVzOiBhbnksIHVwZGF0ZTogKHZhbHVlOiBhbnkpID0+IFByb21pc2U8dm9pZD4sIHZhbHVlOiBhbnksIGluZGV4OiBudW1iZXIsIGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiBIVE1MRGl2RWxlbWVudCB7XHJcbiAgICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICByb3cuY2xhc3NMaXN0LmFkZChcIm1ldGFkYXRhLW11bHRpRmlsZXMtcm93LWlubGluZVwiKTtcclxuXHJcbiAgICAgICAgLy8gQWpvdXRlciBsZSBib3V0b24gZGUgc3VwcHJlc3Npb25cclxuICAgICAgICBjb25zdCBkZWxldGVCdXR0b24gPSB0aGlzLmNyZWF0ZURlbGV0ZUJ1dHRvbih2YWx1ZXMsIHVwZGF0ZSwgaW5kZXgsIGNvbnRhaW5lcik7XHJcbiAgICAgICAgcm93LmFwcGVuZENoaWxkKGRlbGV0ZUJ1dHRvbik7XHJcblxyXG5cclxuIFxyXG4gICAgICAgIGxldCBwcm9wZXJ0eUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgcHJvcGVydHlDb250YWluZXIuY2xhc3NMaXN0LmFkZChcIm1ldGFkYXRhLW11bHRpRmlsZXMtcHJvcGVydHktaW5saW5lXCIpO1xyXG4gICAgICAgIHByb3BlcnR5Q29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMucHJvcGVydHkuZmlsbERpc3BsYXkodmFsdWUsIGFzeW5jICh2YWx1ZSA6IGFueSkgPT4gYXdhaXQgdGhpcy51cGRhdGVPYmplY3QodmFsdWVzLCB1cGRhdGUsIGluZGV4LCB0aGlzLnByb3BlcnR5LCB2YWx1ZSkpKTtcclxuICAgICAgICByb3cuYXBwZW5kQ2hpbGQocHJvcGVydHlDb250YWluZXIpO1xyXG5cclxuICAgICAgICByZXR1cm4gcm93O1xyXG4gICAgfVxyXG5cclxuICAgIG92ZXJyaWRlIGNyZWF0ZURlbGV0ZUJ1dHRvbih2YWx1ZXM6IGFueSwgdXBkYXRlOiAodmFsdWU6IGFueSkgPT4gUHJvbWlzZTx2b2lkPiwgaW5kZXg6IG51bWJlciwgY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IEhUTUxCdXR0b25FbGVtZW50IHtcclxuICAgICAgICBjb25zdCBkZWxldGVCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xyXG4gICAgICAgIHRoaXMudmF1bHQuYXBwLnNldEljb24oZGVsZXRlQnV0dG9uLCBcIm1pbnVzXCIpO1xyXG4gICAgICAgIGRlbGV0ZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwibWV0YWRhdGEtZGVsZXRlLWJ1dHRvbi1pbmxpbmUtc21hbGxcIik7XHJcbiAgICAgICAgZGVsZXRlQnV0dG9uLm9uY2xpY2sgPSBhc3luYyAoKSA9PiBhd2FpdCB0aGlzLnJlbW92ZVByb3BlcnR5KHZhbHVlcywgdXBkYXRlLCBpbmRleCwgY29udGFpbmVyKTtcclxuICAgICAgICByZXR1cm4gZGVsZXRlQnV0dG9uO1xyXG4gICAgfVxyXG5cclxuICAgIG92ZXJyaWRlIGFzeW5jIGFkZFByb3BlcnR5KHZhbHVlczogYW55LCB1cGRhdGU6ICh2YWx1ZTogYW55KSA9PiBQcm9taXNlPHZvaWQ+LCBjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KSB7XHJcbiAgICAgICAgbGV0IG5ld0ZpbGUgPSBhd2FpdCBnbG9iYWxUaGlzLnNlbGVjdE1lZGlhKHRoaXMudmF1bHQsIFwiQ2hvaXNpc3NleiB1biBtZWRpYSBcIik7XHJcbiAgICAgICAgaWYgKG5ld0ZpbGUpIHtcclxuICAgICAgICAgICAgaWYgKCF2YWx1ZXMpe3ZhbHVlcyA9IFtdfVxyXG4gICAgICAgICAgICB2YWx1ZXMucHVzaChgW1ske25ld0ZpbGUucGF0aH18JHtuZXdGaWxlLm5hbWV9XV1gKTtcclxuICAgICAgICAgICAgYXdhaXQgdXBkYXRlKHZhbHVlcyk7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucmVsb2FkT2JqZWN0cyh2YWx1ZXMsIHVwZGF0ZSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb3ZlcnJpZGUgY3JlYXRlQWRkQnV0dG9uKHZhbHVlczogYW55LCB1cGRhdGU6ICh2YWx1ZTogYW55KSA9PiBQcm9taXNlPHZvaWQ+LCBjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogSFRNTEJ1dHRvbkVsZW1lbnQge1xyXG4gICAgICAgIGNvbnN0IGFkZEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XHJcbiAgICAgICAgdGhpcy52YXVsdC5hcHAuc2V0SWNvbihhZGRCdXR0b24sIFwicGx1c1wiKTtcclxuICAgICAgICBhZGRCdXR0b24uY2xhc3NMaXN0LmFkZChcIm1ldGFkYXRhLWFkZC1idXR0b24taW5saW5lLXNtYWxsXCIpO1xyXG4gICAgICAgIGFkZEJ1dHRvbi5vbmNsaWNrID0gYXN5bmMgKCkgPT4gYXdhaXQgdGhpcy5hZGRQcm9wZXJ0eSh2YWx1ZXMsIHVwZGF0ZSwgY29udGFpbmVyKTtcclxuICAgICAgICByZXR1cm4gYWRkQnV0dG9uO1xyXG4gICAgfVxyXG5cclxuICAgIG92ZXJyaWRlIGVuYWJsZURyYWdBbmREcm9wKCkge1xyXG4gICAgICAgIC8vIERpc2FibGUgZHJhZyBhbmQgZHJvcFxyXG4gICAgfVxyXG59Il0sInZlcnNpb24iOjN9