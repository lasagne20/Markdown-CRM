{"file":"C:\\Users\\leodu\\Documents\\1 - Pro\\Test plugin obsidian\\.obsidian\\plugins\\obsidian-CRM\\dynamic-fields\\src\\properties\\Property.ts","mappings":"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","names":[],"sources":["C:\\Users\\leodu\\Documents\\1 - Pro\\Test plugin obsidian\\.obsidian\\plugins\\obsidian-CRM\\dynamic-fields\\src\\properties\\Property.ts"],"sourcesContent":["import { File } from \"../vault/File\";\r\nimport { IApp } from \"../interfaces/IApp\";\r\nimport { Vault } from \"../vault/Vault\";\r\n\r\n/**\r\n * Base class for all properties in the dynamic field system.\r\n * Represents an editable property with a dynamic user interface.\r\n * \r\n * This class provides the base behavior for:\r\n * - Displaying metadata fields\r\n * - Inline editing of values\r\n * - User input validation\r\n * - Vault interaction\r\n */\r\nexport class Property {\r\n    public name: string;\r\n    public icon: string;\r\n    public vault: Vault;\r\n    public static: boolean;\r\n    public title: string = \"\";\r\n    public flexSpan = 0;\r\n    public default: any;\r\n\r\n    public type : string = \"text\";\r\n\r\n    /**\r\n     * Property constructor.\r\n     * Initializes a property with its name, vault, and configuration options.\r\n     * \r\n     * @param name - Unique property name (used to identify the property in metadata)\r\n     * @param vault - Vault instance for data operations\r\n     * @param options - Optional property configuration\r\n     * @param options.icon - Lucide icon to display next to the property (default: \"align-left\")\r\n     * @param options.staticProperty - If true, the property is static and doesn't change (default: false)\r\n     * @param options.flexSpan - Relative width of the property in the display (default: 1)\r\n     * @param options.defaultValue - Default value of the property (default: \"\")\r\n     */\r\n    constructor(name: string, vault: Vault, options: { \r\n        icon?: string, \r\n        staticProperty?: boolean, \r\n        flexSpan?: number, \r\n        defaultValue?: any, \r\n        [key: string]: any \r\n    } = {}) {\r\n        const { icon = \"align-left\", staticProperty = false, flexSpan = 1, defaultValue = \"\", ...additionalOptions } = options;\r\n        this.flexSpan = flexSpan;\r\n        this.name = name;\r\n        this.vault = vault;\r\n        this.icon = icon;\r\n        this.default = defaultValue;\r\n        this.static = staticProperty;\r\n\r\n        // Assign additional options to the instance\r\n        Object.assign(this, additionalOptions);\r\n    }\r\n\r\n    /**\r\n     * Gets the default value of the property.\r\n     * Handles special default values like \"personalName\" that require\r\n     * dynamic resolution via the vault.\r\n     * \r\n     * @returns The resolved default value of the property\r\n     */\r\n    getDefaultValue(){\r\n        // TODO use a dictionary for special default values in vault\r\n        if (this.default == \"personalName\"){\r\n            return this.vault.getPersonalName();\r\n        }\r\n        return this.default;\r\n    }\r\n\r\n    /**\r\n     * Reads the property value from the file's metadata.\r\n     * Supports two file types: those with a getMetadataValue method\r\n     * and those with a direct metadata object.\r\n     * \r\n     * @param file - Obsidian file from which to read the property\r\n     * @returns The property value or undefined if it doesn't exist\r\n     */\r\n    read(file: File): any {\r\n        if (file && typeof file === 'object' && 'readProperty' in file) {\r\n            return file.getMetadataValue(this.name)\r\n        }\r\n        return file.getMetadata()?.[this.name];\r\n    }\r\n\r\n    /**\r\n     * Validates and normalizes an input value for this property.\r\n     * The base method returns the value unchanged, but can be \r\n     * overridden by derived classes to perform transformations.\r\n     * \r\n     * @param value - Value to validate and normalize\r\n     * @returns The validated and normalized value\r\n     */\r\n    validate(value: string) {\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     * Generates a link for the property value.\r\n     * Used to create clickable links in the user interface.\r\n     * \r\n     * @param value - Value for which to generate a link\r\n     * @returns The link representation of the value\r\n     */\r\n    getLink(value: string) {\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     * Formats a value for \"pretty\" display in the interface.\r\n     * Can be overridden for property type-specific formatting.\r\n     * \r\n     * @param value - Value to format for display\r\n     * @returns The formatted value for display\r\n     */\r\n    getPretty(value: string) {\r\n        return value;  \r\n    }\r\n\r\n    /**\r\n     * Generates the complete display of the property for a given file.\r\n     * Configures the display mode (static or editable) and title,\r\n     * then delegates DOM creation to fillDisplay.\r\n     * \r\n     * @param file - File for which to generate the display\r\n     * @param args - Display options\r\n     * @param args.staticMode - If true, displays the property in read-only mode\r\n     * @param args.title - Custom title for the property\r\n     * @returns The DOM element representing the property\r\n     */\r\n    getDisplay(file: any, args : {staticMode? : boolean, title?: string} = {staticMode : false, title:\"\"}) {\r\n        this.static = args.staticMode ? true : this.static;\r\n        this.title = args.title ? args.title : \"\";\r\n        let value = this.read(file);\r\n        return this.fillDisplay(value, async (value: any) => await file.updateMetadata(this.name, value), args);\r\n    }\r\n\r\n    /**\r\n     * Fills and builds the complete DOM display of the property.\r\n     * Creates the HTML structure with optional title, icon and editable content.\r\n     * \r\n     * @param value - Current property value to display\r\n     * @param update - Update function called during changes\r\n     * @param args - Additional arguments for configuration\r\n     * @returns The complete DOM element of the property\r\n     */\r\n    fillDisplay(value: any, update: (value: any) => Promise<void>, args? : {}) {\r\n        const field = this.createFieldContainer();\r\n\r\n        if (this.title) {\r\n            const title = document.createElement(\"div\");\r\n            title.textContent = this.title;\r\n            title.classList.add(\"metadata-title\");\r\n            field.appendChild(title);\r\n        }\r\n\r\n        const iconContainer = this.createIconContainer(update);\r\n        const fieldContainer = this.createFieldContainerContent(update, value);\r\n\r\n        field.appendChild(iconContainer);\r\n        field.appendChild(fieldContainer);\r\n\r\n        return field;\r\n    }\r\n\r\n    /**\r\n     * Creates the main container for the property display.\r\n     * Defines the basic HTML structure with appropriate CSS classes.\r\n     * \r\n     * @returns The main container div element of the property\r\n     */\r\n    createFieldContainer() {\r\n        const field = document.createElement(\"div\");\r\n        field.classList.add(\"metadata-field\");\r\n        return field;\r\n    }\r\n\r\n    /**\r\n     * Creates the icon container for the property.\r\n     * Adds a click handler to toggle to edit mode if the property is not static.\r\n     * \r\n     * @param update - Update function to persist changes\r\n     * @returns The icon container element with its events\r\n     */\r\n    createIconContainer(update: (value: string) => Promise<void>) {\r\n        const iconContainer = document.createElement(\"div\");\r\n        iconContainer.classList.add(\"icon-container\");\r\n        if (this.icon) {\r\n            const icon = document.createElement(\"div\");\r\n            this.vault.app.setIcon(icon, this.icon);\r\n            iconContainer.appendChild(icon);\r\n            if (!this.static) {\r\n                iconContainer.addEventListener(\"click\", (event) => this.modifyField(event));\r\n            }\r\n        }\r\n        return iconContainer;\r\n    }\r\n\r\n    /**\r\n     * Handles switching to edit mode when the user clicks on the icon.\r\n     * Hides the read-only display and shows the input field with focus.\r\n     * \r\n     * @param event - Click event on the icon\r\n     */\r\n    modifyField(event: Event) {\r\n        const link = (event.target as HTMLElement).closest('.metadata-field')?.querySelector('.field-link') as HTMLElement;\r\n        const input = (event.target as HTMLElement).closest('.metadata-field')?.querySelector('.field-input') as HTMLInputElement;\r\n        if (link && input) {\r\n            link.style.display = \"none\";\r\n            input.style.display = \"block\";\r\n            input.focus(); \r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates the field container content with input and link elements.\r\n     * Manages the visibility of edit and display modes based on property state.\r\n     * \r\n     * @param update - Update function to persist changes\r\n     * @param value - Current value to display\r\n     * @returns The field container div with input and link elements\r\n     */\r\n    createFieldContainerContent(update: (value: string) => Promise<void>, value: string): HTMLDivElement {\r\n        const fieldContainer = document.createElement(\"div\");\r\n        fieldContainer.classList.add(\"field-container\");\r\n\r\n        const currentField = value;\r\n        const input = this.createFieldInput(currentField);\r\n        const link = this.createFieldLink(currentField);\r\n\r\n        if (this.static) {\r\n            link.style.display = \"block\";\r\n            input.style.display = \"none\";\r\n        } else {\r\n            if (currentField) {\r\n                link.style.display = \"block\";\r\n                input.style.display = \"none\";\r\n            } else {\r\n                input.style.display = \"block\";\r\n                link.style.display = \"none\";\r\n            }\r\n        }\r\n\r\n        fieldContainer.appendChild(link);\r\n        fieldContainer.appendChild(input);\r\n\r\n        if (!this.static) {\r\n            this.handleFieldInput(update, input, link);\r\n        }\r\n\r\n        return fieldContainer;\r\n    }\r\n\r\n    /**\r\n     * Creates a clickable link element for displaying the property value.\r\n     * Configures cursor style and click behavior based on static property.\r\n     * \r\n     * @param value - Value to display in the link\r\n     * @returns The configured link div element\r\n     */\r\n    createFieldLink(value: string) {\r\n        const link = document.createElement(\"div\");\r\n        link.textContent = this.getPretty(value) || \"\";\r\n        link.classList.add(\"field-link\");\r\n        link.style.cursor = this.static ? \"default\" : \"text\";\r\n        if (!this.static) {\r\n            link.addEventListener(\"click\", (event) => this.modifyField(event));\r\n        }\r\n        return link;\r\n    }\r\n\r\n    /**\r\n     * Handles input field events for editing functionality.\r\n     * Sets up blur and keyboard event listeners to save changes.\r\n     * \r\n     * @param update - Update function to persist changes\r\n     * @param input - Input element to handle\r\n     * @param link - Link element to show after editing\r\n     */\r\n    handleFieldInput(update: (value: string) => Promise<void>, input: HTMLInputElement | HTMLTextAreaElement, link: HTMLElement) {\r\n        input.addEventListener(\"blur\", async () => {\r\n            await this.updateField(update, input, link);\r\n        });\r\n\r\n        input.addEventListener(\"keydown\", async (event) => {\r\n            if ((event as KeyboardEvent).key === \"Enter\" || (event as KeyboardEvent).key === \"Escape\") {\r\n                    event.preventDefault();\r\n                    await this.updateField(update, input, link);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Creates an input field for editing the property value.\r\n     * Base implementation creates a text input, can be overridden for specific input types.\r\n     * \r\n     * @param value - Initial value for the input field\r\n     * @returns The configured input element (input or textarea)\r\n     */\r\n    createFieldInput(value: string) : HTMLInputElement | HTMLTextAreaElement {\r\n        const input = document.createElement(\"input\");\r\n        input.type = \"text\";\r\n        input.value = value || \"\";\r\n        input.classList.add(\"field-input\");\r\n        return input;\r\n    }\r\n\r\n    /**\r\n     * Updates the field value and switches back to display mode.\r\n     * Validates the input, updates the backend, and refreshes the UI.\r\n     * \r\n     * @param update - Update function to persist the changes\r\n     * @param input - Input element containing the new value\r\n     * @param link - Link element to update and show\r\n     */\r\n    async updateField(update: (value: string) => Promise<void>, input: HTMLInputElement | HTMLTextAreaElement, link: HTMLElement) {\r\n        let value = this.validate(input.value);\r\n        if (value) {\r\n            await update(value);\r\n            input.style.display = \"none\";\r\n            link.textContent = value;\r\n            if ((link as HTMLAnchorElement).href){\r\n                (link as HTMLAnchorElement).href = this.getLink(value);\r\n            }\r\n            link.style.display = \"block\";\r\n        } else {\r\n            await update(input.value);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Reloads the dynamic content of the property field from the file.\r\n     * Updates both the display link and input field with the current file value.\r\n     * \r\n     * @param file - File from which to reload the property value\r\n     */\r\n    async reloadDynamicContent(file: File) {\r\n        const field = document.querySelector('.metadata-field');\r\n        if (field) {\r\n            const newValue = this.read(file);\r\n            const link = field.querySelector('.field-link') as HTMLElement;\r\n            const input = field.querySelector('.field-input') as HTMLInputElement;\r\n            if (link && input) {\r\n                link.textContent = newValue;\r\n                input.value = newValue;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n"],"version":3}