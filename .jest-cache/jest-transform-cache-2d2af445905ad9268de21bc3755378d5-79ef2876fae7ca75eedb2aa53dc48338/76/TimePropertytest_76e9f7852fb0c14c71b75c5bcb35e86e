f81badb251107bbf0ce484206b3a462d
"use strict";
/**
 * @jest-environment jsdom
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock flatpickr
jest.mock('flatpickr', () => {
    return jest.fn().mockImplementation((element, options) => {
        // Simuler l'initialization flatpickr
        element.setAttribute('data-flatpickr', 'true');
        // Simuler le trigger des événements flatpickr
        if (options?.onChange) {
            element._flatpickrOnChange = options.onChange;
        }
        if (options?.onClose) {
            element._flatpickrOnClose = options.onClose;
        }
        return {
            destroy: jest.fn(),
            clear: jest.fn(),
            setDate: jest.fn()
        };
    });
});
// Mock French locale
jest.mock('flatpickr/dist/l10n/fr.js', () => ({
    French: {}
}), { virtual: true });
const TimeProperty_1 = require("../../properties/TimeProperty ");
describe('TimeProperty', () => {
    let timeProperty;
    beforeEach(() => {
        // Reset DOM mocks
        document.body.innerHTML = '';
        jest.clearAllMocks();
        // Mock focus pour tous les éléments HTML
        HTMLElement.prototype.focus = jest.fn();
    });
    describe('constructor', () => {
        it('should create TimeProperty with default format', () => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
            expect(timeProperty.name).toBe('testTime');
            expect(timeProperty.type).toBe('time');
            expect(timeProperty['format']).toBe('HH:mm'); // format par défaut
        });
        it('should create TimeProperty with custom format', () => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime', { format: 'HH:mm:ss', icon: 'clock' });
            expect(timeProperty.name).toBe('testTime');
            expect(timeProperty.type).toBe('time');
            expect(timeProperty['format']).toBe('HH:mm:ss');
            expect(timeProperty.icon).toBe('clock');
        });
    });
    describe('validate', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should validate correct time format HH:mm', () => {
            expect(timeProperty.validate('14:30')).toBe('14:30');
            expect(timeProperty.validate('09:15')).toBe('09:15');
            expect(timeProperty.validate('00:00')).toBe('00:00');
            expect(timeProperty.validate('23:59')).toBe('23:59');
        });
        it('should return empty string for invalid time format', () => {
            expect(timeProperty.validate('25:00')).toBe('25:00'); // Format valide même si heure invalide
            expect(timeProperty.validate('14:70')).toBe('14:70'); // Format valide même si minutes invalides
            expect(timeProperty.validate('14')).toBe(''); // Format incomplet
            expect(timeProperty.validate('14:3')).toBe(''); // Format incorrect (pas 2 digits)
            expect(timeProperty.validate('abc')).toBe(''); // Texte invalide
            expect(timeProperty.validate('')).toBe(''); // Chaîne vide
        });
    });
    describe('formatTimeForDisplay', () => {
        it('should format time for HH:mm format', () => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime', { format: 'HH:mm' });
            expect(timeProperty.formatTimeForDisplay('14:30')).toBe('14:30');
            expect(timeProperty.formatTimeForDisplay('09:15')).toBe('09:15');
            expect(timeProperty.formatTimeForDisplay('')).toBe('Aucune heure sélectionnée');
        });
        it('should format time for custom format with units', () => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime', { format: 'custom' });
            expect(timeProperty.formatTimeForDisplay('14:30')).toBe('14h 30 min');
            expect(timeProperty.formatTimeForDisplay('09:00')).toBe('9h');
            expect(timeProperty.formatTimeForDisplay('00:15')).toBe('15 min');
            expect(timeProperty.formatTimeForDisplay('00:00')).toBe('0 min');
            expect(timeProperty.formatTimeForDisplay('')).toBe('');
        });
        it('should handle time with seconds', () => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime', { format: 'custom' });
            expect(timeProperty.formatTimeForDisplay('14:30:45')).toBe('14h 30 min 45s');
            expect(timeProperty.formatTimeForDisplay('00:00:30')).toBe('30s');
        });
    });
    describe('formatTimeForStorage', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should format Date to HH:mm string', () => {
            const date1 = new Date('2024-01-01T14:30:00');
            const date2 = new Date('2024-01-01T09:15:00');
            expect(timeProperty.formatTimeForStorage(date1)).toBe('14:30');
            expect(timeProperty.formatTimeForStorage(date2)).toBe('09:15');
        });
    });
    describe('createFieldLink', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should create link element with time value', () => {
            const link = timeProperty.createFieldLink('14:30');
            expect(link.tagName).toBe('DIV');
            expect(link.textContent).toBe('14:30');
            expect(link.classList.contains('time-field-link')).toBe(true);
            expect(link.classList.contains('field-link')).toBe(true);
            expect(link.style.cursor).toBe('pointer');
        });
        it('should create link with default text when no value', () => {
            const link = timeProperty.createFieldLink('');
            expect(link.textContent).toBe('Aucune heure sélectionnée');
        });
        it('should handle click event to trigger modifyField', () => {
            const spy = jest.spyOn(timeProperty, 'modifyField');
            const link = timeProperty.createFieldLink('14:30');
            link.click();
            expect(spy).toHaveBeenCalledWith(expect.objectContaining({
                type: 'click',
                currentTarget: link
            }));
        });
    });
    describe('createFieldTime', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should create input element with flatpickr', () => {
            const mockUpdate = jest.fn();
            const mockLink = document.createElement('div');
            const input = timeProperty.createFieldTime('14:30', mockUpdate, mockLink);
            expect(input.tagName).toBe('INPUT');
            expect(input.type).toBe('text');
            expect(input.value).toBe('14:30');
            expect(input.classList.contains('field-input')).toBe(true);
            expect(input.hasAttribute('data-flatpickr')).toBe(true);
        });
        it('should create input with empty value when no initial value', () => {
            const mockUpdate = jest.fn();
            const mockLink = document.createElement('div');
            const input = timeProperty.createFieldTime('', mockUpdate, mockLink);
            expect(input.value).toBe('');
        });
        it('should handle flatpickr onChange event', async () => {
            const mockUpdate = jest.fn().mockResolvedValue(undefined);
            const mockLink = document.createElement('div');
            const spy = jest.spyOn(timeProperty, 'updateField').mockResolvedValue(undefined);
            const input = timeProperty.createFieldTime('', mockUpdate, mockLink);
            // Simuler le changement flatpickr
            const mockDate = new Date('2024-01-01T15:45:00');
            if (input._flatpickrOnChange) {
                await input._flatpickrOnChange([mockDate]);
            }
            expect(input.value).toBe('15:45');
            expect(spy).toHaveBeenCalledWith(mockUpdate, input, mockLink);
        });
        it('should handle flatpickr onClose event', async () => {
            const mockUpdate = jest.fn().mockResolvedValue(undefined);
            const mockLink = document.createElement('div');
            const spy = jest.spyOn(timeProperty, 'updateField').mockResolvedValue(undefined);
            const input = timeProperty.createFieldTime('invalid', mockUpdate, mockLink);
            // Simuler la fermeture flatpickr
            if (input._flatpickrOnClose) {
                await input._flatpickrOnClose();
            }
            expect(input.value).toBe(''); // Valeur invalide effacée
            expect(spy).toHaveBeenCalledWith(mockUpdate, input, mockLink);
        });
    });
    describe('fillDisplay', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should create container with link and input for valid value', () => {
            const mockUpdate = jest.fn();
            const container = timeProperty.fillDisplay({}, '14:30', mockUpdate);
            expect(container.tagName).toBe('DIV');
            expect(container.classList.contains('field-container')).toBe(true);
            const link = container.querySelector('.time-field-link');
            const input = container.querySelector('input');
            expect(link).toBeTruthy();
            expect(input).toBeTruthy();
            expect(link?.style.display).toBe('block');
            // L'input est initialisé par flatpickr, donc on vérifie qu'il existe mais pas nécessairement qu'il soit caché
            expect(input).toBeTruthy();
        });
        it('should show input for invalid value', () => {
            const mockUpdate = jest.fn();
            const container = timeProperty.fillDisplay({}, 'invalid', mockUpdate);
            const link = container.querySelector('.time-field-link');
            const input = container.querySelector('input');
            expect(input?.style.display).toBe('block');
            expect(link?.style.display).toBe('none');
        });
        it('should show input for empty value', () => {
            const mockUpdate = jest.fn();
            const container = timeProperty.fillDisplay({}, '', mockUpdate);
            const link = container.querySelector('.time-field-link');
            const input = container.querySelector('input');
            expect(input?.style.display).toBe('block');
            expect(link?.style.display).toBe('none');
        });
    });
    describe('updateField', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should update field with valid value', async () => {
            const mockUpdate = jest.fn().mockResolvedValue(undefined);
            const input = document.createElement('input');
            input.value = '14:30';
            const link = document.createElement('div');
            await timeProperty.updateField(mockUpdate, input, link);
            expect(mockUpdate).toHaveBeenCalledWith('14:30');
            expect(input.style.display).toBe('none');
            expect(link.style.display).toBe('block');
            expect(link.textContent).toBe('14:30');
        });
        it('should handle invalid value', async () => {
            const mockUpdate = jest.fn().mockResolvedValue(undefined);
            const input = document.createElement('input');
            input.value = 'invalid';
            const link = document.createElement('div');
            await timeProperty.updateField(mockUpdate, input, link);
            expect(mockUpdate).toHaveBeenCalledWith('');
            expect(link.textContent).toBe('Aucune heure sélectionnée');
        });
    });
    describe('modifyField', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should call modifyField without throwing errors', () => {
            // Test que modifyField peut être appelé sans erreur
            const container = document.createElement('div');
            const link = document.createElement('div');
            const input = document.createElement('input');
            container.appendChild(link);
            container.appendChild(input);
            const event = { currentTarget: link };
            // Vérifier que modifyField ne lance pas d'erreur
            expect(() => timeProperty.modifyField(event)).not.toThrow();
        });
        it('should handle missing container', () => {
            const link = document.createElement('div'); // Pas de parent
            const event = { currentTarget: link };
            // Ne devrait pas lever d'erreur
            expect(() => timeProperty.modifyField(event)).not.toThrow();
        });
        it('should handle missing input in container', () => {
            const container = document.createElement('div');
            const link = document.createElement('div');
            container.appendChild(link); // Pas d'input
            const event = { currentTarget: link };
            // Ne devrait pas lever d'erreur
            expect(() => timeProperty.modifyField(event)).not.toThrow();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxzcmNcXF9fdGVzdHNfX1xcUHJvcGVydGllc1xcVGltZVByb3BlcnR5LnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOztHQUVHOztBQUlILGlCQUFpQjtBQUNqQixJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxHQUFHLEVBQUU7SUFDeEIsT0FBTyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxPQUFPLEVBQUUsT0FBTyxFQUFFLEVBQUU7UUFDckQscUNBQXFDO1FBQ3JDLE9BQU8sQ0FBQyxZQUFZLENBQUMsZ0JBQWdCLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFFL0MsOENBQThDO1FBQzlDLElBQUksT0FBTyxFQUFFLFFBQVEsRUFBRSxDQUFDO1lBQ3BCLE9BQU8sQ0FBQyxrQkFBa0IsR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDO1FBQ2xELENBQUM7UUFDRCxJQUFJLE9BQU8sRUFBRSxPQUFPLEVBQUUsQ0FBQztZQUNuQixPQUFPLENBQUMsaUJBQWlCLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQztRQUNoRCxDQUFDO1FBRUQsT0FBTztZQUNILE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ2xCLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ2hCLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1NBQ3JCLENBQUM7SUFDTixDQUFDLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQyxDQUFDO0FBRUgscUJBQXFCO0FBQ3JCLElBQUksQ0FBQyxJQUFJLENBQUMsMkJBQTJCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUMxQyxNQUFNLEVBQUUsRUFBRTtDQUNiLENBQUMsRUFBRSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsQ0FB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LEVBQUUsQ0FBQyxZQUFZLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ2hFLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGxlb2R1XFxEb2N1bWVudHNcXDEgLSBQcm9cXFRlc3QgcGx1Z2luIG9ic2lkaWFuXFwub2JzaWRpYW5cXHBsdWdpbnNcXG9ic2lkaWFuLUNSTVxcZHluYW1pYy1maWVsZHNcXHNyY1xcX190ZXN0c19fXFxQcm9wZXJ0aWVzXFxUaW1lUHJvcGVydHkudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQGplc3QtZW52aXJvbm1lbnQganNkb21cclxuICovXHJcblxyXG5pbXBvcnQgeyBUaW1lUHJvcGVydHkgfSBmcm9tICcuLi8uLi9wcm9wZXJ0aWVzL1RpbWVQcm9wZXJ0eSAnO1xyXG5cclxuLy8gTW9jayBmbGF0cGlja3JcclxuamVzdC5tb2NrKCdmbGF0cGlja3InLCAoKSA9PiB7XHJcbiAgICByZXR1cm4gamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoZWxlbWVudCwgb3B0aW9ucykgPT4ge1xyXG4gICAgICAgIC8vIFNpbXVsZXIgbCdpbml0aWFsaXphdGlvbiBmbGF0cGlja3JcclxuICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1mbGF0cGlja3InLCAndHJ1ZScpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFNpbXVsZXIgbGUgdHJpZ2dlciBkZXMgw6l2w6luZW1lbnRzIGZsYXRwaWNrclxyXG4gICAgICAgIGlmIChvcHRpb25zPy5vbkNoYW5nZSkge1xyXG4gICAgICAgICAgICBlbGVtZW50Ll9mbGF0cGlja3JPbkNoYW5nZSA9IG9wdGlvbnMub25DaGFuZ2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChvcHRpb25zPy5vbkNsb3NlKSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuX2ZsYXRwaWNrck9uQ2xvc2UgPSBvcHRpb25zLm9uQ2xvc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGRlc3Ryb3k6IGplc3QuZm4oKSxcclxuICAgICAgICAgICAgY2xlYXI6IGplc3QuZm4oKSxcclxuICAgICAgICAgICAgc2V0RGF0ZTogamVzdC5mbigpXHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG59KTtcclxuXHJcbi8vIE1vY2sgRnJlbmNoIGxvY2FsZVxyXG5qZXN0Lm1vY2soJ2ZsYXRwaWNrci9kaXN0L2wxMG4vZnIuanMnLCAoKSA9PiAoe1xyXG4gICAgRnJlbmNoOiB7fVxyXG59KSwgeyB2aXJ0dWFsOiB0cnVlIH0pO1xyXG5cclxuZGVzY3JpYmUoJ1RpbWVQcm9wZXJ0eScsICgpID0+IHtcclxuICAgIGxldCB0aW1lUHJvcGVydHk6IFRpbWVQcm9wZXJ0eTtcclxuXHJcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICAvLyBSZXNldCBET00gbW9ja3NcclxuICAgICAgICBkb2N1bWVudC5ib2R5LmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIE1vY2sgZm9jdXMgcG91ciB0b3VzIGxlcyDDqWzDqW1lbnRzIEhUTUxcclxuICAgICAgICBIVE1MRWxlbWVudC5wcm90b3R5cGUuZm9jdXMgPSBqZXN0LmZuKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnY29uc3RydWN0b3InLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgVGltZVByb3BlcnR5IHdpdGggZGVmYXVsdCBmb3JtYXQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRpbWVQcm9wZXJ0eSA9IG5ldyBUaW1lUHJvcGVydHkoJ3Rlc3RUaW1lJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5Lm5hbWUpLnRvQmUoJ3Rlc3RUaW1lJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkudHlwZSkudG9CZSgndGltZScpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5Wydmb3JtYXQnXSkudG9CZSgnSEg6bW0nKTsgLy8gZm9ybWF0IHBhciBkw6lmYXV0XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIFRpbWVQcm9wZXJ0eSB3aXRoIGN1c3RvbSBmb3JtYXQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRpbWVQcm9wZXJ0eSA9IG5ldyBUaW1lUHJvcGVydHkoJ3Rlc3RUaW1lJywgeyBmb3JtYXQ6ICdISDptbTpzcycsIGljb246ICdjbG9jaycgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5Lm5hbWUpLnRvQmUoJ3Rlc3RUaW1lJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkudHlwZSkudG9CZSgndGltZScpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5Wydmb3JtYXQnXSkudG9CZSgnSEg6bW06c3MnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eS5pY29uKS50b0JlKCdjbG9jaycpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ3ZhbGlkYXRlJywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lUHJvcGVydHkgPSBuZXcgVGltZVByb3BlcnR5KCd0ZXN0VGltZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGNvcnJlY3QgdGltZSBmb3JtYXQgSEg6bW0nLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkudmFsaWRhdGUoJzE0OjMwJykpLnRvQmUoJzE0OjMwJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkudmFsaWRhdGUoJzA5OjE1JykpLnRvQmUoJzA5OjE1Jyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkudmFsaWRhdGUoJzAwOjAwJykpLnRvQmUoJzAwOjAwJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkudmFsaWRhdGUoJzIzOjU5JykpLnRvQmUoJzIzOjU5Jyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGVtcHR5IHN0cmluZyBmb3IgaW52YWxpZCB0aW1lIGZvcm1hdCcsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eS52YWxpZGF0ZSgnMjU6MDAnKSkudG9CZSgnMjU6MDAnKTsgLy8gRm9ybWF0IHZhbGlkZSBtw6ptZSBzaSBoZXVyZSBpbnZhbGlkZVxyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LnZhbGlkYXRlKCcxNDo3MCcpKS50b0JlKCcxNDo3MCcpOyAvLyBGb3JtYXQgdmFsaWRlIG3Dqm1lIHNpIG1pbnV0ZXMgaW52YWxpZGVzXHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkudmFsaWRhdGUoJzE0JykpLnRvQmUoJycpOyAvLyBGb3JtYXQgaW5jb21wbGV0XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkudmFsaWRhdGUoJzE0OjMnKSkudG9CZSgnJyk7IC8vIEZvcm1hdCBpbmNvcnJlY3QgKHBhcyAyIGRpZ2l0cylcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eS52YWxpZGF0ZSgnYWJjJykpLnRvQmUoJycpOyAvLyBUZXh0ZSBpbnZhbGlkZVxyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LnZhbGlkYXRlKCcnKSkudG9CZSgnJyk7IC8vIENoYcOubmUgdmlkZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2Zvcm1hdFRpbWVGb3JEaXNwbGF5JywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgZm9ybWF0IHRpbWUgZm9yIEhIOm1tIGZvcm1hdCcsICgpID0+IHtcclxuICAgICAgICAgICAgdGltZVByb3BlcnR5ID0gbmV3IFRpbWVQcm9wZXJ0eSgndGVzdFRpbWUnLCB7IGZvcm1hdDogJ0hIOm1tJyB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkuZm9ybWF0VGltZUZvckRpc3BsYXkoJzE0OjMwJykpLnRvQmUoJzE0OjMwJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkuZm9ybWF0VGltZUZvckRpc3BsYXkoJzA5OjE1JykpLnRvQmUoJzA5OjE1Jyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkuZm9ybWF0VGltZUZvckRpc3BsYXkoJycpKS50b0JlKCdBdWN1bmUgaGV1cmUgc8OpbGVjdGlvbm7DqWUnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBmb3JtYXQgdGltZSBmb3IgY3VzdG9tIGZvcm1hdCB3aXRoIHVuaXRzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lUHJvcGVydHkgPSBuZXcgVGltZVByb3BlcnR5KCd0ZXN0VGltZScsIHsgZm9ybWF0OiAnY3VzdG9tJyB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkuZm9ybWF0VGltZUZvckRpc3BsYXkoJzE0OjMwJykpLnRvQmUoJzE0aCAzMCBtaW4nKTtcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eS5mb3JtYXRUaW1lRm9yRGlzcGxheSgnMDk6MDAnKSkudG9CZSgnOWgnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eS5mb3JtYXRUaW1lRm9yRGlzcGxheSgnMDA6MTUnKSkudG9CZSgnMTUgbWluJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkuZm9ybWF0VGltZUZvckRpc3BsYXkoJzAwOjAwJykpLnRvQmUoJzAgbWluJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkuZm9ybWF0VGltZUZvckRpc3BsYXkoJycpKS50b0JlKCcnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgdGltZSB3aXRoIHNlY29uZHMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRpbWVQcm9wZXJ0eSA9IG5ldyBUaW1lUHJvcGVydHkoJ3Rlc3RUaW1lJywgeyBmb3JtYXQ6ICdjdXN0b20nIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eS5mb3JtYXRUaW1lRm9yRGlzcGxheSgnMTQ6MzA6NDUnKSkudG9CZSgnMTRoIDMwIG1pbiA0NXMnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eS5mb3JtYXRUaW1lRm9yRGlzcGxheSgnMDA6MDA6MzAnKSkudG9CZSgnMzBzJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnZm9ybWF0VGltZUZvclN0b3JhZ2UnLCAoKSA9PiB7XHJcbiAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRpbWVQcm9wZXJ0eSA9IG5ldyBUaW1lUHJvcGVydHkoJ3Rlc3RUaW1lJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgZm9ybWF0IERhdGUgdG8gSEg6bW0gc3RyaW5nJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlMSA9IG5ldyBEYXRlKCcyMDI0LTAxLTAxVDE0OjMwOjAwJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGUyID0gbmV3IERhdGUoJzIwMjQtMDEtMDFUMDk6MTU6MDAnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkuZm9ybWF0VGltZUZvclN0b3JhZ2UoZGF0ZTEpKS50b0JlKCcxNDozMCcpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LmZvcm1hdFRpbWVGb3JTdG9yYWdlKGRhdGUyKSkudG9CZSgnMDk6MTUnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdjcmVhdGVGaWVsZExpbmsnLCAoKSA9PiB7XHJcbiAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRpbWVQcm9wZXJ0eSA9IG5ldyBUaW1lUHJvcGVydHkoJ3Rlc3RUaW1lJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIGxpbmsgZWxlbWVudCB3aXRoIHRpbWUgdmFsdWUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSB0aW1lUHJvcGVydHkuY3JlYXRlRmllbGRMaW5rKCcxNDozMCcpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmsudGFnTmFtZSkudG9CZSgnRElWJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rLnRleHRDb250ZW50KS50b0JlKCcxNDozMCcpO1xyXG4gICAgICAgICAgICBleHBlY3QobGluay5jbGFzc0xpc3QuY29udGFpbnMoJ3RpbWUtZmllbGQtbGluaycpKS50b0JlKHRydWUpO1xyXG4gICAgICAgICAgICBleHBlY3QobGluay5jbGFzc0xpc3QuY29udGFpbnMoJ2ZpZWxkLWxpbmsnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmsuc3R5bGUuY3Vyc29yKS50b0JlKCdwb2ludGVyJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIGxpbmsgd2l0aCBkZWZhdWx0IHRleHQgd2hlbiBubyB2YWx1ZScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbGluayA9IHRpbWVQcm9wZXJ0eS5jcmVhdGVGaWVsZExpbmsoJycpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmsudGV4dENvbnRlbnQpLnRvQmUoJ0F1Y3VuZSBoZXVyZSBzw6lsZWN0aW9ubsOpZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBjbGljayBldmVudCB0byB0cmlnZ2VyIG1vZGlmeUZpZWxkJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzcHkgPSBqZXN0LnNweU9uKHRpbWVQcm9wZXJ0eSwgJ21vZGlmeUZpZWxkJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSB0aW1lUHJvcGVydHkuY3JlYXRlRmllbGRMaW5rKCcxNDozMCcpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbGluay5jbGljaygpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xyXG4gICAgICAgICAgICAgICAgdHlwZTogJ2NsaWNrJyxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRUYXJnZXQ6IGxpbmtcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2NyZWF0ZUZpZWxkVGltZScsICgpID0+IHtcclxuICAgICAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICAgICAgdGltZVByb3BlcnR5ID0gbmV3IFRpbWVQcm9wZXJ0eSgndGVzdFRpbWUnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgaW5wdXQgZWxlbWVudCB3aXRoIGZsYXRwaWNrcicsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VwZGF0ZSA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja0xpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gdGltZVByb3BlcnR5LmNyZWF0ZUZpZWxkVGltZSgnMTQ6MzAnLCBtb2NrVXBkYXRlLCBtb2NrTGluayk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QoaW5wdXQudGFnTmFtZSkudG9CZSgnSU5QVVQnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGlucHV0LnR5cGUpLnRvQmUoJ3RleHQnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGlucHV0LnZhbHVlKS50b0JlKCcxNDozMCcpO1xyXG4gICAgICAgICAgICBleHBlY3QoaW5wdXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdmaWVsZC1pbnB1dCcpKS50b0JlKHRydWUpO1xyXG4gICAgICAgICAgICBleHBlY3QoaW5wdXQuaGFzQXR0cmlidXRlKCdkYXRhLWZsYXRwaWNrcicpKS50b0JlKHRydWUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBpbnB1dCB3aXRoIGVtcHR5IHZhbHVlIHdoZW4gbm8gaW5pdGlhbCB2YWx1ZScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VwZGF0ZSA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja0xpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gdGltZVByb3BlcnR5LmNyZWF0ZUZpZWxkVGltZSgnJywgbW9ja1VwZGF0ZSwgbW9ja0xpbmspO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGlucHV0LnZhbHVlKS50b0JlKCcnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgZmxhdHBpY2tyIG9uQ2hhbmdlIGV2ZW50JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tMaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHNweSA9IGplc3Quc3B5T24odGltZVByb3BlcnR5LCAndXBkYXRlRmllbGQnKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSB0aW1lUHJvcGVydHkuY3JlYXRlRmllbGRUaW1lKCcnLCBtb2NrVXBkYXRlLCBtb2NrTGluaykgYXMgYW55O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gU2ltdWxlciBsZSBjaGFuZ2VtZW50IGZsYXRwaWNrclxyXG4gICAgICAgICAgICBjb25zdCBtb2NrRGF0ZSA9IG5ldyBEYXRlKCcyMDI0LTAxLTAxVDE1OjQ1OjAwJyk7XHJcbiAgICAgICAgICAgIGlmIChpbnB1dC5fZmxhdHBpY2tyT25DaGFuZ2UpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IGlucHV0Ll9mbGF0cGlja3JPbkNoYW5nZShbbW9ja0RhdGVdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGlucHV0LnZhbHVlKS50b0JlKCcxNTo0NScpO1xyXG4gICAgICAgICAgICBleHBlY3Qoc3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChtb2NrVXBkYXRlLCBpbnB1dCwgbW9ja0xpbmspO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBmbGF0cGlja3Igb25DbG9zZSBldmVudCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VwZGF0ZSA9IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrTGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBjb25zdCBzcHkgPSBqZXN0LnNweU9uKHRpbWVQcm9wZXJ0eSwgJ3VwZGF0ZUZpZWxkJykubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gdGltZVByb3BlcnR5LmNyZWF0ZUZpZWxkVGltZSgnaW52YWxpZCcsIG1vY2tVcGRhdGUsIG1vY2tMaW5rKSBhcyBhbnk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBTaW11bGVyIGxhIGZlcm1ldHVyZSBmbGF0cGlja3JcclxuICAgICAgICAgICAgaWYgKGlucHV0Ll9mbGF0cGlja3JPbkNsb3NlKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBpbnB1dC5fZmxhdHBpY2tyT25DbG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QoaW5wdXQudmFsdWUpLnRvQmUoJycpOyAvLyBWYWxldXIgaW52YWxpZGUgZWZmYWPDqWVcclxuICAgICAgICAgICAgZXhwZWN0KHNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgobW9ja1VwZGF0ZSwgaW5wdXQsIG1vY2tMaW5rKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdmaWxsRGlzcGxheScsICgpID0+IHtcclxuICAgICAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICAgICAgdGltZVByb3BlcnR5ID0gbmV3IFRpbWVQcm9wZXJ0eSgndGVzdFRpbWUnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgY29udGFpbmVyIHdpdGggbGluayBhbmQgaW5wdXQgZm9yIHZhbGlkIHZhbHVlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSB0aW1lUHJvcGVydHkuZmlsbERpc3BsYXkoe30sICcxNDozMCcsIG1vY2tVcGRhdGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci50YWdOYW1lKS50b0JlKCdESVYnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci5jbGFzc0xpc3QuY29udGFpbnMoJ2ZpZWxkLWNvbnRhaW5lcicpKS50b0JlKHRydWUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgbGluayA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcudGltZS1maWVsZC1saW5rJykgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0JykgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rKS50b0JlVHJ1dGh5KCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChpbnB1dCkudG9CZVRydXRoeSgpO1xyXG4gICAgICAgICAgICBleHBlY3QobGluaz8uc3R5bGUuZGlzcGxheSkudG9CZSgnYmxvY2snKTtcclxuICAgICAgICAgICAgLy8gTCdpbnB1dCBlc3QgaW5pdGlhbGlzw6kgcGFyIGZsYXRwaWNrciwgZG9uYyBvbiB2w6lyaWZpZSBxdSdpbCBleGlzdGUgbWFpcyBwYXMgbsOpY2Vzc2FpcmVtZW50IHF1J2lsIHNvaXQgY2FjaMOpXHJcbiAgICAgICAgICAgIGV4cGVjdChpbnB1dCkudG9CZVRydXRoeSgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHNob3cgaW5wdXQgZm9yIGludmFsaWQgdmFsdWUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRpbWVQcm9wZXJ0eS5maWxsRGlzcGxheSh7fSwgJ2ludmFsaWQnLCBtb2NrVXBkYXRlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLnRpbWUtZmllbGQtbGluaycpIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICAgICAgICBjb25zdCBpbnB1dCA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QoaW5wdXQ/LnN0eWxlLmRpc3BsYXkpLnRvQmUoJ2Jsb2NrJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rPy5zdHlsZS5kaXNwbGF5KS50b0JlKCdub25lJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgc2hvdyBpbnB1dCBmb3IgZW1wdHkgdmFsdWUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRpbWVQcm9wZXJ0eS5maWxsRGlzcGxheSh7fSwgJycsIG1vY2tVcGRhdGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgbGluayA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcudGltZS1maWVsZC1saW5rJykgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0JykgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChpbnB1dD8uc3R5bGUuZGlzcGxheSkudG9CZSgnYmxvY2snKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbms/LnN0eWxlLmRpc3BsYXkpLnRvQmUoJ25vbmUnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCd1cGRhdGVGaWVsZCcsICgpID0+IHtcclxuICAgICAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICAgICAgdGltZVByb3BlcnR5ID0gbmV3IFRpbWVQcm9wZXJ0eSgndGVzdFRpbWUnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCB1cGRhdGUgZmllbGQgd2l0aCB2YWxpZCB2YWx1ZScsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VwZGF0ZSA9IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xyXG4gICAgICAgICAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XHJcbiAgICAgICAgICAgIGlucHV0LnZhbHVlID0gJzE0OjMwJztcclxuICAgICAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgYXdhaXQgdGltZVByb3BlcnR5LnVwZGF0ZUZpZWxkKG1vY2tVcGRhdGUsIGlucHV0LCBsaW5rKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrVXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnMTQ6MzAnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGlucHV0LnN0eWxlLmRpc3BsYXkpLnRvQmUoJ25vbmUnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmsuc3R5bGUuZGlzcGxheSkudG9CZSgnYmxvY2snKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmsudGV4dENvbnRlbnQpLnRvQmUoJzE0OjMwJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGludmFsaWQgdmFsdWUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcclxuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xyXG4gICAgICAgICAgICBpbnB1dC52YWx1ZSA9ICdpbnZhbGlkJztcclxuICAgICAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgYXdhaXQgdGltZVByb3BlcnR5LnVwZGF0ZUZpZWxkKG1vY2tVcGRhdGUsIGlucHV0LCBsaW5rKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrVXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rLnRleHRDb250ZW50KS50b0JlKCdBdWN1bmUgaGV1cmUgc8OpbGVjdGlvbm7DqWUnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdtb2RpZnlGaWVsZCcsICgpID0+IHtcclxuICAgICAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICAgICAgdGltZVByb3BlcnR5ID0gbmV3IFRpbWVQcm9wZXJ0eSgndGVzdFRpbWUnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBjYWxsIG1vZGlmeUZpZWxkIHdpdGhvdXQgdGhyb3dpbmcgZXJyb3JzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBUZXN0IHF1ZSBtb2RpZnlGaWVsZCBwZXV0IMOqdHJlIGFwcGVsw6kgc2FucyBlcnJldXJcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGxpbmspO1xyXG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoaW5wdXQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSB7IGN1cnJlbnRUYXJnZXQ6IGxpbmsgfSBhcyB1bmtub3duIGFzIEV2ZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVsOpcmlmaWVyIHF1ZSBtb2RpZnlGaWVsZCBuZSBsYW5jZSBwYXMgZCdlcnJldXJcclxuICAgICAgICAgICAgZXhwZWN0KCgpID0+IHRpbWVQcm9wZXJ0eS5tb2RpZnlGaWVsZChldmVudCkpLm5vdC50b1Rocm93KCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIG1pc3NpbmcgY29udGFpbmVyJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7IC8vIFBhcyBkZSBwYXJlbnRcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGV2ZW50ID0geyBjdXJyZW50VGFyZ2V0OiBsaW5rIH0gYXMgdW5rbm93biBhcyBFdmVudDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIE5lIGRldnJhaXQgcGFzIGxldmVyIGQnZXJyZXVyXHJcbiAgICAgICAgICAgIGV4cGVjdCgoKSA9PiB0aW1lUHJvcGVydHkubW9kaWZ5RmllbGQoZXZlbnQpKS5ub3QudG9UaHJvdygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBtaXNzaW5nIGlucHV0IGluIGNvbnRhaW5lcicsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGxpbmspOyAvLyBQYXMgZCdpbnB1dFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSB7IGN1cnJlbnRUYXJnZXQ6IGxpbmsgfSBhcyB1bmtub3duIGFzIEV2ZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gTmUgZGV2cmFpdCBwYXMgbGV2ZXIgZCdlcnJldXJcclxuICAgICAgICAgICAgZXhwZWN0KCgpID0+IHRpbWVQcm9wZXJ0eS5tb2RpZnlGaWVsZChldmVudCkpLm5vdC50b1Rocm93KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufSk7Il0sInZlcnNpb24iOjN9