7b455ee8fc90611d58ffc50059a0f836
"use strict";
/**
 * @jest-environment jsdom
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock Obsidian modules
jest.mock('obsidian', () => ({}), { virtual: true });
// Mock vault utilities
jest.mock('../../vault/Utils', () => ({
    setIcon: jest.fn()
}));
const BooleanProperty_1 = require("../../properties/BooleanProperty");
// Import the mocked function for use in tests
const { setIcon } = jest.requireMock('../../vault/Utils');
describe('BooleanProperty', () => {
    let booleanProperty;
    let mockVault;
    let mockFile;
    // Helper function to trigger clicks in jsdom
    const triggerClick = (button) => {
        const clickEvent = new MouseEvent('click', { bubbles: true });
        button.dispatchEvent(clickEvent);
    };
    beforeEach(() => {
        // Reset DOM
        document.body.innerHTML = '';
        // Clear all mocks
        jest.clearAllMocks();
        // Ensure setIcon mock is working properly
        setIcon.mockImplementation((element, iconName) => {
            element.setAttribute('data-icon', iconName);
            element.textContent = `[${iconName}]`;
        });
        // Mock vault
        mockVault = {
            app: {
                vault: { getFiles: jest.fn(() => []) }
            }
        };
        // Mock file
        mockFile = {
            getMetadata: jest.fn(() => ({ isActive: true })),
            getMetadataValue: jest.fn((key) => key === 'isActive' ? true : undefined),
            updateMetadata: jest.fn(),
            vault: mockVault
        };
        booleanProperty = new BooleanProperty_1.BooleanProperty('isActive');
        // Ensure clean state for each test
        booleanProperty.static = false;
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    describe('constructor', () => {
        it('should create BooleanProperty with correct type', () => {
            const prop = new BooleanProperty_1.BooleanProperty('test');
            expect(prop.name).toBe('test');
            expect(prop.type).toBe('boolean');
        });
        it('should accept additional arguments', () => {
            const args = { icon: 'check', staticProperty: true };
            const prop = new BooleanProperty_1.BooleanProperty('testBool', args);
            expect(prop.name).toBe('testBool');
            expect(prop.static).toBe(true);
            expect(prop.icon).toBe('check');
        });
        it('should use default icon if not provided', () => {
            const prop = new BooleanProperty_1.BooleanProperty('testDefault');
            expect(prop.icon).toBe('align-left'); // Default from base Property class
        });
    });
    describe('fillDisplay', () => {
        it('should create container with button element', () => {
            const updateFn = jest.fn();
            const container = booleanProperty.fillDisplay(mockVault, true, updateFn);
            expect(container.tagName).toBe('DIV');
            const button = container.querySelector('span');
            expect(button).toBeTruthy();
            expect(button?.getAttribute('data-icon')).toBe('align-left');
        });
        it('should set vault reference', () => {
            const updateFn = jest.fn();
            booleanProperty.fillDisplay(mockVault, true, updateFn);
            expect(booleanProperty.vault).toBe(mockVault);
        });
        it('should add active class when value is true', () => {
            const updateFn = jest.fn();
            const container = booleanProperty.fillDisplay(mockVault, true, updateFn);
            const button = container.querySelector('span');
            expect(button?.classList.contains('boolean-property-button-active')).toBe(true);
        });
        it('should not add active class when value is false', () => {
            const updateFn = jest.fn();
            const container = booleanProperty.fillDisplay(mockVault, false, updateFn);
            const button = container.querySelector('span');
            expect(button?.classList.contains('boolean-property-button-active')).toBe(false);
        });
        it('should not add active class when value is falsy', () => {
            const updateFn = jest.fn();
            // Test various falsy values
            const falsyValues = [false, null, undefined, 0, '', NaN];
            falsyValues.forEach(value => {
                const container = booleanProperty.fillDisplay(mockVault, value, updateFn);
                const button = container.querySelector('span');
                expect(button?.classList.contains('boolean-property-button-active')).toBe(false);
            });
        });
        it('should add active class for truthy values', () => {
            const updateFn = jest.fn();
            // Test various truthy values
            const truthyValues = [true, 1, 'yes', {}, [], 42];
            truthyValues.forEach(value => {
                const container = booleanProperty.fillDisplay(mockVault, value, updateFn);
                const button = container.querySelector('span');
                expect(button?.classList.contains('boolean-property-button-active')).toBe(true);
            });
        });
    });
    describe('click functionality for non-static property', () => {
        it('should toggle value on click when not static', async () => {
            booleanProperty.static = false;
            const updateFn = jest.fn();
            let currentValue = false;
            const container = booleanProperty.fillDisplay(mockVault, currentValue, updateFn);
            const button = container.querySelector('span');
            // Initially false, should not have active class
            expect(button.classList.contains('boolean-property-button-active')).toBe(false);
            // Click to toggle
            button.click();
            // Wait for async update
            await new Promise(resolve => setTimeout(resolve, 0));
            expect(updateFn).toHaveBeenCalledWith(true);
            expect(button.classList.contains('boolean-property-button-active')).toBe(true);
        });
        it('should toggle from true to false', async () => {
            booleanProperty.static = false;
            const updateFn = jest.fn();
            let currentValue = true;
            const container = booleanProperty.fillDisplay(mockVault, currentValue, updateFn);
            const button = container.querySelector('span');
            // Initially true, should have active class
            expect(button.classList.contains('boolean-property-button-active')).toBe(true);
            // Click to toggle
            button.click();
            // Wait for async update
            await new Promise(resolve => setTimeout(resolve, 0));
            expect(updateFn).toHaveBeenCalledWith(false);
            expect(button.classList.contains('boolean-property-button-active')).toBe(false);
        });
        it('should handle multiple clicks correctly', async () => {
            booleanProperty.static = false;
            const updateFn = jest.fn();
            let currentValue = false;
            const container = booleanProperty.fillDisplay(mockVault, currentValue, updateFn);
            const button = container.querySelector('span');
            // Add to document for proper event handling
            document.body.appendChild(container);
            // First click: false -> true
            button.click();
            await new Promise(resolve => setTimeout(resolve, 10));
            expect(updateFn).toHaveBeenNthCalledWith(1, true);
            // Second click: true -> false
            button.click();
            await new Promise(resolve => setTimeout(resolve, 0));
            expect(updateFn).toHaveBeenNthCalledWith(2, false);
            // Third click: false -> true
            button.click();
            await new Promise(resolve => setTimeout(resolve, 0));
            expect(updateFn).toHaveBeenNthCalledWith(3, true);
            expect(updateFn).toHaveBeenCalledTimes(3);
        });
        it('should update visual state immediately on click', async () => {
            booleanProperty.static = false;
            const updateFn = jest.fn();
            const container = booleanProperty.fillDisplay(mockVault, false, updateFn);
            const button = container.querySelector('span');
            // Before click
            expect(button.classList.contains('boolean-property-button-active')).toBe(false);
            // Click should immediately update visual state
            button.click();
            // Visual state should update immediately, before async operation completes
            expect(button.classList.contains('boolean-property-button-active')).toBe(true);
            // Wait for async operation
            await new Promise(resolve => setTimeout(resolve, 0));
            expect(updateFn).toHaveBeenCalledWith(true);
        });
    });
    describe('static property behavior', () => {
        it('should not add click listener when static', () => {
            booleanProperty.static = true;
            const updateFn = jest.fn();
            const container = booleanProperty.fillDisplay(mockVault, false, updateFn);
            const button = container.querySelector('span');
            // Click should not trigger update
            button.click();
            expect(updateFn).not.toHaveBeenCalled();
        });
        it('should still show correct visual state when static', () => {
            booleanProperty.static = true;
            const updateFn = jest.fn();
            // Test true value
            const containerTrue = booleanProperty.fillDisplay(mockVault, true, updateFn);
            const buttonTrue = containerTrue.querySelector('span');
            expect(buttonTrue?.classList.contains('boolean-property-button-active')).toBe(true);
            // Test false value
            const containerFalse = booleanProperty.fillDisplay(mockVault, false, updateFn);
            const buttonFalse = containerFalse.querySelector('span');
            expect(buttonFalse?.classList.contains('boolean-property-button-active')).toBe(false);
        });
    });
    describe('icon functionality', () => {
        it('should set custom icon', () => {
            const customProperty = new BooleanProperty_1.BooleanProperty('custom', { icon: 'check-circle' });
            const updateFn = jest.fn();
            const container = customProperty.fillDisplay(mockVault, true, updateFn);
            const button = container.querySelector('span');
            expect(button?.getAttribute('data-icon')).toBe('check-circle');
        });
        it('should call setIcon with correct parameters', () => {
            const updateFn = jest.fn();
            // Clear previous calls
            setIcon.mockClear();
            booleanProperty.fillDisplay(mockVault, true, updateFn);
            expect(setIcon).toHaveBeenCalled();
            const callArgs = setIcon.mock.calls[0];
            expect(callArgs[0]).toHaveProperty('tagName'); // Should be an element-like object
            expect(callArgs[0]).toHaveProperty('classList'); // Should have DOM-like interface
            expect(callArgs[1]).toBe('align-left');
        });
    });
    describe('integration with base Property class', () => {
        it('should inherit from Property class', () => {
            expect(booleanProperty).toBeInstanceOf(BooleanProperty_1.BooleanProperty);
            expect(booleanProperty.name).toBe('isActive');
            expect(booleanProperty.type).toBe('boolean');
        });
        it('should have access to base class properties', () => {
            expect(typeof booleanProperty.read).toBe('function');
            expect(typeof booleanProperty.validate).toBe('function');
            expect(typeof booleanProperty.getPretty).toBe('function');
        });
    });
    describe('edge cases and error handling', () => {
        it('should handle null update function gracefully', () => {
            booleanProperty.static = false;
            // Should not throw error with null update function
            expect(() => {
                booleanProperty.fillDisplay(mockVault, true, null);
            }).not.toThrow();
        });
        it('should handle undefined value', () => {
            const updateFn = jest.fn();
            const container = booleanProperty.fillDisplay(mockVault, undefined, updateFn);
            const button = container.querySelector('span');
            expect(button?.classList.contains('boolean-property-button-active')).toBe(false);
        });
        it('should handle string boolean values', () => {
            const updateFn = jest.fn();
            // Test truthy strings
            const containerTruthy = booleanProperty.fillDisplay(mockVault, 'true', updateFn);
            const buttonTruthy = containerTruthy.querySelector('span');
            expect(buttonTruthy?.classList.contains('boolean-property-button-active')).toBe(true);
            // Test empty string (falsy)
            const containerFalsy = booleanProperty.fillDisplay(mockVault, '', updateFn);
            const buttonFalsy = containerFalsy.querySelector('span');
            expect(buttonFalsy?.classList.contains('boolean-property-button-active')).toBe(false);
        });
        it('should handle rapid successive clicks', async () => {
            booleanProperty.static = false;
            const updateFn = jest.fn();
            const container = booleanProperty.fillDisplay(mockVault, false, updateFn);
            const button = container.querySelector('span');
            // Rapid clicks
            button.click();
            button.click();
            button.click();
            // Wait for all async operations
            await new Promise(resolve => setTimeout(resolve, 10));
            expect(updateFn).toHaveBeenCalledTimes(3);
            // Final state should be true (false -> true -> false -> true)
            expect(updateFn).toHaveBeenLastCalledWith(true);
        });
    });
    describe('CSS class management', () => {
        it('should properly add and remove active class', () => {
            booleanProperty.static = false;
            const updateFn = jest.fn();
            // Start with false
            const container = booleanProperty.fillDisplay(mockVault, false, updateFn);
            const button = container.querySelector('span');
            // Should not have active class initially
            expect(button.classList.contains('boolean-property-button-active')).toBe(false);
            // Click to activate
            button.click();
            expect(button.classList.contains('boolean-property-button-active')).toBe(true);
            // Click to deactivate
            button.click();
            expect(button.classList.contains('boolean-property-button-active')).toBe(false);
        });
        it('should not interfere with other CSS classes', () => {
            booleanProperty.static = false;
            const updateFn = jest.fn();
            const container = booleanProperty.fillDisplay(mockVault, true, updateFn);
            const button = container.querySelector('span');
            // Add some other classes
            button.classList.add('custom-class', 'another-class');
            // Verify active class is added correctly
            expect(button.classList.contains('boolean-property-button-active')).toBe(true);
            expect(button.classList.contains('custom-class')).toBe(true);
            expect(button.classList.contains('another-class')).toBe(true);
            // Toggle and verify other classes remain
            if (!booleanProperty.static) {
                button.click();
                expect(button.classList.contains('custom-class')).toBe(true);
                expect(button.classList.contains('another-class')).toBe(true);
            }
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxzcmNcXF9fdGVzdHNfX1xcUHJvcGVydGllc1xcQm9vbGVhblByb3BlcnR5LnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOztHQUVHOztBQUlILHdCQUF3QjtBQUN4QixJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7QUFFckQsdUJBQXVCO0FBQ3ZCLElBQUksQ0FBQyxJQUFJLENBQUMsbUJBQW1CLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNsQyxPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUNyQixDQUFDLENBQUMsQ0FBQztBQVJKLHNFQUFtRTtBQVVuRSw4Q0FBOEM7QUFDOUMsTUFBTSxFQUFFLE9BQU8sRUFBRSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsbUJBQW1CLENBQUMsQ0FBQztBQUUxRCxRQUFRLENBQUMsaUJBQWlCLEVBQUUsR0FBRyxFQUFFO0lBQzdCLElBQUksZUFBZ0MsQ0FBQztJQUNyQyxJQUFJLFNBQWMsQ0FBQztJQUNuQixJQUFJLFFBQWEsQ0FBQztJQUVsQiw2Q0FBNkM7SUFDN0MsTUFBTSxZQUFZLEdBQUcsQ0FBQyxNQUFtQixFQUFFLEVBQUU7UUFDekMsTUFBTSxVQUFVLEdBQUcsSUFBSSxVQUFVLENBQUMsT0FBTyxFQUFFLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7UUFDOUQsTUFBTSxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUNyQyxDQUFDLENBQUM7SUFFRixVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ1osWUFBWTtRQUNaLFFBQVEsQ0FBQyxJQUFJLENBQUMsU0FBUyxHQUFH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RSxDQUFDLDZDQUE2QyxFQUFFLEdBQUcsRUFBRTtZQUNuRCxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7WUFDM0IsTUFBTSxTQUFTLEdBQUcsZUFBZSxDQUFDLFdBQVcsQ0FBQyxTQUFTLEVBQUUsSUFBSSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1lBRXpFLE1BQU0sQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRXRDLE1BQU0sTUFBTSxHQUFHLFNBQVMsQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDL0MsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1lBQzVCLE1BQU0sQ0FBQyxNQUFNLEVBQUUsWUFBWSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQ2pFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDRCQUE0QixFQUFFLEdBQUcsRUFBRTtZQUNsQyxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7WUFDM0IsZUFBZSxDQUFDLFdBQVcsQ0FBQyxTQUFTLEVBQUUsSUFBSSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1lBRXZELE1BQU0sQ0FBQyxlQUFlLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ2xELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDRDQUE0QyxFQUFFLEdBQUcsRUFBRTtZQUNsRCxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7WUFDM0IsTUFBTSxTQUFTLEdBQUcsZUFBZSxDQUFDLFdBQVcsQ0FBQyxTQUFTLEVBQUUsSUFBSSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1lBRXpFLE1BQU0sTUFBTSxHQUFHLFNBQVMsQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDL0MsTUFBTSxDQUFDLE1BQU0sRUFBRSxTQUFTLENB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QUcsZUFBZSxDQUFDLFdBQVcsQ0FBQyxTQUFTLEVBQUUsSUFBSSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1lBQ3pFLE1BQU0sTUFBTSxHQUFHLFNBQVMsQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFnQixDQUFDO1lBRTlELHlCQUF5QjtZQUN6QixNQUFNLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxjQUFjLEVBQUUsZUFBZSxDQUFDLENBQUM7WUFFdEQseUNBQXlDO1lBQ3pDLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxnQ0FBZ0MsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQy9FLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUM3RCxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFFOUQseUNBQXlDO1lBQ3pDLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxFQUFFLENBQUM7Z0JBQzFCLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztnQkFDZixNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQzdELE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNsRSxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbGVvZHVcXERvY3VtZW50c1xcMSAtIFByb1xcVGVzdCBwbHVnaW4gb2JzaWRpYW5cXC5vYnNpZGlhblxccGx1Z2luc1xcb2JzaWRpYW4tQ1JNXFxkeW5hbWljLWZpZWxkc1xcc3JjXFxfX3Rlc3RzX19cXFByb3BlcnRpZXNcXEJvb2xlYW5Qcm9wZXJ0eS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAamVzdC1lbnZpcm9ubWVudCBqc2RvbVxyXG4gKi9cclxuXHJcbmltcG9ydCB7IEJvb2xlYW5Qcm9wZXJ0eSB9IGZyb20gJy4uLy4uL3Byb3BlcnRpZXMvQm9vbGVhblByb3BlcnR5JztcclxuXHJcbi8vIE1vY2sgT2JzaWRpYW4gbW9kdWxlc1xyXG5qZXN0Lm1vY2soJ29ic2lkaWFuJywgKCkgPT4gKHt9KSwgeyB2aXJ0dWFsOiB0cnVlIH0pO1xyXG5cclxuLy8gTW9jayB2YXVsdCB1dGlsaXRpZXNcclxuamVzdC5tb2NrKCcuLi8uLi92YXVsdC9VdGlscycsICgpID0+ICh7XHJcbiAgICBzZXRJY29uOiBqZXN0LmZuKClcclxufSkpO1xyXG5cclxuLy8gSW1wb3J0IHRoZSBtb2NrZWQgZnVuY3Rpb24gZm9yIHVzZSBpbiB0ZXN0c1xyXG5jb25zdCB7IHNldEljb24gfSA9IGplc3QucmVxdWlyZU1vY2soJy4uLy4uL3ZhdWx0L1V0aWxzJyk7XHJcblxyXG5kZXNjcmliZSgnQm9vbGVhblByb3BlcnR5JywgKCkgPT4ge1xyXG4gICAgbGV0IGJvb2xlYW5Qcm9wZXJ0eTogQm9vbGVhblByb3BlcnR5O1xyXG4gICAgbGV0IG1vY2tWYXVsdDogYW55O1xyXG4gICAgbGV0IG1vY2tGaWxlOiBhbnk7XHJcblxyXG4gICAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIHRyaWdnZXIgY2xpY2tzIGluIGpzZG9tXHJcbiAgICBjb25zdCB0cmlnZ2VyQ2xpY2sgPSAoYnV0dG9uOiBIVE1MRWxlbWVudCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNsaWNrRXZlbnQgPSBuZXcgTW91c2VFdmVudCgnY2xpY2snLCB7IGJ1YmJsZXM6IHRydWUgfSk7XHJcbiAgICAgICAgYnV0dG9uLmRpc3BhdGNoRXZlbnQoY2xpY2tFdmVudCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgIC8vIFJlc2V0IERPTVxyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ2xlYXIgYWxsIG1vY2tzXHJcbiAgICAgICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gRW5zdXJlIHNldEljb24gbW9jayBpcyB3b3JraW5nIHByb3Blcmx5XHJcbiAgICAgICAgc2V0SWNvbi5tb2NrSW1wbGVtZW50YXRpb24oKGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBpY29uTmFtZTogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLWljb24nLCBpY29uTmFtZSk7XHJcbiAgICAgICAgICAgIGVsZW1lbnQudGV4dENvbnRlbnQgPSBgWyR7aWNvbk5hbWV9XWA7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gTW9jayB2YXVsdFxyXG4gICAgICAgIG1vY2tWYXVsdCA9IHtcclxuICAgICAgICAgICAgYXBwOiB7XHJcbiAgICAgICAgICAgICAgICB2YXVsdDogeyBnZXRGaWxlczogamVzdC5mbigoKSA9PiBbXSkgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gTW9jayBmaWxlXHJcbiAgICAgICAgbW9ja0ZpbGUgPSB7XHJcbiAgICAgICAgICAgIGdldE1ldGFkYXRhOiBqZXN0LmZuKCgpID0+ICh7IGlzQWN0aXZlOiB0cnVlIH0pKSxcclxuICAgICAgICAgICAgZ2V0TWV0YWRhdGFWYWx1ZTogamVzdC5mbigoa2V5OiBzdHJpbmcpID0+IGtleSA9PT0gJ2lzQWN0aXZlJyA/IHRydWUgOiB1bmRlZmluZWQpLFxyXG4gICAgICAgICAgICB1cGRhdGVNZXRhZGF0YTogamVzdC5mbigpLFxyXG4gICAgICAgICAgICB2YXVsdDogbW9ja1ZhdWx0XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgYm9vbGVhblByb3BlcnR5ID0gbmV3IEJvb2xlYW5Qcm9wZXJ0eSgnaXNBY3RpdmUnKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBFbnN1cmUgY2xlYW4gc3RhdGUgZm9yIGVhY2ggdGVzdFxyXG4gICAgICAgIGJvb2xlYW5Qcm9wZXJ0eS5zdGF0aWMgPSBmYWxzZTtcclxuICAgIH0pO1xyXG5cclxuICAgIGFmdGVyRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnY29uc3RydWN0b3InLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgQm9vbGVhblByb3BlcnR5IHdpdGggY29ycmVjdCB0eXBlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwcm9wID0gbmV3IEJvb2xlYW5Qcm9wZXJ0eSgndGVzdCcpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHByb3AubmFtZSkudG9CZSgndGVzdCcpO1xyXG4gICAgICAgICAgICBleHBlY3QocHJvcC50eXBlKS50b0JlKCdib29sZWFuJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgYWNjZXB0IGFkZGl0aW9uYWwgYXJndW1lbnRzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBhcmdzID0geyBpY29uOiAnY2hlY2snLCBzdGF0aWNQcm9wZXJ0eTogdHJ1ZSB9O1xyXG4gICAgICAgICAgICBjb25zdCBwcm9wID0gbmV3IEJvb2xlYW5Qcm9wZXJ0eSgndGVzdEJvb2wnLCBhcmdzKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChwcm9wLm5hbWUpLnRvQmUoJ3Rlc3RCb29sJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChwcm9wLnN0YXRpYykudG9CZSh0cnVlKTtcclxuICAgICAgICAgICAgZXhwZWN0KHByb3AuaWNvbikudG9CZSgnY2hlY2snKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCB1c2UgZGVmYXVsdCBpY29uIGlmIG5vdCBwcm92aWRlZCcsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcHJvcCA9IG5ldyBCb29sZWFuUHJvcGVydHkoJ3Rlc3REZWZhdWx0Jyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocHJvcC5pY29uKS50b0JlKCdhbGlnbi1sZWZ0Jyk7IC8vIERlZmF1bHQgZnJvbSBiYXNlIFByb3BlcnR5IGNsYXNzXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnZmlsbERpc3BsYXknLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgY29udGFpbmVyIHdpdGggYnV0dG9uIGVsZW1lbnQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZUZuID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBib29sZWFuUHJvcGVydHkuZmlsbERpc3BsYXkobW9ja1ZhdWx0LCB0cnVlLCB1cGRhdGVGbik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QoY29udGFpbmVyLnRhZ05hbWUpLnRvQmUoJ0RJVicpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKTtcclxuICAgICAgICAgICAgZXhwZWN0KGJ1dHRvbikudG9CZVRydXRoeSgpO1xyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uPy5nZXRBdHRyaWJ1dGUoJ2RhdGEtaWNvbicpKS50b0JlKCdhbGlnbi1sZWZ0Jyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgc2V0IHZhdWx0IHJlZmVyZW5jZScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlRm4gPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsIHRydWUsIHVwZGF0ZUZuKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChib29sZWFuUHJvcGVydHkudmF1bHQpLnRvQmUobW9ja1ZhdWx0KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBhZGQgYWN0aXZlIGNsYXNzIHdoZW4gdmFsdWUgaXMgdHJ1ZScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlRm4gPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsIHRydWUsIHVwZGF0ZUZuKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdzcGFuJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b24/LmNsYXNzTGlzdC5jb250YWlucygnYm9vbGVhbi1wcm9wZXJ0eS1idXR0b24tYWN0aXZlJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgbm90IGFkZCBhY3RpdmUgY2xhc3Mgd2hlbiB2YWx1ZSBpcyBmYWxzZScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlRm4gPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsIGZhbHNlLCB1cGRhdGVGbik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBidXR0b24gPSBjb250YWluZXIucXVlcnlTZWxlY3Rvcignc3BhbicpO1xyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uPy5jbGFzc0xpc3QuY29udGFpbnMoJ2Jvb2xlYW4tcHJvcGVydHktYnV0dG9uLWFjdGl2ZScpKS50b0JlKGZhbHNlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBub3QgYWRkIGFjdGl2ZSBjbGFzcyB3aGVuIHZhbHVlIGlzIGZhbHN5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVGbiA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFRlc3QgdmFyaW91cyBmYWxzeSB2YWx1ZXNcclxuICAgICAgICAgICAgY29uc3QgZmFsc3lWYWx1ZXMgPSBbZmFsc2UsIG51bGwsIHVuZGVmaW5lZCwgMCwgJycsIE5hTl07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBmYWxzeVZhbHVlcy5mb3JFYWNoKHZhbHVlID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsIHZhbHVlLCB1cGRhdGVGbik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBjb250YWluZXIucXVlcnlTZWxlY3Rvcignc3BhbicpO1xyXG4gICAgICAgICAgICAgICAgZXhwZWN0KGJ1dHRvbj8uY2xhc3NMaXN0LmNvbnRhaW5zKCdib29sZWFuLXByb3BlcnR5LWJ1dHRvbi1hY3RpdmUnKSkudG9CZShmYWxzZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGFkZCBhY3RpdmUgY2xhc3MgZm9yIHRydXRoeSB2YWx1ZXMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZUZuID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVGVzdCB2YXJpb3VzIHRydXRoeSB2YWx1ZXNcclxuICAgICAgICAgICAgY29uc3QgdHJ1dGh5VmFsdWVzID0gW3RydWUsIDEsICd5ZXMnLCB7fSwgW10sIDQyXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRydXRoeVZhbHVlcy5mb3JFYWNoKHZhbHVlID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsIHZhbHVlLCB1cGRhdGVGbik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBjb250YWluZXIucXVlcnlTZWxlY3Rvcignc3BhbicpO1xyXG4gICAgICAgICAgICAgICAgZXhwZWN0KGJ1dHRvbj8uY2xhc3NMaXN0LmNvbnRhaW5zKCdib29sZWFuLXByb3BlcnR5LWJ1dHRvbi1hY3RpdmUnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnY2xpY2sgZnVuY3Rpb25hbGl0eSBmb3Igbm9uLXN0YXRpYyBwcm9wZXJ0eScsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIHRvZ2dsZSB2YWx1ZSBvbiBjbGljayB3aGVuIG5vdCBzdGF0aWMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGJvb2xlYW5Qcm9wZXJ0eS5zdGF0aWMgPSBmYWxzZTtcclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlRm4gPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGxldCBjdXJyZW50VmFsdWUgPSBmYWxzZTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsIGN1cnJlbnRWYWx1ZSwgdXBkYXRlRm4pO1xyXG4gICAgICAgICAgICBjb25zdCBidXR0b24gPSBjb250YWluZXIucXVlcnlTZWxlY3Rvcignc3BhbicpIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gSW5pdGlhbGx5IGZhbHNlLCBzaG91bGQgbm90IGhhdmUgYWN0aXZlIGNsYXNzXHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdib29sZWFuLXByb3BlcnR5LWJ1dHRvbi1hY3RpdmUnKSkudG9CZShmYWxzZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBDbGljayB0byB0b2dnbGVcclxuICAgICAgICAgICAgYnV0dG9uLmNsaWNrKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBXYWl0IGZvciBhc3luYyB1cGRhdGVcclxuICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDApKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdCh1cGRhdGVGbikudG9IYXZlQmVlbkNhbGxlZFdpdGgodHJ1ZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdib29sZWFuLXByb3BlcnR5LWJ1dHRvbi1hY3RpdmUnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCB0b2dnbGUgZnJvbSB0cnVlIHRvIGZhbHNlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBib29sZWFuUHJvcGVydHkuc3RhdGljID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZUZuID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBsZXQgY3VycmVudFZhbHVlID0gdHJ1ZTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsIGN1cnJlbnRWYWx1ZSwgdXBkYXRlRm4pO1xyXG4gICAgICAgICAgICBjb25zdCBidXR0b24gPSBjb250YWluZXIucXVlcnlTZWxlY3Rvcignc3BhbicpIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gSW5pdGlhbGx5IHRydWUsIHNob3VsZCBoYXZlIGFjdGl2ZSBjbGFzc1xyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYm9vbGVhbi1wcm9wZXJ0eS1idXR0b24tYWN0aXZlJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBDbGljayB0byB0b2dnbGVcclxuICAgICAgICAgICAgYnV0dG9uLmNsaWNrKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBXYWl0IGZvciBhc3luYyB1cGRhdGVcclxuICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDApKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdCh1cGRhdGVGbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoZmFsc2UpO1xyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYm9vbGVhbi1wcm9wZXJ0eS1idXR0b24tYWN0aXZlJykpLnRvQmUoZmFsc2UpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBtdWx0aXBsZSBjbGlja3MgY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBib29sZWFuUHJvcGVydHkuc3RhdGljID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZUZuID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBsZXQgY3VycmVudFZhbHVlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBib29sZWFuUHJvcGVydHkuZmlsbERpc3BsYXkobW9ja1ZhdWx0LCBjdXJyZW50VmFsdWUsIHVwZGF0ZUZuKTtcclxuICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEFkZCB0byBkb2N1bWVudCBmb3IgcHJvcGVyIGV2ZW50IGhhbmRsaW5nXHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEZpcnN0IGNsaWNrOiBmYWxzZSAtPiB0cnVlXHJcbiAgICAgICAgICAgIGJ1dHRvbi5jbGljaygpO1xyXG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTApKTtcclxuICAgICAgICAgICAgZXhwZWN0KHVwZGF0ZUZuKS50b0hhdmVCZWVuTnRoQ2FsbGVkV2l0aCgxLCB0cnVlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFNlY29uZCBjbGljazogdHJ1ZSAtPiBmYWxzZVxyXG4gICAgICAgICAgICBidXR0b24uY2xpY2soKTtcclxuICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDApKTtcclxuICAgICAgICAgICAgZXhwZWN0KHVwZGF0ZUZuKS50b0hhdmVCZWVuTnRoQ2FsbGVkV2l0aCgyLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBUaGlyZCBjbGljazogZmFsc2UgLT4gdHJ1ZVxyXG4gICAgICAgICAgICBidXR0b24uY2xpY2soKTtcclxuICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDApKTtcclxuICAgICAgICAgICAgZXhwZWN0KHVwZGF0ZUZuKS50b0hhdmVCZWVuTnRoQ2FsbGVkV2l0aCgzLCB0cnVlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdCh1cGRhdGVGbikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDMpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHVwZGF0ZSB2aXN1YWwgc3RhdGUgaW1tZWRpYXRlbHkgb24gY2xpY2snLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGJvb2xlYW5Qcm9wZXJ0eS5zdGF0aWMgPSBmYWxzZTtcclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlRm4gPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBib29sZWFuUHJvcGVydHkuZmlsbERpc3BsYXkobW9ja1ZhdWx0LCBmYWxzZSwgdXBkYXRlRm4pO1xyXG4gICAgICAgICAgICBjb25zdCBidXR0b24gPSBjb250YWluZXIucXVlcnlTZWxlY3Rvcignc3BhbicpIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gQmVmb3JlIGNsaWNrXHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdib29sZWFuLXByb3BlcnR5LWJ1dHRvbi1hY3RpdmUnKSkudG9CZShmYWxzZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBDbGljayBzaG91bGQgaW1tZWRpYXRlbHkgdXBkYXRlIHZpc3VhbCBzdGF0ZVxyXG4gICAgICAgICAgICBidXR0b24uY2xpY2soKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFZpc3VhbCBzdGF0ZSBzaG91bGQgdXBkYXRlIGltbWVkaWF0ZWx5LCBiZWZvcmUgYXN5bmMgb3BlcmF0aW9uIGNvbXBsZXRlc1xyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYm9vbGVhbi1wcm9wZXJ0eS1idXR0b24tYWN0aXZlJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBXYWl0IGZvciBhc3luYyBvcGVyYXRpb25cclxuICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDApKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdCh1cGRhdGVGbikudG9IYXZlQmVlbkNhbGxlZFdpdGgodHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnc3RhdGljIHByb3BlcnR5IGJlaGF2aW9yJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgbm90IGFkZCBjbGljayBsaXN0ZW5lciB3aGVuIHN0YXRpYycsICgpID0+IHtcclxuICAgICAgICAgICAgYm9vbGVhblByb3BlcnR5LnN0YXRpYyA9IHRydWU7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZUZuID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gYm9vbGVhblByb3BlcnR5LmZpbGxEaXNwbGF5KG1vY2tWYXVsdCwgZmFsc2UsIHVwZGF0ZUZuKTtcclxuICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIENsaWNrIHNob3VsZCBub3QgdHJpZ2dlciB1cGRhdGVcclxuICAgICAgICAgICAgYnV0dG9uLmNsaWNrKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QodXBkYXRlRm4pLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgc3RpbGwgc2hvdyBjb3JyZWN0IHZpc3VhbCBzdGF0ZSB3aGVuIHN0YXRpYycsICgpID0+IHtcclxuICAgICAgICAgICAgYm9vbGVhblByb3BlcnR5LnN0YXRpYyA9IHRydWU7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZUZuID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVGVzdCB0cnVlIHZhbHVlXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lclRydWUgPSBib29sZWFuUHJvcGVydHkuZmlsbERpc3BsYXkobW9ja1ZhdWx0LCB0cnVlLCB1cGRhdGVGbik7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvblRydWUgPSBjb250YWluZXJUcnVlLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKTtcclxuICAgICAgICAgICAgZXhwZWN0KGJ1dHRvblRydWU/LmNsYXNzTGlzdC5jb250YWlucygnYm9vbGVhbi1wcm9wZXJ0eS1idXR0b24tYWN0aXZlJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBUZXN0IGZhbHNlIHZhbHVlXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lckZhbHNlID0gYm9vbGVhblByb3BlcnR5LmZpbGxEaXNwbGF5KG1vY2tWYXVsdCwgZmFsc2UsIHVwZGF0ZUZuKTtcclxuICAgICAgICAgICAgY29uc3QgYnV0dG9uRmFsc2UgPSBjb250YWluZXJGYWxzZS5xdWVyeVNlbGVjdG9yKCdzcGFuJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b25GYWxzZT8uY2xhc3NMaXN0LmNvbnRhaW5zKCdib29sZWFuLXByb3BlcnR5LWJ1dHRvbi1hY3RpdmUnKSkudG9CZShmYWxzZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnaWNvbiBmdW5jdGlvbmFsaXR5JywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgc2V0IGN1c3RvbSBpY29uJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjdXN0b21Qcm9wZXJ0eSA9IG5ldyBCb29sZWFuUHJvcGVydHkoJ2N1c3RvbScsIHsgaWNvbjogJ2NoZWNrLWNpcmNsZScgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZUZuID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gY3VzdG9tUHJvcGVydHkuZmlsbERpc3BsYXkobW9ja1ZhdWx0LCB0cnVlLCB1cGRhdGVGbik7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdzcGFuJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uPy5nZXRBdHRyaWJ1dGUoJ2RhdGEtaWNvbicpKS50b0JlKCdjaGVjay1jaXJjbGUnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBjYWxsIHNldEljb24gd2l0aCBjb3JyZWN0IHBhcmFtZXRlcnMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZUZuID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gQ2xlYXIgcHJldmlvdXMgY2FsbHNcclxuICAgICAgICAgICAgc2V0SWNvbi5tb2NrQ2xlYXIoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsIHRydWUsIHVwZGF0ZUZuKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChzZXRJY29uKS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNhbGxBcmdzID0gc2V0SWNvbi5tb2NrLmNhbGxzWzBdO1xyXG4gICAgICAgICAgICBleHBlY3QoY2FsbEFyZ3NbMF0pLnRvSGF2ZVByb3BlcnR5KCd0YWdOYW1lJyk7IC8vIFNob3VsZCBiZSBhbiBlbGVtZW50LWxpa2Ugb2JqZWN0XHJcbiAgICAgICAgICAgIGV4cGVjdChjYWxsQXJnc1swXSkudG9IYXZlUHJvcGVydHkoJ2NsYXNzTGlzdCcpOyAvLyBTaG91bGQgaGF2ZSBET00tbGlrZSBpbnRlcmZhY2VcclxuICAgICAgICAgICAgZXhwZWN0KGNhbGxBcmdzWzFdKS50b0JlKCdhbGlnbi1sZWZ0Jyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnaW50ZWdyYXRpb24gd2l0aCBiYXNlIFByb3BlcnR5IGNsYXNzJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgaW5oZXJpdCBmcm9tIFByb3BlcnR5IGNsYXNzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QoYm9vbGVhblByb3BlcnR5KS50b0JlSW5zdGFuY2VPZihCb29sZWFuUHJvcGVydHkpO1xyXG4gICAgICAgICAgICBleHBlY3QoYm9vbGVhblByb3BlcnR5Lm5hbWUpLnRvQmUoJ2lzQWN0aXZlJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChib29sZWFuUHJvcGVydHkudHlwZSkudG9CZSgnYm9vbGVhbicpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhdmUgYWNjZXNzIHRvIGJhc2UgY2xhc3MgcHJvcGVydGllcycsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KHR5cGVvZiBib29sZWFuUHJvcGVydHkucmVhZCkudG9CZSgnZnVuY3Rpb24nKTtcclxuICAgICAgICAgICAgZXhwZWN0KHR5cGVvZiBib29sZWFuUHJvcGVydHkudmFsaWRhdGUpLnRvQmUoJ2Z1bmN0aW9uJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0eXBlb2YgYm9vbGVhblByb3BlcnR5LmdldFByZXR0eSkudG9CZSgnZnVuY3Rpb24nKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnZWRnZSBjYXNlcyBhbmQgZXJyb3IgaGFuZGxpbmcnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgbnVsbCB1cGRhdGUgZnVuY3Rpb24gZ3JhY2VmdWxseScsICgpID0+IHtcclxuICAgICAgICAgICAgYm9vbGVhblByb3BlcnR5LnN0YXRpYyA9IGZhbHNlO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gU2hvdWxkIG5vdCB0aHJvdyBlcnJvciB3aXRoIG51bGwgdXBkYXRlIGZ1bmN0aW9uXHJcbiAgICAgICAgICAgIGV4cGVjdCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBib29sZWFuUHJvcGVydHkuZmlsbERpc3BsYXkobW9ja1ZhdWx0LCB0cnVlLCBudWxsIGFzIGFueSk7XHJcbiAgICAgICAgICAgIH0pLm5vdC50b1Rocm93KCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIHVuZGVmaW5lZCB2YWx1ZScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlRm4gPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsIHVuZGVmaW5lZCwgdXBkYXRlRm4pO1xyXG4gICAgICAgICAgICBjb25zdCBidXR0b24gPSBjb250YWluZXIucXVlcnlTZWxlY3Rvcignc3BhbicpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGJ1dHRvbj8uY2xhc3NMaXN0LmNvbnRhaW5zKCdib29sZWFuLXByb3BlcnR5LWJ1dHRvbi1hY3RpdmUnKSkudG9CZShmYWxzZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIHN0cmluZyBib29sZWFuIHZhbHVlcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlRm4gPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBUZXN0IHRydXRoeSBzdHJpbmdzXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lclRydXRoeSA9IGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsICd0cnVlJywgdXBkYXRlRm4pO1xyXG4gICAgICAgICAgICBjb25zdCBidXR0b25UcnV0aHkgPSBjb250YWluZXJUcnV0aHkucXVlcnlTZWxlY3Rvcignc3BhbicpO1xyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uVHJ1dGh5Py5jbGFzc0xpc3QuY29udGFpbnMoJ2Jvb2xlYW4tcHJvcGVydHktYnV0dG9uLWFjdGl2ZScpKS50b0JlKHRydWUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVGVzdCBlbXB0eSBzdHJpbmcgKGZhbHN5KVxyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXJGYWxzeSA9IGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsICcnLCB1cGRhdGVGbik7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbkZhbHN5ID0gY29udGFpbmVyRmFsc3kucXVlcnlTZWxlY3Rvcignc3BhbicpO1xyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uRmFsc3k/LmNsYXNzTGlzdC5jb250YWlucygnYm9vbGVhbi1wcm9wZXJ0eS1idXR0b24tYWN0aXZlJykpLnRvQmUoZmFsc2UpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSByYXBpZCBzdWNjZXNzaXZlIGNsaWNrcycsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgYm9vbGVhblByb3BlcnR5LnN0YXRpYyA9IGZhbHNlO1xyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVGbiA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsIGZhbHNlLCB1cGRhdGVGbik7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdzcGFuJykgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBSYXBpZCBjbGlja3NcclxuICAgICAgICAgICAgYnV0dG9uLmNsaWNrKCk7XHJcbiAgICAgICAgICAgIGJ1dHRvbi5jbGljaygpO1xyXG4gICAgICAgICAgICBidXR0b24uY2xpY2soKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFdhaXQgZm9yIGFsbCBhc3luYyBvcGVyYXRpb25zXHJcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMCkpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHVwZGF0ZUZuKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMyk7XHJcbiAgICAgICAgICAgIC8vIEZpbmFsIHN0YXRlIHNob3VsZCBiZSB0cnVlIChmYWxzZSAtPiB0cnVlIC0+IGZhbHNlIC0+IHRydWUpXHJcbiAgICAgICAgICAgIGV4cGVjdCh1cGRhdGVGbikudG9IYXZlQmVlbkxhc3RDYWxsZWRXaXRoKHRydWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ0NTUyBjbGFzcyBtYW5hZ2VtZW50JywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgcHJvcGVybHkgYWRkIGFuZCByZW1vdmUgYWN0aXZlIGNsYXNzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBib29sZWFuUHJvcGVydHkuc3RhdGljID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZUZuID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gU3RhcnQgd2l0aCBmYWxzZVxyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBib29sZWFuUHJvcGVydHkuZmlsbERpc3BsYXkobW9ja1ZhdWx0LCBmYWxzZSwgdXBkYXRlRm4pO1xyXG4gICAgICAgICAgICBjb25zdCBidXR0b24gPSBjb250YWluZXIucXVlcnlTZWxlY3Rvcignc3BhbicpIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gU2hvdWxkIG5vdCBoYXZlIGFjdGl2ZSBjbGFzcyBpbml0aWFsbHlcclxuICAgICAgICAgICAgZXhwZWN0KGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2Jvb2xlYW4tcHJvcGVydHktYnV0dG9uLWFjdGl2ZScpKS50b0JlKGZhbHNlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIENsaWNrIHRvIGFjdGl2YXRlXHJcbiAgICAgICAgICAgIGJ1dHRvbi5jbGljaygpO1xyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYm9vbGVhbi1wcm9wZXJ0eS1idXR0b24tYWN0aXZlJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBDbGljayB0byBkZWFjdGl2YXRlXHJcbiAgICAgICAgICAgIGJ1dHRvbi5jbGljaygpO1xyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYm9vbGVhbi1wcm9wZXJ0eS1idXR0b24tYWN0aXZlJykpLnRvQmUoZmFsc2UpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIG5vdCBpbnRlcmZlcmUgd2l0aCBvdGhlciBDU1MgY2xhc3NlcycsICgpID0+IHtcclxuICAgICAgICAgICAgYm9vbGVhblByb3BlcnR5LnN0YXRpYyA9IGZhbHNlO1xyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVGbiA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGJvb2xlYW5Qcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsIHRydWUsIHVwZGF0ZUZuKTtcclxuICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEFkZCBzb21lIG90aGVyIGNsYXNzZXNcclxuICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2N1c3RvbS1jbGFzcycsICdhbm90aGVyLWNsYXNzJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBWZXJpZnkgYWN0aXZlIGNsYXNzIGlzIGFkZGVkIGNvcnJlY3RseVxyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYm9vbGVhbi1wcm9wZXJ0eS1idXR0b24tYWN0aXZlJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdjdXN0b20tY2xhc3MnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICAgICAgZXhwZWN0KGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2Fub3RoZXItY2xhc3MnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFRvZ2dsZSBhbmQgdmVyaWZ5IG90aGVyIGNsYXNzZXMgcmVtYWluXHJcbiAgICAgICAgICAgIGlmICghYm9vbGVhblByb3BlcnR5LnN0YXRpYykge1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uLmNsaWNrKCk7XHJcbiAgICAgICAgICAgICAgICBleHBlY3QoYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnY3VzdG9tLWNsYXNzJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBleHBlY3QoYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYW5vdGhlci1jbGFzcycpKS50b0JlKHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufSk7Il0sInZlcnNpb24iOjN9