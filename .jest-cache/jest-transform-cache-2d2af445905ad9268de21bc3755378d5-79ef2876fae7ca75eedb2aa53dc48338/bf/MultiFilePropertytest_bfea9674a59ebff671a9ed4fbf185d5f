04176600bc27a22ca80d89d0dd7803fd
"use strict";
/**
 * @jest-environment jsdom
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock the vault utilities
jest.mock('../../vault/Utils', () => ({
    selectMultipleFile: jest.fn(),
    setIcon: jest.fn()
}));
// Mock the related classes
jest.mock('../../properties/FileProperty');
jest.mock('../../vault/File');
jest.mock('../../vault/MyVault');
const FileProperty_1 = require("../../properties/FileProperty");
const MultiFileProperty_1 = require("../../properties/MultiFileProperty");
// Import the mocked functions
const { selectMultipleFile, setIcon } = jest.requireMock('../../vault/Utils');
describe('MultiFileProperty', () => {
    let multiFileProperty;
    let mockVault;
    let mockFileProperty;
    let mockFile;
    let mockUpdate;
    beforeEach(() => {
        // Reset DOM
        document.body.innerHTML = '';
        // Reset all mocks
        jest.clearAllMocks();
        // Mock DOM methods that need to be tracked - we'll spy on individual instances instead
        // Setup mocks
        mockVault = {
            readFile: jest.fn(),
            getFiles: jest.fn()
        };
        mockFile = {
            getLink: jest.fn().mockReturnValue('[[TestFile]]'),
            path: 'TestFile.md'
        };
        mockFileProperty = {
            fillDisplay: jest.fn().mockReturnValue(document.createElement('div')),
            getParentValue: jest.fn(),
            name: 'testFile'
        };
        mockUpdate = jest.fn();
        // Mock FileProperty constructor
        FileProperty_1.FileProperty.mockImplementation(() => mockFileProperty);
        // Reset selectMultipleFile to return empty array by default
        selectMultipleFile.mockResolvedValue([]);
    });
    describe('Constructor', () => {
        test('should create MultiFileProperty with required parameters', () => {
            const classes = ['Document', 'Image'];
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', classes);
            expect(multiFileProperty.name).toBe('testFiles');
            expect(multiFileProperty.type).toBe('multiFile');
            expect(multiFileProperty.classes).toEqual(classes);
            expect(multiFileProperty.flexSpan).toBe(2);
            expect(multiFileProperty.property).toBe(mockFileProperty);
        });
        test('should create FileProperty instance in constructor', () => {
            const classes = ['Document'];
            const args = { icon: 'file' };
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', classes, args);
            expect(FileProperty_1.FileProperty).toHaveBeenCalledWith('testFiles', classes, args);
        });
        test('should handle empty classes array', () => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', []);
            expect(multiFileProperty.classes).toEqual([]);
            expect(multiFileProperty.getClasses()).toEqual([]);
        });
    });
    describe('getClasses', () => {
        test('should return classes array', () => {
            const classes = ['Document', 'Image', 'Video'];
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', classes);
            expect(multiFileProperty.getClasses()).toEqual(classes);
        });
    });
    describe('getParentValue', () => {
        test('should delegate to FileProperty getParentValue', () => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', ['Document']);
            const testValues = { test: 'value' };
            const expectedResult = mockFile;
            mockFileProperty.getParentValue.mockReturnValue(expectedResult);
            const result = multiFileProperty.getParentValue(testValues);
            expect(mockFileProperty.getParentValue).toHaveBeenCalledWith(testValues);
            expect(result).toBe(expectedResult);
        });
        test('should return undefined when FileProperty returns undefined', () => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', ['Document']);
            const testValues = { test: 'value' };
            mockFileProperty.getParentValue.mockReturnValue(undefined);
            const result = multiFileProperty.getParentValue(testValues);
            expect(result).toBeUndefined();
        });
    });
    describe('formatParentValue', () => {
        test('should wrap single value in array', () => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', ['Document']);
            const result = multiFileProperty.formatParentValue('test-value');
            expect(result).toEqual(['test-value']);
        });
        test('should handle empty string', () => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', ['Document']);
            const result = multiFileProperty.formatParentValue('');
            expect(result).toEqual(['']);
        });
    });
    describe('fillDisplay', () => {
        beforeEach(() => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', ['Document']);
        });
        test('should create container with correct classes', () => {
            const values = [];
            const container = multiFileProperty.fillDisplay(mockVault, values, mockUpdate);
            expect(container.classList.contains('metadata-multiFiles-container-testfiles')).toBe(true);
            expect(container.classList.contains('metadata-multiFiles-container')).toBe(true);
        });
        test('should set vault property', () => {
            const values = [];
            multiFileProperty.fillDisplay(mockVault, values, mockUpdate);
            expect(multiFileProperty.vault).toBe(mockVault);
        });
        test('should create add button', () => {
            const values = [];
            const container = multiFileProperty.fillDisplay(mockVault, values, mockUpdate);
            // Test that a button with the add button class was created
            expect(container.querySelector('button.metadata-add-button-inline-small')).not.toBeNull();
        });
        test('should handle null values', () => {
            const container = multiFileProperty.fillDisplay(mockVault, null, mockUpdate);
            expect(container).toBeDefined();
            expect(container.tagName).toBe('DIV');
        });
    });
    describe('createObjects', () => {
        beforeEach(() => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', ['Document']);
        });
        test('should handle null values', () => {
            const container = document.createElement('div');
            // Should not throw
            multiFileProperty.createObjects(null, mockUpdate, container);
            multiFileProperty.createObjects(undefined, mockUpdate, container);
            // No children should have been added for null/undefined values
            expect(container.children.length).toBe(0);
        });
        test('should create rows for each value', () => {
            const container = document.createElement('div');
            const values = ['[[File1]]', '[[File2]]', '[[File3]]'];
            multiFileProperty.createObjects(values, mockUpdate, container);
            // Should have created 3 row elements
            expect(container.children.length).toBe(3);
        });
        test('should handle empty array', () => {
            const container = document.createElement('div');
            const values = [];
            multiFileProperty.createObjects(values, mockUpdate, container);
            // Empty array should not add any children
            expect(container.children.length).toBe(0);
        });
    });
    describe('createObjectRow', () => {
        beforeEach(() => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', ['Document']);
            multiFileProperty.vault = mockVault;
        });
        test('should create row with correct class', () => {
            const container = document.createElement('div');
            const values = ['[[File1]]'];
            const row = multiFileProperty.createObjectRow(values, mockUpdate, '[[File1]]', 0, container);
            expect(row.classList.contains('metadata-multiFiles-row-inline')).toBe(true);
        });
        test('should create delete button', () => {
            const container = document.createElement('div');
            const values = ['[[File1]]'];
            const row = multiFileProperty.createObjectRow(values, mockUpdate, '[[File1]]', 0, container);
            // Should have 2 children: delete button + property container
            expect(row.children.length).toBe(2);
            expect(row.querySelector('button.metadata-delete-button-inline-small')).not.toBeNull();
        });
        test('should create property container', () => {
            const container = document.createElement('div');
            const values = ['[[File1]]'];
            const row = multiFileProperty.createObjectRow(values, mockUpdate, '[[File1]]', 0, container);
            expect(mockFileProperty.fillDisplay).toHaveBeenCalledWith(mockVault, '[[File1]]', expect.any(Function));
        });
    });
    describe('createDeleteButton', () => {
        beforeEach(() => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', ['Document']);
        });
        test('should create button with correct classes and icon', () => {
            const container = document.createElement('div');
            const values = ['[[File1]]'];
            const button = multiFileProperty.createDeleteButton(values, mockUpdate, 0, container);
            expect(setIcon).toHaveBeenCalledWith(button, 'minus');
            expect(button.classList.contains('metadata-delete-button-inline-small')).toBe(true);
        });
        test('should have onclick handler', () => {
            const container = document.createElement('div');
            const values = ['[[File1]]'];
            const button = multiFileProperty.createDeleteButton(values, mockUpdate, 0, container);
            expect(button.onclick).toBeDefined();
            expect(typeof button.onclick).toBe('function');
        });
    });
    describe('createAddButton', () => {
        beforeEach(() => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', ['Document']);
        });
        test('should create button with correct classes and icon', () => {
            const container = document.createElement('div');
            const values = [];
            const button = multiFileProperty.createAddButton(values, mockUpdate, container);
            expect(setIcon).toHaveBeenCalledWith(button, 'plus');
            expect(button.classList.contains('metadata-add-button-inline-small')).toBe(true);
        });
        test('should have onclick handler', () => {
            const container = document.createElement('div');
            const values = [];
            const button = multiFileProperty.createAddButton(values, mockUpdate, container);
            expect(button.onclick).toBeDefined();
            expect(typeof button.onclick).toBe('function');
        });
    });
    describe('addProperty', () => {
        beforeEach(() => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', ['Document', 'Image']);
            multiFileProperty.vault = mockVault;
            // Mock reloadObjects method
            multiFileProperty.reloadObjects = jest.fn();
        });
        test('should call selectMultipleFile with correct parameters', async () => {
            const container = document.createElement('div');
            const values = [];
            await multiFileProperty.addProperty(values, mockUpdate, container);
            expect(selectMultipleFile).toHaveBeenCalledWith(mockVault, ['Document', 'Image'], { hint: 'Choisissez des fichiers Document ou Image' });
        });
        test('should add files to values when files are selected', async () => {
            const container = document.createElement('div');
            const values = [];
            const mockFiles = [
                { getLink: () => '[[File1]]' },
                { getLink: () => '[[File2]]' }
            ];
            selectMultipleFile.mockResolvedValue(mockFiles);
            await multiFileProperty.addProperty(values, mockUpdate, container);
            expect(values).toEqual(['[[File1]]', '[[File2]]']);
            expect(mockUpdate).toHaveBeenCalledWith(['[[File1]]', '[[File2]]']);
        });
        test('should initialize values array if null', async () => {
            const container = document.createElement('div');
            let values = null;
            const mockFiles = [{ getLink: () => '[[File1]]' }];
            selectMultipleFile.mockResolvedValue(mockFiles);
            await multiFileProperty.addProperty(values, mockUpdate, container);
            expect(mockUpdate).toHaveBeenCalledWith(['[[File1]]']);
        });
        test('should handle no files selected', async () => {
            const container = document.createElement('div');
            const values = [];
            selectMultipleFile.mockResolvedValue(null);
            await multiFileProperty.addProperty(values, mockUpdate, container);
            expect(mockUpdate).not.toHaveBeenCalled();
        });
        test('should handle empty files array', async () => {
            const container = document.createElement('div');
            const values = [];
            selectMultipleFile.mockResolvedValue([]);
            await multiFileProperty.addProperty(values, mockUpdate, container);
            expect(mockUpdate).not.toHaveBeenCalled();
        });
        test('should call reloadObjects when files are added', async () => {
            const container = document.createElement('div');
            const values = [];
            const mockFiles = [{ getLink: () => '[[File1]]' }];
            selectMultipleFile.mockResolvedValue(mockFiles);
            await multiFileProperty.addProperty(values, mockUpdate, container);
            expect(multiFileProperty.reloadObjects).toHaveBeenCalledWith(values, mockUpdate);
        });
    });
    describe('enableDragAndDrop', () => {
        test('should exist and be callable', () => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', ['Document']);
            expect(() => multiFileProperty.enableDragAndDrop()).not.toThrow();
        });
    });
    describe('Integration', () => {
        test('should work with multiple classes in hint', () => {
            const classes = ['Document', 'Image', 'Video'];
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', classes);
            expect(multiFileProperty.getClasses().join(' ou ')).toBe('Document ou Image ou Video');
        });
        test('should handle single class in hint', () => {
            const classes = ['Document'];
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', classes);
            expect(multiFileProperty.getClasses().join(' ou ')).toBe('Document');
        });
        test('should maintain proper inheritance from ObjectProperty', () => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', ['Document']);
            expect(multiFileProperty.type).toBe('multiFile');
            expect(typeof multiFileProperty.fillDisplay).toBe('function');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxzcmNcXF9fdGVzdHNfX1xcUHJvcGVydGllc1xcTXVsdGlGaWxlUHJvcGVydHkudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7O0dBRUc7O0FBT0gsMkJBQTJCO0FBQzNCLElBQUksQ0FBQyxJQUFJLENBQUMsbUJBQW1CLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNsQyxrQkFBa0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQzdCLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0NBQ3JCLENBQUMsQ0FBQyxDQUFDO0FBRUosMkJBQTJCO0FBQzNCLElBQUksQ0FBQyxJQUFJLENBQUMsK0JBQStCLENBQUMsQ0FBQztBQUMzQyxJQUFJLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUM7QUFDOUIsSUFBSSxDQUFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO0FBWmpDLGdFQUE2RDtBQUM3RCwwRUFBdUU7QUFhdkUsOEJBQThCO0FBQzlCLE1BQU0sRUFBRSxrQkFBa0IsRUFBRSxPQUFPLEVBQUUsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLG1CQUFtQixDQUFDLENBQUM7QUFFOUUsUUFBUSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRTtJQUMvQixJQUFJLGlCQUFvQyxDQUFDO0lBQ3pDLElBQUksU0FBK0IsQ0FBQztJQUNwQyxJQUFJLGdCQUEyQyxDQUFDO0lBQ2hELElBQUksUUFBMkIsQ0FBQztJQUNoQyxJQUFJLFVBQXFCLENBQUM7SUFFMUIsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNaLFlBQVk7UUFDWixRQUFRLENBQUMsSUFBSSxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUM7UUFDN0Isa0JBQWtCO1FBQ2xCLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztR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VUFBVSxDQUFDLENBQUMsQ0FBQztZQUVyRSxNQUFNLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQ2pELE1BQU0sQ0FBQyxPQUFPLGlCQUFpQixDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNsRSxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxzcmNcXF9fdGVzdHNfX1xcUHJvcGVydGllc1xcTXVsdGlGaWxlUHJvcGVydHkudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQGplc3QtZW52aXJvbm1lbnQganNkb21cclxuICovXHJcblxyXG5pbXBvcnQgeyBGaWxlIH0gZnJvbSAnLi4vLi4vdmF1bHQvRmlsZSc7XHJcbmltcG9ydCB7IE15VmF1bHQgfSBmcm9tICcuLi8uLi92YXVsdC9NeVZhdWx0JztcclxuaW1wb3J0IHsgRmlsZVByb3BlcnR5IH0gZnJvbSAnLi4vLi4vcHJvcGVydGllcy9GaWxlUHJvcGVydHknO1xyXG5pbXBvcnQgeyBNdWx0aUZpbGVQcm9wZXJ0eSB9IGZyb20gJy4uLy4uL3Byb3BlcnRpZXMvTXVsdGlGaWxlUHJvcGVydHknO1xyXG5cclxuLy8gTW9jayB0aGUgdmF1bHQgdXRpbGl0aWVzXHJcbmplc3QubW9jaygnLi4vLi4vdmF1bHQvVXRpbHMnLCAoKSA9PiAoe1xyXG4gICAgc2VsZWN0TXVsdGlwbGVGaWxlOiBqZXN0LmZuKCksXHJcbiAgICBzZXRJY29uOiBqZXN0LmZuKClcclxufSkpO1xyXG5cclxuLy8gTW9jayB0aGUgcmVsYXRlZCBjbGFzc2VzXHJcbmplc3QubW9jaygnLi4vLi4vcHJvcGVydGllcy9GaWxlUHJvcGVydHknKTtcclxuamVzdC5tb2NrKCcuLi8uLi92YXVsdC9GaWxlJyk7XHJcbmplc3QubW9jaygnLi4vLi4vdmF1bHQvTXlWYXVsdCcpO1xyXG5cclxuLy8gSW1wb3J0IHRoZSBtb2NrZWQgZnVuY3Rpb25zXHJcbmNvbnN0IHsgc2VsZWN0TXVsdGlwbGVGaWxlLCBzZXRJY29uIH0gPSBqZXN0LnJlcXVpcmVNb2NrKCcuLi8uLi92YXVsdC9VdGlscycpO1xyXG5cclxuZGVzY3JpYmUoJ011bHRpRmlsZVByb3BlcnR5JywgKCkgPT4ge1xyXG4gICAgbGV0IG11bHRpRmlsZVByb3BlcnR5OiBNdWx0aUZpbGVQcm9wZXJ0eTtcclxuICAgIGxldCBtb2NrVmF1bHQ6IGplc3QuTW9ja2VkPE15VmF1bHQ+O1xyXG4gICAgbGV0IG1vY2tGaWxlUHJvcGVydHk6IGplc3QuTW9ja2VkPEZpbGVQcm9wZXJ0eT47XHJcbiAgICBsZXQgbW9ja0ZpbGU6IGplc3QuTW9ja2VkPEZpbGU+O1xyXG4gICAgbGV0IG1vY2tVcGRhdGU6IGplc3QuTW9jaztcclxuXHJcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICAvLyBSZXNldCBET01cclxuICAgICAgICBkb2N1bWVudC5ib2R5LmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgIC8vIFJlc2V0IGFsbCBtb2Nrc1xyXG4gICAgICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIE1vY2sgRE9NIG1ldGhvZHMgdGhhdCBuZWVkIHRvIGJlIHRyYWNrZWQgLSB3ZSdsbCBzcHkgb24gaW5kaXZpZHVhbCBpbnN0YW5jZXMgaW5zdGVhZFxyXG5cclxuICAgICAgICAvLyBTZXR1cCBtb2Nrc1xyXG4gICAgICAgIG1vY2tWYXVsdCA9IHtcclxuICAgICAgICAgICAgcmVhZEZpbGU6IGplc3QuZm4oKSxcclxuICAgICAgICAgICAgZ2V0RmlsZXM6IGplc3QuZm4oKVxyXG4gICAgICAgIH0gYXMgYW55O1xyXG5cclxuICAgICAgICBtb2NrRmlsZSA9IHtcclxuICAgICAgICAgICAgZ2V0TGluazogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnW1tUZXN0RmlsZV1dJyksXHJcbiAgICAgICAgICAgIHBhdGg6ICdUZXN0RmlsZS5tZCdcclxuICAgICAgICB9IGFzIGFueTtcclxuXHJcbiAgICAgICAgbW9ja0ZpbGVQcm9wZXJ0eSA9IHtcclxuICAgICAgICAgICAgZmlsbERpc3BsYXk6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JykpLFxyXG4gICAgICAgICAgICBnZXRQYXJlbnRWYWx1ZTogamVzdC5mbigpLFxyXG4gICAgICAgICAgICBuYW1lOiAndGVzdEZpbGUnXHJcbiAgICAgICAgfSBhcyBhbnk7XHJcblxyXG4gICAgICAgIG1vY2tVcGRhdGUgPSBqZXN0LmZuKCk7XHJcblxyXG4gICAgICAgIC8vIE1vY2sgRmlsZVByb3BlcnR5IGNvbnN0cnVjdG9yXHJcbiAgICAgICAgKEZpbGVQcm9wZXJ0eSBhcyBqZXN0Lk1vY2tlZENsYXNzPHR5cGVvZiBGaWxlUHJvcGVydHk+KS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gbW9ja0ZpbGVQcm9wZXJ0eSk7XHJcblxyXG4gICAgICAgIC8vIFJlc2V0IHNlbGVjdE11bHRpcGxlRmlsZSB0byByZXR1cm4gZW1wdHkgYXJyYXkgYnkgZGVmYXVsdFxyXG4gICAgICAgIHNlbGVjdE11bHRpcGxlRmlsZS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnQ29uc3RydWN0b3InLCAoKSA9PiB7XHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGNyZWF0ZSBNdWx0aUZpbGVQcm9wZXJ0eSB3aXRoIHJlcXVpcmVkIHBhcmFtZXRlcnMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNsYXNzZXMgPSBbJ0RvY3VtZW50JywgJ0ltYWdlJ107XHJcbiAgICAgICAgICAgIG11bHRpRmlsZVByb3BlcnR5ID0gbmV3IE11bHRpRmlsZVByb3BlcnR5KCd0ZXN0RmlsZXMnLCBjbGFzc2VzKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtdWx0aUZpbGVQcm9wZXJ0eS5uYW1lKS50b0JlKCd0ZXN0RmlsZXMnKTtcclxuICAgICAgICAgICAgZXhwZWN0KG11bHRpRmlsZVByb3BlcnR5LnR5cGUpLnRvQmUoJ211bHRpRmlsZScpO1xyXG4gICAgICAgICAgICBleHBlY3QobXVsdGlGaWxlUHJvcGVydHkuY2xhc3NlcykudG9FcXVhbChjbGFzc2VzKTtcclxuICAgICAgICAgICAgZXhwZWN0KG11bHRpRmlsZVByb3BlcnR5LmZsZXhTcGFuKS50b0JlKDIpO1xyXG4gICAgICAgICAgICBleHBlY3QobXVsdGlGaWxlUHJvcGVydHkucHJvcGVydHkpLnRvQmUobW9ja0ZpbGVQcm9wZXJ0eSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBjcmVhdGUgRmlsZVByb3BlcnR5IGluc3RhbmNlIGluIGNvbnN0cnVjdG9yJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjbGFzc2VzID0gWydEb2N1bWVudCddO1xyXG4gICAgICAgICAgICBjb25zdCBhcmdzID0geyBpY29uOiAnZmlsZScgfTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIG11bHRpRmlsZVByb3BlcnR5ID0gbmV3IE11bHRpRmlsZVByb3BlcnR5KCd0ZXN0RmlsZXMnLCBjbGFzc2VzLCBhcmdzKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChGaWxlUHJvcGVydHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCd0ZXN0RmlsZXMnLCBjbGFzc2VzLCBhcmdzKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBjbGFzc2VzIGFycmF5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBtdWx0aUZpbGVQcm9wZXJ0eSA9IG5ldyBNdWx0aUZpbGVQcm9wZXJ0eSgndGVzdEZpbGVzJywgW10pO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG11bHRpRmlsZVByb3BlcnR5LmNsYXNzZXMpLnRvRXF1YWwoW10pO1xyXG4gICAgICAgICAgICBleHBlY3QobXVsdGlGaWxlUHJvcGVydHkuZ2V0Q2xhc3NlcygpKS50b0VxdWFsKFtdKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdnZXRDbGFzc2VzJywgKCkgPT4ge1xyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCByZXR1cm4gY2xhc3NlcyBhcnJheScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY2xhc3NlcyA9IFsnRG9jdW1lbnQnLCAnSW1hZ2UnLCAnVmlkZW8nXTtcclxuICAgICAgICAgICAgbXVsdGlGaWxlUHJvcGVydHkgPSBuZXcgTXVsdGlGaWxlUHJvcGVydHkoJ3Rlc3RGaWxlcycsIGNsYXNzZXMpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG11bHRpRmlsZVByb3BlcnR5LmdldENsYXNzZXMoKSkudG9FcXVhbChjbGFzc2VzKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdnZXRQYXJlbnRWYWx1ZScsICgpID0+IHtcclxuICAgICAgICB0ZXN0KCdzaG91bGQgZGVsZWdhdGUgdG8gRmlsZVByb3BlcnR5IGdldFBhcmVudFZhbHVlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBtdWx0aUZpbGVQcm9wZXJ0eSA9IG5ldyBNdWx0aUZpbGVQcm9wZXJ0eSgndGVzdEZpbGVzJywgWydEb2N1bWVudCddKTtcclxuICAgICAgICAgICAgY29uc3QgdGVzdFZhbHVlcyA9IHsgdGVzdDogJ3ZhbHVlJyB9O1xyXG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZFJlc3VsdCA9IG1vY2tGaWxlO1xyXG5cclxuICAgICAgICAgICAgbW9ja0ZpbGVQcm9wZXJ0eS5nZXRQYXJlbnRWYWx1ZS5tb2NrUmV0dXJuVmFsdWUoZXhwZWN0ZWRSZXN1bHQpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gbXVsdGlGaWxlUHJvcGVydHkuZ2V0UGFyZW50VmFsdWUodGVzdFZhbHVlcyk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja0ZpbGVQcm9wZXJ0eS5nZXRQYXJlbnRWYWx1ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgodGVzdFZhbHVlcyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoZXhwZWN0ZWRSZXN1bHQpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgcmV0dXJuIHVuZGVmaW5lZCB3aGVuIEZpbGVQcm9wZXJ0eSByZXR1cm5zIHVuZGVmaW5lZCcsICgpID0+IHtcclxuICAgICAgICAgICAgbXVsdGlGaWxlUHJvcGVydHkgPSBuZXcgTXVsdGlGaWxlUHJvcGVydHkoJ3Rlc3RGaWxlcycsIFsnRG9jdW1lbnQnXSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRlc3RWYWx1ZXMgPSB7IHRlc3Q6ICd2YWx1ZScgfTtcclxuXHJcbiAgICAgICAgICAgIG1vY2tGaWxlUHJvcGVydHkuZ2V0UGFyZW50VmFsdWUubW9ja1JldHVyblZhbHVlKHVuZGVmaW5lZCk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBtdWx0aUZpbGVQcm9wZXJ0eS5nZXRQYXJlbnRWYWx1ZSh0ZXN0VmFsdWVzKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVVbmRlZmluZWQoKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdmb3JtYXRQYXJlbnRWYWx1ZScsICgpID0+IHtcclxuICAgICAgICB0ZXN0KCdzaG91bGQgd3JhcCBzaW5nbGUgdmFsdWUgaW4gYXJyYXknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIG11bHRpRmlsZVByb3BlcnR5ID0gbmV3IE11bHRpRmlsZVByb3BlcnR5KCd0ZXN0RmlsZXMnLCBbJ0RvY3VtZW50J10pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gbXVsdGlGaWxlUHJvcGVydHkuZm9ybWF0UGFyZW50VmFsdWUoJ3Rlc3QtdmFsdWUnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoWyd0ZXN0LXZhbHVlJ10pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIGVtcHR5IHN0cmluZycsICgpID0+IHtcclxuICAgICAgICAgICAgbXVsdGlGaWxlUHJvcGVydHkgPSBuZXcgTXVsdGlGaWxlUHJvcGVydHkoJ3Rlc3RGaWxlcycsIFsnRG9jdW1lbnQnXSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBtdWx0aUZpbGVQcm9wZXJ0eS5mb3JtYXRQYXJlbnRWYWx1ZSgnJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKFsnJ10pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2ZpbGxEaXNwbGF5JywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICBtdWx0aUZpbGVQcm9wZXJ0eSA9IG5ldyBNdWx0aUZpbGVQcm9wZXJ0eSgndGVzdEZpbGVzJywgWydEb2N1bWVudCddKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGNyZWF0ZSBjb250YWluZXIgd2l0aCBjb3JyZWN0IGNsYXNzZXMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlczogYW55W10gPSBbXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IG11bHRpRmlsZVByb3BlcnR5LmZpbGxEaXNwbGF5KG1vY2tWYXVsdCwgdmFsdWVzLCBtb2NrVXBkYXRlKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChjb250YWluZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdtZXRhZGF0YS1tdWx0aUZpbGVzLWNvbnRhaW5lci10ZXN0ZmlsZXMnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci5jbGFzc0xpc3QuY29udGFpbnMoJ21ldGFkYXRhLW11bHRpRmlsZXMtY29udGFpbmVyJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBzZXQgdmF1bHQgcHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlczogYW55W10gPSBbXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIG11bHRpRmlsZVByb3BlcnR5LmZpbGxEaXNwbGF5KG1vY2tWYXVsdCwgdmFsdWVzLCBtb2NrVXBkYXRlKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtdWx0aUZpbGVQcm9wZXJ0eS52YXVsdCkudG9CZShtb2NrVmF1bHQpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgY3JlYXRlIGFkZCBidXR0b24nLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlczogYW55W10gPSBbXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IG11bHRpRmlsZVByb3BlcnR5LmZpbGxEaXNwbGF5KG1vY2tWYXVsdCwgdmFsdWVzLCBtb2NrVXBkYXRlKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFRlc3QgdGhhdCBhIGJ1dHRvbiB3aXRoIHRoZSBhZGQgYnV0dG9uIGNsYXNzIHdhcyBjcmVhdGVkXHJcbiAgICAgICAgICAgIGV4cGVjdChjb250YWluZXIucXVlcnlTZWxlY3RvcignYnV0dG9uLm1ldGFkYXRhLWFkZC1idXR0b24taW5saW5lLXNtYWxsJykpLm5vdC50b0JlTnVsbCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIG51bGwgdmFsdWVzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBtdWx0aUZpbGVQcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsIG51bGwsIG1vY2tVcGRhdGUpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lcikudG9CZURlZmluZWQoKTtcclxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci50YWdOYW1lKS50b0JlKCdESVYnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdjcmVhdGVPYmplY3RzJywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICBtdWx0aUZpbGVQcm9wZXJ0eSA9IG5ldyBNdWx0aUZpbGVQcm9wZXJ0eSgndGVzdEZpbGVzJywgWydEb2N1bWVudCddKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBudWxsIHZhbHVlcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBTaG91bGQgbm90IHRocm93XHJcbiAgICAgICAgICAgIG11bHRpRmlsZVByb3BlcnR5LmNyZWF0ZU9iamVjdHMobnVsbCwgbW9ja1VwZGF0ZSwgY29udGFpbmVyKTtcclxuICAgICAgICAgICAgbXVsdGlGaWxlUHJvcGVydHkuY3JlYXRlT2JqZWN0cyh1bmRlZmluZWQsIG1vY2tVcGRhdGUsIGNvbnRhaW5lcik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBObyBjaGlsZHJlbiBzaG91bGQgaGF2ZSBiZWVuIGFkZGVkIGZvciBudWxsL3VuZGVmaW5lZCB2YWx1ZXNcclxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGgpLnRvQmUoMCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBjcmVhdGUgcm93cyBmb3IgZWFjaCB2YWx1ZScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlcyA9IFsnW1tGaWxlMV1dJywgJ1tbRmlsZTJdXScsICdbW0ZpbGUzXV0nXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIG11bHRpRmlsZVByb3BlcnR5LmNyZWF0ZU9iamVjdHModmFsdWVzLCBtb2NrVXBkYXRlLCBjb250YWluZXIpO1xyXG5cclxuICAgICAgICAgICAgLy8gU2hvdWxkIGhhdmUgY3JlYXRlZCAzIHJvdyBlbGVtZW50c1xyXG4gICAgICAgICAgICBleHBlY3QoY29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aCkudG9CZSgzKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBhcnJheScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlczogYW55W10gPSBbXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIG11bHRpRmlsZVByb3BlcnR5LmNyZWF0ZU9iamVjdHModmFsdWVzLCBtb2NrVXBkYXRlLCBjb250YWluZXIpO1xyXG5cclxuICAgICAgICAgICAgLy8gRW1wdHkgYXJyYXkgc2hvdWxkIG5vdCBhZGQgYW55IGNoaWxkcmVuXHJcbiAgICAgICAgICAgIGV4cGVjdChjb250YWluZXIuY2hpbGRyZW4ubGVuZ3RoKS50b0JlKDApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2NyZWF0ZU9iamVjdFJvdycsICgpID0+IHtcclxuICAgICAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICAgICAgbXVsdGlGaWxlUHJvcGVydHkgPSBuZXcgTXVsdGlGaWxlUHJvcGVydHkoJ3Rlc3RGaWxlcycsIFsnRG9jdW1lbnQnXSk7XHJcbiAgICAgICAgICAgIG11bHRpRmlsZVByb3BlcnR5LnZhdWx0ID0gbW9ja1ZhdWx0O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgY3JlYXRlIHJvdyB3aXRoIGNvcnJlY3QgY2xhc3MnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZXMgPSBbJ1tbRmlsZTFdXSddO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3Qgcm93ID0gbXVsdGlGaWxlUHJvcGVydHkuY3JlYXRlT2JqZWN0Um93KHZhbHVlcywgbW9ja1VwZGF0ZSwgJ1tbRmlsZTFdXScsIDAsIGNvbnRhaW5lcik7XHJcblxyXG4gICAgICAgICAgICBleHBlY3Qocm93LmNsYXNzTGlzdC5jb250YWlucygnbWV0YWRhdGEtbXVsdGlGaWxlcy1yb3ctaW5saW5lJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBjcmVhdGUgZGVsZXRlIGJ1dHRvbicsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlcyA9IFsnW1tGaWxlMV1dJ107XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByb3cgPSBtdWx0aUZpbGVQcm9wZXJ0eS5jcmVhdGVPYmplY3RSb3codmFsdWVzLCBtb2NrVXBkYXRlLCAnW1tGaWxlMV1dJywgMCwgY29udGFpbmVyKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFNob3VsZCBoYXZlIDIgY2hpbGRyZW46IGRlbGV0ZSBidXR0b24gKyBwcm9wZXJ0eSBjb250YWluZXJcclxuICAgICAgICAgICAgZXhwZWN0KHJvdy5jaGlsZHJlbi5sZW5ndGgpLnRvQmUoMik7XHJcbiAgICAgICAgICAgIGV4cGVjdChyb3cucXVlcnlTZWxlY3RvcignYnV0dG9uLm1ldGFkYXRhLWRlbGV0ZS1idXR0b24taW5saW5lLXNtYWxsJykpLm5vdC50b0JlTnVsbCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgY3JlYXRlIHByb3BlcnR5IGNvbnRhaW5lcicsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlcyA9IFsnW1tGaWxlMV1dJ107XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByb3cgPSBtdWx0aUZpbGVQcm9wZXJ0eS5jcmVhdGVPYmplY3RSb3codmFsdWVzLCBtb2NrVXBkYXRlLCAnW1tGaWxlMV1dJywgMCwgY29udGFpbmVyKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrRmlsZVByb3BlcnR5LmZpbGxEaXNwbGF5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcclxuICAgICAgICAgICAgICAgIG1vY2tWYXVsdCwgXHJcbiAgICAgICAgICAgICAgICAnW1tGaWxlMV1dJywgXHJcbiAgICAgICAgICAgICAgICBleHBlY3QuYW55KEZ1bmN0aW9uKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2NyZWF0ZURlbGV0ZUJ1dHRvbicsICgpID0+IHtcclxuICAgICAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICAgICAgbXVsdGlGaWxlUHJvcGVydHkgPSBuZXcgTXVsdGlGaWxlUHJvcGVydHkoJ3Rlc3RGaWxlcycsIFsnRG9jdW1lbnQnXSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBjcmVhdGUgYnV0dG9uIHdpdGggY29ycmVjdCBjbGFzc2VzIGFuZCBpY29uJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWVzID0gWydbW0ZpbGUxXV0nXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IG11bHRpRmlsZVByb3BlcnR5LmNyZWF0ZURlbGV0ZUJ1dHRvbih2YWx1ZXMsIG1vY2tVcGRhdGUsIDAsIGNvbnRhaW5lcik7XHJcblxyXG4gICAgICAgICAgICBleHBlY3Qoc2V0SWNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoYnV0dG9uLCAnbWludXMnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ21ldGFkYXRhLWRlbGV0ZS1idXR0b24taW5saW5lLXNtYWxsJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYXZlIG9uY2xpY2sgaGFuZGxlcicsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlcyA9IFsnW1tGaWxlMV1dJ107XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBidXR0b24gPSBtdWx0aUZpbGVQcm9wZXJ0eS5jcmVhdGVEZWxldGVCdXR0b24odmFsdWVzLCBtb2NrVXBkYXRlLCAwLCBjb250YWluZXIpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KGJ1dHRvbi5vbmNsaWNrKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICAgICAgICBleHBlY3QodHlwZW9mIGJ1dHRvbi5vbmNsaWNrKS50b0JlKCdmdW5jdGlvbicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2NyZWF0ZUFkZEJ1dHRvbicsICgpID0+IHtcclxuICAgICAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICAgICAgbXVsdGlGaWxlUHJvcGVydHkgPSBuZXcgTXVsdGlGaWxlUHJvcGVydHkoJ3Rlc3RGaWxlcycsIFsnRG9jdW1lbnQnXSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBjcmVhdGUgYnV0dG9uIHdpdGggY29ycmVjdCBjbGFzc2VzIGFuZCBpY29uJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWVzOiBhbnlbXSA9IFtdO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gbXVsdGlGaWxlUHJvcGVydHkuY3JlYXRlQWRkQnV0dG9uKHZhbHVlcywgbW9ja1VwZGF0ZSwgY29udGFpbmVyKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChzZXRJY29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChidXR0b24sICdwbHVzJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdtZXRhZGF0YS1hZGQtYnV0dG9uLWlubGluZS1zbWFsbCcpKS50b0JlKHRydWUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgaGF2ZSBvbmNsaWNrIGhhbmRsZXInLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZXM6IGFueVtdID0gW107XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBidXR0b24gPSBtdWx0aUZpbGVQcm9wZXJ0eS5jcmVhdGVBZGRCdXR0b24odmFsdWVzLCBtb2NrVXBkYXRlLCBjb250YWluZXIpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KGJ1dHRvbi5vbmNsaWNrKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICAgICAgICBleHBlY3QodHlwZW9mIGJ1dHRvbi5vbmNsaWNrKS50b0JlKCdmdW5jdGlvbicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2FkZFByb3BlcnR5JywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICBtdWx0aUZpbGVQcm9wZXJ0eSA9IG5ldyBNdWx0aUZpbGVQcm9wZXJ0eSgndGVzdEZpbGVzJywgWydEb2N1bWVudCcsICdJbWFnZSddKTtcclxuICAgICAgICAgICAgbXVsdGlGaWxlUHJvcGVydHkudmF1bHQgPSBtb2NrVmF1bHQ7XHJcbiAgICAgICAgICAgIC8vIE1vY2sgcmVsb2FkT2JqZWN0cyBtZXRob2RcclxuICAgICAgICAgICAgbXVsdGlGaWxlUHJvcGVydHkucmVsb2FkT2JqZWN0cyA9IGplc3QuZm4oKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGNhbGwgc2VsZWN0TXVsdGlwbGVGaWxlIHdpdGggY29ycmVjdCBwYXJhbWV0ZXJzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWVzOiBhbnlbXSA9IFtdO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgbXVsdGlGaWxlUHJvcGVydHkuYWRkUHJvcGVydHkodmFsdWVzLCBtb2NrVXBkYXRlLCBjb250YWluZXIpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KHNlbGVjdE11bHRpcGxlRmlsZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXHJcbiAgICAgICAgICAgICAgICBtb2NrVmF1bHQsXHJcbiAgICAgICAgICAgICAgICBbJ0RvY3VtZW50JywgJ0ltYWdlJ10sXHJcbiAgICAgICAgICAgICAgICB7IGhpbnQ6ICdDaG9pc2lzc2V6IGRlcyBmaWNoaWVycyBEb2N1bWVudCBvdSBJbWFnZScgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgYWRkIGZpbGVzIHRvIHZhbHVlcyB3aGVuIGZpbGVzIGFyZSBzZWxlY3RlZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlczogYW55W10gPSBbXTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja0ZpbGVzID0gW1xyXG4gICAgICAgICAgICAgICAgeyBnZXRMaW5rOiAoKSA9PiAnW1tGaWxlMV1dJyB9LFxyXG4gICAgICAgICAgICAgICAgeyBnZXRMaW5rOiAoKSA9PiAnW1tGaWxlMl1dJyB9XHJcbiAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAoc2VsZWN0TXVsdGlwbGVGaWxlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja0ZpbGVzKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGF3YWl0IG11bHRpRmlsZVByb3BlcnR5LmFkZFByb3BlcnR5KHZhbHVlcywgbW9ja1VwZGF0ZSwgY29udGFpbmVyKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdCh2YWx1ZXMpLnRvRXF1YWwoWydbW0ZpbGUxXV0nLCAnW1tGaWxlMl1dJ10pO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1VwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoWydbW0ZpbGUxXV0nLCAnW1tGaWxlMl1dJ10pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBpbml0aWFsaXplIHZhbHVlcyBhcnJheSBpZiBudWxsJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgbGV0IHZhbHVlczogYW55ID0gbnVsbDtcclxuICAgICAgICAgICAgY29uc3QgbW9ja0ZpbGVzID0gW3sgZ2V0TGluazogKCkgPT4gJ1tbRmlsZTFdXScgfV07XHJcblxyXG4gICAgICAgICAgICAoc2VsZWN0TXVsdGlwbGVGaWxlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja0ZpbGVzKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IG11bHRpRmlsZVByb3BlcnR5LmFkZFByb3BlcnR5KHZhbHVlcywgbW9ja1VwZGF0ZSwgY29udGFpbmVyKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrVXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChbJ1tbRmlsZTFdXSddKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBubyBmaWxlcyBzZWxlY3RlZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlczogYW55W10gPSBbXTtcclxuXHJcbiAgICAgICAgICAgIChzZWxlY3RNdWx0aXBsZUZpbGUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IG11bHRpRmlsZVByb3BlcnR5LmFkZFByb3BlcnR5KHZhbHVlcywgbW9ja1VwZGF0ZSwgY29udGFpbmVyKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrVXBkYXRlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIGVtcHR5IGZpbGVzIGFycmF5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWVzOiBhbnlbXSA9IFtdO1xyXG5cclxuICAgICAgICAgICAgKHNlbGVjdE11bHRpcGxlRmlsZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFtdKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IG11bHRpRmlsZVByb3BlcnR5LmFkZFByb3BlcnR5KHZhbHVlcywgbW9ja1VwZGF0ZSwgY29udGFpbmVyKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrVXBkYXRlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgY2FsbCByZWxvYWRPYmplY3RzIHdoZW4gZmlsZXMgYXJlIGFkZGVkJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWVzOiBhbnlbXSA9IFtdO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrRmlsZXMgPSBbeyBnZXRMaW5rOiAoKSA9PiAnW1tGaWxlMV1dJyB9XTtcclxuXHJcbiAgICAgICAgICAgIChzZWxlY3RNdWx0aXBsZUZpbGUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrRmlsZXMpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgbXVsdGlGaWxlUHJvcGVydHkuYWRkUHJvcGVydHkodmFsdWVzLCBtb2NrVXBkYXRlLCBjb250YWluZXIpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG11bHRpRmlsZVByb3BlcnR5LnJlbG9hZE9iamVjdHMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHZhbHVlcywgbW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnZW5hYmxlRHJhZ0FuZERyb3AnLCAoKSA9PiB7XHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGV4aXN0IGFuZCBiZSBjYWxsYWJsZScsICgpID0+IHtcclxuICAgICAgICAgICAgbXVsdGlGaWxlUHJvcGVydHkgPSBuZXcgTXVsdGlGaWxlUHJvcGVydHkoJ3Rlc3RGaWxlcycsIFsnRG9jdW1lbnQnXSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QoKCkgPT4gbXVsdGlGaWxlUHJvcGVydHkuZW5hYmxlRHJhZ0FuZERyb3AoKSkubm90LnRvVGhyb3coKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdJbnRlZ3JhdGlvbicsICgpID0+IHtcclxuICAgICAgICB0ZXN0KCdzaG91bGQgd29yayB3aXRoIG11bHRpcGxlIGNsYXNzZXMgaW4gaGludCcsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY2xhc3NlcyA9IFsnRG9jdW1lbnQnLCAnSW1hZ2UnLCAnVmlkZW8nXTtcclxuICAgICAgICAgICAgbXVsdGlGaWxlUHJvcGVydHkgPSBuZXcgTXVsdGlGaWxlUHJvcGVydHkoJ3Rlc3RGaWxlcycsIGNsYXNzZXMpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG11bHRpRmlsZVByb3BlcnR5LmdldENsYXNzZXMoKS5qb2luKCcgb3UgJykpLnRvQmUoJ0RvY3VtZW50IG91IEltYWdlIG91IFZpZGVvJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgc2luZ2xlIGNsYXNzIGluIGhpbnQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNsYXNzZXMgPSBbJ0RvY3VtZW50J107XHJcbiAgICAgICAgICAgIG11bHRpRmlsZVByb3BlcnR5ID0gbmV3IE11bHRpRmlsZVByb3BlcnR5KCd0ZXN0RmlsZXMnLCBjbGFzc2VzKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtdWx0aUZpbGVQcm9wZXJ0eS5nZXRDbGFzc2VzKCkuam9pbignIG91ICcpKS50b0JlKCdEb2N1bWVudCcpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgbWFpbnRhaW4gcHJvcGVyIGluaGVyaXRhbmNlIGZyb20gT2JqZWN0UHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIG11bHRpRmlsZVByb3BlcnR5ID0gbmV3IE11bHRpRmlsZVByb3BlcnR5KCd0ZXN0RmlsZXMnLCBbJ0RvY3VtZW50J10pO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG11bHRpRmlsZVByb3BlcnR5LnR5cGUpLnRvQmUoJ211bHRpRmlsZScpO1xyXG4gICAgICAgICAgICBleHBlY3QodHlwZW9mIG11bHRpRmlsZVByb3BlcnR5LmZpbGxEaXNwbGF5KS50b0JlKCdmdW5jdGlvbicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==