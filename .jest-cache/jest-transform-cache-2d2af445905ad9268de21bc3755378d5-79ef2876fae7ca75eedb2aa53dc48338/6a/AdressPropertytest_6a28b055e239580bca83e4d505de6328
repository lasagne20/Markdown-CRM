1fe7676602903a69cb3254f233ced4eb
"use strict";
/**
 * @jest-environment jsdom
 */
Object.defineProperty(exports, "__esModule", { value: true });
jest.mock('../../src/vault/Utils', () => ({
    setIcon: jest.fn()
}));
const AdressProperty_1 = require("../../src/properties/AdressProperty");
const LinkProperty_1 = require("../../src/properties/LinkProperty");
describe('AdressProperty', () => {
    let adressProperty;
    let mockVault;
    beforeAll(() => {
        // Create mock vault with all necessary properties
        mockVault = {
            app: {
                setIcon: jest.fn()
            }
        };
    });
    beforeEach(() => {
        // Reset DOM mocks
        document.body.innerHTML = '';
        jest.clearAllMocks();
    });
    beforeEach(() => {
        adressProperty = new AdressProperty_1.AdressProperty('testAdress', mockVault);
    });
    describe('constructor', () => {
        it('should create AdressProperty with correct type', () => {
            expect(adressProperty.type).toBe('adress');
        });
        it('should inherit from LinkProperty', () => {
            expect(adressProperty).toBeInstanceOf(LinkProperty_1.LinkProperty);
        });
        it('should use default icon when no args provided', () => {
            const defaultProperty = new AdressProperty_1.AdressProperty('defaultTest', mockVault);
            expect(defaultProperty.name).toBe('defaultTest');
            expect(defaultProperty.type).toBe('adress');
        });
        it('should pass custom args to parent constructor', () => {
            const customArgs = { icon: 'custom-icon', flexSpan: 3 };
            const customProperty = new AdressProperty_1.AdressProperty('customName', mockVault, customArgs);
            expect(customProperty.name).toBe('customName');
        });
    });
    describe('validate', () => {
        it('should return input value unchanged', () => {
            const testAddress = '123 Main St, Paris, France';
            expect(adressProperty.validate(testAddress)).toBe(testAddress);
        });
        it('should handle empty string', () => {
            expect(adressProperty.validate('')).toBe('');
        });
        it('should handle special characters in address', () => {
            const specialAddress = 'Rue de l\'Église, 75001 Paris';
            expect(adressProperty.validate(specialAddress)).toBe(specialAddress);
        });
        it('should handle unicode characters', () => {
            const unicodeAddress = '北京市朝阳区';
            expect(adressProperty.validate(unicodeAddress)).toBe(unicodeAddress);
        });
        it('should handle multiline addresses', () => {
            const multilineAddress = '123 Main St\\nApt 4B\\nParis, France';
            expect(adressProperty.validate(multilineAddress)).toBe(multilineAddress);
        });
    });
    describe('getLink', () => {
        it('should generate Google Maps search URL for simple address', () => {
            const address = '123 Main St, Paris';
            const expectedUrl = 'https://www.google.com/maps/search/123%20Main%20St%2C%20Paris';
            expect(adressProperty.getLink(address)).toBe(expectedUrl);
        });
        it('should properly encode special characters', () => {
            const address = 'Rue de l\'Église & Café';
            const expectedUrl = 'https://www.google.com/maps/search/Rue%20de%20l\'%C3%89glise%20%26%20Caf%C3%A9';
            expect(adressProperty.getLink(address)).toBe(expectedUrl);
        });
        it('should handle empty address', () => {
            const address = '';
            const expectedUrl = 'https://www.google.com/maps/search/';
            expect(adressProperty.getLink(address)).toBe(expectedUrl);
        });
        it('should encode spaces correctly', () => {
            const address = 'New York City';
            const expectedUrl = 'https://www.google.com/maps/search/New%20York%20City';
            expect(adressProperty.getLink(address)).toBe(expectedUrl);
        });
        it('should handle complex international address', () => {
            const address = '東京都渋谷区, Japan';
            const result = adressProperty.getLink(address);
            expect(result).toContain('https://www.google.com/maps/search/');
            expect(result).toContain('%E6%9D%B1%E4%BA%AC%E9%83%BD'); // Encoded Tokyo characters
        });
        it('should handle address with numbers and symbols', () => {
            const address = '123-45 Main St #456';
            const result = adressProperty.getLink(address);
            expect(result).toContain('https://www.google.com/maps/search/');
            expect(result).toContain('123-45%20Main%20St%20%23456');
        });
        it('should handle very long address', () => {
            const longAddress = 'Very Long Street Name With Many Words And Details Including Building Number 12345 Apartment Complex Building A Unit 456 City State Postal Code Country';
            const result = adressProperty.getLink(longAddress);
            expect(result).toContain('https://www.google.com/maps/search/');
            expect(result.length).toBeGreaterThan(50); // Should be encoded and long
        });
    });
    describe('inheritance from LinkProperty', () => {
        it('should have fillDisplay method from parent', () => {
            expect(typeof adressProperty.fillDisplay).toBe('function');
        });
        it('should have validate method from parent', () => {
            expect(typeof adressProperty.validate).toBe('function');
        });
        it('should have getLink method', () => {
            expect(typeof adressProperty.getLink).toBe('function');
        });
        it('should have createFieldLink method from parent', () => {
            expect(typeof adressProperty.createFieldLink).toBe('function');
        });
        it('should have getPretty method from parent', () => {
            expect(typeof adressProperty.getPretty).toBe('function');
        });
        it('should have name property from parent', () => {
            expect(adressProperty.name).toBe('testAdress');
        });
    });
    describe('link functionality integration', () => {
        it('should create clickable link with Google Maps URL', () => {
            const mockFile = {};
            const mockUpdate = jest.fn();
            const address = 'Paris, France';
            const result = adressProperty.fillDisplay(null, address, mockUpdate, mockFile);
            expect(result).toBeTruthy();
            expect(result.tagName).toBe('DIV');
        });
        it('should handle null value in fillDisplay', () => {
            const mockFile = {};
            const mockUpdate = jest.fn();
            const result = adressProperty.fillDisplay(null, null, mockUpdate, mockFile);
            expect(result).toBeTruthy();
            expect(result.tagName).toBe('DIV');
        });
        it('should handle undefined value in fillDisplay', () => {
            const mockFile = {};
            const mockUpdate = jest.fn();
            const result = adressProperty.fillDisplay(null, undefined, mockUpdate, mockFile);
            expect(result).toBeTruthy();
            expect(result.tagName).toBe('DIV');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxfX3Rlc3RzX19cXFByb3BlcnRpZXNcXEFkcmVzc1Byb3BlcnR5LnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOztHQUVHOztBQUtILElBQUksQ0FBQyxJQUFJLENBQUMsdUJBQXVCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUN0QyxPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUNyQixDQUFDLENBQUMsQ0FBQztBQUxKLHdFQUFxRTtBQUNyRSxvRUFBaUU7QUFNakUsUUFBUSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRTtJQUM1QixJQUFJLGNBQThCLENBQUM7SUFDbkMsSUFBSSxTQUFjLENBQUM7SUFFbkIsU0FBUyxDQUFDLEdBQUcsRUFBRTtRQUNYLGtEQUFrRDtRQUNsRCxTQUFTLEdBQUc7WUFDUixHQUFHLEVBQUU7Z0JBQ0QsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7YUFDckI7U0FDSixDQUFDO0lBQ04sQ0FBQyxDQUFDLENBQUM7SUFFSCxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ1osa0JBQWtCO1FBQ2xCLFFBQVEsQ0FBQyxJQUFJLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQztRQUM3QixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDekIsQ0FBQyxDQUFDLENBQUM7SUFFSCxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ1osY0FBYyxHQUFHLElBQUksK0JBQWMsQ0FBQyxZQUFZLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFDakUsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsYUFBYSxFQUFFLEdBQUcsRUFBRTtRQUN6QixFQUFFLENBQUMsZ0RBQWdELEVBQUUsR0FBRyxFQUFFO1lBQ3RELE1BQU0sQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENB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Q0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHlDQUF5QyxFQUFFLEdBQUcsRUFBRTtZQUMvQyxNQUFNLFFBQVEsR0FBRyxFQUFFLENBQUM7WUFDcEIsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO1lBRTdCLE1BQU0sTUFBTSxHQUFHLGNBQWMsQ0FBQyxXQUFXLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFFNUUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1lBQzVCLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3ZDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDhDQUE4QyxFQUFFLEdBQUcsRUFBRTtZQUNwRCxNQUFNLFFBQVEsR0FBRyxFQUFFLENBQUM7WUFDcEIsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO1lBRTdCLE1BQU0sTUFBTSxHQUFHLGNBQWMsQ0FBQyxXQUFXLENBQUMsSUFBSSxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFFakYsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1lBQzVCLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3ZDLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGxlb2R1XFxEb2N1bWVudHNcXDEgLSBQcm9cXFRlc3QgcGx1Z2luIG9ic2lkaWFuXFwub2JzaWRpYW5cXHBsdWdpbnNcXG9ic2lkaWFuLUNSTVxcZHluYW1pYy1maWVsZHNcXF9fdGVzdHNfX1xcUHJvcGVydGllc1xcQWRyZXNzUHJvcGVydHkudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQGplc3QtZW52aXJvbm1lbnQganNkb21cclxuICovXHJcblxyXG5pbXBvcnQgeyBBZHJlc3NQcm9wZXJ0eSB9IGZyb20gJy4uLy4uL3NyYy9wcm9wZXJ0aWVzL0FkcmVzc1Byb3BlcnR5JztcclxuaW1wb3J0IHsgTGlua1Byb3BlcnR5IH0gZnJvbSAnLi4vLi4vc3JjL3Byb3BlcnRpZXMvTGlua1Byb3BlcnR5JztcclxuXHJcbmplc3QubW9jaygnLi4vLi4vc3JjL3ZhdWx0L1V0aWxzJywgKCkgPT4gKHtcclxuICAgIHNldEljb246IGplc3QuZm4oKVxyXG59KSk7XHJcblxyXG5kZXNjcmliZSgnQWRyZXNzUHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICBsZXQgYWRyZXNzUHJvcGVydHk6IEFkcmVzc1Byb3BlcnR5O1xyXG4gICAgbGV0IG1vY2tWYXVsdDogYW55O1xyXG5cclxuICAgIGJlZm9yZUFsbCgoKSA9PiB7XHJcbiAgICAgICAgLy8gQ3JlYXRlIG1vY2sgdmF1bHQgd2l0aCBhbGwgbmVjZXNzYXJ5IHByb3BlcnRpZXNcclxuICAgICAgICBtb2NrVmF1bHQgPSB7XHJcbiAgICAgICAgICAgIGFwcDoge1xyXG4gICAgICAgICAgICAgICAgc2V0SWNvbjogamVzdC5mbigpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcblxyXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgLy8gUmVzZXQgRE9NIG1vY2tzXHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgIGFkcmVzc1Byb3BlcnR5ID0gbmV3IEFkcmVzc1Byb3BlcnR5KCd0ZXN0QWRyZXNzJywgbW9ja1ZhdWx0KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdjb25zdHJ1Y3RvcicsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBBZHJlc3NQcm9wZXJ0eSB3aXRoIGNvcnJlY3QgdHlwZScsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KGFkcmVzc1Byb3BlcnR5LnR5cGUpLnRvQmUoJ2FkcmVzcycpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGluaGVyaXQgZnJvbSBMaW5rUHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChhZHJlc3NQcm9wZXJ0eSkudG9CZUluc3RhbmNlT2YoTGlua1Byb3BlcnR5KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCB1c2UgZGVmYXVsdCBpY29uIHdoZW4gbm8gYXJncyBwcm92aWRlZCcsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZGVmYXVsdFByb3BlcnR5ID0gbmV3IEFkcmVzc1Byb3BlcnR5KCdkZWZhdWx0VGVzdCcsIG1vY2tWYXVsdCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChkZWZhdWx0UHJvcGVydHkubmFtZSkudG9CZSgnZGVmYXVsdFRlc3QnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGRlZmF1bHRQcm9wZXJ0eS50eXBlKS50b0JlKCdhZHJlc3MnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBwYXNzIGN1c3RvbSBhcmdzIHRvIHBhcmVudCBjb25zdHJ1Y3RvcicsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VzdG9tQXJncyA9IHsgaWNvbjogJ2N1c3RvbS1pY29uJywgZmxleFNwYW46IDMgfTtcclxuICAgICAgICAgICAgY29uc3QgY3VzdG9tUHJvcGVydHkgPSBuZXcgQWRyZXNzUHJvcGVydHkoJ2N1c3RvbU5hbWUnLCBtb2NrVmF1bHQsIGN1c3RvbUFyZ3MpO1xyXG4gICAgICAgICAgICBleHBlY3QoY3VzdG9tUHJvcGVydHkubmFtZSkudG9CZSgnY3VzdG9tTmFtZScpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ3ZhbGlkYXRlJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGlucHV0IHZhbHVlIHVuY2hhbmdlZCcsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdGVzdEFkZHJlc3MgPSAnMTIzIE1haW4gU3QsIFBhcmlzLCBGcmFuY2UnO1xyXG4gICAgICAgICAgICBleHBlY3QoYWRyZXNzUHJvcGVydHkudmFsaWRhdGUodGVzdEFkZHJlc3MpKS50b0JlKHRlc3RBZGRyZXNzKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgc3RyaW5nJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QoYWRyZXNzUHJvcGVydHkudmFsaWRhdGUoJycpKS50b0JlKCcnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgc3BlY2lhbCBjaGFyYWN0ZXJzIGluIGFkZHJlc3MnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNwZWNpYWxBZGRyZXNzID0gJ1J1ZSBkZSBsXFwnw4lnbGlzZSwgNzUwMDEgUGFyaXMnO1xyXG4gICAgICAgICAgICBleHBlY3QoYWRyZXNzUHJvcGVydHkudmFsaWRhdGUoc3BlY2lhbEFkZHJlc3MpKS50b0JlKHNwZWNpYWxBZGRyZXNzKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgdW5pY29kZSBjaGFyYWN0ZXJzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB1bmljb2RlQWRkcmVzcyA9ICfljJfkuqzluILmnJ3pmLPljLonO1xyXG4gICAgICAgICAgICBleHBlY3QoYWRyZXNzUHJvcGVydHkudmFsaWRhdGUodW5pY29kZUFkZHJlc3MpKS50b0JlKHVuaWNvZGVBZGRyZXNzKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgbXVsdGlsaW5lIGFkZHJlc3NlcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbXVsdGlsaW5lQWRkcmVzcyA9ICcxMjMgTWFpbiBTdFxcXFxuQXB0IDRCXFxcXG5QYXJpcywgRnJhbmNlJztcclxuICAgICAgICAgICAgZXhwZWN0KGFkcmVzc1Byb3BlcnR5LnZhbGlkYXRlKG11bHRpbGluZUFkZHJlc3MpKS50b0JlKG11bHRpbGluZUFkZHJlc3MpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2dldExpbmsnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSBHb29nbGUgTWFwcyBzZWFyY2ggVVJMIGZvciBzaW1wbGUgYWRkcmVzcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgYWRkcmVzcyA9ICcxMjMgTWFpbiBTdCwgUGFyaXMnO1xyXG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZFVybCA9ICdodHRwczovL3d3dy5nb29nbGUuY29tL21hcHMvc2VhcmNoLzEyMyUyME1haW4lMjBTdCUyQyUyMFBhcmlzJztcclxuICAgICAgICAgICAgZXhwZWN0KGFkcmVzc1Byb3BlcnR5LmdldExpbmsoYWRkcmVzcykpLnRvQmUoZXhwZWN0ZWRVcmwpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHByb3Blcmx5IGVuY29kZSBzcGVjaWFsIGNoYXJhY3RlcnMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFkZHJlc3MgPSAnUnVlIGRlIGxcXCfDiWdsaXNlICYgQ2Fmw6knO1xyXG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZFVybCA9ICdodHRwczovL3d3dy5nb29nbGUuY29tL21hcHMvc2VhcmNoL1J1ZSUyMGRlJTIwbFxcJyVDMyU4OWdsaXNlJTIwJTI2JTIwQ2FmJUMzJUE5JztcclxuICAgICAgICAgICAgZXhwZWN0KGFkcmVzc1Byb3BlcnR5LmdldExpbmsoYWRkcmVzcykpLnRvQmUoZXhwZWN0ZWRVcmwpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBhZGRyZXNzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBhZGRyZXNzID0gJyc7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkVXJsID0gJ2h0dHBzOi8vd3d3Lmdvb2dsZS5jb20vbWFwcy9zZWFyY2gvJztcclxuICAgICAgICAgICAgZXhwZWN0KGFkcmVzc1Byb3BlcnR5LmdldExpbmsoYWRkcmVzcykpLnRvQmUoZXhwZWN0ZWRVcmwpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGVuY29kZSBzcGFjZXMgY29ycmVjdGx5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBhZGRyZXNzID0gJ05ldyBZb3JrIENpdHknO1xyXG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZFVybCA9ICdodHRwczovL3d3dy5nb29nbGUuY29tL21hcHMvc2VhcmNoL05ldyUyMFlvcmslMjBDaXR5JztcclxuICAgICAgICAgICAgZXhwZWN0KGFkcmVzc1Byb3BlcnR5LmdldExpbmsoYWRkcmVzcykpLnRvQmUoZXhwZWN0ZWRVcmwpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb21wbGV4IGludGVybmF0aW9uYWwgYWRkcmVzcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgYWRkcmVzcyA9ICfmnbHkuqzpg73muIvosLfljLosIEphcGFuJztcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYWRyZXNzUHJvcGVydHkuZ2V0TGluayhhZGRyZXNzKTtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9Db250YWluKCdodHRwczovL3d3dy5nb29nbGUuY29tL21hcHMvc2VhcmNoLycpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0NvbnRhaW4oJyVFNiU5RCVCMSVFNCVCQSVBQyVFOSU4MyVCRCcpOyAvLyBFbmNvZGVkIFRva3lvIGNoYXJhY3RlcnNcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgYWRkcmVzcyB3aXRoIG51bWJlcnMgYW5kIHN5bWJvbHMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFkZHJlc3MgPSAnMTIzLTQ1IE1haW4gU3QgIzQ1Nic7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGFkcmVzc1Byb3BlcnR5LmdldExpbmsoYWRkcmVzcyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQ29udGFpbignaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9tYXBzL3NlYXJjaC8nKTtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9Db250YWluKCcxMjMtNDUlMjBNYWluJTIwU3QlMjAlMjM0NTYnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgdmVyeSBsb25nIGFkZHJlc3MnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGxvbmdBZGRyZXNzID0gJ1ZlcnkgTG9uZyBTdHJlZXQgTmFtZSBXaXRoIE1hbnkgV29yZHMgQW5kIERldGFpbHMgSW5jbHVkaW5nIEJ1aWxkaW5nIE51bWJlciAxMjM0NSBBcGFydG1lbnQgQ29tcGxleCBCdWlsZGluZyBBIFVuaXQgNDU2IENpdHkgU3RhdGUgUG9zdGFsIENvZGUgQ291bnRyeSc7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGFkcmVzc1Byb3BlcnR5LmdldExpbmsobG9uZ0FkZHJlc3MpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0NvbnRhaW4oJ2h0dHBzOi8vd3d3Lmdvb2dsZS5jb20vbWFwcy9zZWFyY2gvJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oNTApOyAvLyBTaG91bGQgYmUgZW5jb2RlZCBhbmQgbG9uZ1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2luaGVyaXRhbmNlIGZyb20gTGlua1Byb3BlcnR5JywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgaGF2ZSBmaWxsRGlzcGxheSBtZXRob2QgZnJvbSBwYXJlbnQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0eXBlb2YgYWRyZXNzUHJvcGVydHkuZmlsbERpc3BsYXkpLnRvQmUoJ2Z1bmN0aW9uJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGF2ZSB2YWxpZGF0ZSBtZXRob2QgZnJvbSBwYXJlbnQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0eXBlb2YgYWRyZXNzUHJvcGVydHkudmFsaWRhdGUpLnRvQmUoJ2Z1bmN0aW9uJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGF2ZSBnZXRMaW5rIG1ldGhvZCcsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KHR5cGVvZiBhZHJlc3NQcm9wZXJ0eS5nZXRMaW5rKS50b0JlKCdmdW5jdGlvbicpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhdmUgY3JlYXRlRmllbGRMaW5rIG1ldGhvZCBmcm9tIHBhcmVudCcsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KHR5cGVvZiBhZHJlc3NQcm9wZXJ0eS5jcmVhdGVGaWVsZExpbmspLnRvQmUoJ2Z1bmN0aW9uJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGF2ZSBnZXRQcmV0dHkgbWV0aG9kIGZyb20gcGFyZW50JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QodHlwZW9mIGFkcmVzc1Byb3BlcnR5LmdldFByZXR0eSkudG9CZSgnZnVuY3Rpb24nKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYXZlIG5hbWUgcHJvcGVydHkgZnJvbSBwYXJlbnQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChhZHJlc3NQcm9wZXJ0eS5uYW1lKS50b0JlKCd0ZXN0QWRyZXNzJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnbGluayBmdW5jdGlvbmFsaXR5IGludGVncmF0aW9uJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIGNsaWNrYWJsZSBsaW5rIHdpdGggR29vZ2xlIE1hcHMgVVJMJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrRmlsZSA9IHt9O1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBjb25zdCBhZGRyZXNzID0gJ1BhcmlzLCBGcmFuY2UnO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYWRyZXNzUHJvcGVydHkuZmlsbERpc3BsYXkobnVsbCwgYWRkcmVzcywgbW9ja1VwZGF0ZSwgbW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZVRydXRoeSgpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LnRhZ05hbWUpLnRvQmUoJ0RJVicpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBudWxsIHZhbHVlIGluIGZpbGxEaXNwbGF5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrRmlsZSA9IHt9O1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYWRyZXNzUHJvcGVydHkuZmlsbERpc3BsYXkobnVsbCwgbnVsbCwgbW9ja1VwZGF0ZSwgbW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZVRydXRoeSgpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LnRhZ05hbWUpLnRvQmUoJ0RJVicpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSB1bmRlZmluZWQgdmFsdWUgaW4gZmlsbERpc3BsYXknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tGaWxlID0ge307XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhZHJlc3NQcm9wZXJ0eS5maWxsRGlzcGxheShudWxsLCB1bmRlZmluZWQsIG1vY2tVcGRhdGUsIG1vY2tGaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVUcnV0aHkoKTtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC50YWdOYW1lKS50b0JlKCdESVYnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59KTtcclxuIl0sInZlcnNpb24iOjN9