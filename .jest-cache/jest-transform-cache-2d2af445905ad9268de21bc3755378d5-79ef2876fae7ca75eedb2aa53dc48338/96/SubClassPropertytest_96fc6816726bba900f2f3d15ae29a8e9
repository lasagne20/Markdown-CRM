d5bc14e132901fe1f08c931c34800840
"use strict";
/**
 * @jest-environment jsdom
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock dependencies
jest.mock('../../src/vault/Utils', () => ({
    setIcon: jest.fn()
}));
const SelectProperty_1 = require("../../src/properties/SelectProperty");
const SubClassProperty_1 = require("../../src/properties/SubClassProperty");
describe('SubClassProperty', () => {
    let subClassProperty;
    let mockSubClasses;
    let mockFile;
    beforeEach(() => {
        // Reset DOM mocks
        document.body.innerHTML = '';
        jest.clearAllMocks();
        // Mock SubClass objects
        mockSubClasses = [
            {
                getsubClassName: jest.fn().mockReturnValue('SubClass1'),
                getConstructor: jest.fn().mockReturnValue('Constructor1'),
                getProperties: jest.fn().mockReturnValue({
                    prop1: { name: 'prop1', type: 'text' },
                    prop2: { name: 'prop2', type: 'number' }
                }),
                getTopDisplayContent: jest.fn().mockReturnValue(document.createElement('div'))
            },
            {
                getsubClassName: jest.fn().mockReturnValue('SubClass2'),
                getConstructor: jest.fn().mockReturnValue('Constructor2'),
                getProperties: jest.fn().mockReturnValue({
                    prop3: { name: 'prop3', type: 'text' }
                }),
                getTopDisplayContent: jest.fn().mockReturnValue(document.createElement('span'))
            }
        ];
        // Mock File object
        mockFile = {
            metadata: {},
            updateMetadata: jest.fn()
        };
    });
    beforeEach(() => {
        subClassProperty = new SubClassProperty_1.SubClassProperty('testSubClass', mockVault, mockSubClasses);
    });
    describe('constructor', () => {
        it('should create SubClassProperty with correct type', () => {
            expect(subClassProperty.type).toBe('subClass');
        });
        it('should inherit from SelectProperty', () => {
            expect(subClassProperty).toBeInstanceOf(SelectProperty_1.SelectProperty);
        });
        it('should store subClasses correctly', () => {
            expect(subClassProperty.subClasses).toBe(mockSubClasses);
            expect(subClassProperty.subClasses.length).toBe(2);
        });
        it('should pass subclass names to parent SelectProperty', () => {
            // Check that options were created from subclass names
            expect(subClassProperty.options).toEqual([
                { name: 'SubClass1', color: '' },
                { name: 'SubClass2', color: '' }
            ]);
        });
        it('should pass args to parent constructor', () => {
            const customArgs = { icon: 'custom-icon' };
            const customProperty = new SubClassProperty_1.SubClassProperty('customName', mockVault, mockSubClasses, customArgs);
            expect(customProperty.name).toBe('customName');
        });
        it('should handle empty subClasses array', () => {
            const emptyProperty = new SubClassProperty_1.SubClassProperty('empty', mockVault, []);
            expect(emptyProperty.subClasses).toEqual([]);
            expect(emptyProperty.options).toEqual([]);
        });
    });
    describe('getSubClassFromName', () => {
        it('should return constructor for existing subclass name', () => {
            const result = subClassProperty.getSubClassFromName('SubClass1');
            expect(result).toBe('Constructor1');
            expect(mockSubClasses[0].getsubClassName).toHaveBeenCalled();
            expect(mockSubClasses[0].getConstructor).toHaveBeenCalled();
        });
        it('should return undefined for non-existing subclass name', () => {
            const result = subClassProperty.getSubClassFromName('NonExistentClass');
            expect(result).toBeUndefined();
        });
        it('should handle empty string', () => {
            const result = subClassProperty.getSubClassFromName('');
            expect(result).toBeUndefined();
        });
        it('should handle null input', () => {
            const result = subClassProperty.getSubClassFromName(null);
            expect(result).toBeUndefined();
        });
        it('should handle case sensitivity', () => {
            const result = subClassProperty.getSubClassFromName('subclass1');
            expect(result).toBeUndefined(); // Should be case sensitive
        });
    });
    describe('getSubClass', () => {
        beforeEach(() => {
            // Mock the read method to return a specific value
            subClassProperty.read = jest.fn();
        });
        it('should return subclass when value matches', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass1');
            const result = subClassProperty.getSubClass(mockFile);
            expect(subClassProperty.read).toHaveBeenCalledWith(mockFile);
            expect(result).toBe(mockSubClasses[0]);
        });
        it('should return undefined when no match found', () => {
            subClassProperty.read = jest.fn().mockReturnValue('NonExistentClass');
            const result = subClassProperty.getSubClass(mockFile);
            expect(result).toBeUndefined();
        });
        it('should return undefined when read returns null', () => {
            subClassProperty.read = jest.fn().mockReturnValue(null);
            const result = subClassProperty.getSubClass(mockFile);
            expect(result).toBeUndefined();
        });
        it('should return undefined when read returns undefined', () => {
            subClassProperty.read = jest.fn().mockReturnValue(undefined);
            const result = subClassProperty.getSubClass(mockFile);
            expect(result).toBeUndefined();
        });
        it('should handle second subclass correctly', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass2');
            const result = subClassProperty.getSubClass(mockFile);
            expect(result).toBe(mockSubClasses[1]);
        });
    });
    describe('getSubclassesNames', () => {
        it('should return all subclasses', () => {
            const result = subClassProperty.getSubclassesNames();
            expect(result).toBe(mockSubClasses);
            expect(result.length).toBe(2);
        });
        it('should return empty array when no subclasses', () => {
            const emptyProperty = new SubClassProperty_1.SubClassProperty('empty', mockVault, []);
            const result = emptyProperty.getSubclassesNames();
            expect(result).toEqual([]);
        });
        it('should return same reference to subclasses array', () => {
            const result = subClassProperty.getSubclassesNames();
            expect(result).toBe(subClassProperty.subClasses);
        });
    });
    describe('getSubClassProperty', () => {
        beforeEach(() => {
            subClassProperty.read = jest.fn();
        });
        it('should return properties when subclass found', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass1');
            const result = subClassProperty.getSubClassProperty(mockFile);
            expect(result).toEqual([
                { name: 'prop1', type: 'text' },
                { name: 'prop2', type: 'number' }
            ]);
            expect(mockSubClasses[0].getProperties).toHaveBeenCalled();
        });
        it('should return empty array when no subclass found', () => {
            subClassProperty.read = jest.fn().mockReturnValue('NonExistentClass');
            const result = subClassProperty.getSubClassProperty(mockFile);
            expect(result).toEqual([]);
        });
        it('should return empty array when subclass has no properties', () => {
            const subClassWithoutProps = {
                getsubClassName: jest.fn().mockReturnValue('EmptyClass'),
                getConstructor: jest.fn().mockReturnValue('EmptyConstructor'),
                getProperties: jest.fn().mockReturnValue(null),
                getTopDisplayContent: jest.fn().mockReturnValue(document.createElement('div'))
            };
            const propertyWithEmptyClass = new SubClassProperty_1.SubClassProperty('test', mockVault, [subClassWithoutProps]);
            propertyWithEmptyClass.read = jest.fn().mockReturnValue('EmptyClass');
            const result = propertyWithEmptyClass.getSubClassProperty(mockFile);
            expect(result).toEqual([]);
        });
        it('should handle different property structures', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass2');
            const result = subClassProperty.getSubClassProperty(mockFile);
            expect(result).toEqual([{ name: 'prop3', type: 'text' }]);
        });
    });
    describe('getTopDisplayContent', () => {
        beforeEach(() => {
            subClassProperty.read = jest.fn();
        });
        it('should return container with subclass content when subclass found', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass1');
            const result = subClassProperty.getTopDisplayContent(mockFile);
            expect(result.tagName).toBe('DIV');
            expect(result.children.length).toBe(1);
            expect(mockSubClasses[0].getTopDisplayContent).toHaveBeenCalledWith(mockFile);
        });
        it('should return empty container when no subclass found', () => {
            subClassProperty.read = jest.fn().mockReturnValue('NonExistentClass');
            const result = subClassProperty.getTopDisplayContent(mockFile);
            expect(result.tagName).toBe('DIV');
            expect(result.children.length).toBe(0);
        });
        it('should handle null read result', () => {
            subClassProperty.read = jest.fn().mockReturnValue(null);
            const result = subClassProperty.getTopDisplayContent(mockFile);
            expect(result.tagName).toBe('DIV');
            expect(result.children.length).toBe(0);
        });
        it('should call getTopDisplayContent on correct subclass', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass2');
            const result = subClassProperty.getTopDisplayContent(mockFile);
            expect(mockSubClasses[1].getTopDisplayContent).toHaveBeenCalledWith(mockFile);
            expect(mockSubClasses[0].getTopDisplayContent).not.toHaveBeenCalled();
        });
    });
    describe('inheritance from SelectProperty', () => {
        it('should have options property from parent', () => {
            expect(subClassProperty.options).toBeDefined();
            expect(Array.isArray(subClassProperty.options)).toBe(true);
        });
        it('should have name property from parent', () => {
            expect(subClassProperty.name).toBe('testSubClass');
        });
        it('should have fillDisplay method from parent', () => {
            expect(typeof subClassProperty.fillDisplay).toBe('function');
        });
        it('should have read method from parent', () => {
            expect(typeof subClassProperty.read).toBe('function');
        });
    });
    describe('integration with subclasses', () => {
        it('should maintain consistency between subClasses and options', () => {
            expect(subClassProperty.subClasses.length).toBe(subClassProperty.options.length);
            subClassProperty.subClasses.forEach((subClass, index) => {
                expect(subClass.getsubClassName()).toBe(subClassProperty.options[index].name);
            });
        });
        it('should handle subclass method calls correctly', () => {
            subClassProperty.read = jest.fn().mockReturnValue('SubClass1');
            // Test multiple method calls
            subClassProperty.getSubClass(mockFile);
            subClassProperty.getSubClassProperty(mockFile);
            subClassProperty.getTopDisplayContent(mockFile);
            // Verify all methods were called on the correct subclass
            expect(mockSubClasses[0].getsubClassName).toHaveBeenCalled();
            expect(mockSubClasses[0].getProperties).toHaveBeenCalled();
            expect(mockSubClasses[0].getTopDisplayContent).toHaveBeenCalled();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxfX3Rlc3RzX19cXFByb3BlcnRpZXNcXFN1YkNsYXNzUHJvcGVydHkudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7O0dBRUc7O0FBS0gsb0JBQW9CO0FBQ3BCLElBQUksQ0FBQyxJQUFJLENBQUMsdUJBQXVCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUN0QyxPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUNyQixDQUFDLENBQUMsQ0FBQztBQU5KLHdFQUFxRTtBQUNyRSw0RUFBeUU7QUFPekUsUUFBUSxDQUFDLGtCQUFrQixFQUFFLEdBQUcsRUFBRTtJQUM5QixJQUFJLGdCQUFrQyxDQUFDO0lBQ3ZDLElBQUksY0FBcUIsQ0FBQztJQUMxQixJQUFJLFFBQWEsQ0FBQztJQUVsQixVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ1osa0JBQWtCO1FBQ2xCLFFBQVEsQ0FBQyxJQUFJLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQztRQUM3QixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFFckIsd0JBQXdCO1FBQ3hCLGNBQWMsR0FBRztZQUNiO2dCQUNJLGVBQWUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLFdBQVcsQ0FBQztnQkFDdkQsY0FBYyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsY0FBYyxDQUFDO2dCQUN6RCxhQUFhLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQztvQkFDckMsS0FBSyxFQUFFLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFO29CQUN0QyxLQUFLLEVBQUUsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUU7aUJB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UUFBUSxDQUFDLENBQUM7WUFFaEQseURBQXlEO1lBQ3pELE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUMsZUFBZSxDQUFDLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztZQUM3RCxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLGdCQUFnQixFQUFFLENBQUM7WUFDM0QsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLGdCQUFnQixFQUFFLENBQUM7UUFDdEUsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbGVvZHVcXERvY3VtZW50c1xcMSAtIFByb1xcVGVzdCBwbHVnaW4gb2JzaWRpYW5cXC5vYnNpZGlhblxccGx1Z2luc1xcb2JzaWRpYW4tQ1JNXFxkeW5hbWljLWZpZWxkc1xcX190ZXN0c19fXFxQcm9wZXJ0aWVzXFxTdWJDbGFzc1Byb3BlcnR5LnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBqZXN0LWVudmlyb25tZW50IGpzZG9tXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgU2VsZWN0UHJvcGVydHkgfSBmcm9tICcuLi8uLi9zcmMvcHJvcGVydGllcy9TZWxlY3RQcm9wZXJ0eSc7XHJcbmltcG9ydCB7IFN1YkNsYXNzUHJvcGVydHkgfSBmcm9tICcuLi8uLi9zcmMvcHJvcGVydGllcy9TdWJDbGFzc1Byb3BlcnR5JztcclxuXHJcbi8vIE1vY2sgZGVwZW5kZW5jaWVzXHJcbmplc3QubW9jaygnLi4vLi4vc3JjL3ZhdWx0L1V0aWxzJywgKCkgPT4gKHtcclxuICAgIHNldEljb246IGplc3QuZm4oKVxyXG59KSk7XHJcblxyXG5kZXNjcmliZSgnU3ViQ2xhc3NQcm9wZXJ0eScsICgpID0+IHtcclxuICAgIGxldCBzdWJDbGFzc1Byb3BlcnR5OiBTdWJDbGFzc1Byb3BlcnR5O1xyXG4gICAgbGV0IG1vY2tTdWJDbGFzc2VzOiBhbnlbXTtcclxuICAgIGxldCBtb2NrRmlsZTogYW55O1xyXG5cclxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgIC8vIFJlc2V0IERPTSBtb2Nrc1xyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gTW9jayBTdWJDbGFzcyBvYmplY3RzXHJcbiAgICAgICAgbW9ja1N1YkNsYXNzZXMgPSBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGdldHN1YkNsYXNzTmFtZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnU3ViQ2xhc3MxJyksXHJcbiAgICAgICAgICAgICAgICBnZXRDb25zdHJ1Y3RvcjogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnQ29uc3RydWN0b3IxJyksXHJcbiAgICAgICAgICAgICAgICBnZXRQcm9wZXJ0aWVzOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9wMTogeyBuYW1lOiAncHJvcDEnLCB0eXBlOiAndGV4dCcgfSxcclxuICAgICAgICAgICAgICAgICAgICBwcm9wMjogeyBuYW1lOiAncHJvcDInLCB0eXBlOiAnbnVtYmVyJyB9XHJcbiAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgIGdldFRvcERpc3BsYXlDb250ZW50OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpKVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBnZXRzdWJDbGFzc05hbWU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ1N1YkNsYXNzMicpLFxyXG4gICAgICAgICAgICAgICAgZ2V0Q29uc3RydWN0b3I6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ0NvbnN0cnVjdG9yMicpLFxyXG4gICAgICAgICAgICAgICAgZ2V0UHJvcGVydGllczogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcDM6IHsgbmFtZTogJ3Byb3AzJywgdHlwZTogJ3RleHQnIH1cclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgZ2V0VG9wRGlzcGxheUNvbnRlbnQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBNb2NrIEZpbGUgb2JqZWN0XHJcbiAgICAgICAgbW9ja0ZpbGUgPSB7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhOiB7fSxcclxuICAgICAgICAgICAgdXBkYXRlTWV0YWRhdGE6IGplc3QuZm4oKVxyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxuXHJcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICBzdWJDbGFzc1Byb3BlcnR5ID0gbmV3IFN1YkNsYXNzUHJvcGVydHkoJ3Rlc3RTdWJDbGFzcycsIG1vY2tWYXVsdCwgbW9ja1N1YkNsYXNzZXMpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2NvbnN0cnVjdG9yJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIFN1YkNsYXNzUHJvcGVydHkgd2l0aCBjb3JyZWN0IHR5cGUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChzdWJDbGFzc1Byb3BlcnR5LnR5cGUpLnRvQmUoJ3N1YkNsYXNzJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaW5oZXJpdCBmcm9tIFNlbGVjdFByb3BlcnR5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3Qoc3ViQ2xhc3NQcm9wZXJ0eSkudG9CZUluc3RhbmNlT2YoU2VsZWN0UHJvcGVydHkpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHN0b3JlIHN1YkNsYXNzZXMgY29ycmVjdGx5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3Qoc3ViQ2xhc3NQcm9wZXJ0eS5zdWJDbGFzc2VzKS50b0JlKG1vY2tTdWJDbGFzc2VzKTtcclxuICAgICAgICAgICAgZXhwZWN0KHN1YkNsYXNzUHJvcGVydHkuc3ViQ2xhc3Nlcy5sZW5ndGgpLnRvQmUoMik7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcGFzcyBzdWJjbGFzcyBuYW1lcyB0byBwYXJlbnQgU2VsZWN0UHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIENoZWNrIHRoYXQgb3B0aW9ucyB3ZXJlIGNyZWF0ZWQgZnJvbSBzdWJjbGFzcyBuYW1lc1xyXG4gICAgICAgICAgICBleHBlY3Qoc3ViQ2xhc3NQcm9wZXJ0eS5vcHRpb25zKS50b0VxdWFsKFtcclxuICAgICAgICAgICAgICAgIHsgbmFtZTogJ1N1YkNsYXNzMScsIGNvbG9yOiAnJyB9LFxyXG4gICAgICAgICAgICAgICAgeyBuYW1lOiAnU3ViQ2xhc3MyJywgY29sb3I6ICcnIH1cclxuICAgICAgICAgICAgXSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcGFzcyBhcmdzIHRvIHBhcmVudCBjb25zdHJ1Y3RvcicsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VzdG9tQXJncyA9IHsgaWNvbjogJ2N1c3RvbS1pY29uJyB9O1xyXG4gICAgICAgICAgICBjb25zdCBjdXN0b21Qcm9wZXJ0eSA9IG5ldyBTdWJDbGFzc1Byb3BlcnR5KCdjdXN0b21OYW1lJywgbW9ja1ZhdWx0LCBtb2NrU3ViQ2xhc3NlcywgY3VzdG9tQXJncyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChjdXN0b21Qcm9wZXJ0eS5uYW1lKS50b0JlKCdjdXN0b21OYW1lJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IHN1YkNsYXNzZXMgYXJyYXknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVtcHR5UHJvcGVydHkgPSBuZXcgU3ViQ2xhc3NQcm9wZXJ0eSgnZW1wdHknLCBtb2NrVmF1bHQsIFtdKTtcclxuICAgICAgICAgICAgZXhwZWN0KGVtcHR5UHJvcGVydHkuc3ViQ2xhc3NlcykudG9FcXVhbChbXSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChlbXB0eVByb3BlcnR5Lm9wdGlvbnMpLnRvRXF1YWwoW10pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2dldFN1YkNsYXNzRnJvbU5hbWUnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gY29uc3RydWN0b3IgZm9yIGV4aXN0aW5nIHN1YmNsYXNzIG5hbWUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0U3ViQ2xhc3NGcm9tTmFtZSgnU3ViQ2xhc3MxJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoJ0NvbnN0cnVjdG9yMScpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1N1YkNsYXNzZXNbMF0uZ2V0c3ViQ2xhc3NOYW1lKS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrU3ViQ2xhc3Nlc1swXS5nZXRDb25zdHJ1Y3RvcikudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiB1bmRlZmluZWQgZm9yIG5vbi1leGlzdGluZyBzdWJjbGFzcyBuYW1lJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBzdWJDbGFzc1Byb3BlcnR5LmdldFN1YkNsYXNzRnJvbU5hbWUoJ05vbkV4aXN0ZW50Q2xhc3MnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZVVuZGVmaW5lZCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBzdHJpbmcnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0U3ViQ2xhc3NGcm9tTmFtZSgnJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVVbmRlZmluZWQoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgbnVsbCBpbnB1dCcsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gc3ViQ2xhc3NQcm9wZXJ0eS5nZXRTdWJDbGFzc0Zyb21OYW1lKG51bGwgYXMgYW55KTtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZVVuZGVmaW5lZCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBjYXNlIHNlbnNpdGl2aXR5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBzdWJDbGFzc1Byb3BlcnR5LmdldFN1YkNsYXNzRnJvbU5hbWUoJ3N1YmNsYXNzMScpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlVW5kZWZpbmVkKCk7IC8vIFNob3VsZCBiZSBjYXNlIHNlbnNpdGl2ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2dldFN1YkNsYXNzJywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBNb2NrIHRoZSByZWFkIG1ldGhvZCB0byByZXR1cm4gYSBzcGVjaWZpYyB2YWx1ZVxyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LnJlYWQgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIHN1YmNsYXNzIHdoZW4gdmFsdWUgbWF0Y2hlcycsICgpID0+IHtcclxuICAgICAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eS5yZWFkID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnU3ViQ2xhc3MxJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBzdWJDbGFzc1Byb3BlcnR5LmdldFN1YkNsYXNzKG1vY2tGaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChzdWJDbGFzc1Byb3BlcnR5LnJlYWQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1vY2tGaWxlKTtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZShtb2NrU3ViQ2xhc3Nlc1swXSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIHVuZGVmaW5lZCB3aGVuIG5vIG1hdGNoIGZvdW5kJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LnJlYWQgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdOb25FeGlzdGVudENsYXNzJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBzdWJDbGFzc1Byb3BlcnR5LmdldFN1YkNsYXNzKG1vY2tGaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVVbmRlZmluZWQoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gdW5kZWZpbmVkIHdoZW4gcmVhZCByZXR1cm5zIG51bGwnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHN1YkNsYXNzUHJvcGVydHkucmVhZCA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUobnVsbCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBzdWJDbGFzc1Byb3BlcnR5LmdldFN1YkNsYXNzKG1vY2tGaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVVbmRlZmluZWQoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gdW5kZWZpbmVkIHdoZW4gcmVhZCByZXR1cm5zIHVuZGVmaW5lZCcsICgpID0+IHtcclxuICAgICAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eS5yZWFkID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh1bmRlZmluZWQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gc3ViQ2xhc3NQcm9wZXJ0eS5nZXRTdWJDbGFzcyhtb2NrRmlsZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlVW5kZWZpbmVkKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlY29uZCBzdWJjbGFzcyBjb3JyZWN0bHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHN1YkNsYXNzUHJvcGVydHkucmVhZCA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ1N1YkNsYXNzMicpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gc3ViQ2xhc3NQcm9wZXJ0eS5nZXRTdWJDbGFzcyhtb2NrRmlsZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKG1vY2tTdWJDbGFzc2VzWzFdKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdnZXRTdWJjbGFzc2VzTmFtZXMnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gYWxsIHN1YmNsYXNzZXMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0U3ViY2xhc3Nlc05hbWVzKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKG1vY2tTdWJDbGFzc2VzKTtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC5sZW5ndGgpLnRvQmUoMik7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGVtcHR5IGFycmF5IHdoZW4gbm8gc3ViY2xhc3NlcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZW1wdHlQcm9wZXJ0eSA9IG5ldyBTdWJDbGFzc1Byb3BlcnR5KCdlbXB0eScsIG1vY2tWYXVsdCwgW10pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gZW1wdHlQcm9wZXJ0eS5nZXRTdWJjbGFzc2VzTmFtZXMoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoW10pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBzYW1lIHJlZmVyZW5jZSB0byBzdWJjbGFzc2VzIGFycmF5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBzdWJDbGFzc1Byb3BlcnR5LmdldFN1YmNsYXNzZXNOYW1lcygpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZShzdWJDbGFzc1Byb3BlcnR5LnN1YkNsYXNzZXMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2dldFN1YkNsYXNzUHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHN1YkNsYXNzUHJvcGVydHkucmVhZCA9IGplc3QuZm4oKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gcHJvcGVydGllcyB3aGVuIHN1YmNsYXNzIGZvdW5kJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LnJlYWQgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdTdWJDbGFzczEnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0U3ViQ2xhc3NQcm9wZXJ0eShtb2NrRmlsZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKFtcclxuICAgICAgICAgICAgICAgIHsgbmFtZTogJ3Byb3AxJywgdHlwZTogJ3RleHQnIH0sXHJcbiAgICAgICAgICAgICAgICB7IG5hbWU6ICdwcm9wMicsIHR5cGU6ICdudW1iZXInIH1cclxuICAgICAgICAgICAgXSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrU3ViQ2xhc3Nlc1swXS5nZXRQcm9wZXJ0aWVzKS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGVtcHR5IGFycmF5IHdoZW4gbm8gc3ViY2xhc3MgZm91bmQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHN1YkNsYXNzUHJvcGVydHkucmVhZCA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ05vbkV4aXN0ZW50Q2xhc3MnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0U3ViQ2xhc3NQcm9wZXJ0eShtb2NrRmlsZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKFtdKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gZW1wdHkgYXJyYXkgd2hlbiBzdWJjbGFzcyBoYXMgbm8gcHJvcGVydGllcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgc3ViQ2xhc3NXaXRob3V0UHJvcHMgPSB7XHJcbiAgICAgICAgICAgICAgICBnZXRzdWJDbGFzc05hbWU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ0VtcHR5Q2xhc3MnKSxcclxuICAgICAgICAgICAgICAgIGdldENvbnN0cnVjdG9yOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdFbXB0eUNvbnN0cnVjdG9yJyksXHJcbiAgICAgICAgICAgICAgICBnZXRQcm9wZXJ0aWVzOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKG51bGwpLFxyXG4gICAgICAgICAgICAgICAgZ2V0VG9wRGlzcGxheUNvbnRlbnQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JykpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0eVdpdGhFbXB0eUNsYXNzID0gbmV3IFN1YkNsYXNzUHJvcGVydHkoJ3Rlc3QnLCBtb2NrVmF1bHQsIFtzdWJDbGFzc1dpdGhvdXRQcm9wc10pO1xyXG4gICAgICAgICAgICBwcm9wZXJ0eVdpdGhFbXB0eUNsYXNzLnJlYWQgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdFbXB0eUNsYXNzJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBwcm9wZXJ0eVdpdGhFbXB0eUNsYXNzLmdldFN1YkNsYXNzUHJvcGVydHkobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbXSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGRpZmZlcmVudCBwcm9wZXJ0eSBzdHJ1Y3R1cmVzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LnJlYWQgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdTdWJDbGFzczInKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0U3ViQ2xhc3NQcm9wZXJ0eShtb2NrRmlsZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKFt7IG5hbWU6ICdwcm9wMycsIHR5cGU6ICd0ZXh0JyB9XSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnZ2V0VG9wRGlzcGxheUNvbnRlbnQnLCAoKSA9PiB7XHJcbiAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHN1YkNsYXNzUHJvcGVydHkucmVhZCA9IGplc3QuZm4oKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gY29udGFpbmVyIHdpdGggc3ViY2xhc3MgY29udGVudCB3aGVuIHN1YmNsYXNzIGZvdW5kJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LnJlYWQgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdTdWJDbGFzczEnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0VG9wRGlzcGxheUNvbnRlbnQobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC50YWdOYW1lKS50b0JlKCdESVYnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC5jaGlsZHJlbi5sZW5ndGgpLnRvQmUoMSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrU3ViQ2xhc3Nlc1swXS5nZXRUb3BEaXNwbGF5Q29udGVudCkudG9IYXZlQmVlbkNhbGxlZFdpdGgobW9ja0ZpbGUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBlbXB0eSBjb250YWluZXIgd2hlbiBubyBzdWJjbGFzcyBmb3VuZCcsICgpID0+IHtcclxuICAgICAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eS5yZWFkID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnTm9uRXhpc3RlbnRDbGFzcycpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gc3ViQ2xhc3NQcm9wZXJ0eS5nZXRUb3BEaXNwbGF5Q29udGVudChtb2NrRmlsZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LnRhZ05hbWUpLnRvQmUoJ0RJVicpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LmNoaWxkcmVuLmxlbmd0aCkudG9CZSgwKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgbnVsbCByZWFkIHJlc3VsdCcsICgpID0+IHtcclxuICAgICAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eS5yZWFkID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShudWxsKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0VG9wRGlzcGxheUNvbnRlbnQobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC50YWdOYW1lKS50b0JlKCdESVYnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC5jaGlsZHJlbi5sZW5ndGgpLnRvQmUoMCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgY2FsbCBnZXRUb3BEaXNwbGF5Q29udGVudCBvbiBjb3JyZWN0IHN1YmNsYXNzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LnJlYWQgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdTdWJDbGFzczInKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YkNsYXNzUHJvcGVydHkuZ2V0VG9wRGlzcGxheUNvbnRlbnQobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tTdWJDbGFzc2VzWzFdLmdldFRvcERpc3BsYXlDb250ZW50KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChtb2NrRmlsZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrU3ViQ2xhc3Nlc1swXS5nZXRUb3BEaXNwbGF5Q29udGVudCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdpbmhlcml0YW5jZSBmcm9tIFNlbGVjdFByb3BlcnR5JywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgaGF2ZSBvcHRpb25zIHByb3BlcnR5IGZyb20gcGFyZW50JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3Qoc3ViQ2xhc3NQcm9wZXJ0eS5vcHRpb25zKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICAgICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShzdWJDbGFzc1Byb3BlcnR5Lm9wdGlvbnMpKS50b0JlKHRydWUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhdmUgbmFtZSBwcm9wZXJ0eSBmcm9tIHBhcmVudCcsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KHN1YkNsYXNzUHJvcGVydHkubmFtZSkudG9CZSgndGVzdFN1YkNsYXNzJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGF2ZSBmaWxsRGlzcGxheSBtZXRob2QgZnJvbSBwYXJlbnQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0eXBlb2Ygc3ViQ2xhc3NQcm9wZXJ0eS5maWxsRGlzcGxheSkudG9CZSgnZnVuY3Rpb24nKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYXZlIHJlYWQgbWV0aG9kIGZyb20gcGFyZW50JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QodHlwZW9mIHN1YkNsYXNzUHJvcGVydHkucmVhZCkudG9CZSgnZnVuY3Rpb24nKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdpbnRlZ3JhdGlvbiB3aXRoIHN1YmNsYXNzZXMnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBtYWludGFpbiBjb25zaXN0ZW5jeSBiZXR3ZWVuIHN1YkNsYXNzZXMgYW5kIG9wdGlvbnMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChzdWJDbGFzc1Byb3BlcnR5LnN1YkNsYXNzZXMubGVuZ3RoKS50b0JlKHN1YkNsYXNzUHJvcGVydHkub3B0aW9ucy5sZW5ndGgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgc3ViQ2xhc3NQcm9wZXJ0eS5zdWJDbGFzc2VzLmZvckVhY2goKHN1YkNsYXNzLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZXhwZWN0KHN1YkNsYXNzLmdldHN1YkNsYXNzTmFtZSgpKS50b0JlKHN1YkNsYXNzUHJvcGVydHkub3B0aW9uc1tpbmRleF0ubmFtZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBzdWJjbGFzcyBtZXRob2QgY2FsbHMgY29ycmVjdGx5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LnJlYWQgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdTdWJDbGFzczEnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFRlc3QgbXVsdGlwbGUgbWV0aG9kIGNhbGxzXHJcbiAgICAgICAgICAgIHN1YkNsYXNzUHJvcGVydHkuZ2V0U3ViQ2xhc3MobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LmdldFN1YkNsYXNzUHJvcGVydHkobW9ja0ZpbGUpO1xyXG4gICAgICAgICAgICBzdWJDbGFzc1Byb3BlcnR5LmdldFRvcERpc3BsYXlDb250ZW50KG1vY2tGaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFZlcmlmeSBhbGwgbWV0aG9kcyB3ZXJlIGNhbGxlZCBvbiB0aGUgY29ycmVjdCBzdWJjbGFzc1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1N1YkNsYXNzZXNbMF0uZ2V0c3ViQ2xhc3NOYW1lKS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrU3ViQ2xhc3Nlc1swXS5nZXRQcm9wZXJ0aWVzKS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrU3ViQ2xhc3Nlc1swXS5nZXRUb3BEaXNwbGF5Q29udGVudCkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn0pO1xyXG4iXSwidmVyc2lvbiI6M30=