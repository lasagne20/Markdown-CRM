{"version":3,"names":["cov_sxci7xf7c","actualCoverage","s","Property_1","require","LinkProperty","Property","constructor","name","vault","args","b","icon","f","type","createIconContainer","update","iconContainer","style","cursor","static","onclick","event","modifyField","validate","url","fixedUrl","trim","test","urlRegex","getPretty","value","urlObj","URL","pretty","hostname","pathname","segments","split","filter","Boolean","length","slice","join","replace","createFieldLink","link","document","createElement","href","getLink","textContent","classList","add","oncontextmenu","preventDefault","navigator","clipboard","writeText","then","app","sendNotice","exports"],"sources":["C:\\Users\\leodu\\Documents\\1 - Pro\\Test plugin obsidian\\.obsidian\\plugins\\obsidian-CRM\\dynamic-fields\\src\\properties\\LinkProperty.ts"],"sourcesContent":["import { Property } from \"./Property\";\r\nimport { Vault } from \"../vault/Vault\";\r\n\r\n\r\n\r\nexport class LinkProperty extends Property{\r\n\r\n  override type : string = \"link\";\r\n\r\n  constructor(name: string, vault: Vault, args: { icon?: string} = { icon: \"square-arrow-out-up-right\" }) {\r\n    super(name, vault, args);\r\n  }\r\n\r\n  override createIconContainer(update: (value: string) => Promise<void>) {\r\n    const iconContainer = super.createIconContainer(update);\r\n    iconContainer.style.cursor = \"pointer\";\r\n\r\n    if (!this.static) {\r\n      iconContainer.onclick = (event) => this.modifyField(event);\r\n    }\r\n\r\n    return iconContainer;\r\n  }\r\n\r\n\r\n    override validate(url: string) {\r\n      // Ajoute le préfixe \"http://\" si l'URL ne commence pas par http:// ou https://\r\n      let fixedUrl = url.trim();\r\n  \r\n      // Si le lien ne commence pas par http:// ou https://, ajoute \"http://\"\r\n      if (!/^https?:\\/\\//i.test(fixedUrl)) {\r\n          fixedUrl = \"http://\" + fixedUrl;\r\n      }\r\n      const urlRegex = /^(https?:\\/\\/)?([a-zA-Z0-9_-]+\\.)+[a-zA-Z]{2,6}(\\/[a-zA-Z0-9_-]+)*\\/?$/;\r\n      if (!urlRegex.test(fixedUrl)) {\r\n          return \"\";\r\n      }\r\n      return fixedUrl;\r\n    }\r\n\r\n\r\n    override getPretty(value: string) {\r\n      if (!value) return value;\r\n      try {\r\n        const urlObj = new URL(value);\r\n        // Garde le domaine, puis les premiers segments du chemin si trop long\r\n        let pretty = urlObj.hostname;\r\n        if (urlObj.pathname && urlObj.pathname !== \"/\") {\r\n          const segments = urlObj.pathname.split(\"/\").filter(Boolean);\r\n          if (segments.length > 2) {\r\n            pretty += \"/\" + segments.slice(0, 2).join(\"/\") + \"/...\";\r\n          } else {\r\n            pretty += urlObj.pathname;\r\n          }\r\n        }\r\n        return pretty;\r\n      } catch {\r\n        // Si ce n'est pas une URL valide, retourne la valeur d'origine sans protocole\r\n        return value.replace(/^https?:\\/\\//, \"\");\r\n      }\r\n    }\r\n\r\n    // Fonction pour créer le lien de l'field\r\n    override createFieldLink(value: string) : any {\r\n      const link = document.createElement(\"a\");\r\n      link.href = this.getLink(value);\r\n      link.textContent = this.getPretty(value) || \"\";\r\n      link.classList.add(\"field-link\");\r\n      link.oncontextmenu = (event) => {\r\n        event.preventDefault();\r\n        const value = link.textContent;\r\n        if (value) {\r\n            navigator.clipboard.writeText(value).then(() => {\r\n            this.vault.app.sendNotice(\"Lien copié dans le presse-papiers\");\r\n          });\r\n        }\r\n      };\r\n      return link;\r\n    }\r\n}"],"mappings":"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","ignoreList":[]}