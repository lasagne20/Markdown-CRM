{"version":3,"names":["cov_1vha5z0nuy","actualCoverage","s","Classe_1","require","ConfigLoader_1","ClassConfigManager","constructor","configPath","app","f","loadedClasses","Map","configLoader","ConfigLoader","createDynamicClasse","className","has","b","get","config","loadClassConfig","DynamicClasse","Classe","vault","file","name","icon","classIcon","getConstructor","populate","args","getTopDisplayContent","container","document","createElement","display","containers","containerConfig","displayContainer","createDisplayContainer","appendChild","properties","property","Object","values","getProperties","getDisplay","classList","add","type","title","textContent","propName","getProperty","Properties","parentProperty","createProperty","key","propConfig","entries","subClassesProperty","set","getClassConfig","getAvailableClasses","getAllClassNames","clearCache","clear","exports"],"sources":["C:\\Users\\leodu\\Documents\\1 - Pro\\Test plugin obsidian\\.obsidian\\plugins\\obsidian-CRM\\dynamic-fields\\src\\Config\\ClassConfigManager.ts"],"sourcesContent":["import { Classe } from '../vault/Classe';\r\nimport { FileProperty } from '../properties/FileProperty';\r\nimport { MultiFileProperty } from '../properties/MultiFileProperty';\r\nimport { ObjectProperty } from '../properties/ObjectProperty';\r\nimport { Property } from '../properties/Property';\r\nimport { SubClassProperty } from '../properties/SubClassProperty';\r\nimport { ConfigLoader } from './ConfigLoader';\r\nimport { ClassConfig, DisplayContainer } from './interfaces';\r\n\r\nexport class ClassConfigManager {\r\n    private configLoader: ConfigLoader;\r\n    private loadedClasses: Map<string, typeof Classe> = new Map();\r\n\r\n    constructor(configPath: string, app?: any) {\r\n        this.configLoader = new ConfigLoader(configPath, app);\r\n    }\r\n\r\n    /**\r\n     * Create a dynamic Classe from configuration\r\n     */\r\n    async createDynamicClasse(className: string): Promise<typeof Classe> {\r\n        if (this.loadedClasses.has(className)) {\r\n            return this.loadedClasses.get(className)!;\r\n        }\r\n\r\n        const config = await this.configLoader.loadClassConfig(className);\r\n        \r\n        class DynamicClasse extends Classe {\r\n            public override name = config.className;\r\n            public override icon = config.classIcon;\r\n            \r\n            public static parentProperty: FileProperty | MultiFileProperty | ObjectProperty;\r\n            public static subClassesProperty: SubClassProperty;\r\n            public static Properties: { [key: string]: Property } = {};\r\n\r\n            constructor(app: any, vault: any, file: any) {\r\n                super(app, vault, file);\r\n            }\r\n\r\n            static getConstructor(): typeof DynamicClasse {\r\n                return DynamicClasse;\r\n            }\r\n\r\n            getConstructor(): typeof DynamicClasse {\r\n                return DynamicClasse;\r\n            }\r\n\r\n            async populate(...args: any[]): Promise<void> {\r\n                // Default implementation - can be overridden in config if needed\r\n            }\r\n\r\n            getTopDisplayContent(): any {\r\n                const container = document.createElement(\"div\");\r\n                \r\n                if (config.display && config.display.containers) {\r\n                    for (const containerConfig of config.display.containers) {\r\n                        const displayContainer = this.createDisplayContainer(containerConfig);\r\n                        container.appendChild(displayContainer);\r\n                    }\r\n                } else {\r\n                    // Default display: show all properties\r\n                    const properties = document.createElement(\"div\");\r\n                    for (let property of Object.values(this.getProperties())) {\r\n                        properties.appendChild(property.getDisplay(this));\r\n                    }\r\n                    container.appendChild(properties);\r\n                }\r\n                \r\n                return container;\r\n            }\r\n\r\n            private createDisplayContainer(containerConfig: DisplayContainer): HTMLElement {\r\n                const container = document.createElement(\"div\");\r\n                \r\n                if (containerConfig.className) {\r\n                    container.classList.add(containerConfig.className);\r\n                }\r\n                \r\n                // Add CSS class based on container type\r\n                switch (containerConfig.type) {\r\n                    case 'line':\r\n                        container.classList.add(\"metadata-line\");\r\n                        break;\r\n                    case 'column':\r\n                        container.classList.add(\"metadata-column\");\r\n                        break;\r\n                }\r\n                \r\n                if (containerConfig.title) {\r\n                    const title = document.createElement(\"div\");\r\n                    title.textContent = containerConfig.title;\r\n                    title.classList.add(\"metadata-title\");\r\n                    container.appendChild(title);\r\n                }\r\n                \r\n                // Add properties to container\r\n                if (containerConfig.properties) {\r\n                    for (const propName of containerConfig.properties) {\r\n                        const property = this.getProperty(propName);\r\n                        if (property) {\r\n                            container.appendChild(property.getDisplay(this));\r\n                        }\r\n                    }\r\n                }\r\n                \r\n                return container;\r\n            }\r\n        }\r\n\r\n        // Initialize static properties\r\n        if (config.parentProperty) {\r\n            DynamicClasse.parentProperty = this.configLoader.createProperty(config.parentProperty) as FileProperty | MultiFileProperty | ObjectProperty;\r\n        }\r\n\r\n\r\n        // Initialize all properties\r\n        for (const [key, propConfig] of Object.entries(config.properties)) {\r\n            if (propConfig.type === 'SubClassProperty' && config.subClassesProperty) {\r\n                // Use the subClassesProperty instead\r\n                DynamicClasse.Properties[key] = DynamicClasse.subClassesProperty;\r\n            } else {\r\n                DynamicClasse.Properties[key] = this.configLoader.createProperty(propConfig);\r\n            }\r\n        }\r\n\r\n        this.loadedClasses.set(className, DynamicClasse);\r\n        return DynamicClasse;\r\n    }\r\n\r\n    /**\r\n     * Get class configuration for display purposes\r\n     */\r\n    async getClassConfig(className: string): Promise<ClassConfig> {\r\n        return await this.configLoader.loadClassConfig(className);\r\n    }\r\n\r\n    /**\r\n     * Get all available class names\r\n     */\r\n    async getAvailableClasses(): Promise<string[]> {\r\n        return await this.configLoader.getAllClassNames();\r\n    }\r\n\r\n    /**\r\n     * Clear the cache and reload configurations\r\n     */\r\n    clearCache(): void {\r\n        this.loadedClasses.clear();\r\n    }\r\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAsBY;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAAAA,cAAA,GAAAE,CAAA;;;;;;;AAtBZ,MAAAC,QAAA;AAAA;AAAA,CAAAH,cAAA,GAAAE,CAAA,OAAAE,OAAA;AAMA,MAAAC,cAAA;AAAA;AAAA,CAAAL,cAAA,GAAAE,CAAA,OAAAE,OAAA;AAGA,MAAaE,kBAAkB;EAI3BC,YAAYC,UAAkB,EAAEC,GAAS;IAAA;IAAAT,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAE,CAAA;IAFjC,KAAAS,aAAa,GAA+B,IAAIC,GAAG,EAAE;IAAC;IAAAZ,cAAA,GAAAE,CAAA;IAG1D,IAAI,CAACW,YAAY,GAAG,IAAIR,cAAA,CAAAS,YAAY,CAACN,UAAU,EAAEC,GAAG,CAAC;EACzD;EAEA;;;EAGA,MAAMM,mBAAmBA,CAACC,SAAiB;IAAA;IAAAhB,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAE,CAAA;IACvC,IAAI,IAAI,CAACS,aAAa,CAACM,GAAG,CAACD,SAAS,CAAC,EAAE;MAAA;MAAAhB,cAAA,GAAAkB,CAAA;MAAAlB,cAAA,GAAAE,CAAA;MACnC,OAAO,IAAI,CAACS,aAAa,CAACQ,GAAG,CAACH,SAAS,CAAE;IAC7C,CAAC;IAAA;IAAA;MAAAhB,cAAA,GAAAkB,CAAA;IAAA;IAED,MAAME,MAAM;IAAA;IAAA,CAAApB,cAAA,GAAAE,CAAA,OAAG,MAAM,IAAI,CAACW,YAAY,CAACQ,eAAe,CAACL,SAAS,CAAC;IAEjE,MAAMM,aAAc;IAAA;IAAA,CAAQnB,QAAA,CAAAoB,MAAM;MAQ9BhB,YAAYE,GAAQ,EAAEe,KAAU,EAAEC,IAAS;QAAA;QAAAzB,cAAA,GAAAU,CAAA;QAAAV,cAAA,GAAAE,CAAA;QACvC,KAAK,CAACO,GAAG,EAAEe,KAAK,EAAEC,IAAI,CAAC;QAAC;QAAAzB,cAAA,GAAAE,CAAA;QARZ,KAAAwB,IAAI,GAAGN,MAAM,CAACJ,SAAS;QAAC;QAAAhB,cAAA,GAAAE,CAAA;QACxB,KAAAyB,IAAI,GAAGP,MAAM,CAACQ,SAAS;MAQvC;MAEA,OAAOC,cAAcA,CAAA;QAAA;QAAA7B,cAAA,GAAAU,CAAA;QAAAV,cAAA,GAAAE,CAAA;QACjB,OAAOoB,aAAa;MACxB;MAEAO,cAAcA,CAAA;QAAA;QAAA7B,cAAA,GAAAU,CAAA;QAAAV,cAAA,GAAAE,CAAA;QACV,OAAOoB,aAAa;MACxB;MAEA,MAAMQ,QAAQA,CAAC,GAAGC,IAAW;QAAA;QAAA/B,cAAA,GAAAU,CAAA;MAE7B,CAAC,CADG;MAGJsB,oBAAoBA,CAAA;QAAA;QAAAhC,cAAA,GAAAU,CAAA;QAChB,MAAMuB,SAAS;QAAA;QAAA,CAAAjC,cAAA,GAAAE,CAAA,QAAGgC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;QAAC;QAAAnC,cAAA,GAAAE,CAAA;QAEhD;QAAI;QAAA,CAAAF,cAAA,GAAAkB,CAAA,UAAAE,MAAM,CAACgB,OAAO;QAAA;QAAA,CAAApC,cAAA,GAAAkB,CAAA,UAAIE,MAAM,CAACgB,OAAO,CAACC,UAAU,GAAE;UAAA;UAAArC,cAAA,GAAAkB,CAAA;UAAAlB,cAAA,GAAAE,CAAA;UAC7C,KAAK,MAAMoC,eAAe,IAAIlB,MAAM,CAACgB,OAAO,CAACC,UAAU,EAAE;YACrD,MAAME,gBAAgB;YAAA;YAAA,CAAAvC,cAAA,GAAAE,CAAA,QAAG,IAAI,CAACsC,sBAAsB,CAACF,eAAe,CAAC;YAAC;YAAAtC,cAAA,GAAAE,CAAA;YACtE+B,SAAS,CAACQ,WAAW,CAACF,gBAAgB,CAAC;UAC3C;QACJ,CAAC,MAAM;UAAA;UAAAvC,cAAA,GAAAkB,CAAA;UACH;UACA,MAAMwB,UAAU;UAAA;UAAA,CAAA1C,cAAA,GAAAE,CAAA,QAAGgC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;UAAC;UAAAnC,cAAA,GAAAE,CAAA;UACjD,KAAK,IAAIyC,QAAQ,IAAIC,MAAM,CAACC,MAAM,CAAC,IAAI,CAACC,aAAa,EAAE,CAAC,EAAE;YAAA;YAAA9C,cAAA,GAAAE,CAAA;YACtDwC,UAAU,CAACD,WAAW,CAACE,QAAQ,CAACI,UAAU,CAAC,IAAI,CAAC,CAAC;UACrD;UAAC;UAAA/C,cAAA,GAAAE,CAAA;UACD+B,SAAS,CAACQ,WAAW,CAACC,UAAU,CAAC;QACrC;QAAC;QAAA1C,cAAA,GAAAE,CAAA;QAED,OAAO+B,SAAS;MACpB;MAEQO,sBAAsBA,CAACF,eAAiC;QAAA;QAAAtC,cAAA,GAAAU,CAAA;QAC5D,MAAMuB,SAAS;QAAA;QAAA,CAAAjC,cAAA,GAAAE,CAAA,QAAGgC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;QAAC;QAAAnC,cAAA,GAAAE,CAAA;QAEhD,IAAIoC,eAAe,CAACtB,SAAS,EAAE;UAAA;UAAAhB,cAAA,GAAAkB,CAAA;UAAAlB,cAAA,GAAAE,CAAA;UAC3B+B,SAAS,CAACe,SAAS,CAACC,GAAG,CAACX,eAAe,CAACtB,SAAS,CAAC;QACtD,CAAC;QAAA;QAAA;UAAAhB,cAAA,GAAAkB,CAAA;QAAA;QAED;QAAAlB,cAAA,GAAAE,CAAA;QACA,QAAQoC,eAAe,CAACY,IAAI;UACxB,KAAK,MAAM;YAAA;YAAAlD,cAAA,GAAAkB,CAAA;YAAAlB,cAAA,GAAAE,CAAA;YACP+B,SAAS,CAACe,SAAS,CAACC,GAAG,CAAC,eAAe,CAAC;YAAC;YAAAjD,cAAA,GAAAE,CAAA;YACzC;UACJ,KAAK,QAAQ;YAAA;YAAAF,cAAA,GAAAkB,CAAA;YAAAlB,cAAA,GAAAE,CAAA;YACT+B,SAAS,CAACe,SAAS,CAACC,GAAG,CAAC,iBAAiB,CAAC;YAAC;YAAAjD,cAAA,GAAAE,CAAA;YAC3C;QACR;QAAC;QAAAF,cAAA,GAAAE,CAAA;QAED,IAAIoC,eAAe,CAACa,KAAK,EAAE;UAAA;UAAAnD,cAAA,GAAAkB,CAAA;UACvB,MAAMiC,KAAK;UAAA;UAAA,CAAAnD,cAAA,GAAAE,CAAA,QAAGgC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;UAAC;UAAAnC,cAAA,GAAAE,CAAA;UAC5CiD,KAAK,CAACC,WAAW,GAAGd,eAAe,CAACa,KAAK;UAAC;UAAAnD,cAAA,GAAAE,CAAA;UAC1CiD,KAAK,CAACH,SAAS,CAACC,GAAG,CAAC,gBAAgB,CAAC;UAAC;UAAAjD,cAAA,GAAAE,CAAA;UACtC+B,SAAS,CAACQ,WAAW,CAACU,KAAK,CAAC;QAChC,CAAC;QAAA;QAAA;UAAAnD,cAAA,GAAAkB,CAAA;QAAA;QAED;QAAAlB,cAAA,GAAAE,CAAA;QACA,IAAIoC,eAAe,CAACI,UAAU,EAAE;UAAA;UAAA1C,cAAA,GAAAkB,CAAA;UAAAlB,cAAA,GAAAE,CAAA;UAC5B,KAAK,MAAMmD,QAAQ,IAAIf,eAAe,CAACI,UAAU,EAAE;YAC/C,MAAMC,QAAQ;YAAA;YAAA,CAAA3C,cAAA,GAAAE,CAAA,QAAG,IAAI,CAACoD,WAAW,CAACD,QAAQ,CAAC;YAAC;YAAArD,cAAA,GAAAE,CAAA;YAC5C,IAAIyC,QAAQ,EAAE;cAAA;cAAA3C,cAAA,GAAAkB,CAAA;cAAAlB,cAAA,GAAAE,CAAA;cACV+B,SAAS,CAACQ,WAAW,CAACE,QAAQ,CAACI,UAAU,CAAC,IAAI,CAAC,CAAC;YACpD,CAAC;YAAA;YAAA;cAAA/C,cAAA,GAAAkB,CAAA;YAAA;UACL;QACJ,CAAC;QAAA;QAAA;UAAAlB,cAAA,GAAAkB,CAAA;QAAA;QAAAlB,cAAA,GAAAE,CAAA;QAED,OAAO+B,SAAS;MACpB;;;;IAzEcX,aAAA,CAAAiC,UAAU,GAAgC,EAAE;IA4E9D;IAAA;IAAAvD,cAAA,GAAAE,CAAA;IACA,IAAIkB,MAAM,CAACoC,cAAc,EAAE;MAAA;MAAAxD,cAAA,GAAAkB,CAAA;MAAAlB,cAAA,GAAAE,CAAA;MACvBoB,aAAa,CAACkC,cAAc,GAAG,IAAI,CAAC3C,YAAY,CAAC4C,cAAc,CAACrC,MAAM,CAACoC,cAAc,CAAsD;IAC/I,CAAC;IAAA;IAAA;MAAAxD,cAAA,GAAAkB,CAAA;IAAA;IAGD;IAAAlB,cAAA,GAAAE,CAAA;IACA,KAAK,MAAM,CAACwD,GAAG,EAAEC,UAAU,CAAC,IAAIf,MAAM,CAACgB,OAAO,CAACxC,MAAM,CAACsB,UAAU,CAAC,EAAE;MAAA;MAAA1C,cAAA,GAAAE,CAAA;MAC/D;MAAI;MAAA,CAAAF,cAAA,GAAAkB,CAAA,WAAAyC,UAAU,CAACT,IAAI,KAAK,kBAAkB;MAAA;MAAA,CAAAlD,cAAA,GAAAkB,CAAA,WAAIE,MAAM,CAACyC,kBAAkB,GAAE;QAAA;QAAA7D,cAAA,GAAAkB,CAAA;QAAAlB,cAAA,GAAAE,CAAA;QACrE;QACAoB,aAAa,CAACiC,UAAU,CAACG,GAAG,CAAC,GAAGpC,aAAa,CAACuC,kBAAkB;MACpE,CAAC,MAAM;QAAA;QAAA7D,cAAA,GAAAkB,CAAA;QAAAlB,cAAA,GAAAE,CAAA;QACHoB,aAAa,CAACiC,UAAU,CAACG,GAAG,CAAC,GAAG,IAAI,CAAC7C,YAAY,CAAC4C,cAAc,CAACE,UAAU,CAAC;MAChF;IACJ;IAAC;IAAA3D,cAAA,GAAAE,CAAA;IAED,IAAI,CAACS,aAAa,CAACmD,GAAG,CAAC9C,SAAS,EAAEM,aAAa,CAAC;IAAC;IAAAtB,cAAA,GAAAE,CAAA;IACjD,OAAOoB,aAAa;EACxB;EAEA;;;EAGA,MAAMyC,cAAcA,CAAC/C,SAAiB;IAAA;IAAAhB,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAE,CAAA;IAClC,OAAO,MAAM,IAAI,CAACW,YAAY,CAACQ,eAAe,CAACL,SAAS,CAAC;EAC7D;EAEA;;;EAGA,MAAMgD,mBAAmBA,CAAA;IAAA;IAAAhE,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAE,CAAA;IACrB,OAAO,MAAM,IAAI,CAACW,YAAY,CAACoD,gBAAgB,EAAE;EACrD;EAEA;;;EAGAC,UAAUA,CAAA;IAAA;IAAAlE,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAE,CAAA;IACN,IAAI,CAACS,aAAa,CAACwD,KAAK,EAAE;EAC9B;;AACH;AAAAnE,cAAA,GAAAE,CAAA;AA5IDkE,OAAA,CAAA9D,kBAAA,GAAAA,kBAAA","ignoreList":[]}