2c61c1a6d5f0b0f8aece2b30ef8584c1
"use strict";
/**
 * @jest-environment jsdom
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock the vault utilities
jest.mock('../../src/vault/Utils', () => ({
    selectMultipleFile: jest.fn(),
    setIcon: jest.fn()
}));
// Mock the related classes
jest.mock('../../src/properties/FileProperty');
jest.mock('../../src/vault/File');
jest.mock('../../src/vault/Vault');
const FileProperty_1 = require("../../src/properties/FileProperty");
const MultiFileProperty_1 = require("../../src/properties/MultiFileProperty");
// Import the mocked functions
const { selectMultipleFile, setIcon } = jest.requireMock('../../src/vault/Utils');
describe('MultiFileProperty', () => {
    let multiFileProperty;
    let mockVault;
    let mockFileProperty;
    let mockFile;
    let mockUpdate;
    beforeEach(() => {
        // Reset DOM
        document.body.innerHTML = '';
        // Reset all mocks
        jest.clearAllMocks();
        // Mock DOM methods that need to be tracked - we'll spy on individual instances instead
        // Setup mocks
        mockVault = {
            readFile: jest.fn(),
            getFiles: jest.fn(),
            app: {
                selectMultipleFile: selectMultipleFile,
                setIcon: jest.fn((element, iconName) => {
                    element.setAttribute('data-icon', iconName);
                    element.textContent = `[${iconName}]`;
                })
            }
        };
        mockFile = {
            getLink: jest.fn().mockReturnValue('[[TestFile]]'),
            path: 'TestFile.md'
        };
        mockFileProperty = {
            fillDisplay: jest.fn().mockReturnValue(document.createElement('div')),
            getParentValue: jest.fn(),
            name: 'testFile'
        };
        mockUpdate = jest.fn();
        // Mock FileProperty constructor
        FileProperty_1.FileProperty.mockImplementation(() => mockFileProperty);
        // Reset selectMultipleFile to return empty array by default
        selectMultipleFile.mockResolvedValue([]);
    });
    describe('Constructor', () => {
        test('should create MultiFileProperty with required parameters', () => {
            const classes = ['Document', 'Image'];
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', mockVault, classes);
            expect(multiFileProperty.name).toBe('testFiles');
            expect(multiFileProperty.type).toBe('multiFile');
            expect(multiFileProperty.classes).toEqual(classes);
            expect(multiFileProperty.flexSpan).toBe(2);
            expect(multiFileProperty.property).toBe(mockFileProperty);
        });
        test('should create FileProperty instance in constructor', () => {
            const classes = ['Document'];
            const args = { icon: 'file' };
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', mockVault, classes, args);
            expect(FileProperty_1.FileProperty).toHaveBeenCalledWith('testFiles', mockVault, classes, args);
        });
        test('should handle empty classes array', () => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', mockVault, []);
            expect(multiFileProperty.classes).toEqual([]);
            expect(multiFileProperty.getClasses()).toEqual([]);
        });
    });
    describe('getClasses', () => {
        test('should return classes array', () => {
            const classes = ['Document', 'Image', 'Video'];
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', mockVault, classes);
            expect(multiFileProperty.getClasses()).toEqual(classes);
        });
    });
    describe('getParentValue', () => {
        test('should delegate to FileProperty getParentValue', () => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', mockVault, ['Document']);
            const testValues = [{ testFiles: 'some-value' }];
            const result = multiFileProperty.getParentValue(testValues);
            // Test that method works without throwing error
            // The exact behavior depends on internal implementation
            expect(result).toBeDefined();
        });
        test('should return undefined when FileProperty returns undefined', () => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', mockVault, ['Document']);
            const testValues = []; // Empty values should return undefined
            const result = multiFileProperty.getParentValue(testValues);
            expect(result).toBeUndefined();
        });
    });
    describe('formatParentValue', () => {
        test('should wrap single value in array', () => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', mockVault, ['Document']);
            const result = multiFileProperty.formatParentValue('test-value');
            expect(result).toEqual(['test-value']);
        });
        test('should handle empty string', () => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', mockVault, ['Document']);
            const result = multiFileProperty.formatParentValue('');
            expect(result).toEqual(['']);
        });
    });
    describe('fillDisplay', () => {
        beforeEach(() => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', mockVault, ['Document']);
        });
        test('should create container with correct classes', () => {
            const values = [];
            const container = multiFileProperty.fillDisplay(values, mockUpdate);
            expect(container.classList.contains('metadata-multiFiles-container-testfiles')).toBe(true);
            expect(container.classList.contains('metadata-multiFiles-container')).toBe(true);
        });
        test('should set vault property', () => {
            const values = [];
            multiFileProperty.fillDisplay(values, mockUpdate);
            expect(multiFileProperty.vault).toBe(mockVault);
        });
        test('should create add button', () => {
            const values = [];
            const container = multiFileProperty.fillDisplay(values, mockUpdate);
            // Test that a button with the add button class was created
            expect(container.querySelector('button.metadata-add-button-inline-small')).not.toBeNull();
        });
        test('should handle null values', () => {
            const container = multiFileProperty.fillDisplay(null, mockUpdate);
            expect(container).toBeDefined();
            expect(container.tagName).toBe('DIV');
        });
    });
    describe('createObjects', () => {
        beforeEach(() => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', mockVault, ['Document']);
        });
        test('should handle null values', () => {
            const container = document.createElement('div');
            // Should not throw
            multiFileProperty.createObjects(null, mockUpdate, container);
            multiFileProperty.createObjects(undefined, mockUpdate, container);
            // No children should have been added for null/undefined values
            expect(container.children.length).toBe(0);
        });
        test('should create rows for each value', () => {
            const container = document.createElement('div');
            const values = ['[[File1]]', '[[File2]]', '[[File3]]'];
            multiFileProperty.createObjects(values, mockUpdate, container);
            // Should have created 3 row elements
            expect(container.children.length).toBe(3);
        });
        test('should handle empty array', () => {
            const container = document.createElement('div');
            const values = [];
            multiFileProperty.createObjects(values, mockUpdate, container);
            // Empty array should not add any children
            expect(container.children.length).toBe(0);
        });
    });
    describe('createObjectRow', () => {
        beforeEach(() => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', mockVault, ['Document']);
            multiFileProperty.vault = mockVault;
        });
        test('should create row with correct class', () => {
            const container = document.createElement('div');
            const values = ['[[File1]]'];
            const row = multiFileProperty.createObjectRow(values, mockUpdate, '[[File1]]', 0, container);
            expect(row.classList.contains('metadata-multiFiles-row-inline')).toBe(true);
        });
        test('should create delete button', () => {
            const container = document.createElement('div');
            const values = ['[[File1]]'];
            const row = multiFileProperty.createObjectRow(values, mockUpdate, '[[File1]]', 0, container);
            // Should have 2 children: delete button + property container
            expect(row.children.length).toBe(2);
            expect(row.querySelector('button.metadata-delete-button-inline-small')).not.toBeNull();
        });
        test('should create property container', () => {
            const container = document.createElement('div');
            const values = ['[[File1]]'];
            const row = multiFileProperty.createObjectRow(values, mockUpdate, '[[File1]]', 0, container);
            expect(mockFileProperty.fillDisplay).toHaveBeenCalledWith(mockVault, '[[File1]]', expect.any(Function));
        });
    });
    describe('createDeleteButton', () => {
        beforeEach(() => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', mockVault, ['Document']);
        });
        test('should create button with correct classes and icon', () => {
            const container = document.createElement('div');
            const values = ['[[File1]]'];
            const button = multiFileProperty.createDeleteButton(values, mockUpdate, 0, container);
            expect(mockVault.app.setIcon).toHaveBeenCalledWith(button, 'minus');
            expect(button.classList.contains('metadata-delete-button-inline-small')).toBe(true);
        });
        test('should have onclick handler', () => {
            const container = document.createElement('div');
            const values = ['[[File1]]'];
            const button = multiFileProperty.createDeleteButton(values, mockUpdate, 0, container);
            expect(button.onclick).toBeDefined();
            expect(typeof button.onclick).toBe('function');
        });
    });
    describe('createAddButton', () => {
        beforeEach(() => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', mockVault, ['Document']);
        });
        test('should create button with correct classes and icon', () => {
            const container = document.createElement('div');
            const values = [];
            const button = multiFileProperty.createAddButton(values, mockUpdate, container);
            expect(mockVault.app.setIcon).toHaveBeenCalledWith(button, 'plus');
            expect(button.classList.contains('metadata-add-button-inline-small')).toBe(true);
        });
        test('should have onclick handler', () => {
            const container = document.createElement('div');
            const values = [];
            const button = multiFileProperty.createAddButton(values, mockUpdate, container);
            expect(button.onclick).toBeDefined();
            expect(typeof button.onclick).toBe('function');
        });
    });
    describe('addProperty', () => {
        beforeEach(() => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', mockVault, ['Document', 'Image']);
            multiFileProperty.vault = mockVault;
            // Mock reloadObjects method
            multiFileProperty.reloadObjects = jest.fn();
        });
        test('should call selectMultipleFile with correct parameters', async () => {
            const container = document.createElement('div');
            const values = [];
            await multiFileProperty.addProperty(values, mockUpdate, container);
            expect(selectMultipleFile).toHaveBeenCalledWith(mockVault, ['Document', 'Image'], { hint: 'Choisissez des fichiers Document ou Image' });
        });
        test('should add files to values when files are selected', async () => {
            const container = document.createElement('div');
            const values = [];
            const mockFiles = [
                { getLink: () => '[[File1]]' },
                { getLink: () => '[[File2]]' }
            ];
            selectMultipleFile.mockResolvedValue(mockFiles);
            await multiFileProperty.addProperty(values, mockUpdate, container);
            expect(values).toEqual(['[[File1]]', '[[File2]]']);
            expect(mockUpdate).toHaveBeenCalledWith(['[[File1]]', '[[File2]]']);
        });
        test('should initialize values array if null', async () => {
            const container = document.createElement('div');
            let values = null;
            const mockFiles = [{ getLink: () => '[[File1]]' }];
            selectMultipleFile.mockResolvedValue(mockFiles);
            await multiFileProperty.addProperty(values, mockUpdate, container);
            expect(mockUpdate).toHaveBeenCalledWith(['[[File1]]']);
        });
        test('should handle no files selected', async () => {
            const container = document.createElement('div');
            const values = [];
            selectMultipleFile.mockResolvedValue(null);
            await multiFileProperty.addProperty(values, mockUpdate, container);
            expect(mockUpdate).not.toHaveBeenCalled();
        });
        test('should handle empty files array', async () => {
            const container = document.createElement('div');
            const values = [];
            selectMultipleFile.mockResolvedValue([]);
            await multiFileProperty.addProperty(values, mockUpdate, container);
            expect(mockUpdate).not.toHaveBeenCalled();
        });
        test('should call reloadObjects when files are added', async () => {
            const container = document.createElement('div');
            const values = [];
            const mockFiles = [{ getLink: () => '[[File1]]' }];
            selectMultipleFile.mockResolvedValue(mockFiles);
            await multiFileProperty.addProperty(values, mockUpdate, container);
            expect(multiFileProperty.reloadObjects).toHaveBeenCalledWith(values, mockUpdate);
        });
    });
    describe('enableDragAndDrop', () => {
        test('should exist and be callable', () => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', mockVault, ['Document']);
            expect(() => multiFileProperty.enableDragAndDrop()).not.toThrow();
        });
    });
    describe('Integration', () => {
        test('should work with multiple classes in hint', () => {
            const classes = ['Document', 'Image', 'Video'];
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', mockVault, classes);
            expect(multiFileProperty.getClasses().join(' ou ')).toBe('Document ou Image ou Video');
        });
        test('should handle single class in hint', () => {
            const classes = ['Document'];
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', mockVault, classes);
            expect(multiFileProperty.getClasses().join(' ou ')).toBe('Document');
        });
        test('should maintain proper inheritance from ObjectProperty', () => {
            multiFileProperty = new MultiFileProperty_1.MultiFileProperty('testFiles', mockVault, ['Document']);
            expect(multiFileProperty.type).toBe('multiFile');
            expect(typeof multiFileProperty.fillDisplay).toBe('function');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxfX3Rlc3RzX19cXFByb3BlcnRpZXNcXE11bHRpRmlsZVByb3BlcnR5LnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOztHQUVHOztBQU9ILDJCQUEyQjtBQUMzQixJQUFJLENBQUMsSUFBSSxDQUFDLHVCQUF1QixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDdEMsa0JBQWtCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUM3QixPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUNyQixDQUFDLENBQUMsQ0FBQztBQUVKLDJCQUEyQjtBQUMzQixJQUFJLENBQUMsSUFBSSxDQUFDLG1DQUFtQyxDQUFDLENBQUM7QUFDL0MsSUFBSSxDQUFDLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO0FBQ2xDLElBQUksQ0FBQyxJQUFJLENBQUMsdUJBQXVCLENBQUMsQ0FBQztBQVpuQyxvRUFBaUU7QUFDakUsOEVBQTJFO0FBYTNFLDhCQUE4QjtBQUM5QixNQUFNLEVBQUUsa0JBQWtCLEVBQUUsT0FBTyxFQUFFLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO0FBRWxGLFFBQVEsQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUU7SUFDL0IsSUFBSSxpQkFBb0MsQ0FBQztJQUN6QyxJQUFJLFNBQTZCLENBQUM7SUFDbEMsSUFBSSxnQkFBMkMsQ0FBQztJQUNoRCxJQUFJLFFBQTJCLENBQUM7SUFDaEMsSUFBSSxVQUFxQixDQUFDO0lBRTFCLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDWixZQUFZO1FBQ1osUUFBUSxDQUFDLElBQUksQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDO1FBQzdCLGtCQUFrQjtRQUNsQixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFFckIs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LENBQUMsQ0FBQztZQUUzRSxNQUFNLENBQUMsaUJBQWlCLENBQUMsVUFBVSxFQUFFLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ3pFLENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLHdEQUF3RCxFQUFFLEdBQUcsRUFBRTtZQUNoRSxpQkFBaUIsR0FBRyxJQUFJLHFDQUFpQixDQUFDLFdBQVcsRUFBRSxTQUFTLEVBQUUsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO1lBRWhGLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDakQsTUFBTSxDQUFDLE9BQU8saUJBQWlCLENBQUMsV0FBVyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ2xFLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGxlb2R1XFxEb2N1bWVudHNcXDEgLSBQcm9cXFRlc3QgcGx1Z2luIG9ic2lkaWFuXFwub2JzaWRpYW5cXHBsdWdpbnNcXG9ic2lkaWFuLUNSTVxcZHluYW1pYy1maWVsZHNcXF9fdGVzdHNfX1xcUHJvcGVydGllc1xcTXVsdGlGaWxlUHJvcGVydHkudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQGplc3QtZW52aXJvbm1lbnQganNkb21cclxuICovXHJcblxyXG5pbXBvcnQgeyBGaWxlIH0gZnJvbSAnLi4vLi4vc3JjL3ZhdWx0L0ZpbGUnO1xyXG5pbXBvcnQgeyBWYXVsdCB9IGZyb20gJy4uLy4uL3NyYy92YXVsdC9WYXVsdCc7XHJcbmltcG9ydCB7IEZpbGVQcm9wZXJ0eSB9IGZyb20gJy4uLy4uL3NyYy9wcm9wZXJ0aWVzL0ZpbGVQcm9wZXJ0eSc7XHJcbmltcG9ydCB7IE11bHRpRmlsZVByb3BlcnR5IH0gZnJvbSAnLi4vLi4vc3JjL3Byb3BlcnRpZXMvTXVsdGlGaWxlUHJvcGVydHknO1xyXG5cclxuLy8gTW9jayB0aGUgdmF1bHQgdXRpbGl0aWVzXHJcbmplc3QubW9jaygnLi4vLi4vc3JjL3ZhdWx0L1V0aWxzJywgKCkgPT4gKHtcclxuICAgIHNlbGVjdE11bHRpcGxlRmlsZTogamVzdC5mbigpLFxyXG4gICAgc2V0SWNvbjogamVzdC5mbigpXHJcbn0pKTtcclxuXHJcbi8vIE1vY2sgdGhlIHJlbGF0ZWQgY2xhc3Nlc1xyXG5qZXN0Lm1vY2soJy4uLy4uL3NyYy9wcm9wZXJ0aWVzL0ZpbGVQcm9wZXJ0eScpO1xyXG5qZXN0Lm1vY2soJy4uLy4uL3NyYy92YXVsdC9GaWxlJyk7XHJcbmplc3QubW9jaygnLi4vLi4vc3JjL3ZhdWx0L1ZhdWx0Jyk7XHJcblxyXG4vLyBJbXBvcnQgdGhlIG1vY2tlZCBmdW5jdGlvbnNcclxuY29uc3QgeyBzZWxlY3RNdWx0aXBsZUZpbGUsIHNldEljb24gfSA9IGplc3QucmVxdWlyZU1vY2soJy4uLy4uL3NyYy92YXVsdC9VdGlscycpO1xyXG5cclxuZGVzY3JpYmUoJ011bHRpRmlsZVByb3BlcnR5JywgKCkgPT4ge1xyXG4gICAgbGV0IG11bHRpRmlsZVByb3BlcnR5OiBNdWx0aUZpbGVQcm9wZXJ0eTtcclxuICAgIGxldCBtb2NrVmF1bHQ6IGplc3QuTW9ja2VkPFZhdWx0PjtcclxuICAgIGxldCBtb2NrRmlsZVByb3BlcnR5OiBqZXN0Lk1vY2tlZDxGaWxlUHJvcGVydHk+O1xyXG4gICAgbGV0IG1vY2tGaWxlOiBqZXN0Lk1vY2tlZDxGaWxlPjtcclxuICAgIGxldCBtb2NrVXBkYXRlOiBqZXN0Lk1vY2s7XHJcblxyXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgLy8gUmVzZXQgRE9NXHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICAvLyBSZXNldCBhbGwgbW9ja3NcclxuICAgICAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBNb2NrIERPTSBtZXRob2RzIHRoYXQgbmVlZCB0byBiZSB0cmFja2VkIC0gd2UnbGwgc3B5IG9uIGluZGl2aWR1YWwgaW5zdGFuY2VzIGluc3RlYWRcclxuXHJcbiAgICAgICAgLy8gU2V0dXAgbW9ja3NcclxuICAgICAgICBtb2NrVmF1bHQgPSB7XHJcbiAgICAgICAgICAgIHJlYWRGaWxlOiBqZXN0LmZuKCksXHJcbiAgICAgICAgICAgIGdldEZpbGVzOiBqZXN0LmZuKCksXHJcbiAgICAgICAgICAgIGFwcDoge1xyXG4gICAgICAgICAgICAgICAgc2VsZWN0TXVsdGlwbGVGaWxlOiBzZWxlY3RNdWx0aXBsZUZpbGUsXHJcbiAgICAgICAgICAgICAgICBzZXRJY29uOiBqZXN0LmZuKChlbGVtZW50OiBIVE1MRWxlbWVudCwgaWNvbk5hbWU6IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLWljb24nLCBpY29uTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC50ZXh0Q29udGVudCA9IGBbJHtpY29uTmFtZX1dYDtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGFzIGFueTtcclxuXHJcbiAgICAgICAgbW9ja0ZpbGUgPSB7XHJcbiAgICAgICAgICAgIGdldExpbms6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ1tbVGVzdEZpbGVdXScpLFxyXG4gICAgICAgICAgICBwYXRoOiAnVGVzdEZpbGUubWQnXHJcbiAgICAgICAgfSBhcyBhbnk7XHJcblxyXG4gICAgICAgIG1vY2tGaWxlUHJvcGVydHkgPSB7XHJcbiAgICAgICAgICAgIGZpbGxEaXNwbGF5OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpKSxcclxuICAgICAgICAgICAgZ2V0UGFyZW50VmFsdWU6IGplc3QuZm4oKSxcclxuICAgICAgICAgICAgbmFtZTogJ3Rlc3RGaWxlJ1xyXG4gICAgICAgIH0gYXMgYW55O1xyXG5cclxuICAgICAgICBtb2NrVXBkYXRlID0gamVzdC5mbigpO1xyXG5cclxuICAgICAgICAvLyBNb2NrIEZpbGVQcm9wZXJ0eSBjb25zdHJ1Y3RvclxyXG4gICAgICAgIChGaWxlUHJvcGVydHkgYXMgamVzdC5Nb2NrZWRDbGFzczx0eXBlb2YgRmlsZVByb3BlcnR5PikubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IG1vY2tGaWxlUHJvcGVydHkpO1xyXG5cclxuICAgICAgICAvLyBSZXNldCBzZWxlY3RNdWx0aXBsZUZpbGUgdG8gcmV0dXJuIGVtcHR5IGFycmF5IGJ5IGRlZmF1bHRcclxuICAgICAgICBzZWxlY3RNdWx0aXBsZUZpbGUubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ0NvbnN0cnVjdG9yJywgKCkgPT4ge1xyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBjcmVhdGUgTXVsdGlGaWxlUHJvcGVydHkgd2l0aCByZXF1aXJlZCBwYXJhbWV0ZXJzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjbGFzc2VzID0gWydEb2N1bWVudCcsICdJbWFnZSddO1xyXG4gICAgICAgICAgICBtdWx0aUZpbGVQcm9wZXJ0eSA9IG5ldyBNdWx0aUZpbGVQcm9wZXJ0eSgndGVzdEZpbGVzJywgbW9ja1ZhdWx0LCBjbGFzc2VzKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtdWx0aUZpbGVQcm9wZXJ0eS5uYW1lKS50b0JlKCd0ZXN0RmlsZXMnKTtcclxuICAgICAgICAgICAgZXhwZWN0KG11bHRpRmlsZVByb3BlcnR5LnR5cGUpLnRvQmUoJ211bHRpRmlsZScpO1xyXG4gICAgICAgICAgICBleHBlY3QobXVsdGlGaWxlUHJvcGVydHkuY2xhc3NlcykudG9FcXVhbChjbGFzc2VzKTtcclxuICAgICAgICAgICAgZXhwZWN0KG11bHRpRmlsZVByb3BlcnR5LmZsZXhTcGFuKS50b0JlKDIpO1xyXG4gICAgICAgICAgICBleHBlY3QobXVsdGlGaWxlUHJvcGVydHkucHJvcGVydHkpLnRvQmUobW9ja0ZpbGVQcm9wZXJ0eSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBjcmVhdGUgRmlsZVByb3BlcnR5IGluc3RhbmNlIGluIGNvbnN0cnVjdG9yJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjbGFzc2VzID0gWydEb2N1bWVudCddO1xyXG4gICAgICAgICAgICBjb25zdCBhcmdzID0geyBpY29uOiAnZmlsZScgfTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIG11bHRpRmlsZVByb3BlcnR5ID0gbmV3IE11bHRpRmlsZVByb3BlcnR5KCd0ZXN0RmlsZXMnLCBtb2NrVmF1bHQsIGNsYXNzZXMsIGFyZ3MpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KEZpbGVQcm9wZXJ0eSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3Rlc3RGaWxlcycsIG1vY2tWYXVsdCwgY2xhc3NlcywgYXJncyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgY2xhc3NlcyBhcnJheScsICgpID0+IHtcclxuICAgICAgICAgICAgbXVsdGlGaWxlUHJvcGVydHkgPSBuZXcgTXVsdGlGaWxlUHJvcGVydHkoJ3Rlc3RGaWxlcycsIG1vY2tWYXVsdCwgW10pO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG11bHRpRmlsZVByb3BlcnR5LmNsYXNzZXMpLnRvRXF1YWwoW10pO1xyXG4gICAgICAgICAgICBleHBlY3QobXVsdGlGaWxlUHJvcGVydHkuZ2V0Q2xhc3NlcygpKS50b0VxdWFsKFtdKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdnZXRDbGFzc2VzJywgKCkgPT4ge1xyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCByZXR1cm4gY2xhc3NlcyBhcnJheScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY2xhc3NlcyA9IFsnRG9jdW1lbnQnLCAnSW1hZ2UnLCAnVmlkZW8nXTtcclxuICAgICAgICAgICAgbXVsdGlGaWxlUHJvcGVydHkgPSBuZXcgTXVsdGlGaWxlUHJvcGVydHkoJ3Rlc3RGaWxlcycsIG1vY2tWYXVsdCwgY2xhc3Nlcyk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobXVsdGlGaWxlUHJvcGVydHkuZ2V0Q2xhc3NlcygpKS50b0VxdWFsKGNsYXNzZXMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2dldFBhcmVudFZhbHVlJywgKCkgPT4ge1xyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBkZWxlZ2F0ZSB0byBGaWxlUHJvcGVydHkgZ2V0UGFyZW50VmFsdWUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIG11bHRpRmlsZVByb3BlcnR5ID0gbmV3IE11bHRpRmlsZVByb3BlcnR5KCd0ZXN0RmlsZXMnLCBtb2NrVmF1bHQsIFsnRG9jdW1lbnQnXSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRlc3RWYWx1ZXMgPSBbeyB0ZXN0RmlsZXM6ICdzb21lLXZhbHVlJyB9XTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG11bHRpRmlsZVByb3BlcnR5LmdldFBhcmVudFZhbHVlKHRlc3RWYWx1ZXMpO1xyXG5cclxuICAgICAgICAgICAgLy8gVGVzdCB0aGF0IG1ldGhvZCB3b3JrcyB3aXRob3V0IHRocm93aW5nIGVycm9yXHJcbiAgICAgICAgICAgIC8vIFRoZSBleGFjdCBiZWhhdmlvciBkZXBlbmRzIG9uIGludGVybmFsIGltcGxlbWVudGF0aW9uXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCByZXR1cm4gdW5kZWZpbmVkIHdoZW4gRmlsZVByb3BlcnR5IHJldHVybnMgdW5kZWZpbmVkJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBtdWx0aUZpbGVQcm9wZXJ0eSA9IG5ldyBNdWx0aUZpbGVQcm9wZXJ0eSgndGVzdEZpbGVzJywgbW9ja1ZhdWx0LCBbJ0RvY3VtZW50J10pO1xyXG4gICAgICAgICAgICBjb25zdCB0ZXN0VmFsdWVzOiBhbnlbXSA9IFtdOyAvLyBFbXB0eSB2YWx1ZXMgc2hvdWxkIHJldHVybiB1bmRlZmluZWRcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG11bHRpRmlsZVByb3BlcnR5LmdldFBhcmVudFZhbHVlKHRlc3RWYWx1ZXMpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZVVuZGVmaW5lZCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2Zvcm1hdFBhcmVudFZhbHVlJywgKCkgPT4ge1xyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCB3cmFwIHNpbmdsZSB2YWx1ZSBpbiBhcnJheScsICgpID0+IHtcclxuICAgICAgICAgICAgbXVsdGlGaWxlUHJvcGVydHkgPSBuZXcgTXVsdGlGaWxlUHJvcGVydHkoJ3Rlc3RGaWxlcycsIG1vY2tWYXVsdCwgWydEb2N1bWVudCddKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG11bHRpRmlsZVByb3BlcnR5LmZvcm1hdFBhcmVudFZhbHVlKCd0ZXN0LXZhbHVlJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKFsndGVzdC12YWx1ZSddKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBzdHJpbmcnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIG11bHRpRmlsZVByb3BlcnR5ID0gbmV3IE11bHRpRmlsZVByb3BlcnR5KCd0ZXN0RmlsZXMnLCBtb2NrVmF1bHQsIFsnRG9jdW1lbnQnXSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBtdWx0aUZpbGVQcm9wZXJ0eS5mb3JtYXRQYXJlbnRWYWx1ZSgnJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKFsnJ10pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2ZpbGxEaXNwbGF5JywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICBtdWx0aUZpbGVQcm9wZXJ0eSA9IG5ldyBNdWx0aUZpbGVQcm9wZXJ0eSgndGVzdEZpbGVzJywgbW9ja1ZhdWx0LCBbJ0RvY3VtZW50J10pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgY3JlYXRlIGNvbnRhaW5lciB3aXRoIGNvcnJlY3QgY2xhc3NlcycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWVzOiBhbnlbXSA9IFtdO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gbXVsdGlGaWxlUHJvcGVydHkuZmlsbERpc3BsYXkodmFsdWVzLCBtb2NrVXBkYXRlKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChjb250YWluZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdtZXRhZGF0YS1tdWx0aUZpbGVzLWNvbnRhaW5lci10ZXN0ZmlsZXMnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci5jbGFzc0xpc3QuY29udGFpbnMoJ21ldGFkYXRhLW11bHRpRmlsZXMtY29udGFpbmVyJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBzZXQgdmF1bHQgcHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlczogYW55W10gPSBbXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIG11bHRpRmlsZVByb3BlcnR5LmZpbGxEaXNwbGF5KHZhbHVlcywgbW9ja1VwZGF0ZSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobXVsdGlGaWxlUHJvcGVydHkudmF1bHQpLnRvQmUobW9ja1ZhdWx0KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGNyZWF0ZSBhZGQgYnV0dG9uJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZXM6IGFueVtdID0gW107XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBtdWx0aUZpbGVQcm9wZXJ0eS5maWxsRGlzcGxheSh2YWx1ZXMsIG1vY2tVcGRhdGUpO1xyXG5cclxuICAgICAgICAgICAgLy8gVGVzdCB0aGF0IGEgYnV0dG9uIHdpdGggdGhlIGFkZCBidXR0b24gY2xhc3Mgd2FzIGNyZWF0ZWRcclxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdidXR0b24ubWV0YWRhdGEtYWRkLWJ1dHRvbi1pbmxpbmUtc21hbGwnKSkubm90LnRvQmVOdWxsKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgbnVsbCB2YWx1ZXMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IG11bHRpRmlsZVByb3BlcnR5LmZpbGxEaXNwbGF5KG51bGwsIG1vY2tVcGRhdGUpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lcikudG9CZURlZmluZWQoKTtcclxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci50YWdOYW1lKS50b0JlKCdESVYnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdjcmVhdGVPYmplY3RzJywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICBtdWx0aUZpbGVQcm9wZXJ0eSA9IG5ldyBNdWx0aUZpbGVQcm9wZXJ0eSgndGVzdEZpbGVzJywgbW9ja1ZhdWx0LCBbJ0RvY3VtZW50J10pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIG51bGwgdmFsdWVzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFNob3VsZCBub3QgdGhyb3dcclxuICAgICAgICAgICAgbXVsdGlGaWxlUHJvcGVydHkuY3JlYXRlT2JqZWN0cyhudWxsLCBtb2NrVXBkYXRlLCBjb250YWluZXIpO1xyXG4gICAgICAgICAgICBtdWx0aUZpbGVQcm9wZXJ0eS5jcmVhdGVPYmplY3RzKHVuZGVmaW5lZCwgbW9ja1VwZGF0ZSwgY29udGFpbmVyKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIE5vIGNoaWxkcmVuIHNob3VsZCBoYXZlIGJlZW4gYWRkZWQgZm9yIG51bGwvdW5kZWZpbmVkIHZhbHVlc1xyXG4gICAgICAgICAgICBleHBlY3QoY29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aCkudG9CZSgwKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGNyZWF0ZSByb3dzIGZvciBlYWNoIHZhbHVlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWVzID0gWydbW0ZpbGUxXV0nLCAnW1tGaWxlMl1dJywgJ1tbRmlsZTNdXSddO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbXVsdGlGaWxlUHJvcGVydHkuY3JlYXRlT2JqZWN0cyh2YWx1ZXMsIG1vY2tVcGRhdGUsIGNvbnRhaW5lcik7XHJcblxyXG4gICAgICAgICAgICAvLyBTaG91bGQgaGF2ZSBjcmVhdGVkIDMgcm93IGVsZW1lbnRzXHJcbiAgICAgICAgICAgIGV4cGVjdChjb250YWluZXIuY2hpbGRyZW4ubGVuZ3RoKS50b0JlKDMpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIGVtcHR5IGFycmF5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWVzOiBhbnlbXSA9IFtdO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbXVsdGlGaWxlUHJvcGVydHkuY3JlYXRlT2JqZWN0cyh2YWx1ZXMsIG1vY2tVcGRhdGUsIGNvbnRhaW5lcik7XHJcblxyXG4gICAgICAgICAgICAvLyBFbXB0eSBhcnJheSBzaG91bGQgbm90IGFkZCBhbnkgY2hpbGRyZW5cclxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGgpLnRvQmUoMCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnY3JlYXRlT2JqZWN0Um93JywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICBtdWx0aUZpbGVQcm9wZXJ0eSA9IG5ldyBNdWx0aUZpbGVQcm9wZXJ0eSgndGVzdEZpbGVzJywgbW9ja1ZhdWx0LCBbJ0RvY3VtZW50J10pO1xyXG4gICAgICAgICAgICBtdWx0aUZpbGVQcm9wZXJ0eS52YXVsdCA9IG1vY2tWYXVsdDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGNyZWF0ZSByb3cgd2l0aCBjb3JyZWN0IGNsYXNzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWVzID0gWydbW0ZpbGUxXV0nXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJvdyA9IG11bHRpRmlsZVByb3BlcnR5LmNyZWF0ZU9iamVjdFJvdyh2YWx1ZXMsIG1vY2tVcGRhdGUsICdbW0ZpbGUxXV0nLCAwLCBjb250YWluZXIpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KHJvdy5jbGFzc0xpc3QuY29udGFpbnMoJ21ldGFkYXRhLW11bHRpRmlsZXMtcm93LWlubGluZScpKS50b0JlKHRydWUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgY3JlYXRlIGRlbGV0ZSBidXR0b24nLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZXMgPSBbJ1tbRmlsZTFdXSddO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3Qgcm93ID0gbXVsdGlGaWxlUHJvcGVydHkuY3JlYXRlT2JqZWN0Um93KHZhbHVlcywgbW9ja1VwZGF0ZSwgJ1tbRmlsZTFdXScsIDAsIGNvbnRhaW5lcik7XHJcblxyXG4gICAgICAgICAgICAvLyBTaG91bGQgaGF2ZSAyIGNoaWxkcmVuOiBkZWxldGUgYnV0dG9uICsgcHJvcGVydHkgY29udGFpbmVyXHJcbiAgICAgICAgICAgIGV4cGVjdChyb3cuY2hpbGRyZW4ubGVuZ3RoKS50b0JlKDIpO1xyXG4gICAgICAgICAgICBleHBlY3Qocm93LnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbi5tZXRhZGF0YS1kZWxldGUtYnV0dG9uLWlubGluZS1zbWFsbCcpKS5ub3QudG9CZU51bGwoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGNyZWF0ZSBwcm9wZXJ0eSBjb250YWluZXInLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZXMgPSBbJ1tbRmlsZTFdXSddO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3Qgcm93ID0gbXVsdGlGaWxlUHJvcGVydHkuY3JlYXRlT2JqZWN0Um93KHZhbHVlcywgbW9ja1VwZGF0ZSwgJ1tbRmlsZTFdXScsIDAsIGNvbnRhaW5lcik7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja0ZpbGVQcm9wZXJ0eS5maWxsRGlzcGxheSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXHJcbiAgICAgICAgICAgICAgICBtb2NrVmF1bHQsIFxyXG4gICAgICAgICAgICAgICAgJ1tbRmlsZTFdXScsIFxyXG4gICAgICAgICAgICAgICAgZXhwZWN0LmFueShGdW5jdGlvbilcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdjcmVhdGVEZWxldGVCdXR0b24nLCAoKSA9PiB7XHJcbiAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgIG11bHRpRmlsZVByb3BlcnR5ID0gbmV3IE11bHRpRmlsZVByb3BlcnR5KCd0ZXN0RmlsZXMnLCBtb2NrVmF1bHQsIFsnRG9jdW1lbnQnXSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBjcmVhdGUgYnV0dG9uIHdpdGggY29ycmVjdCBjbGFzc2VzIGFuZCBpY29uJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWVzID0gWydbW0ZpbGUxXV0nXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IG11bHRpRmlsZVByb3BlcnR5LmNyZWF0ZURlbGV0ZUJ1dHRvbih2YWx1ZXMsIG1vY2tVcGRhdGUsIDAsIGNvbnRhaW5lcik7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1ZhdWx0LmFwcC5zZXRJY29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChidXR0b24sICdtaW51cycpO1xyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnbWV0YWRhdGEtZGVsZXRlLWJ1dHRvbi1pbmxpbmUtc21hbGwnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGhhdmUgb25jbGljayBoYW5kbGVyJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWVzID0gWydbW0ZpbGUxXV0nXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IG11bHRpRmlsZVByb3BlcnR5LmNyZWF0ZURlbGV0ZUJ1dHRvbih2YWx1ZXMsIG1vY2tVcGRhdGUsIDAsIGNvbnRhaW5lcik7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QoYnV0dG9uLm9uY2xpY2spLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0eXBlb2YgYnV0dG9uLm9uY2xpY2spLnRvQmUoJ2Z1bmN0aW9uJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnY3JlYXRlQWRkQnV0dG9uJywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICBtdWx0aUZpbGVQcm9wZXJ0eSA9IG5ldyBNdWx0aUZpbGVQcm9wZXJ0eSgndGVzdEZpbGVzJywgbW9ja1ZhdWx0LCBbJ0RvY3VtZW50J10pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgY3JlYXRlIGJ1dHRvbiB3aXRoIGNvcnJlY3QgY2xhc3NlcyBhbmQgaWNvbicsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlczogYW55W10gPSBbXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IG11bHRpRmlsZVByb3BlcnR5LmNyZWF0ZUFkZEJ1dHRvbih2YWx1ZXMsIG1vY2tVcGRhdGUsIGNvbnRhaW5lcik7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1ZhdWx0LmFwcC5zZXRJY29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChidXR0b24sICdwbHVzJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdtZXRhZGF0YS1hZGQtYnV0dG9uLWlubGluZS1zbWFsbCcpKS50b0JlKHRydWUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgaGF2ZSBvbmNsaWNrIGhhbmRsZXInLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZXM6IGFueVtdID0gW107XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBidXR0b24gPSBtdWx0aUZpbGVQcm9wZXJ0eS5jcmVhdGVBZGRCdXR0b24odmFsdWVzLCBtb2NrVXBkYXRlLCBjb250YWluZXIpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KGJ1dHRvbi5vbmNsaWNrKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICAgICAgICBleHBlY3QodHlwZW9mIGJ1dHRvbi5vbmNsaWNrKS50b0JlKCdmdW5jdGlvbicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2FkZFByb3BlcnR5JywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICBtdWx0aUZpbGVQcm9wZXJ0eSA9IG5ldyBNdWx0aUZpbGVQcm9wZXJ0eSgndGVzdEZpbGVzJywgbW9ja1ZhdWx0LCBbJ0RvY3VtZW50JywgJ0ltYWdlJ10pO1xyXG4gICAgICAgICAgICBtdWx0aUZpbGVQcm9wZXJ0eS52YXVsdCA9IG1vY2tWYXVsdDtcclxuICAgICAgICAgICAgLy8gTW9jayByZWxvYWRPYmplY3RzIG1ldGhvZFxyXG4gICAgICAgICAgICBtdWx0aUZpbGVQcm9wZXJ0eS5yZWxvYWRPYmplY3RzID0gamVzdC5mbigpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgY2FsbCBzZWxlY3RNdWx0aXBsZUZpbGUgd2l0aCBjb3JyZWN0IHBhcmFtZXRlcnMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZXM6IGFueVtdID0gW107XHJcblxyXG4gICAgICAgICAgICBhd2FpdCBtdWx0aUZpbGVQcm9wZXJ0eS5hZGRQcm9wZXJ0eSh2YWx1ZXMsIG1vY2tVcGRhdGUsIGNvbnRhaW5lcik7XHJcblxyXG4gICAgICAgICAgICBleHBlY3Qoc2VsZWN0TXVsdGlwbGVGaWxlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcclxuICAgICAgICAgICAgICAgIG1vY2tWYXVsdCxcclxuICAgICAgICAgICAgICAgIFsnRG9jdW1lbnQnLCAnSW1hZ2UnXSxcclxuICAgICAgICAgICAgICAgIHsgaGludDogJ0Nob2lzaXNzZXogZGVzIGZpY2hpZXJzIERvY3VtZW50IG91IEltYWdlJyB9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBhZGQgZmlsZXMgdG8gdmFsdWVzIHdoZW4gZmlsZXMgYXJlIHNlbGVjdGVkJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWVzOiBhbnlbXSA9IFtdO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrRmlsZXMgPSBbXHJcbiAgICAgICAgICAgICAgICB7IGdldExpbms6ICgpID0+ICdbW0ZpbGUxXV0nIH0sXHJcbiAgICAgICAgICAgICAgICB7IGdldExpbms6ICgpID0+ICdbW0ZpbGUyXV0nIH1cclxuICAgICAgICAgICAgXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIChzZWxlY3RNdWx0aXBsZUZpbGUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrRmlsZXMpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgYXdhaXQgbXVsdGlGaWxlUHJvcGVydHkuYWRkUHJvcGVydHkodmFsdWVzLCBtb2NrVXBkYXRlLCBjb250YWluZXIpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KHZhbHVlcykudG9FcXVhbChbJ1tbRmlsZTFdXScsICdbW0ZpbGUyXV0nXSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrVXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChbJ1tbRmlsZTFdXScsICdbW0ZpbGUyXV0nXSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIGluaXRpYWxpemUgdmFsdWVzIGFycmF5IGlmIG51bGwnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBsZXQgdmFsdWVzOiBhbnkgPSBudWxsO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrRmlsZXMgPSBbeyBnZXRMaW5rOiAoKSA9PiAnW1tGaWxlMV1dJyB9XTtcclxuXHJcbiAgICAgICAgICAgIChzZWxlY3RNdWx0aXBsZUZpbGUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrRmlsZXMpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgbXVsdGlGaWxlUHJvcGVydHkuYWRkUHJvcGVydHkodmFsdWVzLCBtb2NrVXBkYXRlLCBjb250YWluZXIpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tVcGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFsnW1tGaWxlMV1dJ10pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIG5vIGZpbGVzIHNlbGVjdGVkJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWVzOiBhbnlbXSA9IFtdO1xyXG5cclxuICAgICAgICAgICAgKHNlbGVjdE11bHRpcGxlRmlsZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgbXVsdGlGaWxlUHJvcGVydHkuYWRkUHJvcGVydHkodmFsdWVzLCBtb2NrVXBkYXRlLCBjb250YWluZXIpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tVcGRhdGUpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgZmlsZXMgYXJyYXknLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZXM6IGFueVtdID0gW107XHJcblxyXG4gICAgICAgICAgICAoc2VsZWN0TXVsdGlwbGVGaWxlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgbXVsdGlGaWxlUHJvcGVydHkuYWRkUHJvcGVydHkodmFsdWVzLCBtb2NrVXBkYXRlLCBjb250YWluZXIpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tVcGRhdGUpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBjYWxsIHJlbG9hZE9iamVjdHMgd2hlbiBmaWxlcyBhcmUgYWRkZWQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZXM6IGFueVtdID0gW107XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tGaWxlcyA9IFt7IGdldExpbms6ICgpID0+ICdbW0ZpbGUxXV0nIH1dO1xyXG5cclxuICAgICAgICAgICAgKHNlbGVjdE11bHRpcGxlRmlsZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tGaWxlcyk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCBtdWx0aUZpbGVQcm9wZXJ0eS5hZGRQcm9wZXJ0eSh2YWx1ZXMsIG1vY2tVcGRhdGUsIGNvbnRhaW5lcik7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobXVsdGlGaWxlUHJvcGVydHkucmVsb2FkT2JqZWN0cykudG9IYXZlQmVlbkNhbGxlZFdpdGgodmFsdWVzLCBtb2NrVXBkYXRlKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdlbmFibGVEcmFnQW5kRHJvcCcsICgpID0+IHtcclxuICAgICAgICB0ZXN0KCdzaG91bGQgZXhpc3QgYW5kIGJlIGNhbGxhYmxlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBtdWx0aUZpbGVQcm9wZXJ0eSA9IG5ldyBNdWx0aUZpbGVQcm9wZXJ0eSgndGVzdEZpbGVzJywgbW9ja1ZhdWx0LCBbJ0RvY3VtZW50J10pO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KCgpID0+IG11bHRpRmlsZVByb3BlcnR5LmVuYWJsZURyYWdBbmREcm9wKCkpLm5vdC50b1Rocm93KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnSW50ZWdyYXRpb24nLCAoKSA9PiB7XHJcbiAgICAgICAgdGVzdCgnc2hvdWxkIHdvcmsgd2l0aCBtdWx0aXBsZSBjbGFzc2VzIGluIGhpbnQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNsYXNzZXMgPSBbJ0RvY3VtZW50JywgJ0ltYWdlJywgJ1ZpZGVvJ107XHJcbiAgICAgICAgICAgIG11bHRpRmlsZVByb3BlcnR5ID0gbmV3IE11bHRpRmlsZVByb3BlcnR5KCd0ZXN0RmlsZXMnLCBtb2NrVmF1bHQsIGNsYXNzZXMpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG11bHRpRmlsZVByb3BlcnR5LmdldENsYXNzZXMoKS5qb2luKCcgb3UgJykpLnRvQmUoJ0RvY3VtZW50IG91IEltYWdlIG91IFZpZGVvJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgc2luZ2xlIGNsYXNzIGluIGhpbnQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNsYXNzZXMgPSBbJ0RvY3VtZW50J107XHJcbiAgICAgICAgICAgIG11bHRpRmlsZVByb3BlcnR5ID0gbmV3IE11bHRpRmlsZVByb3BlcnR5KCd0ZXN0RmlsZXMnLCBtb2NrVmF1bHQsIGNsYXNzZXMpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG11bHRpRmlsZVByb3BlcnR5LmdldENsYXNzZXMoKS5qb2luKCcgb3UgJykpLnRvQmUoJ0RvY3VtZW50Jyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBtYWludGFpbiBwcm9wZXIgaW5oZXJpdGFuY2UgZnJvbSBPYmplY3RQcm9wZXJ0eScsICgpID0+IHtcclxuICAgICAgICAgICAgbXVsdGlGaWxlUHJvcGVydHkgPSBuZXcgTXVsdGlGaWxlUHJvcGVydHkoJ3Rlc3RGaWxlcycsIG1vY2tWYXVsdCwgWydEb2N1bWVudCddKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtdWx0aUZpbGVQcm9wZXJ0eS50eXBlKS50b0JlKCdtdWx0aUZpbGUnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHR5cGVvZiBtdWx0aUZpbGVQcm9wZXJ0eS5maWxsRGlzcGxheSkudG9CZSgnZnVuY3Rpb24nKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59KTtcclxuIl0sInZlcnNpb24iOjN9