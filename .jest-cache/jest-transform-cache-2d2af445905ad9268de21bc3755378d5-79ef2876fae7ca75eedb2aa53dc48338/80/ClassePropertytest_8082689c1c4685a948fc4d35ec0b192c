895e04735e9bdbabf115aa8b1e4bf146
"use strict";
/**
 * @jest-environment jsdom
 */
Object.defineProperty(exports, "__esModule", { value: true });
jest.mock('../../vault/Utils', () => ({
    setIcon: jest.fn()
}));
const ClasseProperty_1 = require("../../properties/ClasseProperty");
const Property_1 = require("../../properties/Property");
// Import the mocked function for use in tests
const { setIcon } = jest.requireMock('../../vault/Utils');
describe('ClasseProperty', () => {
    let classeProperty;
    beforeEach(() => {
        // Reset DOM mocks
        document.body.innerHTML = '';
        jest.clearAllMocks();
    });
    beforeEach(() => {
        classeProperty = new ClasseProperty_1.ClasseProperty('testClasse');
    });
    describe('constructor', () => {
        it('should create ClasseProperty with correct type', () => {
            expect(classeProperty.type).toBe('class');
        });
        it('should inherit from Property', () => {
            expect(classeProperty).toBeInstanceOf(Property_1.Property);
        });
        it('should use empty icon by default', () => {
            const defaultProperty = new ClasseProperty_1.ClasseProperty('defaultTest');
            expect(defaultProperty.name).toBe('defaultTest');
            expect(defaultProperty.type).toBe('class');
        });
        it('should accept custom icon', () => {
            const customProperty = new ClasseProperty_1.ClasseProperty('customName', 'custom-icon');
            expect(customProperty.name).toBe('customName');
            expect(customProperty.icon).toBe('custom-icon');
        });
        it('should handle empty string icon', () => {
            const emptyIconProperty = new ClasseProperty_1.ClasseProperty('emptyIcon', '');
            expect(emptyIconProperty.name).toBe('emptyIcon');
            expect(emptyIconProperty.icon).toBe('');
        });
    });
    describe('fillDisplay', () => {
        it('should create field with correct structure', () => {
            const mockVault = {};
            const mockUpdate = jest.fn();
            const value = 'Test Class Value';
            const result = classeProperty.fillDisplay(mockVault, value, mockUpdate);
            expect(result.tagName).toBe('DIV');
            expect(result.classList.contains('metadata-field')).toBe(true);
        });
        it('should create label with correct text content', () => {
            const mockVault = {};
            const mockUpdate = jest.fn();
            const value = 'Test Class Value';
            const result = classeProperty.fillDisplay(mockVault, value, mockUpdate);
            const label = result.querySelector('label');
            expect(label).toBeTruthy();
            expect(label?.textContent).toBe(value);
        });
        it('should set vault property', () => {
            const mockVault = { files: [] };
            const mockUpdate = jest.fn();
            const value = 'Test Value';
            classeProperty.fillDisplay(mockVault, value, mockUpdate);
            expect(classeProperty.vault).toBe(mockVault);
        });
        it('should handle null value', () => {
            const mockVault = {};
            const mockUpdate = jest.fn();
            const result = classeProperty.fillDisplay(mockVault, null, mockUpdate);
            const label = result.querySelector('label');
            expect(label?.textContent).toBe('');
        });
        it('should handle undefined value', () => {
            const mockVault = {};
            const mockUpdate = jest.fn();
            const result = classeProperty.fillDisplay(mockVault, undefined, mockUpdate);
            const label = result.querySelector('label');
            expect(label?.textContent).toBe('');
        });
        it('should handle empty string value', () => {
            const mockVault = {};
            const mockUpdate = jest.fn();
            const result = classeProperty.fillDisplay(mockVault, '', mockUpdate);
            const label = result.querySelector('label');
            expect(label?.textContent).toBe('');
        });
        it('should handle numeric value', () => {
            const mockVault = {};
            const mockUpdate = jest.fn();
            const numericValue = 42;
            const result = classeProperty.fillDisplay(mockVault, numericValue, mockUpdate);
            const label = result.querySelector('label');
            expect(label?.textContent).toBe('42');
        });
        it('should handle object value', () => {
            const mockVault = {};
            const mockUpdate = jest.fn();
            const objectValue = { name: 'test', id: 123 };
            const result = classeProperty.fillDisplay(mockVault, objectValue, mockUpdate);
            const label = result.querySelector('label');
            expect(label?.textContent).toBe('[object Object]');
        });
    });
    describe('icon handling', () => {
        it('should not create icon container when no icon', () => {
            const propertyWithoutIcon = new ClasseProperty_1.ClasseProperty('noIcon', '');
            const mockVault = {};
            const mockUpdate = jest.fn();
            const value = 'Test Value';
            const result = propertyWithoutIcon.fillDisplay(mockVault, value, mockUpdate);
            const iconContainer = result.querySelector('.icon-container');
            expect(iconContainer).toBeNull();
        });
        it('should create icon container when icon provided', () => {
            const propertyWithIcon = new ClasseProperty_1.ClasseProperty('withIcon', 'test-icon');
            const mockVault = {};
            const mockUpdate = jest.fn();
            const value = 'Test Value';
            const result = propertyWithIcon.fillDisplay(mockVault, value, mockUpdate);
            const iconContainer = result.querySelector('.icon-container');
            expect(iconContainer).toBeTruthy();
            expect(iconContainer?.classList.contains('icon-container')).toBe(true);
        });
        it('should call setIcon when icon is provided', () => {
            const propertyWithIcon = new ClasseProperty_1.ClasseProperty('withIcon', 'custom-icon');
            const mockVault = {};
            const mockUpdate = jest.fn();
            const value = 'Test Value';
            propertyWithIcon.fillDisplay(mockVault, value, mockUpdate);
            expect(setIcon).toHaveBeenCalledWith(expect.objectContaining({
                classList: expect.objectContaining({
                    contains: expect.any(Function)
                })
            }), 'custom-icon');
        });
        it('should not call setIcon when no icon', () => {
            const setIconMock = require('../../Utils/App').setIcon;
            setIconMock.mockClear();
            const propertyWithoutIcon = new ClasseProperty_1.ClasseProperty('noIcon', '');
            const mockVault = {};
            const mockUpdate = jest.fn();
            const value = 'Test Value';
            propertyWithoutIcon.fillDisplay(mockVault, value, mockUpdate);
            expect(setIconMock).not.toHaveBeenCalled();
        });
    });
    describe('inheritance from Property', () => {
        it('should have name property from parent', () => {
            expect(classeProperty.name).toBe('testClasse');
        });
        it('should have type property', () => {
            expect(classeProperty.type).toBe('class');
        });
        it('should have icon property from parent', () => {
            expect(classeProperty.icon).toBeDefined();
        });
        it('should have vault property that can be set', () => {
            const mockVault = { test: 'vault' };
            classeProperty.vault = mockVault;
            expect(classeProperty.vault).toBe(mockVault);
        });
    });
    describe('field structure validation', () => {
        it('should have correct DOM structure without icon', () => {
            const propertyWithoutIcon = new ClasseProperty_1.ClasseProperty('test', '');
            const mockVault = {};
            const mockUpdate = jest.fn();
            const value = 'Test Value';
            const result = propertyWithoutIcon.fillDisplay(mockVault, value, mockUpdate);
            expect(result.children.length).toBe(1); // Only label
            expect(result.children[0].tagName).toBe('LABEL');
        });
        it('should have correct DOM structure with icon', () => {
            const propertyWithIcon = new ClasseProperty_1.ClasseProperty('test', 'icon');
            const mockVault = {};
            const mockUpdate = jest.fn();
            const value = 'Test Value';
            const result = propertyWithIcon.fillDisplay(mockVault, value, mockUpdate);
            expect(result.children.length).toBe(2); // Icon container + label
            expect(result.children[0].classList.contains('icon-container')).toBe(true);
            expect(result.children[1].tagName).toBe('LABEL');
        });
        it('should maintain correct order: icon first, then label', () => {
            const propertyWithIcon = new ClasseProperty_1.ClasseProperty('test', 'icon');
            const mockVault = {};
            const mockUpdate = jest.fn();
            const value = 'Test Value';
            const result = propertyWithIcon.fillDisplay(mockVault, value, mockUpdate);
            const firstChild = result.children[0];
            const secondChild = result.children[1];
            expect(firstChild.classList.contains('icon-container')).toBe(true);
            expect(secondChild.tagName).toBe('LABEL');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxzcmNcXF9fdGVzdHNfX1xcUHJvcGVydGllc1xcQ2xhc3NlUHJvcGVydHkudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7O0dBRUc7O0FBS0gsSUFBSSxDQUFDLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ2xDLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0NBQ3JCLENBQUMsQ0FBQyxDQUFDO0FBTEosb0VBQWlFO0FBQ2pFLHdEQUFxRDtBQU1yRCw4Q0FBOEM7QUFDOUMsTUFBTSxFQUFFLE9BQU8sRUFBRSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsbUJBQW1CLENBQUMsQ0FBQztBQUUxRCxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFO0lBQzVCLElBQUksY0FBOEIsQ0FBQztJQUVuQyxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ1osa0JBQWtCO1FBQ2xCLFFBQVEsQ0FBQyxJQUFJLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQztRQUM3QixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDekIsQ0FBQyxDQUFDLENBQUM7SUFFSCxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ1osY0FBYyxHQUFHLElBQUksK0JBQWMsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUN0RCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxhQUFhLEVBQUUsR0FBRyxFQUFFO1FBQ3pCLEVBQUUsQ0FBQyxnREFBZ0QsRUFBRSxHQUFHLEVBQUU7WUFDdEQsTUFBTSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDOUMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsOEJBQThCLEVBQUUsR0FBRyxFQUFF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cyI6WyJDOlxcVXNlcnNcXGxlb2R1XFxEb2N1bWVudHNcXDEgLSBQcm9cXFRlc3QgcGx1Z2luIG9ic2lkaWFuXFwub2JzaWRpYW5cXHBsdWdpbnNcXG9ic2lkaWFuLUNSTVxcZHluYW1pYy1maWVsZHNcXHNyY1xcX190ZXN0c19fXFxQcm9wZXJ0aWVzXFxDbGFzc2VQcm9wZXJ0eS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAamVzdC1lbnZpcm9ubWVudCBqc2RvbVxyXG4gKi9cclxuXHJcbmltcG9ydCB7IENsYXNzZVByb3BlcnR5IH0gZnJvbSAnLi4vLi4vcHJvcGVydGllcy9DbGFzc2VQcm9wZXJ0eSc7XHJcbmltcG9ydCB7IFByb3BlcnR5IH0gZnJvbSAnLi4vLi4vcHJvcGVydGllcy9Qcm9wZXJ0eSc7XHJcblxyXG5qZXN0Lm1vY2soJy4uLy4uL3ZhdWx0L1V0aWxzJywgKCkgPT4gKHtcclxuICAgIHNldEljb246IGplc3QuZm4oKVxyXG59KSk7XHJcblxyXG4vLyBJbXBvcnQgdGhlIG1vY2tlZCBmdW5jdGlvbiBmb3IgdXNlIGluIHRlc3RzXHJcbmNvbnN0IHsgc2V0SWNvbiB9ID0gamVzdC5yZXF1aXJlTW9jaygnLi4vLi4vdmF1bHQvVXRpbHMnKTtcclxuXHJcbmRlc2NyaWJlKCdDbGFzc2VQcm9wZXJ0eScsICgpID0+IHtcclxuICAgIGxldCBjbGFzc2VQcm9wZXJ0eTogQ2xhc3NlUHJvcGVydHk7XHJcblxyXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgLy8gUmVzZXQgRE9NIG1vY2tzXHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgIGNsYXNzZVByb3BlcnR5ID0gbmV3IENsYXNzZVByb3BlcnR5KCd0ZXN0Q2xhc3NlJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnY29uc3RydWN0b3InLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgQ2xhc3NlUHJvcGVydHkgd2l0aCBjb3JyZWN0IHR5cGUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChjbGFzc2VQcm9wZXJ0eS50eXBlKS50b0JlKCdjbGFzcycpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGluaGVyaXQgZnJvbSBQcm9wZXJ0eScsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KGNsYXNzZVByb3BlcnR5KS50b0JlSW5zdGFuY2VPZihQcm9wZXJ0eSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgdXNlIGVtcHR5IGljb24gYnkgZGVmYXVsdCcsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZGVmYXVsdFByb3BlcnR5ID0gbmV3IENsYXNzZVByb3BlcnR5KCdkZWZhdWx0VGVzdCcpO1xyXG4gICAgICAgICAgICBleHBlY3QoZGVmYXVsdFByb3BlcnR5Lm5hbWUpLnRvQmUoJ2RlZmF1bHRUZXN0Jyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChkZWZhdWx0UHJvcGVydHkudHlwZSkudG9CZSgnY2xhc3MnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBhY2NlcHQgY3VzdG9tIGljb24nLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGN1c3RvbVByb3BlcnR5ID0gbmV3IENsYXNzZVByb3BlcnR5KCdjdXN0b21OYW1lJywgJ2N1c3RvbS1pY29uJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChjdXN0b21Qcm9wZXJ0eS5uYW1lKS50b0JlKCdjdXN0b21OYW1lJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChjdXN0b21Qcm9wZXJ0eS5pY29uKS50b0JlKCdjdXN0b20taWNvbicpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBzdHJpbmcgaWNvbicsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZW1wdHlJY29uUHJvcGVydHkgPSBuZXcgQ2xhc3NlUHJvcGVydHkoJ2VtcHR5SWNvbicsICcnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGVtcHR5SWNvblByb3BlcnR5Lm5hbWUpLnRvQmUoJ2VtcHR5SWNvbicpO1xyXG4gICAgICAgICAgICBleHBlY3QoZW1wdHlJY29uUHJvcGVydHkuaWNvbikudG9CZSgnJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnZmlsbERpc3BsYXknLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgZmllbGQgd2l0aCBjb3JyZWN0IHN0cnVjdHVyZScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1ZhdWx0ID0ge307XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gJ1Rlc3QgQ2xhc3MgVmFsdWUnO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gY2xhc3NlUHJvcGVydHkuZmlsbERpc3BsYXkobW9ja1ZhdWx0LCB2YWx1ZSwgbW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LnRhZ05hbWUpLnRvQmUoJ0RJVicpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LmNsYXNzTGlzdC5jb250YWlucygnbWV0YWRhdGEtZmllbGQnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgbGFiZWwgd2l0aCBjb3JyZWN0IHRleHQgY29udGVudCcsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1ZhdWx0ID0ge307XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gJ1Rlc3QgQ2xhc3MgVmFsdWUnO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gY2xhc3NlUHJvcGVydHkuZmlsbERpc3BsYXkobW9ja1ZhdWx0LCB2YWx1ZSwgbW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhYmVsID0gcmVzdWx0LnF1ZXJ5U2VsZWN0b3IoJ2xhYmVsJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QobGFiZWwpLnRvQmVUcnV0aHkoKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxhYmVsPy50ZXh0Q29udGVudCkudG9CZSh2YWx1ZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgc2V0IHZhdWx0IHByb3BlcnR5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVmF1bHQgPSB7IGZpbGVzOiBbXSB9O1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9ICdUZXN0IFZhbHVlJztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNsYXNzZVByb3BlcnR5LmZpbGxEaXNwbGF5KG1vY2tWYXVsdCwgdmFsdWUsIG1vY2tVcGRhdGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGNsYXNzZVByb3BlcnR5LnZhdWx0KS50b0JlKG1vY2tWYXVsdCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIG51bGwgdmFsdWUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tWYXVsdCA9IHt9O1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gY2xhc3NlUHJvcGVydHkuZmlsbERpc3BsYXkobW9ja1ZhdWx0LCBudWxsLCBtb2NrVXBkYXRlKTtcclxuICAgICAgICAgICAgY29uc3QgbGFiZWwgPSByZXN1bHQucXVlcnlTZWxlY3RvcignbGFiZWwnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChsYWJlbD8udGV4dENvbnRlbnQpLnRvQmUoJycpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSB1bmRlZmluZWQgdmFsdWUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tWYXVsdCA9IHt9O1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gY2xhc3NlUHJvcGVydHkuZmlsbERpc3BsYXkobW9ja1ZhdWx0LCB1bmRlZmluZWQsIG1vY2tVcGRhdGUpO1xyXG4gICAgICAgICAgICBjb25zdCBsYWJlbCA9IHJlc3VsdC5xdWVyeVNlbGVjdG9yKCdsYWJlbCcpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGxhYmVsPy50ZXh0Q29udGVudCkudG9CZSgnJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IHN0cmluZyB2YWx1ZScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1ZhdWx0ID0ge307XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBjbGFzc2VQcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsICcnLCBtb2NrVXBkYXRlKTtcclxuICAgICAgICAgICAgY29uc3QgbGFiZWwgPSByZXN1bHQucXVlcnlTZWxlY3RvcignbGFiZWwnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChsYWJlbD8udGV4dENvbnRlbnQpLnRvQmUoJycpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBudW1lcmljIHZhbHVlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVmF1bHQgPSB7fTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VwZGF0ZSA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgY29uc3QgbnVtZXJpY1ZhbHVlID0gNDI7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBjbGFzc2VQcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsIG51bWVyaWNWYWx1ZSwgbW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhYmVsID0gcmVzdWx0LnF1ZXJ5U2VsZWN0b3IoJ2xhYmVsJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QobGFiZWw/LnRleHRDb250ZW50KS50b0JlKCc0MicpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBvYmplY3QgdmFsdWUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tWYXVsdCA9IHt9O1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBjb25zdCBvYmplY3RWYWx1ZSA9IHsgbmFtZTogJ3Rlc3QnLCBpZDogMTIzIH07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBjbGFzc2VQcm9wZXJ0eS5maWxsRGlzcGxheShtb2NrVmF1bHQsIG9iamVjdFZhbHVlLCBtb2NrVXBkYXRlKTtcclxuICAgICAgICAgICAgY29uc3QgbGFiZWwgPSByZXN1bHQucXVlcnlTZWxlY3RvcignbGFiZWwnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChsYWJlbD8udGV4dENvbnRlbnQpLnRvQmUoJ1tvYmplY3QgT2JqZWN0XScpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2ljb24gaGFuZGxpbmcnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBub3QgY3JlYXRlIGljb24gY29udGFpbmVyIHdoZW4gbm8gaWNvbicsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcHJvcGVydHlXaXRob3V0SWNvbiA9IG5ldyBDbGFzc2VQcm9wZXJ0eSgnbm9JY29uJywgJycpO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVmF1bHQgPSB7fTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VwZGF0ZSA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSAnVGVzdCBWYWx1ZSc7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBwcm9wZXJ0eVdpdGhvdXRJY29uLmZpbGxEaXNwbGF5KG1vY2tWYXVsdCwgdmFsdWUsIG1vY2tVcGRhdGUpO1xyXG4gICAgICAgICAgICBjb25zdCBpY29uQ29udGFpbmVyID0gcmVzdWx0LnF1ZXJ5U2VsZWN0b3IoJy5pY29uLWNvbnRhaW5lcicpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGljb25Db250YWluZXIpLnRvQmVOdWxsKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIGljb24gY29udGFpbmVyIHdoZW4gaWNvbiBwcm92aWRlZCcsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcHJvcGVydHlXaXRoSWNvbiA9IG5ldyBDbGFzc2VQcm9wZXJ0eSgnd2l0aEljb24nLCAndGVzdC1pY29uJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tWYXVsdCA9IHt9O1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9ICdUZXN0IFZhbHVlJztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHByb3BlcnR5V2l0aEljb24uZmlsbERpc3BsYXkobW9ja1ZhdWx0LCB2YWx1ZSwgbW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGljb25Db250YWluZXIgPSByZXN1bHQucXVlcnlTZWxlY3RvcignLmljb24tY29udGFpbmVyJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QoaWNvbkNvbnRhaW5lcikudG9CZVRydXRoeSgpO1xyXG4gICAgICAgICAgICBleHBlY3QoaWNvbkNvbnRhaW5lcj8uY2xhc3NMaXN0LmNvbnRhaW5zKCdpY29uLWNvbnRhaW5lcicpKS50b0JlKHRydWUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGNhbGwgc2V0SWNvbiB3aGVuIGljb24gaXMgcHJvdmlkZWQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHByb3BlcnR5V2l0aEljb24gPSBuZXcgQ2xhc3NlUHJvcGVydHkoJ3dpdGhJY29uJywgJ2N1c3RvbS1pY29uJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tWYXVsdCA9IHt9O1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9ICdUZXN0IFZhbHVlJztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHByb3BlcnR5V2l0aEljb24uZmlsbERpc3BsYXkobW9ja1ZhdWx0LCB2YWx1ZSwgbW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3Qoc2V0SWNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xyXG4gICAgICAgICAgICAgICAgY2xhc3NMaXN0OiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbnM6IGV4cGVjdC5hbnkoRnVuY3Rpb24pXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KSwgJ2N1c3RvbS1pY29uJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgbm90IGNhbGwgc2V0SWNvbiB3aGVuIG5vIGljb24nLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNldEljb25Nb2NrID0gcmVxdWlyZSgnLi4vLi4vVXRpbHMvQXBwJykuc2V0SWNvbjtcclxuICAgICAgICAgICAgc2V0SWNvbk1vY2subW9ja0NsZWFyKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0eVdpdGhvdXRJY29uID0gbmV3IENsYXNzZVByb3BlcnR5KCdub0ljb24nLCAnJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tWYXVsdCA9IHt9O1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9ICdUZXN0IFZhbHVlJztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHByb3BlcnR5V2l0aG91dEljb24uZmlsbERpc3BsYXkobW9ja1ZhdWx0LCB2YWx1ZSwgbW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3Qoc2V0SWNvbk1vY2spLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnaW5oZXJpdGFuY2UgZnJvbSBQcm9wZXJ0eScsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGhhdmUgbmFtZSBwcm9wZXJ0eSBmcm9tIHBhcmVudCcsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KGNsYXNzZVByb3BlcnR5Lm5hbWUpLnRvQmUoJ3Rlc3RDbGFzc2UnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYXZlIHR5cGUgcHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChjbGFzc2VQcm9wZXJ0eS50eXBlKS50b0JlKCdjbGFzcycpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhdmUgaWNvbiBwcm9wZXJ0eSBmcm9tIHBhcmVudCcsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KGNsYXNzZVByb3BlcnR5Lmljb24pLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGF2ZSB2YXVsdCBwcm9wZXJ0eSB0aGF0IGNhbiBiZSBzZXQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tWYXVsdCA9IHsgdGVzdDogJ3ZhdWx0JyB9O1xyXG4gICAgICAgICAgICBjbGFzc2VQcm9wZXJ0eS52YXVsdCA9IG1vY2tWYXVsdDtcclxuICAgICAgICAgICAgZXhwZWN0KGNsYXNzZVByb3BlcnR5LnZhdWx0KS50b0JlKG1vY2tWYXVsdCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnZmllbGQgc3RydWN0dXJlIHZhbGlkYXRpb24nLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYXZlIGNvcnJlY3QgRE9NIHN0cnVjdHVyZSB3aXRob3V0IGljb24nLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHByb3BlcnR5V2l0aG91dEljb24gPSBuZXcgQ2xhc3NlUHJvcGVydHkoJ3Rlc3QnLCAnJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tWYXVsdCA9IHt9O1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9ICdUZXN0IFZhbHVlJztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHByb3BlcnR5V2l0aG91dEljb24uZmlsbERpc3BsYXkobW9ja1ZhdWx0LCB2YWx1ZSwgbW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LmNoaWxkcmVuLmxlbmd0aCkudG9CZSgxKTsgLy8gT25seSBsYWJlbFxyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LmNoaWxkcmVuWzBdLnRhZ05hbWUpLnRvQmUoJ0xBQkVMJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGF2ZSBjb3JyZWN0IERPTSBzdHJ1Y3R1cmUgd2l0aCBpY29uJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0eVdpdGhJY29uID0gbmV3IENsYXNzZVByb3BlcnR5KCd0ZXN0JywgJ2ljb24nKTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1ZhdWx0ID0ge307XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gJ1Rlc3QgVmFsdWUnO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gcHJvcGVydHlXaXRoSWNvbi5maWxsRGlzcGxheShtb2NrVmF1bHQsIHZhbHVlLCBtb2NrVXBkYXRlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQuY2hpbGRyZW4ubGVuZ3RoKS50b0JlKDIpOyAvLyBJY29uIGNvbnRhaW5lciArIGxhYmVsXHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQuY2hpbGRyZW5bMF0uY2xhc3NMaXN0LmNvbnRhaW5zKCdpY29uLWNvbnRhaW5lcicpKS50b0JlKHRydWUpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LmNoaWxkcmVuWzFdLnRhZ05hbWUpLnRvQmUoJ0xBQkVMJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgbWFpbnRhaW4gY29ycmVjdCBvcmRlcjogaWNvbiBmaXJzdCwgdGhlbiBsYWJlbCcsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcHJvcGVydHlXaXRoSWNvbiA9IG5ldyBDbGFzc2VQcm9wZXJ0eSgndGVzdCcsICdpY29uJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tWYXVsdCA9IHt9O1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9ICdUZXN0IFZhbHVlJztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHByb3BlcnR5V2l0aEljb24uZmlsbERpc3BsYXkobW9ja1ZhdWx0LCB2YWx1ZSwgbW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBmaXJzdENoaWxkID0gcmVzdWx0LmNoaWxkcmVuWzBdO1xyXG4gICAgICAgICAgICBjb25zdCBzZWNvbmRDaGlsZCA9IHJlc3VsdC5jaGlsZHJlblsxXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChmaXJzdENoaWxkLmNsYXNzTGlzdC5jb250YWlucygnaWNvbi1jb250YWluZXInKSkudG9CZSh0cnVlKTtcclxuICAgICAgICAgICAgZXhwZWN0KHNlY29uZENoaWxkLnRhZ05hbWUpLnRvQmUoJ0xBQkVMJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufSk7Il0sInZlcnNpb24iOjN9