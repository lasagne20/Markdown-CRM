a46b76410aa6b8fa8552fbc7c269aad3
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
// Mock DynamicClassFactory pour Ã©viter les erreurs
jest.mock('../../src/Config/DynamicClassFactory', () => ({
    DynamicClassFactory: jest.fn().mockImplementation(() => ({
        getAvailableClasses: jest.fn().mockResolvedValue([]),
        getClass: jest.fn()
    }))
}));
const Vault_1 = require("../../src/vault/Vault");
describe('Vault', () => {
    let vault;
    let mockApp;
    let mockSettings;
    beforeEach(() => {
        // Reset all mocks
        jest.clearAllMocks();
        // Create mock app
        mockApp = {
            getVaultPath: jest.fn(() => '/test/path'),
            getName: jest.fn(() => 'TestVault'),
            listFiles: jest.fn(() => Promise.resolve([])),
            listFolders: jest.fn(() => Promise.resolve([])),
            getMetadata: jest.fn(),
            sendNotice: jest.fn()
        };
        // Create mock settings
        mockSettings = {
            templateFolder: 'Templates',
            personalName: 'TestUser',
            configPath: './test-config'
        };
        // Create vault instance
        vault = new Vault_1.Vault(mockApp, mockSettings);
    });
    describe('constructor', () => {
        it('should create vault instance with app and settings', () => {
            expect(vault).toBeInstanceOf(Vault_1.Vault);
            expect(vault.app).toBe(mockApp);
            expect(vault.settings).toBe(mockSettings);
        });
    });
    describe('getPath', () => {
        it('should return vault path from app', () => {
            const path = vault.getPath();
            expect(path).toBe('/test/path');
            expect(mockApp.getVaultPath).toHaveBeenCalled();
        });
    });
    describe('getName', () => {
        it('should return vault name from app', () => {
            const name = vault.getName();
            expect(name).toBe('TestVault');
            expect(mockApp.getName).toHaveBeenCalled();
        });
    });
    describe('getPersonalName', () => {
        it('should return personal name from settings', () => {
            const personalName = vault.getPersonalName();
            expect(personalName).toBe('TestUser');
        });
    });
    describe('readLinkFile', () => {
        it('should parse wikilinks correctly', () => {
            expect(vault.readLinkFile('[[test]]')).toBe('test');
            expect(vault.readLinkFile('[[test|alias]]')).toBe('alias');
            expect(vault.readLinkFile('[[folder/test]]')).toBe('test');
        });
        it('should return path when path=true', () => {
            expect(vault.readLinkFile('[[test]]', true)).toBe('test.md');
            expect(vault.readLinkFile('[[test.pdf]]', true)).toBe('test.pdf');
        });
        it('should handle invalid input', () => {
            expect(vault.readLinkFile('')).toBe('');
            expect(vault.readLinkFile(null)).toBe('');
            expect(vault.readLinkFile('invalid')).toBe('invalid');
        });
    });
    describe('getDynamicClassFactory', () => {
        it('should return dynamic class factory', () => {
            const factory = vault.getDynamicClassFactory();
            expect(factory).toBeDefined();
        });
    });
    describe('getClasseFromName', () => {
        beforeEach(() => {
            // Initialize static classes property
            Vault_1.Vault.classes = {};
        });
        it('should return undefined for non-existent class', () => {
            const classe = vault.getClasseFromName('NonExistent');
            expect(classe).toBeUndefined();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxfX3Rlc3RzX19cXHZhdWx0XFxWYXVsdC50ZXN0LnRzIiwibWFwcGluZ3MiOiI7O0FBRUEsbURBQW1EO0FBQ25ELElBQUksQ0FBQyxJQUFJLENBQUMsc0NBQXNDLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNyRCxtQkFBbUIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsa0JBQWtCLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztRQUNyRCxtQkFBbUIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsaUJBQWlCLENBQUMsRUFBRSxDQUFDO1FBQ3BELFFBQVEsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0tBQ3RCLENBQUMsQ0FBQztDQUNOLENBQUMsQ0FBQyxDQUFDO0FBUkosaURBQThDO0FBVTlDLFFBQVEsQ0FBQyxPQUFPLEVBQUUsR0FBRyxFQUFFO0lBQ25CLElBQUksS0FBWSxDQUFDO0lBQ2pCLElBQUksT0FBWSxDQUFDO0lBQ2pCLElBQUksWUFBaUIsQ0FBQztJQUV0QixVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ1osa0JBQWtCO1FBQ2xCLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUVyQixrQkFBa0I7UUFDbEIsT0FBTyxHQUFHO1lBQ04sWUFBWSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsWUFBWSxDQUFDO1lBQ3pDLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLFdBQVcsQ0FBQztZQUNuQyxTQUFTLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQzdDLFdBQVcsRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFD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QUFDLGlCQUFpQixDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBQ3RELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUNuQyxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxfX3Rlc3RzX19cXHZhdWx0XFxWYXVsdC50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFZhdWx0IH0gZnJvbSAnLi4vLi4vc3JjL3ZhdWx0L1ZhdWx0JztcclxuXHJcbi8vIE1vY2sgRHluYW1pY0NsYXNzRmFjdG9yeSBwb3VyIMOpdml0ZXIgbGVzIGVycmV1cnNcclxuamVzdC5tb2NrKCcuLi8uLi9zcmMvQ29uZmlnL0R5bmFtaWNDbGFzc0ZhY3RvcnknLCAoKSA9PiAoe1xyXG4gICAgRHluYW1pY0NsYXNzRmFjdG9yeTogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiAoe1xyXG4gICAgICAgIGdldEF2YWlsYWJsZUNsYXNzZXM6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSksXHJcbiAgICAgICAgZ2V0Q2xhc3M6IGplc3QuZm4oKVxyXG4gICAgfSkpXHJcbn0pKTtcclxuXHJcbmRlc2NyaWJlKCdWYXVsdCcsICgpID0+IHtcclxuICAgIGxldCB2YXVsdDogVmF1bHQ7XHJcbiAgICBsZXQgbW9ja0FwcDogYW55O1xyXG4gICAgbGV0IG1vY2tTZXR0aW5nczogYW55O1xyXG5cclxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgIC8vIFJlc2V0IGFsbCBtb2Nrc1xyXG4gICAgICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIENyZWF0ZSBtb2NrIGFwcFxyXG4gICAgICAgIG1vY2tBcHAgPSB7XHJcbiAgICAgICAgICAgIGdldFZhdWx0UGF0aDogamVzdC5mbigoKSA9PiAnL3Rlc3QvcGF0aCcpLFxyXG4gICAgICAgICAgICBnZXROYW1lOiBqZXN0LmZuKCgpID0+ICdUZXN0VmF1bHQnKSxcclxuICAgICAgICAgICAgbGlzdEZpbGVzOiBqZXN0LmZuKCgpID0+IFByb21pc2UucmVzb2x2ZShbXSkpLFxyXG4gICAgICAgICAgICBsaXN0Rm9sZGVyczogamVzdC5mbigoKSA9PiBQcm9taXNlLnJlc29sdmUoW10pKSxcclxuICAgICAgICAgICAgZ2V0TWV0YWRhdGE6IGplc3QuZm4oKSxcclxuICAgICAgICAgICAgc2VuZE5vdGljZTogamVzdC5mbigpXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gQ3JlYXRlIG1vY2sgc2V0dGluZ3NcclxuICAgICAgICBtb2NrU2V0dGluZ3MgPSB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlRm9sZGVyOiAnVGVtcGxhdGVzJyxcclxuICAgICAgICAgICAgcGVyc29uYWxOYW1lOiAnVGVzdFVzZXInLFxyXG4gICAgICAgICAgICBjb25maWdQYXRoOiAnLi90ZXN0LWNvbmZpZydcclxuICAgICAgICB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIENyZWF0ZSB2YXVsdCBpbnN0YW5jZVxyXG4gICAgICAgIHZhdWx0ID0gbmV3IFZhdWx0KG1vY2tBcHAsIG1vY2tTZXR0aW5ncyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnY29uc3RydWN0b3InLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgdmF1bHQgaW5zdGFuY2Ugd2l0aCBhcHAgYW5kIHNldHRpbmdzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QodmF1bHQpLnRvQmVJbnN0YW5jZU9mKFZhdWx0KTtcclxuICAgICAgICAgICAgZXhwZWN0KHZhdWx0LmFwcCkudG9CZShtb2NrQXBwKTtcclxuICAgICAgICAgICAgZXhwZWN0KHZhdWx0LnNldHRpbmdzKS50b0JlKG1vY2tTZXR0aW5ncyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnZ2V0UGF0aCcsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiB2YXVsdCBwYXRoIGZyb20gYXBwJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXRoID0gdmF1bHQuZ2V0UGF0aCgpO1xyXG4gICAgICAgICAgICBleHBlY3QocGF0aCkudG9CZSgnL3Rlc3QvcGF0aCcpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja0FwcC5nZXRWYXVsdFBhdGgpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdnZXROYW1lJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIHZhdWx0IG5hbWUgZnJvbSBhcHAnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSB2YXVsdC5nZXROYW1lKCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChuYW1lKS50b0JlKCdUZXN0VmF1bHQnKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tBcHAuZ2V0TmFtZSkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2dldFBlcnNvbmFsTmFtZScsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBwZXJzb25hbCBuYW1lIGZyb20gc2V0dGluZ3MnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBlcnNvbmFsTmFtZSA9IHZhdWx0LmdldFBlcnNvbmFsTmFtZSgpO1xyXG4gICAgICAgICAgICBleHBlY3QocGVyc29uYWxOYW1lKS50b0JlKCdUZXN0VXNlcicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ3JlYWRMaW5rRmlsZScsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIHBhcnNlIHdpa2lsaW5rcyBjb3JyZWN0bHknLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdCh2YXVsdC5yZWFkTGlua0ZpbGUoJ1tbdGVzdF1dJykpLnRvQmUoJ3Rlc3QnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHZhdWx0LnJlYWRMaW5rRmlsZSgnW1t0ZXN0fGFsaWFzXV0nKSkudG9CZSgnYWxpYXMnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHZhdWx0LnJlYWRMaW5rRmlsZSgnW1tmb2xkZXIvdGVzdF1dJykpLnRvQmUoJ3Rlc3QnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gcGF0aCB3aGVuIHBhdGg9dHJ1ZScsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KHZhdWx0LnJlYWRMaW5rRmlsZSgnW1t0ZXN0XV0nLCB0cnVlKSkudG9CZSgndGVzdC5tZCcpO1xyXG4gICAgICAgICAgICBleHBlY3QodmF1bHQucmVhZExpbmtGaWxlKCdbW3Rlc3QucGRmXV0nLCB0cnVlKSkudG9CZSgndGVzdC5wZGYnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgaW52YWxpZCBpbnB1dCcsICgpID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KHZhdWx0LnJlYWRMaW5rRmlsZSgnJykpLnRvQmUoJycpO1xyXG4gICAgICAgICAgICBleHBlY3QodmF1bHQucmVhZExpbmtGaWxlKG51bGwgYXMgYW55KSkudG9CZSgnJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh2YXVsdC5yZWFkTGlua0ZpbGUoJ2ludmFsaWQnKSkudG9CZSgnaW52YWxpZCcpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2dldER5bmFtaWNDbGFzc0ZhY3RvcnknLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gZHluYW1pYyBjbGFzcyBmYWN0b3J5JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBmYWN0b3J5ID0gdmF1bHQuZ2V0RHluYW1pY0NsYXNzRmFjdG9yeSgpO1xyXG4gICAgICAgICAgICBleHBlY3QoZmFjdG9yeSkudG9CZURlZmluZWQoKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdnZXRDbGFzc2VGcm9tTmFtZScsICgpID0+IHtcclxuICAgICAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSBzdGF0aWMgY2xhc3NlcyBwcm9wZXJ0eVxyXG4gICAgICAgICAgICAoVmF1bHQgYXMgYW55KS5jbGFzc2VzID0ge307XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIHVuZGVmaW5lZCBmb3Igbm9uLWV4aXN0ZW50IGNsYXNzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjbGFzc2UgPSB2YXVsdC5nZXRDbGFzc2VGcm9tTmFtZSgnTm9uRXhpc3RlbnQnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGNsYXNzZSkudG9CZVVuZGVmaW5lZCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==