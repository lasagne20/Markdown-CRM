3fe77a64ff8def0018dd43d45586117d
"use strict";
/**
 * @jest-environment jsdom
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock flatpickr
jest.mock('flatpickr', () => {
    return jest.fn().mockImplementation((element, options) => {
        // Simuler l'initialization flatpickr
        element.setAttribute('data-flatpickr', 'true');
        // Simuler le trigger des événements flatpickr
        if (options?.onChange) {
            element._flatpickrOnChange = options.onChange;
        }
        if (options?.onClose) {
            element._flatpickrOnClose = options.onClose;
        }
        return {
            destroy: jest.fn(),
            clear: jest.fn(),
            setDate: jest.fn()
        };
    });
});
// Mock French locale
jest.mock('flatpickr/dist/l10n/fr.js', () => ({
    French: {}
}), { virtual: true });
const TimeProperty_1 = require("../../properties/TimeProperty ");
describe('TimeProperty', () => {
    let timeProperty;
    beforeEach(() => {
        // Reset DOM mocks
        document.body.innerHTML = '';
        jest.clearAllMocks();
        // Mock focus pour tous les éléments HTML
        HTMLElement.prototype.focus = jest.fn();
    });
    describe('constructor', () => {
        it('should create TimeProperty with default format', () => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
            expect(timeProperty.name).toBe('testTime');
            expect(timeProperty.type).toBe('time');
            expect(timeProperty['format']).toBe('HH:mm'); // format par défaut
        });
        it('should create TimeProperty with custom format', () => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime', { format: 'HH:mm:ss', icon: 'clock' });
            expect(timeProperty.name).toBe('testTime');
            expect(timeProperty.type).toBe('time');
            expect(timeProperty['format']).toBe('HH:mm:ss');
            expect(timeProperty.icon).toBe('clock');
        });
    });
    describe('validate', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should validate correct time format HH:mm', () => {
            expect(timeProperty.validate('14:30')).toBe('14:30');
            expect(timeProperty.validate('09:15')).toBe('09:15');
            expect(timeProperty.validate('00:00')).toBe('00:00');
            expect(timeProperty.validate('23:59')).toBe('23:59');
        });
        it('should return empty string for invalid time format', () => {
            expect(timeProperty.validate('25:00')).toBe('25:00'); // Format valide même si heure invalide
            expect(timeProperty.validate('14:70')).toBe('14:70'); // Format valide même si minutes invalides
            expect(timeProperty.validate('14')).toBe(''); // Format incomplet
            expect(timeProperty.validate('14:3')).toBe(''); // Format incorrect (pas 2 digits)
            expect(timeProperty.validate('abc')).toBe(''); // Texte invalide
            expect(timeProperty.validate('')).toBe(''); // Chaîne vide
        });
    });
    describe('formatTimeForDisplay', () => {
        it('should format time for HH:mm format', () => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime', { format: 'HH:mm' });
            expect(timeProperty.formatTimeForDisplay('14:30')).toBe('14:30');
            expect(timeProperty.formatTimeForDisplay('09:15')).toBe('09:15');
            expect(timeProperty.formatTimeForDisplay('')).toBe('Aucune heure sélectionnée');
        });
        it('should format time for custom format with units', () => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime', { format: 'custom' });
            expect(timeProperty.formatTimeForDisplay('14:30')).toBe('14h 30 min');
            expect(timeProperty.formatTimeForDisplay('09:00')).toBe('9h');
            expect(timeProperty.formatTimeForDisplay('00:15')).toBe('15 min');
            expect(timeProperty.formatTimeForDisplay('00:00')).toBe('0 min');
            expect(timeProperty.formatTimeForDisplay('')).toBe('');
        });
        it('should handle time with seconds', () => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime', { format: 'custom' });
            expect(timeProperty.formatTimeForDisplay('14:30:45')).toBe('14h 30 min 45s');
            expect(timeProperty.formatTimeForDisplay('00:00:30')).toBe('30s');
        });
    });
    describe('formatTimeForStorage', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should format Date to HH:mm string', () => {
            const date1 = new Date('2024-01-01T14:30:00');
            const date2 = new Date('2024-01-01T09:15:00');
            expect(timeProperty.formatTimeForStorage(date1)).toBe('14:30');
            expect(timeProperty.formatTimeForStorage(date2)).toBe('09:15');
        });
    });
    describe('createFieldLink', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should create link element with time value', () => {
            const link = timeProperty.createFieldLink('14:30');
            expect(link.tagName).toBe('DIV');
            expect(link.textContent).toBe('14:30');
            expect(link.classList.contains('time-field-link')).toBe(true);
            expect(link.classList.contains('field-link')).toBe(true);
            expect(link.style.cursor).toBe('pointer');
        });
        it('should create link with default text when no value', () => {
            const link = timeProperty.createFieldLink('');
            expect(link.textContent).toBe('Aucune heure sélectionnée');
        });
        it('should handle click event to trigger modifyField', () => {
            const spy = jest.spyOn(timeProperty, 'modifyField');
            const link = timeProperty.createFieldLink('14:30');
            // Simulate the click event more accurately
            const clickEvent = new MouseEvent('click', {
                bubbles: true,
                cancelable: true,
            });
            Object.defineProperty(clickEvent, 'currentTarget', {
                value: link,
                writable: false
            });
            link.dispatchEvent(clickEvent);
            expect(spy).toHaveBeenCalledWith(expect.objectContaining({
                type: 'click',
                currentTarget: link
            }));
        });
    });
    describe('createFieldTime', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should create input element with flatpickr', () => {
            const mockUpdate = jest.fn();
            const mockLink = document.createElement('div');
            const input = timeProperty.createFieldTime('14:30', mockUpdate, mockLink);
            expect(input.tagName).toBe('INPUT');
            expect(input.type).toBe('text');
            expect(input.value).toBe('14:30');
            expect(input.classList.contains('field-input')).toBe(true);
            expect(input.hasAttribute('data-flatpickr')).toBe(true);
        });
        it('should create input with empty value when no initial value', () => {
            const mockUpdate = jest.fn();
            const mockLink = document.createElement('div');
            const input = timeProperty.createFieldTime('', mockUpdate, mockLink);
            expect(input.value).toBe('');
        });
        it('should handle flatpickr onChange event', async () => {
            const mockUpdate = jest.fn().mockResolvedValue(undefined);
            const mockLink = document.createElement('div');
            const spy = jest.spyOn(timeProperty, 'updateField').mockResolvedValue(undefined);
            const input = timeProperty.createFieldTime('', mockUpdate, mockLink);
            // Simuler le changement flatpickr
            const mockDate = new Date('2024-01-01T15:45:00');
            if (input._flatpickrOnChange) {
                await input._flatpickrOnChange([mockDate]);
            }
            expect(input.value).toBe('15:45');
            expect(spy).toHaveBeenCalledWith(mockUpdate, input, mockLink);
        });
        it('should handle flatpickr onClose event', async () => {
            const mockUpdate = jest.fn().mockResolvedValue(undefined);
            const mockLink = document.createElement('div');
            const spy = jest.spyOn(timeProperty, 'updateField').mockResolvedValue(undefined);
            const input = timeProperty.createFieldTime('invalid', mockUpdate, mockLink);
            // Simuler la fermeture flatpickr
            if (input._flatpickrOnClose) {
                await input._flatpickrOnClose();
            }
            expect(input.value).toBe(''); // Valeur invalide effacée
            expect(spy).toHaveBeenCalledWith(mockUpdate, input, mockLink);
        });
    });
    describe('fillDisplay', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should create container with link and input for valid value', () => {
            const mockUpdate = jest.fn();
            const container = timeProperty.fillDisplay({}, '14:30', mockUpdate);
            expect(container.tagName).toBe('DIV');
            expect(container.classList.contains('field-container')).toBe(true);
            const link = container.querySelector('.time-field-link');
            const input = container.querySelector('input');
            expect(link).toBeTruthy();
            expect(input).toBeTruthy();
            expect(link?.style.display).toBe('block');
            // L'input est initialisé par flatpickr, donc on vérifie qu'il existe mais pas nécessairement qu'il soit caché
            expect(input).toBeTruthy();
        });
        it('should show input for invalid value', () => {
            const mockUpdate = jest.fn();
            const container = timeProperty.fillDisplay({}, 'invalid', mockUpdate);
            const link = container.querySelector('.time-field-link');
            const input = container.querySelector('input');
            expect(input?.style.display).toBe('block');
            expect(link?.style.display).toBe('none');
        });
        it('should show input for empty value', () => {
            const mockUpdate = jest.fn();
            const container = timeProperty.fillDisplay({}, '', mockUpdate);
            const link = container.querySelector('.time-field-link');
            const input = container.querySelector('input');
            expect(input?.style.display).toBe('block');
            expect(link?.style.display).toBe('none');
        });
    });
    describe('updateField', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should update field with valid value', async () => {
            const mockUpdate = jest.fn().mockResolvedValue(undefined);
            const input = document.createElement('input');
            input.value = '14:30';
            const link = document.createElement('div');
            await timeProperty.updateField(mockUpdate, input, link);
            expect(mockUpdate).toHaveBeenCalledWith('14:30');
            expect(input.style.display).toBe('none');
            expect(link.style.display).toBe('block');
            expect(link.textContent).toBe('14:30');
        });
        it('should handle invalid value', async () => {
            const mockUpdate = jest.fn().mockResolvedValue(undefined);
            const input = document.createElement('input');
            input.value = 'invalid';
            const link = document.createElement('div');
            await timeProperty.updateField(mockUpdate, input, link);
            expect(mockUpdate).toHaveBeenCalledWith('');
            expect(link.textContent).toBe('Aucune heure sélectionnée');
        });
    });
    describe('modifyField', () => {
        beforeEach(() => {
            timeProperty = new TimeProperty_1.TimeProperty('testTime');
        });
        it('should call modifyField without throwing errors', () => {
            // Test que modifyField peut être appelé sans erreur
            const container = document.createElement('div');
            const link = document.createElement('div');
            const input = document.createElement('input');
            container.appendChild(link);
            container.appendChild(input);
            const event = { currentTarget: link };
            // Vérifier que modifyField ne lance pas d'erreur
            expect(() => timeProperty.modifyField(event)).not.toThrow();
        });
        it('should handle missing container', () => {
            const link = document.createElement('div'); // Pas de parent
            const event = { currentTarget: link };
            // Ne devrait pas lever d'erreur
            expect(() => timeProperty.modifyField(event)).not.toThrow();
        });
        it('should handle missing input in container', () => {
            const container = document.createElement('div');
            const link = document.createElement('div');
            container.appendChild(link); // Pas d'input
            const event = { currentTarget: link };
            // Ne devrait pas lever d'erreur
            expect(() => timeProperty.modifyField(event)).not.toThrow();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxzcmNcXF9fdGVzdHNfX1xcUHJvcGVydGllc1xcVGltZVByb3BlcnR5LnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOztHQUVHOztBQUlILGlCQUFpQjtBQUNqQixJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxHQUFHLEVBQUU7SUFDeEIsT0FBTyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxPQUFPLEVBQUUsT0FBTyxFQUFFLEVBQUU7UUFDckQscUNBQXFDO1FBQ3JDLE9BQU8sQ0FBQyxZQUFZLENBQUMsZ0JBQWdCLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFFL0MsOENBQThDO1FBQzlDLElBQUksT0FBTyxFQUFFLFFBQVEsRUFBRSxDQUFDO1lBQ3BCLE9BQU8sQ0FBQyxrQkFBa0IsR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDO1FBQ2xELENBQUM7UUFDRCxJQUFJLE9BQU8sRUFBRSxPQUFPLEVBQUUsQ0FBQztZQUNuQixPQUFPLENBQUMsaUJBQWlCLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQztRQUNoRCxDQUFDO1FBRUQsT0FBTztZQUNILE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ2xCLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ2hCLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1NBQ3JCLENBQUM7SUFDTixDQUFDLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQyxDQUFDO0FBRUgscUJBQXFCO0FBQ3JCLElBQUksQ0FBQyxJQUFJLENBQUMsMkJBQTJCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUMxQyxNQUFNLEVBQUUsRUFBRTtDQUNiLENBQUMsRUFBRSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO0FBM0J2QixpRUFBOEQ7QUE2QjlELFFBQVEsQ0FBQyxjQUFjLEVBQUUsR0FBRyxFQUFFO0lBQzFCLElBQUksWUFBMEIsQ0FBQztJQUUvQixVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ1osa0JBQWtCO1FBQ2xCLFFBQVEsQ0FBQyxJQUFJLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQztRQUM3QixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFFckIseUNBQXlDO1FBQ3pDLFdBQVcsQ0FBQyxTQUFTLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQztJQUM1QyxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxhQUFhLEVBQUUsR0FBRyxFQUFFO1FBQ3pCLEVBQUUsQ0FBQyxnREFBZ0QsRUFBRSxHQUFHLEVBQUU7WUFDdEQsWUFBWSxHQUFHLElBQUksMkJBQVksQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUU1QyxNQUFNLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUMzQyxNQUFNLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUN2QyxNQUFNLENBQUMsWUFBWSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsb0JBQW9CO1FBQ3RFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLCtDQUErQyxFQUFFLEdBQUcsRUFBRTtZQUNyRCxZQUFZLEdBQUcsSUFBSSwyQkFBWSxDQUFDLFVBQVUsRUFBRSxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxDQUFDLENBQUM7WUFFbkYsTUFBTSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDM0MsTUFBTSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDdkMsTUFBTSxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUNoRCxNQUFNLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUM1QyxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLFVBQVUsRUFBRSxHQUFHLEVBQUU7UUFDdEIsVUFBVSxDQUFDLEdBQUcsRUFBRTtZQUNaLFlBQVksR0FBRyxJQUFJLDJCQUFZLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDaEQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMkNBQTJDLEVBQUUsR0FBRyxFQUFFO1lBQ2pELE1BQU0sQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ3JELE1BQU0sQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ3JELE1BQU0sQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ3JELE1BQU0sQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3pELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG9EQUFvRCxFQUFFLEdBQUcsRUFBRTtZQUMxRCxNQUFNLENBQUMsWUFBWSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLHVDQUF1QztZQUM3RixNQUFNLENBQUMsWUFBWSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLDBDQUEwQztZQUNoRyxNQUFNLENBQUMsWUFBWSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLG1CQUFtQjtZQUNqRSxNQUFNLENBQUMsWUFBWSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLGtDQUFrQztZQUNsRixNQUFNLENBQUMsWUFBWSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLGlCQUFpQjtZQUNoRSxNQUFNLENBQUMsWUFBWSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLGNBQWM7UUFDOUQsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLEVBQUU7UUFDbEMsRUFBRSxDQUFDLHFDQUFxQyxFQUFFLEdBQUcsRUFBRTtZQUMzQyxZQUFZLEdBQUcsSUFBSSwyQkFBWSxDQUFDLFVBQVUsRUFBRSxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsQ0FBQyxDQUFDO1lBRWpFLE1BQU0sQ0FBQyxZQUFZLENBQUMsb0JBQW9CLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDakUsTUFBTSxDQUFDLFlBQVksQ0FBQyxvQkFBb0IsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUNqRSxNQUFNLENBQUMsWUFBWSxDQUFDLG9CQUFvQixDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLDJCQUEyQixDQUFDLENBQUM7UUFDcEYsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsaURBQWlELEVBQUUsR0FBRyxFQUFFO1lBQ3ZELFlBQVksR0FBRyxJQUFJLDJCQUFZLENBQUMsVUFBVSxFQUFFLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxDQUFDLENBQUM7WUFFbEUsTUFBTSxDQUFDLFlBQVksQ0FBQyxvQkFBb0IsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUN0RSxNQUFNLENBQUMsWUFBWSxDQUFDLG9CQUFvQixDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzlELE1BQU0sQ0FBQyxZQUFZLENBQUMsb0JBQW9CLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDbEUsTUFBTSxDQUFDLFlBQVksQ0FBQyxvQkFBb0IsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUNqRSxNQUFNLENBQUMsWUFBWSxDQUFDLG9CQUFvQixDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQzNELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGlDQUFpQyxFQUFFLEdBQUcsRUFBRTtZQUN2QyxZQUFZLEdBQUcsSUFBSSwyQkFBWSxDQUFDLFVBQVUsRUFBRSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsQ0FBQyxDQUFDO1lBRWxFLE1BQU0sQ0FBQyxZQUFZLENBQUMsb0JBQW9CLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUM3RSxNQUFNLENBQUMsWUFBWSxDQUFDLG9CQUFvQixDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3RFLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsc0JBQXNCLEVBQUUsR0FBRyxFQUFFO1FBQ2xDLFVBQVUsQ0FBQyxHQUFHLEVBQUU7WUFDWixZQUFZLEdBQUcsSUFBSSwyQkFBWSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ2hELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG9DQUFvQyxFQUFFLEdBQUcsRUFBRTtZQUMxQyxNQUFNLEtBQUssR0FBRyxJQUFJLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1lBQzlDLE1BQU0sS0FBSyxHQUFHLElBQUksSUFBSSxDQUFDLHFCQUFxQixDQUFDLENBQUM7WUFFOUMsTUFBTSxDQUFDLFlBQVksQ0FBQyxvQkFBb0IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUMvRCxNQUFNLENBQUMsWUFBWSxDQUFDLG9CQUFvQixDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ25FLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsaUJBQWlCLEVBQUUsR0FBRyxFQUFFO1FBQzdCLFVBQVUsQ0FBQyxHQUFHLEVBQUU7WUFDWixZQUFZLEdBQUcsSUFBSSwyQkFBWSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ2hELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDRDQUE0QyxFQUFFLEdBQUcsRUFBRTtZQUNsRCxNQUFNLElBQUksR0FBRyxZQUFZLENBQUMsZUFBZSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBRW5ELE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ2pDLE1BQU0sQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ3ZDLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzlELE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUN6RCxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDOUMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsb0RBQW9ELEVBQUUsR0FBRyxFQUFFO1lBQzFELE1BQU0sSUFBSSxHQUFHLFlBQVksQ0FBQyxlQUFlLENBQUMsRUFBRSxDQUFDLENBQUM7WUFFOUMsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxJQUFJLENBQUMsMkJBQTJCLENBQUMsQ0FBQztRQUMvRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxrREFBa0QsRUFBRSxHQUFHLEVBQUU7WUFDeEQsTUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxZQUFZLEVBQUUsYUFBYSxDQUFDLENBQUM7WUFDcEQsTUFBTSxJQUFJLEdBQUcsWUFBWSxDQUFDLGVBQWUsQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUVuRCwyQ0FBMkM7WUFDM0MsTUFBTSxVQUFVLEdBQUcsSUFBSSxVQUFVLENBQUMsT0FBTyxFQUFFO2dCQUN2QyxPQUFPLEVBQUUsSUFBSTtnQkFDYixVQUFVLEVBQUUsSUFBSTthQUNuQixDQUFDLENBQUM7WUFDSCxNQUFNLENBQUMsY0FBYyxDQUFDLFVBQVUsRUFBRSxlQUFlLEVBQUU7Z0JBQy9DLEtBQUssRUFBRSxJQUFJO2dCQUNYLFFBQVEsRUFBRSxLQUFLO2FBQ2xCLENBQUMsQ0FBQztZQUVILElBQUksQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDLENBQUM7WUFFL0IsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQztnQkFDckQsSUFBSSxFQUFFLE9BQU87Z0JBQ2IsYUFBYSxFQUFFLElBQUk7YUFDdEIsQ0FBQyxDQUFDLENBQUM7UUFDUixDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGlCQUFpQixFQUFFLEdBQUcsRUFBRTtRQUM3QixVQUFVLENBQUMsR0FBRyxFQUFFO1lBQ1osWUFBWSxHQUFHLElBQUksMkJBQVksQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNoRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw0Q0FBNEMsRUFBRSxHQUFHLEVBQUU7WUFDbEQsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO1lBQzdCLE1BQU0sUUFBUSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7WUFFL0MsTUFBTSxLQUFLLEdBQUcsWUFBWSxDQUFDLGVBQWUsQ0FBQyxPQUFPLEVBQUUsVUFBVSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1lBRTFFLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ3BDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ2hDLE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ2xDLE1BQU0sQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUMzRCxNQUFNLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzVELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDREQUE0RCxFQUFFLEdBQUcsRUFBRTtZQUNsRSxNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7WUFDN0IsTUFBTSxRQUFRLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUUvQyxNQUFNLEtBQUssR0FBRyxZQUFZLENBQUMsZUFBZSxDQUFDLEVBQUUsRUFBRSxVQUFVLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFFckUsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDakMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsd0NBQXdDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDcEQsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQzFELE1BQU0sUUFBUSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDL0MsTUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxZQUFZLEVBQUUsYUFBYSxDQUFDLENBQUMsaUJBQWlCLENBQUMsU0FBUyxDQUFDLENBQUM7WUFFakYsTUFBTSxLQUFLLEdBQUcsWUFBWSxDQUFDLGVBQWUsQ0FBQyxFQUFFLEVBQUUsVUFBVSxFQUFFLFFBQVEsQ0FBUSxDQUFDO1lBRTVFLGtDQUFrQztZQUNsQyxNQUFNLFFBQVEsR0FBRyxJQUFJLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1lBQ2pELElBQUksS0FBSyxDQUFDLGtCQUFrQixFQUFFLENBQUM7Z0JBQzNCLE1BQU0sS0FBSyxDQUFDLGtCQUFrQixDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztZQUMvQyxDQUFDO1lBRUQsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDbEMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLFVBQVUsRUFBRSxLQUFLLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDbEUsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsdUNBQXVDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbkQsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQzFELE1BQU0sUUFBUSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDL0MsTUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxZQUFZLEVBQUUsYUFBYSxDQUFDLENBQUMsaUJBQWlCLENBQUMsU0FBUyxDQUFDLENBQUM7WUFFakYsTUFBTSxLQUFLLEdBQUcsWUFBWSxDQUFDLGVBQWUsQ0FBQyxTQUFTLEVBQUUsVUFBVSxFQUFFLFFBQVEsQ0FBUSxDQUFDO1lBRW5GLGlDQUFpQztZQUNqQyxJQUFJLEtBQUssQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO2dCQUMxQixNQUFNLEtBQUssQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1lBQ3BDLENBQUM7WUFFRCxNQUFNLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLDBCQUEwQjtZQUN4RCxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsb0JBQW9CLENBQUMsVUFBVSxFQUFFLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQztRQUNsRSxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGFBQWEsRUFBRSxHQUFHLEVBQUU7UUFDekIsVUFBVSxDQUFDLEdBQUcsRUFBRTtZQUNaLFlBQVksR0FBRyxJQUFJLDJCQUFZLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDaEQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNkRBQTZELEVBQUUsR0FBRyxFQUFFO1lBQ25FLE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQztZQUM3QixNQUFNLFNBQVMsR0FBRyxZQUFZLENBQUMsV0FBVyxDQUFDLEVBQUUsRUFBRSxPQUFPLEVBQUUsVUFBVSxDQUFDLENBQUM7WUFFcEUsTUFBTSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDdEMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFFbkUsTUFBTSxJQUFJLEdBQUcsU0FBUyxDQUFDLGFBQWEsQ0FBQyxrQkFBa0IsQ0FBZ0IsQ0FBQztZQUN4RSxNQUFNLEtBQUssR0FBRyxTQUFTLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBcUIsQ0FBQztZQUVuRSxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUM7WUFDMUIsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1lBQzNCLE1BQU0sQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUMxQyw4R0FBOEc7WUFDOUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQy9CLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHFDQUFxQyxFQUFFLEdBQUcsRUFBRTtZQUMzQyxNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7WUFDN0IsTUFBTSxTQUFTLEdBQUcsWUFBWSxDQUFDLFdBQVcsQ0FBQyxFQUFFLEVBQUUsU0FBUyxFQUFFLFVBQVUsQ0FBQyxDQUFDO1lBRXRFLE1BQU0sSUFBSSxHQUFHLFNBQVMsQ0FBQyxhQUFhLENBQUMsa0JBQWtCLENBQWdCLENBQUM7WUFDeEUsTUFBTSxLQUFLLEdBQUcsU0FBUyxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQXFCLENBQUM7WUFFbkUsTUFBTSxDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQzNDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUM3QyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxtQ0FBbUMsRUFBRSxHQUFHLEVBQUU7WUFDekMsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO1lBQzdCLE1BQU0sU0FBUyxHQUFHLFlBQVksQ0FBQyxXQUFXLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxVQUFVLENBQUMsQ0FBQztZQUUvRCxNQUFNLElBQUksR0FBRyxTQUFTLENBQUMsYUFBYSxDQUFDLGtCQUFrQixDQUFnQixDQUFDO1lBQ3hFLE1BQU0sS0FBSyxHQUFHLFNBQVMsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFxQixDQUFDO1lBRW5FLE1BQU0sQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUMzQyxNQUFNLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDN0MsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxhQUFhLEVBQUUsR0FBRyxFQUFFO1FBQ3pCLFVBQVUsQ0FBQyxHQUFHLEVBQUU7WUFDWixZQUFZLEdBQUcsSUFBSSwyQkFBWSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ2hELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHNDQUFzQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2xELE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUMxRCxNQUFNLEtBQUssR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQzlDLEtBQUssQ0FBQyxLQUFLLEdBQUcsT0FBTyxDQUFDO1lBQ3RCLE1BQU0sSUFBSSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7WUFFM0MsTUFBTSxZQUFZLENBQUMsV0FBVyxDQUFDLFVBQVUsRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUM7WUFFeEQsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ2pELE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUN6QyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDekMsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDM0MsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNkJBQTZCLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDekMsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQzFELE1BQU0sS0FBSyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDOUMsS0FBSyxDQUFDLEtBQUssR0FBRyxTQUFTLENBQUM7WUFDeEIsTUFBTSxJQUFJLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUUzQyxNQUFNLFlBQVksQ0FBQyxXQUFXLENBQUMsVUFBVSxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQztZQUV4RCxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsb0JBQW9CLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDNUMsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxJQUFJLENBQUMsMkJBQTJCLENBQUMsQ0FBQztRQUMvRCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGFBQWEsRUFBRSxHQUFHLEVBQUU7UUFDekIsVUFBVSxDQUFDLEdBQUcsRUFBRTtZQUNaLFlBQVksR0FBRyxJQUFJLDJCQUFZLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDaEQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsaURBQWlELEVBQUUsR0FBRyxFQUFFO1lBQ3ZELG9EQUFvRDtZQUNwRCxNQUFNLFNBQVMsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ2hELE1BQU0sSUFBSSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDM0MsTUFBTSxLQUFLLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUU5QyxTQUFTLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzVCLFNBQVMsQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUM7WUFFN0IsTUFBTSxLQUFLLEdBQUcsRUFBRSxhQUFhLEVBQUUsSUFBSSxFQUFzQixDQUFDO1lBRTFELGlEQUFpRDtZQUNqRCxNQUFNLENBQUMsR0FBRyxFQUFFLENBQUMsWUFBWSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUNoRSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxpQ0FBaUMsRUFBRSxHQUFHLEVBQUU7WUFDdkMsTUFBTSxJQUFJLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLGdCQUFnQjtZQUU1RCxNQUFNLEtBQUssR0FBRyxFQUFFLGFBQWEsRUFBRSxJQUFJLEVBQXNCLENBQUM7WUFFMUQsZ0NBQWdDO1lBQ2hDLE1BQU0sQ0FBQyxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ2hFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDBDQUEwQyxFQUFFLEdBQUcsRUFBRTtZQUNoRCxNQUFNLFNBQVMsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ2hELE1BQU0sSUFBSSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDM0MsU0FBUyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLGNBQWM7WUFFM0MsTUFBTSxLQUFLLEdBQUcsRUFBRSxhQUFhLEVBQUUsSUFBSSxFQUFzQixDQUFDO1lBRTFELGdDQUFnQztZQUNoQyxNQUFNLENBQUMsR0FBRyxFQUFFLENBQUMsWUFBWSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUNoRSxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxsZW9kdVxcRG9jdW1lbnRzXFwxIC0gUHJvXFxUZXN0IHBsdWdpbiBvYnNpZGlhblxcLm9ic2lkaWFuXFxwbHVnaW5zXFxvYnNpZGlhbi1DUk1cXGR5bmFtaWMtZmllbGRzXFxzcmNcXF9fdGVzdHNfX1xcUHJvcGVydGllc1xcVGltZVByb3BlcnR5LnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBqZXN0LWVudmlyb25tZW50IGpzZG9tXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgVGltZVByb3BlcnR5IH0gZnJvbSAnLi4vLi4vcHJvcGVydGllcy9UaW1lUHJvcGVydHkgJztcclxuXHJcbi8vIE1vY2sgZmxhdHBpY2tyXHJcbmplc3QubW9jaygnZmxhdHBpY2tyJywgKCkgPT4ge1xyXG4gICAgcmV0dXJuIGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKGVsZW1lbnQsIG9wdGlvbnMpID0+IHtcclxuICAgICAgICAvLyBTaW11bGVyIGwnaW5pdGlhbGl6YXRpb24gZmxhdHBpY2tyXHJcbiAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtZmxhdHBpY2tyJywgJ3RydWUnKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBTaW11bGVyIGxlIHRyaWdnZXIgZGVzIMOpdsOpbmVtZW50cyBmbGF0cGlja3JcclxuICAgICAgICBpZiAob3B0aW9ucz8ub25DaGFuZ2UpIHtcclxuICAgICAgICAgICAgZWxlbWVudC5fZmxhdHBpY2tyT25DaGFuZ2UgPSBvcHRpb25zLm9uQ2hhbmdlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob3B0aW9ucz8ub25DbG9zZSkge1xyXG4gICAgICAgICAgICBlbGVtZW50Ll9mbGF0cGlja3JPbkNsb3NlID0gb3B0aW9ucy5vbkNsb3NlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBkZXN0cm95OiBqZXN0LmZuKCksXHJcbiAgICAgICAgICAgIGNsZWFyOiBqZXN0LmZuKCksXHJcbiAgICAgICAgICAgIHNldERhdGU6IGplc3QuZm4oKVxyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxufSk7XHJcblxyXG4vLyBNb2NrIEZyZW5jaCBsb2NhbGVcclxuamVzdC5tb2NrKCdmbGF0cGlja3IvZGlzdC9sMTBuL2ZyLmpzJywgKCkgPT4gKHtcclxuICAgIEZyZW5jaDoge31cclxufSksIHsgdmlydHVhbDogdHJ1ZSB9KTtcclxuXHJcbmRlc2NyaWJlKCdUaW1lUHJvcGVydHknLCAoKSA9PiB7XHJcbiAgICBsZXQgdGltZVByb3BlcnR5OiBUaW1lUHJvcGVydHk7XHJcblxyXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgLy8gUmVzZXQgRE9NIG1vY2tzXHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBNb2NrIGZvY3VzIHBvdXIgdG91cyBsZXMgw6lsw6ltZW50cyBIVE1MXHJcbiAgICAgICAgSFRNTEVsZW1lbnQucHJvdG90eXBlLmZvY3VzID0gamVzdC5mbigpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2NvbnN0cnVjdG9yJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIFRpbWVQcm9wZXJ0eSB3aXRoIGRlZmF1bHQgZm9ybWF0JywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lUHJvcGVydHkgPSBuZXcgVGltZVByb3BlcnR5KCd0ZXN0VGltZScpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eS5uYW1lKS50b0JlKCd0ZXN0VGltZScpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LnR5cGUpLnRvQmUoJ3RpbWUnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eVsnZm9ybWF0J10pLnRvQmUoJ0hIOm1tJyk7IC8vIGZvcm1hdCBwYXIgZMOpZmF1dFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBUaW1lUHJvcGVydHkgd2l0aCBjdXN0b20gZm9ybWF0JywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lUHJvcGVydHkgPSBuZXcgVGltZVByb3BlcnR5KCd0ZXN0VGltZScsIHsgZm9ybWF0OiAnSEg6bW06c3MnLCBpY29uOiAnY2xvY2snIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eS5uYW1lKS50b0JlKCd0ZXN0VGltZScpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LnR5cGUpLnRvQmUoJ3RpbWUnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eVsnZm9ybWF0J10pLnRvQmUoJ0hIOm1tOnNzJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkuaWNvbikudG9CZSgnY2xvY2snKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCd2YWxpZGF0ZScsICgpID0+IHtcclxuICAgICAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICAgICAgdGltZVByb3BlcnR5ID0gbmV3IFRpbWVQcm9wZXJ0eSgndGVzdFRpbWUnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBjb3JyZWN0IHRpbWUgZm9ybWF0IEhIOm1tJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LnZhbGlkYXRlKCcxNDozMCcpKS50b0JlKCcxNDozMCcpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LnZhbGlkYXRlKCcwOToxNScpKS50b0JlKCcwOToxNScpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LnZhbGlkYXRlKCcwMDowMCcpKS50b0JlKCcwMDowMCcpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LnZhbGlkYXRlKCcyMzo1OScpKS50b0JlKCcyMzo1OScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBlbXB0eSBzdHJpbmcgZm9yIGludmFsaWQgdGltZSBmb3JtYXQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkudmFsaWRhdGUoJzI1OjAwJykpLnRvQmUoJzI1OjAwJyk7IC8vIEZvcm1hdCB2YWxpZGUgbcOqbWUgc2kgaGV1cmUgaW52YWxpZGVcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eS52YWxpZGF0ZSgnMTQ6NzAnKSkudG9CZSgnMTQ6NzAnKTsgLy8gRm9ybWF0IHZhbGlkZSBtw6ptZSBzaSBtaW51dGVzIGludmFsaWRlc1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LnZhbGlkYXRlKCcxNCcpKS50b0JlKCcnKTsgLy8gRm9ybWF0IGluY29tcGxldFxyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LnZhbGlkYXRlKCcxNDozJykpLnRvQmUoJycpOyAvLyBGb3JtYXQgaW5jb3JyZWN0IChwYXMgMiBkaWdpdHMpXHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkudmFsaWRhdGUoJ2FiYycpKS50b0JlKCcnKTsgLy8gVGV4dGUgaW52YWxpZGVcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eS52YWxpZGF0ZSgnJykpLnRvQmUoJycpOyAvLyBDaGHDrm5lIHZpZGVcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdmb3JtYXRUaW1lRm9yRGlzcGxheScsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGZvcm1hdCB0aW1lIGZvciBISDptbSBmb3JtYXQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRpbWVQcm9wZXJ0eSA9IG5ldyBUaW1lUHJvcGVydHkoJ3Rlc3RUaW1lJywgeyBmb3JtYXQ6ICdISDptbScgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LmZvcm1hdFRpbWVGb3JEaXNwbGF5KCcxNDozMCcpKS50b0JlKCcxNDozMCcpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LmZvcm1hdFRpbWVGb3JEaXNwbGF5KCcwOToxNScpKS50b0JlKCcwOToxNScpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LmZvcm1hdFRpbWVGb3JEaXNwbGF5KCcnKSkudG9CZSgnQXVjdW5lIGhldXJlIHPDqWxlY3Rpb25uw6llJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgZm9ybWF0IHRpbWUgZm9yIGN1c3RvbSBmb3JtYXQgd2l0aCB1bml0cycsICgpID0+IHtcclxuICAgICAgICAgICAgdGltZVByb3BlcnR5ID0gbmV3IFRpbWVQcm9wZXJ0eSgndGVzdFRpbWUnLCB7IGZvcm1hdDogJ2N1c3RvbScgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LmZvcm1hdFRpbWVGb3JEaXNwbGF5KCcxNDozMCcpKS50b0JlKCcxNGggMzAgbWluJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkuZm9ybWF0VGltZUZvckRpc3BsYXkoJzA5OjAwJykpLnRvQmUoJzloJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkuZm9ybWF0VGltZUZvckRpc3BsYXkoJzAwOjE1JykpLnRvQmUoJzE1IG1pbicpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LmZvcm1hdFRpbWVGb3JEaXNwbGF5KCcwMDowMCcpKS50b0JlKCcwIG1pbicpO1xyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LmZvcm1hdFRpbWVGb3JEaXNwbGF5KCcnKSkudG9CZSgnJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIHRpbWUgd2l0aCBzZWNvbmRzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lUHJvcGVydHkgPSBuZXcgVGltZVByb3BlcnR5KCd0ZXN0VGltZScsIHsgZm9ybWF0OiAnY3VzdG9tJyB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkuZm9ybWF0VGltZUZvckRpc3BsYXkoJzE0OjMwOjQ1JykpLnRvQmUoJzE0aCAzMCBtaW4gNDVzJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdCh0aW1lUHJvcGVydHkuZm9ybWF0VGltZUZvckRpc3BsYXkoJzAwOjAwOjMwJykpLnRvQmUoJzMwcycpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2Zvcm1hdFRpbWVGb3JTdG9yYWdlJywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lUHJvcGVydHkgPSBuZXcgVGltZVByb3BlcnR5KCd0ZXN0VGltZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGZvcm1hdCBEYXRlIHRvIEhIOm1tIHN0cmluZycsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZGF0ZTEgPSBuZXcgRGF0ZSgnMjAyNC0wMS0wMVQxNDozMDowMCcpO1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlMiA9IG5ldyBEYXRlKCcyMDI0LTAxLTAxVDA5OjE1OjAwJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QodGltZVByb3BlcnR5LmZvcm1hdFRpbWVGb3JTdG9yYWdlKGRhdGUxKSkudG9CZSgnMTQ6MzAnKTtcclxuICAgICAgICAgICAgZXhwZWN0KHRpbWVQcm9wZXJ0eS5mb3JtYXRUaW1lRm9yU3RvcmFnZShkYXRlMikpLnRvQmUoJzA5OjE1Jyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnY3JlYXRlRmllbGRMaW5rJywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lUHJvcGVydHkgPSBuZXcgVGltZVByb3BlcnR5KCd0ZXN0VGltZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBsaW5rIGVsZW1lbnQgd2l0aCB0aW1lIHZhbHVlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gdGltZVByb3BlcnR5LmNyZWF0ZUZpZWxkTGluaygnMTQ6MzAnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rLnRhZ05hbWUpLnRvQmUoJ0RJVicpO1xyXG4gICAgICAgICAgICBleHBlY3QobGluay50ZXh0Q29udGVudCkudG9CZSgnMTQ6MzAnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmsuY2xhc3NMaXN0LmNvbnRhaW5zKCd0aW1lLWZpZWxkLWxpbmsnKSkudG9CZSh0cnVlKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmsuY2xhc3NMaXN0LmNvbnRhaW5zKCdmaWVsZC1saW5rJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rLnN0eWxlLmN1cnNvcikudG9CZSgncG9pbnRlcicpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBsaW5rIHdpdGggZGVmYXVsdCB0ZXh0IHdoZW4gbm8gdmFsdWUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSB0aW1lUHJvcGVydHkuY3JlYXRlRmllbGRMaW5rKCcnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rLnRleHRDb250ZW50KS50b0JlKCdBdWN1bmUgaGV1cmUgc8OpbGVjdGlvbm7DqWUnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgY2xpY2sgZXZlbnQgdG8gdHJpZ2dlciBtb2RpZnlGaWVsZCcsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgc3B5ID0gamVzdC5zcHlPbih0aW1lUHJvcGVydHksICdtb2RpZnlGaWVsZCcpO1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gdGltZVByb3BlcnR5LmNyZWF0ZUZpZWxkTGluaygnMTQ6MzAnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFNpbXVsYXRlIHRoZSBjbGljayBldmVudCBtb3JlIGFjY3VyYXRlbHlcclxuICAgICAgICAgICAgY29uc3QgY2xpY2tFdmVudCA9IG5ldyBNb3VzZUV2ZW50KCdjbGljaycsIHtcclxuICAgICAgICAgICAgICAgIGJ1YmJsZXM6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBjYW5jZWxhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNsaWNrRXZlbnQsICdjdXJyZW50VGFyZ2V0Jywge1xyXG4gICAgICAgICAgICAgICAgdmFsdWU6IGxpbmssXHJcbiAgICAgICAgICAgICAgICB3cml0YWJsZTogZmFsc2VcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBsaW5rLmRpc3BhdGNoRXZlbnQoY2xpY2tFdmVudCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3Qoc3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiAnY2xpY2snLFxyXG4gICAgICAgICAgICAgICAgY3VycmVudFRhcmdldDogbGlua1xyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnY3JlYXRlRmllbGRUaW1lJywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lUHJvcGVydHkgPSBuZXcgVGltZVByb3BlcnR5KCd0ZXN0VGltZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBpbnB1dCBlbGVtZW50IHdpdGggZmxhdHBpY2tyJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrTGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSB0aW1lUHJvcGVydHkuY3JlYXRlRmllbGRUaW1lKCcxNDozMCcsIG1vY2tVcGRhdGUsIG1vY2tMaW5rKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChpbnB1dC50YWdOYW1lKS50b0JlKCdJTlBVVCcpO1xyXG4gICAgICAgICAgICBleHBlY3QoaW5wdXQudHlwZSkudG9CZSgndGV4dCcpO1xyXG4gICAgICAgICAgICBleHBlY3QoaW5wdXQudmFsdWUpLnRvQmUoJzE0OjMwJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChpbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoJ2ZpZWxkLWlucHV0JykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChpbnB1dC5oYXNBdHRyaWJ1dGUoJ2RhdGEtZmxhdHBpY2tyJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIGlucHV0IHdpdGggZW1wdHkgdmFsdWUgd2hlbiBubyBpbml0aWFsIHZhbHVlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrTGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSB0aW1lUHJvcGVydHkuY3JlYXRlRmllbGRUaW1lKCcnLCBtb2NrVXBkYXRlLCBtb2NrTGluayk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QoaW5wdXQudmFsdWUpLnRvQmUoJycpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBmbGF0cGlja3Igb25DaGFuZ2UgZXZlbnQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja0xpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29uc3Qgc3B5ID0gamVzdC5zcHlPbih0aW1lUHJvcGVydHksICd1cGRhdGVGaWVsZCcpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBpbnB1dCA9IHRpbWVQcm9wZXJ0eS5jcmVhdGVGaWVsZFRpbWUoJycsIG1vY2tVcGRhdGUsIG1vY2tMaW5rKSBhcyBhbnk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBTaW11bGVyIGxlIGNoYW5nZW1lbnQgZmxhdHBpY2tyXHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tEYXRlID0gbmV3IERhdGUoJzIwMjQtMDEtMDFUMTU6NDU6MDAnKTtcclxuICAgICAgICAgICAgaWYgKGlucHV0Ll9mbGF0cGlja3JPbkNoYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgaW5wdXQuX2ZsYXRwaWNrck9uQ2hhbmdlKFttb2NrRGF0ZV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QoaW5wdXQudmFsdWUpLnRvQmUoJzE1OjQ1Jyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChzcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1vY2tVcGRhdGUsIGlucHV0LCBtb2NrTGluayk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGZsYXRwaWNrciBvbkNsb3NlIGV2ZW50JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tMaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHNweSA9IGplc3Quc3B5T24odGltZVByb3BlcnR5LCAndXBkYXRlRmllbGQnKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSB0aW1lUHJvcGVydHkuY3JlYXRlRmllbGRUaW1lKCdpbnZhbGlkJywgbW9ja1VwZGF0ZSwgbW9ja0xpbmspIGFzIGFueTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFNpbXVsZXIgbGEgZmVybWV0dXJlIGZsYXRwaWNrclxyXG4gICAgICAgICAgICBpZiAoaW5wdXQuX2ZsYXRwaWNrck9uQ2xvc2UpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IGlucHV0Ll9mbGF0cGlja3JPbkNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChpbnB1dC52YWx1ZSkudG9CZSgnJyk7IC8vIFZhbGV1ciBpbnZhbGlkZSBlZmZhY8OpZVxyXG4gICAgICAgICAgICBleHBlY3Qoc3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChtb2NrVXBkYXRlLCBpbnB1dCwgbW9ja0xpbmspO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2ZpbGxEaXNwbGF5JywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lUHJvcGVydHkgPSBuZXcgVGltZVByb3BlcnR5KCd0ZXN0VGltZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBjb250YWluZXIgd2l0aCBsaW5rIGFuZCBpbnB1dCBmb3IgdmFsaWQgdmFsdWUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVcGRhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRpbWVQcm9wZXJ0eS5maWxsRGlzcGxheSh7fSwgJzE0OjMwJywgbW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QoY29udGFpbmVyLnRhZ05hbWUpLnRvQmUoJ0RJVicpO1xyXG4gICAgICAgICAgICBleHBlY3QoY29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucygnZmllbGQtY29udGFpbmVyJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy50aW1lLWZpZWxkLWxpbmsnKSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignaW5wdXQnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmspLnRvQmVUcnV0aHkoKTtcclxuICAgICAgICAgICAgZXhwZWN0KGlucHV0KS50b0JlVHJ1dGh5KCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChsaW5rPy5zdHlsZS5kaXNwbGF5KS50b0JlKCdibG9jaycpO1xyXG4gICAgICAgICAgICAvLyBMJ2lucHV0IGVzdCBpbml0aWFsaXPDqSBwYXIgZmxhdHBpY2tyLCBkb25jIG9uIHbDqXJpZmllIHF1J2lsIGV4aXN0ZSBtYWlzIHBhcyBuw6ljZXNzYWlyZW1lbnQgcXUnaWwgc29pdCBjYWNow6lcclxuICAgICAgICAgICAgZXhwZWN0KGlucHV0KS50b0JlVHJ1dGh5KCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgc2hvdyBpbnB1dCBmb3IgaW52YWxpZCB2YWx1ZScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VwZGF0ZSA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGltZVByb3BlcnR5LmZpbGxEaXNwbGF5KHt9LCAnaW52YWxpZCcsIG1vY2tVcGRhdGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgbGluayA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcudGltZS1maWVsZC1saW5rJykgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0JykgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChpbnB1dD8uc3R5bGUuZGlzcGxheSkudG9CZSgnYmxvY2snKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbms/LnN0eWxlLmRpc3BsYXkpLnRvQmUoJ25vbmUnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBzaG93IGlucHV0IGZvciBlbXB0eSB2YWx1ZScsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VwZGF0ZSA9IGplc3QuZm4oKTtcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGltZVByb3BlcnR5LmZpbGxEaXNwbGF5KHt9LCAnJywgbW9ja1VwZGF0ZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy50aW1lLWZpZWxkLWxpbmsnKSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignaW5wdXQnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KGlucHV0Py5zdHlsZS5kaXNwbGF5KS50b0JlKCdibG9jaycpO1xyXG4gICAgICAgICAgICBleHBlY3QobGluaz8uc3R5bGUuZGlzcGxheSkudG9CZSgnbm9uZScpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ3VwZGF0ZUZpZWxkJywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lUHJvcGVydHkgPSBuZXcgVGltZVByb3BlcnR5KCd0ZXN0VGltZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHVwZGF0ZSBmaWVsZCB3aXRoIHZhbGlkIHZhbHVlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXBkYXRlID0gamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcclxuICAgICAgICAgICAgaW5wdXQudmFsdWUgPSAnMTQ6MzAnO1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBhd2FpdCB0aW1lUHJvcGVydHkudXBkYXRlRmllbGQobW9ja1VwZGF0ZSwgaW5wdXQsIGxpbmspO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tVcGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcxNDozMCcpO1xyXG4gICAgICAgICAgICBleHBlY3QoaW5wdXQuc3R5bGUuZGlzcGxheSkudG9CZSgnbm9uZScpO1xyXG4gICAgICAgICAgICBleHBlY3QobGluay5zdHlsZS5kaXNwbGF5KS50b0JlKCdibG9jaycpO1xyXG4gICAgICAgICAgICBleHBlY3QobGluay50ZXh0Q29udGVudCkudG9CZSgnMTQ6MzAnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgaW52YWxpZCB2YWx1ZScsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VwZGF0ZSA9IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xyXG4gICAgICAgICAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XHJcbiAgICAgICAgICAgIGlucHV0LnZhbHVlID0gJ2ludmFsaWQnO1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBhd2FpdCB0aW1lUHJvcGVydHkudXBkYXRlRmllbGQobW9ja1VwZGF0ZSwgaW5wdXQsIGxpbmspO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tVcGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcnKTtcclxuICAgICAgICAgICAgZXhwZWN0KGxpbmsudGV4dENvbnRlbnQpLnRvQmUoJ0F1Y3VuZSBoZXVyZSBzw6lsZWN0aW9ubsOpZScpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ21vZGlmeUZpZWxkJywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lUHJvcGVydHkgPSBuZXcgVGltZVByb3BlcnR5KCd0ZXN0VGltZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGNhbGwgbW9kaWZ5RmllbGQgd2l0aG91dCB0aHJvd2luZyBlcnJvcnMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIFRlc3QgcXVlIG1vZGlmeUZpZWxkIHBldXQgw6p0cmUgYXBwZWzDqSBzYW5zIGVycmV1clxyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQobGluayk7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChpbnB1dCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBldmVudCA9IHsgY3VycmVudFRhcmdldDogbGluayB9IGFzIHVua25vd24gYXMgRXZlbnQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBWw6lyaWZpZXIgcXVlIG1vZGlmeUZpZWxkIG5lIGxhbmNlIHBhcyBkJ2VycmV1clxyXG4gICAgICAgICAgICBleHBlY3QoKCkgPT4gdGltZVByb3BlcnR5Lm1vZGlmeUZpZWxkKGV2ZW50KSkubm90LnRvVGhyb3coKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWlzc2luZyBjb250YWluZXInLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsgLy8gUGFzIGRlIHBhcmVudFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSB7IGN1cnJlbnRUYXJnZXQ6IGxpbmsgfSBhcyB1bmtub3duIGFzIEV2ZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gTmUgZGV2cmFpdCBwYXMgbGV2ZXIgZCdlcnJldXJcclxuICAgICAgICAgICAgZXhwZWN0KCgpID0+IHRpbWVQcm9wZXJ0eS5tb2RpZnlGaWVsZChldmVudCkpLm5vdC50b1Rocm93KCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIG1pc3NpbmcgaW5wdXQgaW4gY29udGFpbmVyJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQobGluayk7IC8vIFBhcyBkJ2lucHV0XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBldmVudCA9IHsgY3VycmVudFRhcmdldDogbGluayB9IGFzIHVua25vd24gYXMgRXZlbnQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBOZSBkZXZyYWl0IHBhcyBsZXZlciBkJ2VycmV1clxyXG4gICAgICAgICAgICBleHBlY3QoKCkgPT4gdGltZVByb3BlcnR5Lm1vZGlmeUZpZWxkKGV2ZW50KSkubm90LnRvVGhyb3coKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59KTsiXSwidmVyc2lvbiI6M30=